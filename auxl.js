(()=>{var e={537:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var o=i(81),a=i.n(o),n=i(645),s=i.n(n)()(a());s.push([e.id,'/* MVP.css v1.12 - https://github.com/andybrewer/mvp */\n\n:root {\n    --active-brightness: 0.85;\n    --border-radius: 5px;\n    --box-shadow: 2px 2px 10px;\n    --color-accent: #118bee15;\n    --color-bg: #fff;\n    --color-bg-secondary: #e9e9e9;\n    --color-link: #118bee;\n    --color-secondary: #920de9;\n    --color-secondary-accent: #920de90b;\n    --color-shadow: #f4f4f4;\n    --color-table: #118bee;\n    --color-text: #000;\n    --color-text-secondary: #999;\n    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;\n    --hover-brightness: 1.2;\n    --justify-important: center;\n    --justify-normal: left;\n    --line-height: 1.5;\n    --width-card: 285px;\n    --width-card-medium: 460px;\n    --width-card-wide: 800px;\n    --width-content: 1080px;\n}\n\n@media (prefers-color-scheme: dark) {\n    :root[color-mode="user"] {\n        --color-accent: #0097fc4f;\n        --color-bg: #333;\n        --color-bg-secondary: #555;\n        --color-link: #0097fc;\n        --color-secondary: #e20de9;\n        --color-secondary-accent: #e20de94f;\n        --color-shadow: #bbbbbb20;\n        --color-table: #0097fc;\n        --color-text: #f7f7f7;\n        --color-text-secondary: #aaa;\n    }\n}\n\n/* Layout */\narticle aside {\n    background: var(--color-secondary-accent);\n    border-left: 4px solid var(--color-secondary);\n    padding: 0.01rem 0.8rem;\n}\n\nbody {\n    background: var(--color-bg);\n    color: var(--color-text);\n    font-family: var(--font-family);\n    line-height: var(--line-height);\n    margin: 0;\n    overflow-x: hidden;\n    padding: 0;\n}\n\nfooter,\nheader,\nmain {\n    margin: 0 auto;\n    max-width: var(--width-content);\n    padding: 3rem 1rem;\n}\n\nhr {\n    background-color: var(--color-bg-secondary);\n    border: none;\n    height: 1px;\n    margin: 4rem 0;\n    width: 100%;\n}\n\nsection {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: var(--justify-important);\n}\n\nsection img,\narticle img {\n    max-width: 100%;\n}\n\nsection pre {\n    overflow: auto;\n}\n\nsection aside {\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow) var(--color-shadow);\n    margin: 1rem;\n    padding: 1.25rem;\n    width: var(--width-card);\n}\n\nsection aside:hover {\n    box-shadow: var(--box-shadow) var(--color-bg-secondary);\n}\n\n[hidden] {\n    display: none;\n}\n\n/* Headers */\narticle header,\ndiv header,\nmain header {\n    padding-top: 0;\n}\n\nheader {\n    text-align: var(--justify-important);\n}\n\nheader a b,\nheader a em,\nheader a i,\nheader a strong {\n    margin-left: 0.5rem;\n    margin-right: 0.5rem;\n}\n\nheader nav img {\n    margin: 1rem 0;\n}\n\nsection header {\n    padding-top: 0;\n    width: 100%;\n}\n\n/* Nav */\nnav {\n    align-items: center;\n    display: flex;\n    font-weight: bold;\n    justify-content: space-between;\n    margin-bottom: 7rem;\n}\n\nnav ul {\n    list-style: none;\n    padding: 0;\n}\n\nnav ul li {\n    display: inline-block;\n    margin: 0 0.5rem;\n    position: relative;\n    text-align: left;\n}\n\n/* Nav Dropdown */\nnav ul li:hover ul {\n    display: block;\n}\n\nnav ul li ul {\n    background: var(--color-bg);\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow) var(--color-shadow);\n    display: none;\n    height: auto;\n    left: -2px;\n    padding: .5rem 1rem;\n    position: absolute;\n    top: 1.7rem;\n    white-space: nowrap;\n    width: auto;\n    z-index: 1;\n}\n\nnav ul li ul::before {\n    /* fill gap above to make mousing over them easier */\n    content: "";\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -0.5rem;\n    height: 0.5rem;\n}\n\nnav ul li ul li,\nnav ul li ul li a {\n    display: block;\n}\n\n/* Typography */\ncode,\nsamp {\n    background-color: var(--color-accent);\n    border-radius: var(--border-radius);\n    color: var(--color-text);\n    display: inline-block;\n    margin: 0 0.1rem;\n    padding: 0 0.5rem;\n}\n\ndetails {\n    margin: 1.3rem 0;\n}\n\ndetails summary {\n    font-weight: bold;\n    cursor: pointer;\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n    line-height: var(--line-height);\n}\n\nmark {\n    padding: 0.1rem;\n}\n\nol li,\nul li {\n    padding: 0.2rem 0;\n}\n\np {\n    margin: 0.75rem 0;\n    padding: 0;\n    width: 100%;\n}\n\npre {\n    margin: 1rem 0;\n    max-width: var(--width-card-wide);\n    padding: 1rem 0;\n}\n\npre code,\npre samp {\n    display: block;\n    max-width: var(--width-card-wide);\n    padding: 0.5rem 2rem;\n    white-space: pre-wrap;\n}\n\nsmall {\n    color: var(--color-text-secondary);\n}\n\nsup {\n    background-color: var(--color-secondary);\n    border-radius: var(--border-radius);\n    color: var(--color-bg);\n    font-size: xx-small;\n    font-weight: bold;\n    margin: 0.2rem;\n    padding: 0.2rem 0.3rem;\n    position: relative;\n    top: -2px;\n}\n\n/* Links */\na {\n    color: var(--color-link);\n    display: inline-block;\n    font-weight: bold;\n    text-decoration: none;\n}\n\na:active {\n    filter: brightness(var(--active-brightness));\n    text-decoration: underline;\n}\n\na:hover {\n    filter: brightness(var(--hover-brightness));\n    text-decoration: underline;\n}\n\na b,\na em,\na i,\na strong,\nbutton,\ninput[type="submit"] {\n    border-radius: var(--border-radius);\n    display: inline-block;\n    font-size: medium;\n    font-weight: bold;\n    line-height: var(--line-height);\n    margin: 0;\n    padding: 0.5rem 1rem;\n}\n\nbutton,\ninput[type="submit"] {\n    font-family: var(--font-family);\n}\n\nbutton:active,\ninput[type="submit"]:active {\n    filter: brightness(var(--active-brightness));\n}\n\nbutton:hover,\ninput[type="submit"]:hover {\n    cursor: pointer;\n    filter: brightness(var(--hover-brightness));\n}\n\na b,\na strong,\nbutton,\ninput[type="submit"] {\n    background-color: var(--color-link);\n    border: 2px solid var(--color-link);\n    color: var(--color-bg);\n}\n\na em,\na i {\n    border: 2px solid var(--color-link);\n    border-radius: var(--border-radius);\n    color: var(--color-link);\n    display: inline-block;\n    padding: 1rem 2rem;\n}\n\narticle aside a {\n    color: var(--color-secondary);\n}\n\n/* Images */\nfigure {\n    margin: 0;\n    padding: 0;\n}\n\nfigure img {\n    max-width: 100%;\n}\n\nfigure figcaption {\n    color: var(--color-text-secondary);\n}\n\n/* Forms */\nbutton:disabled,\ninput:disabled {\n    background: var(--color-bg-secondary);\n    border-color: var(--color-bg-secondary);\n    color: var(--color-text-secondary);\n    cursor: not-allowed;\n}\n\nbutton[disabled]:hover,\ninput[type="submit"][disabled]:hover {\n    filter: none;\n}\n\nform {\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow) var(--color-shadow);\n    display: block;\n    max-width: var(--width-card-wide);\n    min-width: var(--width-card);\n    padding: 1.5rem;\n    text-align: var(--justify-normal);\n}\n\nform header {\n    margin: 1.5rem 0;\n    padding: 1.5rem 0;\n}\n\ninput,\nlabel,\nselect,\ntextarea {\n    display: block;\n    font-size: inherit;\n    max-width: var(--width-card-wide);\n}\n\ninput[type="checkbox"],\ninput[type="radio"] {\n    display: inline-block;\n}\n\ninput[type="checkbox"]+label,\ninput[type="radio"]+label {\n    display: inline-block;\n    font-weight: normal;\n    position: relative;\n    top: 1px;\n}\n\ninput[type="range"] {\n    padding: 0.4rem 0;\n}\n\ninput,\nselect,\ntextarea {\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    margin-bottom: 1rem;\n    padding: 0.4rem 0.8rem;\n}\n\ninput[type="text"],\ntextarea {\n    width: calc(100% - 1.6rem);\n}\n\ninput[readonly],\ntextarea[readonly] {\n    background-color: var(--color-bg-secondary);\n}\n\nlabel {\n    font-weight: bold;\n    margin-bottom: 0.2rem;\n}\n\n/* Popups */\ndialog {\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow) var(--color-shadow);\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 50%;\n    z-index: 999;\n}\n\n/* Tables */\ntable {\n    border: 1px solid var(--color-bg-secondary);\n    border-radius: var(--border-radius);\n    border-spacing: 0;\n    display: inline-block;\n    max-width: 100%;\n    overflow-x: auto;\n    padding: 0;\n    white-space: nowrap;\n}\n\ntable td,\ntable th,\ntable tr {\n    padding: 0.4rem 0.8rem;\n    text-align: var(--justify-important);\n}\n\ntable thead {\n    background-color: var(--color-table);\n    border-collapse: collapse;\n    border-radius: var(--border-radius);\n    color: var(--color-bg);\n    margin: 0;\n    padding: 0;\n}\n\ntable thead th:first-child {\n    border-top-left-radius: var(--border-radius);\n}\n\ntable thead th:last-child {\n    border-top-right-radius: var(--border-radius);\n}\n\ntable thead th:first-child,\ntable tr td:first-child {\n    text-align: var(--justify-normal);\n}\n\ntable tr:nth-child(even) {\n    background-color: var(--color-accent);\n}\n\n/* Quotes */\nblockquote {\n    display: block;\n    font-size: x-large;\n    line-height: var(--line-height);\n    margin: 1rem auto;\n    max-width: var(--width-card-medium);\n    padding: 1.5rem 1rem;\n    text-align: var(--justify-important);\n}\n\nblockquote footer {\n    color: var(--color-text-secondary);\n    display: block;\n    font-size: small;\n    line-height: var(--line-height);\n    padding: 1.5rem 0;\n}\n',""]);const r=s},524:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var o=i(81),a=i.n(o),n=i(645),s=i.n(n)()(a());s.push([e.id,'/* style.css */\n\nhtml {\nscroll-behavior: smooth;\n}\n\nbody {\nbackground-color: transparent;\nbackground-image: none;\nbackground-repeat: repeat;\ntouch-action: manipulation;\n}\n\n\nheader {\npadding-bottom: 0;\n}\n\nh2 {\ntext-align: var(--justify-important);\n}\n\nsection aside {\nborder: none;\n}\n\n.sticky {\nposition: -webkit-sticky;\nposition: sticky;\ntop: 0;\nz-index: 100;\n}\n\n.flexRow {\ndisplay: flex;\nflex-direction: row;\njustify-content: space-between;\n}\n\n.flexStart {\njustify-content: flex-start;\n}\n\n.flexCol {\ndisplay: flex;\nflex-direction: column;\njustify-content: center;\n}\n\n.flexRowCenter {\ndisplay: flex;\nflex-direction: row;\njustify-content: center;\n}\n\n.a-enter-ar, .a-enter-vr {\nposition: fixed;\n}\n\n#stickyBar {\npadding: 0.25em;\nbackground-color: transparent !Important;\nheight: 2.75em;\n}\n\n#stickyTitle h5 {\nmargin-bottom: 0;\nmargin-left: 0.25em;\n--color: var(--h1-color);\njustify-content: flex-start;\n}\n\n#stickyButton {\npadding: 0.9em;\nbackground-color: #C14B76;\n}\n\n#stickyTheme {\nmargin-bottom: 0;\n\n}\n\n#stickyIcon {\nbackground-color: var(--background-color);\nborder-radius: 50%;\n}\n\n#contactButton {\ndisplay: flex;\njustify-content: center;\n}\n\n#photo {\ndisplay: flex;\njustify-content: center;\nborder-radius: 50%;\nborder: solid;\nborder-color: #46c496;\n}\n\n#topButton {\ndisplay: flex;\njustify-content: center;\n}\n\n@media screen and (max-width: 600px) {\n\t#stickyTitle h3 {\n\tfont-size: small;\n\t}\n}\n\n#beginDiv{\nposition: absolute;\nz-index: 1000;\nbackground-color: #C14B76;\npadding: 1.75em;\ndisplay: flex;\nflex-direction: column;\nlist-style: none;\ntop: 50%;\nleft: 50%;\n-ms-transform: translate(-50%, -50%);\ntransform: translate(-50%, -50%);\nborder-radius: 15%;\n}\n\n#beginDiv li{\nmargin-bottom: 0.5em;\n}\n\n#expInfo{\ndisplay: none;\nposition: absolute;\nz-index: 1000;\nbackground-color: #C14B76;\npadding: 1.75em;\nflex-direction: column;\nlist-style: none;\ntop: 50%;\nleft: 50%;\n-ms-transform: translate(-50%, -50%);\ntransform: translate(-50%, -50%);\nborder-radius: 15%;\n}\n\n#dataInfo{\ndisplay: none;\nposition: absolute;\nz-index: 1000;\nbackground-color: #C14B76;\npadding: 1.75em;\nflex-direction: column;\nlist-style: none;\ntop: 50%;\nleft: 50%;\n-ms-transform: translate(-50%, -50%);\ntransform: translate(-50%, -50%);\nborder-radius: 15%;\n}\n\n#vrHandButton{\ndisplay: none;\n}\n\n#vrLocomotionType{\ndisplay: none;\n}\n\n#audioVolume{\ndisplay: none;\n}\n\n#volUpButton{\ndisplay: flex;\n}\n\n#volume{\ndisplay: flex;\n}\n\n#volDownButton{\ndisplay: flex;\n}\n\n\n/* HTML Controller */\n\n/* Controller Block */\n#controllerBlock {\ndisplay: none;\nposition: absolute;\njustify-content: space-around;\nz-index: 2;\npointer-events: none;\n}\n\n.column {\nwidth: 33%;\ndisplay: flex;\nflex-direction: column;\njustify-content: space-around;\n}\n\n.col1 {\njustify-content: space-around;\n}\n\n.col2 {\njustify-content: flex-end;\nmargin-bottom: 1rem;\n}\n\n.col3 {\njustify-content: center;\n}\n\n.directions{\ndisplay: flex;\njustify-content: space-evenly;\n}\n\n.startselect{\ndisplay: flex;\njustify-content: space-evenly;\n}\n\n.abcdef{\ndisplay: flex;\njustify-content: space-evenly;\n}\n\n.a{\ndisplay: flex;\njustify-content: flex-start;\nmargin-top: 6rem;\n}\n\n.d{\ndisplay: flex;\njustify-content: flex-start;\nmargin-top: 2rem;\n}\n\n.b{\ndisplay: flex;\njustify-content: center;\nmargin-top: 4rem;\n}\n\n.e{\ndisplay: flex;\njustify-content: center;\nmargin-top: 2rem;\n}\n\n.c{\ndisplay: flex;\njustify-content: flex-end;\nmargin-top: 2rem;\n}\n\n.f{\ndisplay: flex;\njustify-content: flex-end;\nmargin-top: 2rem;\n}\n\n#center, #start, #select, #a, #b, #c, #d, #e, #f, #l, #r{\ndisplay: none;\n}\n\n.directionButtons {\nheight: 8em;\n}\n\n.startSelectButtons {\nheight: 3.5em;\npadding: 0 1.25em 0 1.6em;\n}\n\n.actionButtons {\nheight: 5em;\n}\n\n.directionButtons, .startSelectButtons, .abcdef button{\npointer-events: auto;\nbackground-color: transparent;\nborder-radius: 4px;\nbox-shadow: inset 0 0 0 2px #e5e2e2;\ncolor: #e5e2e2 !important;\ncursor: pointer;\ndisplay: inline-block;\nfont-size: 0.7em;\nfont-weight: 900;\nheight: 3.5em;\nletter-spacing: 0.35em;\noverflow: hidden;\npadding: 1rem;\ntext-align: center;\ntext-decoration: none;\ntext-overflow: ellipsis;\nwhite-space: nowrap;\n-webkit-user-select: none; /* Safari */\n-ms-user-select: none; /* IE 10+ */\nuser-select: none;\n}\n\n.snapView {\nposition: absolute;\ndisplay: flex;\njustify-content: space-between;\nwidth: 100%;\nheight: 550%;\nz-index: -1;\nbottom: -50%;\n}\n\n.snapView button{\npointer-events: auto;\nbackground-color: transparent;\nborder: 0;\ncursor: pointer;\ndisplay: inline-block;\nfont-size: 0.7em;\nfont-weight: 900;\nletter-spacing: 0.35em;\nwidth: 20vw;\npadding: 1rem;\ntext-align: center;\ntext-decoration: none;\ntext-overflow: ellipsis;\nwhite-space: nowrap;\n-webkit-user-select: none; /* Safari */\n-ms-user-select: none; /* IE 10+ */\nuser-select: none;\n}\n\n#scenarioHeaderTitle {\n\tmargin-right: 0.5em;\n}\n\n#stickyMenu {\n\tbackground-color: transparent;\n}\n\n.stickyButtons {\n\tbackground-color: transparent;\n}\n\n\n#menuModeButton {\n\tbackground-color: red!Important;\n}\n\n\n/* Portrait */\n@media screen and (orientation:portrait) {\n\t/*Testing\n\t#stickyTitle {\n\t\tcolor: blue;\n\t}*/\n\n\n\t/* Controller Block */\n\t#controllerBlock {\n\t\twidth: 100%;\n\t\theight: 20%;\n\t\ttop: 75%;\n\t}\n\n\t.directionButtons, .startSelectButtons, .abcdef button{\n\t\tfont-size: 0.5em;\n\t}\n\n\t.col2 {\n\t\tmargin-bottom: -1rem;\n\t}\n\n}\n\n/* Landscape */\n@media screen and (orientation:landscape) {\n\t/*Testing\n\t#stickyTitle {\n\t\tcolor: red;\n\t}*/\n\n\n\t/* Controller Block */\n\t#controllerBlock {\n\t\twidth: 100%;\n\t\theight: 15%;\n\t\ttop: 60%;\n\t}\n\n\t.col2 {\n\t\tmargin-bottom: -5rem;\n\t}\n\n}\n\n\n.a-dialog-allow-button {\n\tbackground-color: red;\n}\n\n.a-dialog-deny-button {\n\tbackground-color: blue;\n}\n\n.a-dialog-ok-button {\n\tbackground-color: green;\n}\n.a-dialog {\n\tcolor: #b2b1b1;\n}\n\n:root {\n    --active-brightness: 0.45;\n    --border-radius: 5px;\n    --box-shadow: 2px 2px 10px;\n    --color-accent: #118bee15;\n    --color-bg: #fff;\n    --color-bg-secondary: #e9e9e9;\n    --color-link: #46c496;\n    --color-secondary: #f2849e;\n    --color-secondary-accent: #920de90b;\n    --color-shadow: #393434;\n    --color-table: #118bee;\n    --color-text: #FFFFFF;\n    --color-text-secondary: #999;\n    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;\n    --hover-brightness: 1.2;\n    --justify-important: center;\n    --justify-normal: left;\n    --line-height: 1.5;\n    --width-card: 420px;\n    --width-card-medium: 460px;\n    --width-card-wide: 800px;\n    --width-content: 1080px;\n}',""]);const r=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",o=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),o&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),o&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,o,a,n){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var h=[].concat(e[c]);o&&s[h[0]]||(void 0!==n&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=n),i&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=i):h[2]=i),a&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=a):h[4]="".concat(a)),t.push(h))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function i(e){for(var i=-1,o=0;o<t.length;o++)if(t[o].identifier===e){i=o;break}return i}function o(e,o){for(var n={},s=[],r=0;r<e.length;r++){var l=e[r],c=o.base?l[0]+o.base:l[0],h=n[c]||0,d="".concat(c," ").concat(h);n[c]=h+1;var p=i(d),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var m=a(u,o);o.byIndex=r,t.splice(r,0,{identifier:d,updater:m,references:1})}s.push(d)}return s}function a(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,a){var n=o(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<n.length;s++){var r=i(n[s]);t[r].references--}for(var l=o(e,a),c=0;c<n.length;c++){var h=i(n[c]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}n=l}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var o=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(i)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var o="";i.supports&&(o+="@supports (".concat(i.supports,") {")),i.media&&(o+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(o+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),o+=i.css,a&&(o+="}"),i.media&&(o+="}"),i.supports&&(o+="}");var n=i.sourceMap;n&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},655:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},72:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=72,e.exports=t}},t={};function i(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={id:o,exports:{}};return e[o](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nc=void 0,(()=>{"use strict";const e=(e,t)=>{let o=JSON.parse(JSON.stringify(t));o.inScene=!1,o.el={},o.dom=!1,o.domInterval,o.events={},o.parent=!1,o.hasOwnProperty("defaultParent")||(o.defaultParent=!1),o.gridSpawned=!1,o.gridPath=[],o.pathSpeed=1e3,o.pathWait=1e3,o.pathRoute="any",o.pathLoop="infinite",o.pathType="jump",o.currentPath=-1,o.gridPathInterval,o.gridPathTimeout;let a=!1,n=!1,s=!1,r=!1;async function l(e){const t=await fetch(e);return await i(72)(t.url),!0}function c(){e.loadingObjects.set(o.id,!0),e.loadingScene||(e.loadingScene=!0)}function h(){e.loadingObjects.delete(o.id),m(!0),e.el.emit(o.id+"spawned",{})}const d=()=>{if(o.el={},o.sources){let t=Object.keys(o.sources),i=Object.values(o.sources);for(let a in t)if(e.jsLoaded.hasOwnProperty(t[a]))!1===e.jsLoaded[t[a]]&&(console.log(o.id),console.log("JS is not yet loaded"),e.spawnedWaitingForJS[t[a]].push({id:o.id,properties:o.components[t[a]]}));else{function r(){console.log(t[a]),console.log("Done"),e.jsLoaded[t[a]]=!0,b({property:t[a],value:o.components[t[a]]}),console.log(e.spawnedWaitingForJS);for(let i in e.spawnedWaitingForJS[t[a]]){let o=e.spawnedWaitingForJS[t[a]][i].id,n=e.spawnedWaitingForJS[t[a]][i].properties;console.log(o),console.log(n),document.getElementById(o).setAttribute(t[a],n)}delete e.spawnedWaitingForJS[t[a]],console.log(e.spawnedWaitingForJS)}e.spawnedWaitingForJS[t[a]]=[],console.log(t[a]),console.log(i[a]),e.jsLoaded[t[a]]=!1,l(i[a]).then(r)}}if("preAdded"===o.entity?document.getElementById(o.id)?o.el=document.getElementById(o.id):o.el=document.createElement("a-entity"):o.entity?o.el=document.createElement(o.entity):o.el=document.createElement("a-entity"),e.audioEnabled){let c={};if(o.sound&&(c=JSON.parse(JSON.stringify(o.sound)),c.volume||(c.volume=1),c.volume*=e.volume,o.el.setAttribute("auxsound",c)),o.sounds)for(let h in o.sounds)c=JSON.parse(JSON.stringify(o.sounds[h])),c.volume||(c.volume=1),c.volume*=e.volume,o.el.setAttribute("auxsound__"+h,c)}if(o.text&&o.el.setAttribute("text",o.text),o.el.setAttribute("id",o.id),o.geometry&&o.el.setAttribute("geometry",o.geometry),o.material&&(o.material.src&&(s=!0),o.el.setAttribute("material",o.material)),o.position&&o.el.setAttribute("position",o.position),o.rotation&&o.el.setAttribute("rotation",o.rotation),o.scale&&o.el.setAttribute("scale",o.scale),o.mixins&&o.el.setAttribute("mixins",o.mixins),o.classes?o.el.classList.add(...o.classes):o.el.classList.add("a-ent"),o.hasOwnProperty("animations")){let d=Object.keys(o.animations),p=Object.values(o.animations);for(let u in d)0===u||o.el.setAttribute("animation__"+d[u],p[u])}if(o.hasOwnProperty("components")){(o.components["gltf-model"]||o.components["obj-model"])&&(n=!0);let m=Object.keys(o.components),y=Object.values(o.components);for(let g in m)if(0===g);else if(e.jsAll.hasOwnProperty(m[g]))if(e.jsLoaded.hasOwnProperty(m[g]))!1===e.jsLoaded[m[g]]?e.spawnedWaitingForJS[m[g]].push({id:o.id,properties:o.components[m[g]]}):o.el.setAttribute(m[g],y[g]);else{function v(){e.jsLoaded[m[g]]=!0,b({property:m[g],value:o.components[m[g]]});for(let t in e.spawnedWaitingForJS[m[g]]){let i=e.spawnedWaitingForJS[m[g]][t].id,o=e.spawnedWaitingForJS[m[g]][t].properties;document.getElementById(i).setAttribute(m[g],o)}delete e.spawnedWaitingForJS[m[g]]}e.spawnedWaitingForJS[m[g]]=[],e.jsLoaded[m[g]]=!1,l(e.jsAll[m[g]]).then(v)}else o.el.setAttribute(m[g],y[g])}return o.el},p=t=>{o.parent=t||o.defaultParent||!1;let i=!1;if(o.inScene)t&&(o.parent.core?o.parent.core.inScene?o.parent=o.parent.GetEl():o.parent=!1:o.parent.layer?t.layer.inScene?o.parent=o.parent.GetParentEl():o.parent=!1:o.parent.id||"string"==typeof o.parent&&(document.getElementById(o.parent)?o.parent=document.getElementById(o.parent):o.parent=!1),o.parent?o.parent.appendChild(o.el):(console.log(id),console.log(o.parent),console.log(document.getElementById(o.parent)),console.log("Parent is not in scene!")));else{d(),(n||s)&&c(),"preAdded"===o.entity&&document.getElementById(o.id)&&(i=!0),i||(o.parent?(o.parent.core?o.parent.core.inScene?o.parent=o.parent.GetEl():o.parent=!1:o.parent.layer?t.layer.inScene?o.parent=o.parent.GetParentEl():o.parent=!1:o.parent.id||"string"==typeof o.parent&&(document.getElementById(o.parent)?o.parent=document.getElementById(o.parent):o.parent=!1),o.parent?o.parent.appendChild(o.el):(console.log(id),console.log(o.parent),console.log(document.getElementById(o.parent)),console.log("Parent is not in scene!"))):e.sceneEl.appendChild(o.el));let a=!1;n&&(o.el.addEventListener("model-loaded",h),a=!0),s&&(o.el.addEventListener("loaded",h),a=!0),o.el.components&&o.el.components.body&&(o.el.addEventListener("body-loaded",h),a=!0),a||(o.domInterval=setTimeout((()=>{m(!0)&&(e.el.emit(o.id+"spawned",{}),clearInterval(o.domInterval))}),100)),o.inScene=!0}},u=()=>{if(o.inScene){if(clearInterval(o.domInterval),clearTimeout(o.gridPathTimeout),clearInterval(o.gridPathInterval),n&&o.el.removeEventListener("model-loaded",h),(s||r)&&o.el.removeEventListener("loaded",h),o.hasOwnProperty("components")){let e=Object.keys(o.components);for(let t in e)0===t||e[t].startsWith("shape")||m().removeAttribute(e[t])}o.gridSpawned&&(o.grid.collide?e.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,!1):o.grid.trigger&&e.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,!1),o.gridSpawned=!1),o.parent?o.parent.removeChild(o.el):e.sceneEl.removeChild(o.el),e.ExistsInTracker(o.id)&&e.RemoveFromTracker(o.id),o.dom=!1,o.inScene=!1,e.el.emit(o.id+"despawned",{})}},m=e=>(e?o.dom=document.getElementById(o.id):o.dom||(o.dom=document.getElementById(o.id)),o.dom);function y(e){let t=new THREE.Vector3;if(e.start.x===e.end.x&&e.start.z===e.end.z)t.x=e.start.x,t.z=e.start.z;else{let i=-1*(e.start.x-e.end.x),o=-1*(e.start.z-e.end.z);i/=2,o/=2,t.x=e.start.x+i,t.z=e.start.z+o}return t.y=e.start.y,t}const g=t=>{let i={start:{},end:{}};i.start.x=o.grid.start.x,i.start.y=o.grid.start.y,i.start.z=o.grid.start.z,i.end.x=o.grid.end.x,i.end.y=o.grid.end.y,i.end.z=o.grid.end.z,t.x&&(i.start.x+=t.x,i.end.x+=t.x),t.y&&(i.start.y+=t.y,i.end.y+=t.y),t.z&&(i.start.z+=t.z,i.end.z+=t.z);let a=y(i);return o.grid.collide?!!e.map.CheckMapAreaSansArea(o.grid,i,o.grid.height)&&(e.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,!1),e.map.UpdateMapArea(o.id,i.start,i.end,!0),"anim"===o.pathType?t.x?w("animstartx"+a.x):t.y?w("animstarty"+a.y):t.z&&w("animstartz"+a.z):"jump"===o.pathType&&b({property:"position",value:a}),o.grid.start.x=i.start.x,o.grid.start.y=i.start.y,o.grid.start.z=i.start.z,o.grid.end.x=i.end.x,o.grid.end.y=i.end.y,o.grid.end.z=i.end.z,!0):o.grid.trigger?(e.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,!1),e.map.UpdateMapAreaTrigger(o.id,i.start,i.end,!0),"anim"===o.pathType?t.x?w("animstartx"+a.x):t.y?w("animstarty"+a.y):t.z&&w("animstartz"+a.z):"jump"===o.pathType&&(t.pos.y,o.grid.yOffset,b({property:"position",value:a})),o.grid.start.x=i.start.x,o.grid.start.y=i.start.y,o.grid.start.z=i.start.z,o.grid.end.x=i.end.x,o.grid.end.y=i.end.y,o.grid.end.z=i.end.z,!0):void 0},v=e=>{if(Array.isArray(e))for(let t in e)o[e[t].property]=Object.assign({},e[t].value);else o[e.property]=Object.assign({},e.value)},b=(t,i)=>{if(i&&v(t),o.inScene)if(Array.isArray(t))for(let i in t)t[i].value&&t[i].value.src&&e.loadingScene&&(r||(r=!0,c(),o.el.addEventListener("loaded",h))),m().setAttribute(t[i].property,t[i].value);else t.value&&t.value.src&&e.loadingScene&&(r||(r=!0,c(),o.el.addEventListener("loaded",h))),m().setAttribute(t.property,t.value)};function f(e){let t="animation__"+e.name||0,i=e.property,o=e.from||!1;0===e.from&&(o=0);let a=e.to||!1;0===e.to&&(a=0);let n=e.dur||!1,s=e.delay||!1,r=e.loop||!1,l=e.dir||!1,c=e.easing||!1,h=e.elasticity||!1,d=e.autoplay||!1,p=e.enabled||!1,u=e.startEvents||!1,m=e.pauseEvents||!1,y=e.resumeEvents||!1,g={property:"object3D.rotation.y",to:360,dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};return i&&(g.property=i),(o||0===o)&&(g.from=o),(a||0===a)&&(g.to=a),n&&(g.dur=n),s&&(g.delay=s),r&&(g.loop=r),l&&(g.dir=l),c&&(g.easing=c),h&&(g.elasticity=h),d&&(g.autoplay=d),p&&(g.enabled=p),u&&(g.startEvents=u),m&&(g.pauseEvents=m),y&&(g.resumeEvents=y),{name:t,anim:g}}const E=e=>{if(Array.isArray(e))for(let t in e){let i=f(e[t]);m().setAttribute(i.name,i.anim)}else{let t=f(e);m().setAttribute(t.name,t.anim)}},w=(e,t)=>{if(o.inScene)if(Array.isArray(e))for(let i in e)m().emit(e[i],{bubbles:t});else m().emit(e,{bubbles:t})};function x(){o.detailMain.core.el.emit("close",{}),o.detailClose.core.el.emit("close",{});let e=setTimeout((function(){o.detailAll.DespawnLayer(),o.isOpen=!1,clearTimeout(e)}),550)}function T(){function e(){o.detailClose.core.el.removeEventListener("click",e),o.isOpen=x()}o.isOpen?(o.isOpen=x(),o.detailClose.core.el.removeEventListener("click",e)):(o.detailAll.SpawnLayer(),o.isOpen=function(){let e=setTimeout((function(){o.detailMain.core.el.emit("open",{}),o.detailClose.core.el.emit("open",{}),o.isOpen=!0,clearTimeout(e)}),25)}(),o.detailClose.core.el.addEventListener("click",e))}return{core:o,Generate:d,SpawnCore:p,DespawnCore:u,ToggleSpawn:(t,i)=>{let a=t||!1;a&&(o.parent=a),o.inScene?u():(p(o.parent),i&&e.spawnTracker(o.id,i))},GetEl:m,SpawnCoreOnGrid:t=>{if(o.inScene);else{t&&(o.grid=t),o.grid.hasOwnProperty("collide")||o.grid.hasOwnProperty("trigger")||(o.grid.collide=!0),o.grid.end||(o.grid=((e,t,i)=>{let a={},n=new THREE.Vector3;e?e.width?(n.x=e.width,n.y=e.height,n.z=e.depth):e.radius&&!e.height?(n.x=2*e.radius,n.y=2*e.radius,n.z=2*e.radius):e.radius&&e.height&&(n.x=2*e.radius,n.y=e.height,n.z=2*e.radius):(o.gridSize||(o.gridSize={x:1,y:1,z:1}),n.x=o.gridSize.x,n.y=o.gridSize.y,n.z=o.gridSize.z),a.yOffset=0,a.start=(new THREE.Vector3).copy(t),a.end=new THREE.Vector3,a.collide=i||!1;let s=0;if(a.end.x=a.start.x,n.x>.5){s=n.x/.5;for(let e=0;e<s;e++)0!==e&&(a.end.x+=.5)}if(a.end.y=a.start.y,a.yOffset=n.y/2,a.end.z=a.start.z,n.z>.5){s=n.z/.5;for(let e=0;e<s;e++)0!==e&&(a.end.z+=.5)}return a})(o.geometry,o.grid.start,o.grid.collide)),o.grid.start.y||(o.grid.start.y=0),o.grid.end.y||(o.grid.end.y=0),t&&t.xOffset?o.grid.xOffset=t.xOffset:o.grid.xOffset||(o.grid.xOffset=0),t&&t.yOffset?o.grid.yOffset=t.yOffset:o.grid.yOffset||(o.grid.yOffset=0),t&&t.zOffset?o.grid.zOffset=t.zOffset:o.grid.zOffset||(o.grid.zOffset=0),o.grid.start.y===o.grid.end.y?o.grid.height=1:o.grid.height=1+Math.ceil(Math.abs(Math.abs(o.grid.start.y)-Math.abs(o.grid.end.y)));let i=e.player.GetPlayerInfo().grid;if(o.grid.start.x<=i.x&&o.grid.end.x>=i.x&&o.grid.start.y<=i.y&&o.grid.end.y>=i.y&&o.grid.start.z<=i.z&&o.grid.end.z>=i.z)e.map.WaitToSpawn({name:o.id,func:"SpawnCoreOnGrid"});else{let t=y(o.grid);o.position.x=o.grid.xOffset+t.x,o.position.y=o.grid.yOffset+t.y,o.position.z=o.grid.zOffset+t.z,p(),o.grid.collide?e.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,o.grid.collide):o.grid.trigger&&e.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,o.grid.trigger),o.gridSpawned=!0}}},ToggleCoreGridSpawn:e=>{o.inScene?DespawnFromGrid():SpawnOnGrid(e)},RemoveComponent:e=>{if(o.inScene)if(Array.isArray(e))for(let t in e)m().removeAttribute(e[t]);else m().removeAttribute(e)},GridMove:g,GridPath:e=>{o.pathSpeed=e.speed||1e3,o.pathWait=e.wait||1e3,o.pathPatience=e.patience||3,o.pathRoute=e.route||"any",o.pathLoop=e.loop||"infinite",o.pathType=e.type||"jump";let t=y(o.grid);o.position.x=t.x,t.y&&(o.position.y=t.y),o.position.z=t.z;let i,a,n=.5;for(let t in e.path){let i=1;for(let a in e.path[t]){"y"===a?(n=e.path[t][a]>0?1:-1,i=Math.abs(e.path[t][a])):(n=e.path[t][a]>0?.5:-.5,i=Math.abs(e.path[t][a]/.5));for(let e=0;e<i;e++)o.gridPath.push({[a]:n})}}let s=o.position.x,r=o.position.y,l=o.position.z;if("anim"===o.pathType)for(let e in o.gridPath){let t={name:"animmove",property:"object3D.position.x",to:0,dur:o.pathSpeed,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"moveXStart",pauseEvents:"moveXStop"};i=Object.keys(o.gridPath[e])[0],a=o.gridPath[e][i],t.property="object3D.position."+i,"x"===i?(t.to=s+=a,t.name="animmove"+i+s,t.startEvents="animstart"+i+s,t.pauseEvents="animstop"+i+s):"y"===i?(t.to=(r+=a)+o.grid.yOffset,t.name="animmove"+i+r,t.startEvents="animstart"+i+r,t.pauseEvents="animstop"+i+r):"z"===i&&(t.to=l+=a,t.name="animmove"+i+l,t.startEvents="animstart"+i+l,t.pauseEvents="animstop"+i+l),o.inScene?E(t):(0===Object.keys(o.animations).length&&(o.animations={}),delete t.name,o.animations["move"+e]=t)}},WalkPath:()=>{let e=!0,t=!1,i=!0,a=!1,n=!0,s=!1,r=0,l=!1,c=0;function h(){l=!l}function d(){o.currentPath=0}function p(){o.currentPath=o.gridPath.length-1}"any"===o.pathRoute&&100*Math.random()>50&&(l=!0),o.gridPathInterval=setInterval((()=>{e&&i&&n&&(("circuit"===o.pathRoute||"alternate"===o.pathRoute||"any"===o.pathRoute)&&(l?(o.currentPath--,o.currentPath<0&&("infinite"===o.pathLoop||(r>=o.pathLoop?clearInterval(o.gridPathInterval):r++),"circuit"===o.pathRoute?l&&(d(),h()):"alternate"===o.pathRoute?(d(),h()):"any"===o.pathRoute&&(100*Math.random()>50?(d(),h()):p()))):(o.currentPath++,o.currentPath>=o.gridPath.length&&("infinite"===o.pathLoop||(r>=o.pathLoop?clearInterval(o.gridPathInterval):r++),"circuit"===o.pathRoute?d():"alternate"===o.pathRoute?(p(),h()):"any"===o.pathRoute&&(100*Math.random()>50?d():(p(),h()))))),e=!1,i=!1,n=!1,t=!!o.gridPath[o.currentPath].x,a=!!o.gridPath[o.currentPath].y,s=!!o.gridPath[o.currentPath].z),t?(e=g(l?{x:-1*o.gridPath[o.currentPath].x}:{x:o.gridPath[o.currentPath].x}),e?(t=!1,c=0,a||(i=!0),s||(n=!0)):(c++,c>=o.pathPatience&&(e=!0,i=!0,n=!0,h()))):a?(i=g(l?{y:-1*o.gridPath[o.currentPath].y}:{y:o.gridPath[o.currentPath].y}),i?(a=!1,c=0,t||(e=!0),s||(n=!0)):(c++,c>=o.pathPatience&&(e=!0,i=!0,n=!0,h()))):s&&(n=g(l?{z:-1*o.gridPath[o.currentPath].z}:{z:o.gridPath[o.currentPath].z}),n?(s=!1,c=0,t||(e=!0),a||(i=!0)):(c++,c>=o.pathPatience&&(e=!0,i=!0,n=!0,h())))}),o.pathSpeed+o.pathWait)},ChangeSelf:b,ChangeCore:v,EnablePhysics:e=>{e?.body?(o.body=e.body,o.body.type||(o.body.shape="dynamic"),o.body.mass||(o.body.mass=1),o.body.shape="none"):o.body||(o.body={type:"dynamic",shape:"none",mass:1}),e?.shape?o.shape=e.shape:o.shape&&(o.data.geometry?(o.shape=o.data.geometry,o.data.geometry.height?o.shape.offset=new THREE.Vector3(0,o.data.geometry.height/2,0):o.data.geometry.radius&&(o.shape.offset=new THREE.Vector3(0,o.data.geometry.radius/2,0))):o.shape={shape:"box",height:.5,width:.5,depth:.5,offset:"0 0.25 0"}),m().setAttribute("body",o.body),m().setAttribute("shape__core",o.shape)},PhysPos:e=>{o.el.body&&o.inScene&&(o.el.body.position.copy(e),o.el.object3D.position.copy(e))},Animate:E,EmitEvent:w,SetFlag:t=>{if(Array.isArray(t))for(let i in t)o[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:o.id,type:"core",sub:!1,name:t[i].flag,data:t[i].value});else o[t.flag]=t.value,e.saveToProfile({auxlObject:o.id,type:"core",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(o(e[i]));return t}return o[e]},DomClass:(e,t,i)=>{t&&(o.el.classList.remove(...o.classes),o.classes=[]),o.inScene&&(Array.isArray(e)?(o.el.classList.add(...e),i&&e.forEach((e=>o.classes.push(e)))):(o.el.classList.add(e),i&&o.classes.push(e)))},EnableDetail:t=>{var i,n,s,r,l,c;a||(i=t.text,n=t.position,s=t.textColor,r=t.windowColor,l=t.windowWidth,c=t.windowHeight,o.isOpen=!1,o.detailMain=e.Core(e.detailMainData),o.detailClose=e.Core(e.detailCloseData),n?(o.detailMain.core.position.x=n.x,o.detailMain.core.position.y=n.y,o.detailMain.core.position.z=n.z):(o.detailMain.core.position.x=o.position.x+.1,o.detailMain.core.position.y=o.position.y+.75,o.detailMain.core.position.z=o.position.z+.25),r&&(o.detailMain.core.material.color=r),i?o.detailMain.core.text.value=i:o.detail&&(o.detailMain.core.text.value=o.detail),s&&(o.detailMain.core.text.color=s),l&&(o.detailMain.core.geometry.width=l,o.detailClose.core.position.x=c/2),c&&(o.detailMain.core.geometry.height=c,o.detailClose.core.position.y=c/2),o.detailLayer={parent:{core:o.detailMain},child0:{core:o.detailClose}},o.detailAll=e.Layer("detailAll",o.detailLayer),a=!0),m().addEventListener("click",T)},DisableDetail:()=>{o.isOpen&&(o.isOpen=x()),m().removeEventListener("click",T)},ChangeMatSrc:t=>{o.inScene&&(e.loadingScene&&(r||(r=!0,c(),o.el.addEventListener("loaded",h))),m().setAttribute("material",{src:t}))}}},t=(e,t,i,o)=>{let a,n,s,r,l,c,h,d={};d.id=t,d.layer=i,i.id=t,i.vrUI=!1,i.transition={},i.transition.id="000000",i.transition.scene="fade",i.transition.teleport="fade",i.teleporting=!1,i.move=!1,i.moveType={pov:"1st",axis:"posXZ",style:"free"},i.roomScaleStand=!1,i.bodyCrouch=!1,i.animating=!1,i.snapRotating=!1,i.headSnapRotating=!1;let p={name:"anim45",property:"object3D.rotation.y",from:"0",to:"45",dur:250,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0},u={name:"anim90",property:"object3D.rotation.y",from:"0",to:"90",dur:250,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0};i.beltDisplay=!0,i.beltDefaultText="Hello World!",i.beltText="Hello World!",i.infoText="Player :\n",i.equipped=!1,i.equippedObject="none",i.menuToggle=!0,i.SpawnLayer(),e.controller=e.playerRig.GetEl().components.auxcontroller,i.position=new THREE.Vector3(0,0,0),i.gridPos=new THREE.Vector3(0,0,0),i.gridPos.copy(e.playerRig.GetEl().getAttribute("position")),i.gridDirection="still",i.targetDistance=50,i.linkDistance=18;const m=t=>{t="toggle"===t?!i.raycasters.display:t,i.raycasters.display=t,"Desktop"===e.controls||"Mobile"===e.controls?(i.raycasters.hmdmouse.linkDisplay=t,i.raycasters.hand1.linkDisplay=t?!t:t,i.raycasters.hand2.linkDisplay=t?!t:t,t?i.raycasters.hmdmouse.linkAnchor.core.inScene||i.raycasters.hmdmouse.linkAnchor.SpawnCore():i.raycasters.hmdmouse.linkAnchor.core.inScene&&i.raycasters.hmdmouse.linkAnchor.DespawnCore(),i.raycasters.hand1.linkAnchor.core.inScene&&i.raycasters.hand1.linkAnchor.DespawnCore(),i.raycasters.hand2.linkAnchor.core.inScene&&i.raycasters.hand2.linkAnchor.DespawnCore()):"VR"===e.controls&&(i.raycasters.hmdmouse.linkDisplay=t?!t:t,i.raycasters.hand1.linkDisplay=t,i.raycasters.hand2.linkDisplay=t,t?(i.raycasters.hand1.linkAnchor.core.inScene||i.raycasters.hand1.linkAnchor.SpawnCore(),i.raycasters.hand2.linkAnchor.core.inScene||i.raycasters.hand2.linkAnchor.SpawnCore()):(i.raycasters.hand1.linkAnchor.core.inScene&&i.raycasters.hand1.linkAnchor.DespawnCore(),i.raycasters.hand2.linkAnchor.core.inScene&&i.raycasters.hand2.linkAnchor.DespawnCore()),i.raycasters.hmdmouse.linkAnchor.core.inScene&&i.raycasters.hmdmouse.linkAnchor.DespawnCore())};i.raycasters={},i.raycasters.display=!1,i.raycasters.hmdmouse={},i.raycasters.hmdmouse.core=e.mouseController,i.raycasters.hmdmouse.el=e.mouseController.GetEl(),i.raycasters.hmdmouse.intersection=new THREE.Vector3(0,0,0),i.raycasters.hmdmouse.distance=i.linkDistance,i.raycasters.hmdmouse.linkInterval,i.raycasters.hmdmouse.linkDisplay=!1,i.raycasters.hmdmouse.linkCoreData={data:"linkCoreData",id:"hmdLinkCore",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.3,radiusOuter:.5},material:{shader:"standard",color:"#eb07a5",emissive:"#eb07a5",emissiveIntensity:.25,opacity:.9},position:new THREE.Vector3(0,0,.1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{body:{type:"static",shape:"none",mass:0}}},i.raycasters.hmdmouse.linkCore=e.Core(e.coreDataFromTemplate(i.raycasters.hmdmouse.linkCoreData,!1,!0)),i.raycasters.hmdmouse.linkAnchor=e.Core(e.coreDataFromTemplate(i.raycasters.hmdmouse.linkCoreData,{id:"hmdLinkAnchor",geometry:{primitive:"ring",radiusInner:.3,radiusOuter:.5},material:{shader:"standard",color:"#eb07a5",emissive:"#eb07a5",emissiveIntensity:.25,opacity:.9}},!0)),i.raycasters.hmdmouse.linkConfig={type:"auxspring",to:"playerRig",minOneLength:0,maxOneLength:30,restLength:1,damping:.5,stiffness:10},i.raycasters.hmdmouse.linkConstraint=e.Constraints(i.raycasters.hmdmouse.linkCore,i.raycasters.hmdmouse.linkConfig,!1),i.raycasters.hmdmouse.bullets=[],i.raycasters.hmdmouse.bulletCore=e.Core(e.coreDataFromTemplate(i.raycasters.hmdmouse.linkCoreData,{id:"hmdbulletCore",geometry:{primitive:"sphere",radius:.2},material:{shader:"standard",color:"#d8f020",emissive:"#d8f020",emissiveIntensity:.25,opacity:.75},components:{body:{type:"dynamic",shape:"sphere",mass:1},bodymaterial:{friction:1,restitution:.01}}},!0)),i.raycasters.hmdmouse.bullet0=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet0"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet0),i.raycasters.hmdmouse.bullet1=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet1"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet1),i.raycasters.hmdmouse.bullet2=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet2"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet2),i.raycasters.hmdmouse.bullet3=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet3"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet3),i.raycasters.hmdmouse.bullet4=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet4"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet4),i.raycasters.hmdmouse.bullet5=e.coreFromTemplate(i.raycasters.hmdmouse.bulletCore,{id:"hmdbullet5"},!0),i.raycasters.hmdmouse.bullets.push(i.raycasters.hmdmouse.bullet5),i.raycasters.hand1={},i.raycasters.hand1.core=e.vrController1,i.raycasters.hand1.el=e.vrController1.GetEl(),i.raycasters.hand1.intersection=new THREE.Vector3(0,0,0),i.raycasters.hand1.distance=i.linkDistance,i.raycasters.hand1.linkInterval,i.raycasters.hand1.linkDisplay=!1,i.raycasters.hand1.linkCoreData={data:"linkCoreData",id:"hand1LinkCore",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.2},material:{shader:"standard",color:"#ebd107",emissive:"#ebd107",emissiveIntensity:.25,opacity:.75},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{body:{type:"static",shape:"none",mass:0}}},i.raycasters.hand1.linkCore=e.Core(e.coreDataFromTemplate(i.raycasters.hand1.linkCoreData,!1,!0)),i.raycasters.hand1.linkAnchor=e.Core(e.coreDataFromTemplate(i.raycasters.hand1.linkCoreData,{id:"hand1LinkAnchor",geometry:{primitive:"ring",radiusInner:.3,radiusOuter:.5},material:{shader:"standard",color:"#eb07a5",emissive:"#eb07a5",emissiveIntensity:.25,opacity:.9}},!0)),i.raycasters.hand1.linkConfig={type:"auxspring",to:"playerRig",minOneLength:0,maxOneLength:30,restLength:1,damping:.5,stiffness:10},i.raycasters.hand1.linkConstraint=e.Constraints(i.raycasters.hand1.linkCore,i.raycasters.hand1.linkConfig,!1),i.raycasters.hand1.bullets=[],i.raycasters.hand1.bulletCore=e.Core(e.coreDataFromTemplate(i.raycasters.hand1.linkCoreData,{id:"hmdbulletCore",geometry:{primitive:"sphere",radius:.2},material:{shader:"standard",color:"#2dba74",emissive:"#2dba74",emissiveIntensity:.25,opacity:.5,blending:"multiply"},components:{body:{type:"dynamic",shape:"sphere",mass:1},bodymaterial:{friction:1,restitution:.01}}},!0)),i.raycasters.hand1.bullet0=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet0"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet0),i.raycasters.hand1.bullet1=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet1"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet1),i.raycasters.hand1.bullet2=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet2"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet2),i.raycasters.hand1.bullet3=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet3"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet3),i.raycasters.hand1.bullet4=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet4"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet4),i.raycasters.hand1.bullet5=e.coreFromTemplate(i.raycasters.hand1.bulletCore,{id:"hand1bullet5"},!0),i.raycasters.hand1.bullets.push(i.raycasters.hand1.bullet5),i.raycasters.hand2={},i.raycasters.hand2.core=e.vrController2,i.raycasters.hand2.el=e.vrController2.GetEl(),i.raycasters.hand2.intersection=new THREE.Vector3(0,0,0),i.raycasters.hand2.distance=i.linkDistance,i.raycasters.hand2.linkInterval,i.raycasters.hand2.linkDisplay=!1,i.raycasters.hand2.linkCoreData={data:"linkCoreData",id:"hand2LinkCore",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.2},material:{shader:"standard",color:"#ebd107",emissive:"#ebd107",emissiveIntensity:.25,opacity:.75},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{body:{type:"static",shape:"none",mass:0}}},i.raycasters.hand2.linkCore=e.Core(e.coreDataFromTemplate(i.raycasters.hand2.linkCoreData,!1,!0)),i.raycasters.hand2.linkAnchor=e.Core(e.coreDataFromTemplate(i.raycasters.hand2.linkCoreData,{id:"hand2LinkAnchor",geometry:{primitive:"ring",radiusInner:.3,radiusOuter:.5},material:{shader:"standard",color:"#eb07a5",emissive:"#eb07a5",emissiveIntensity:.25,opacity:.9}},!0)),i.raycasters.hand2.linkConfig={type:"auxspring",to:"playerRig",minOneLength:0,maxOneLength:30,restLength:1,damping:.5,stiffness:10},i.raycasters.hand2.linkConstraint=e.Constraints(i.raycasters.hand2.linkCore,i.raycasters.hand2.linkConfig,!1),i.raycasters.hand2.bullets=[],i.raycasters.hand2.bulletCore=e.Core(e.coreDataFromTemplate(i.raycasters.hand2.linkCoreData,{id:"hand2bulletCore",geometry:{primitive:"sphere",radius:.2},material:{shader:"standard",color:"#d02caa",emissive:"#d02caa",emissiveIntensity:.25,opacity:.5,blending:"multiply"},components:{body:{type:"dynamic",shape:"sphere",mass:1},bodymaterial:{friction:1,restitution:.01}}},!0)),i.raycasters.hand2.bullet0=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet0"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet0),i.raycasters.hand2.bullet1=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet1"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet1),i.raycasters.hand2.bullet2=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet2"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet2),i.raycasters.hand2.bullet3=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet3"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet3),i.raycasters.hand2.bullet4=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet4"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet4),i.raycasters.hand2.bullet5=e.coreFromTemplate(i.raycasters.hand2.bulletCore,{id:"hand2bullet5"},!0),i.raycasters.hand2.bullets.push(i.raycasters.hand2.bullet5),i.raycasters.activeCamera="camera",i.raycasters.previousCamera=!1,i.scroll={},i.scroll.mainCurrent=1,i.scroll.roamCurrent=1,i.scrollMin=new THREE.Vector3(0,-1,.3),i.scrollHead=new THREE.Vector3(0,0,0),i.scrollHeadBehind=new THREE.Vector3(0,0,.5),i.scrollShoulder=new THREE.Vector3(.1,.3,.6),i.scrollMid=new THREE.Vector3(0,1.7,1.6),i.scrollMax=new THREE.Vector3(0,4.8,3.2),i.scrolls=[i.scrollMin,i.scrollHead,i.scrollHeadBehind,i.scrollShoulder,i.scrollMid,i.scrollMax];const y=(t,o)=>{if(i.head.attached){e.isFalsey(t)?i.scroll.mainCurrent--:i.scroll.mainCurrent++,i.scroll.mainCurrent===i.scrolls.length?i.scroll.mainCurrent=0:i.scroll.mainCurrent<0&&(i.scroll.mainCurrent=i.scrolls.length-1);let o=new THREE.Vector3(0,0,0).copy(i.scrolls[i.scroll.mainCurrent]);e.headRig.GetEl().object3D.position.copy(o)}else{e.isFalsey(t)?i.scroll.roamCurrent--:i.scroll.roamCurrent++,i.scroll.roamCurrent===i.scrolls.length?i.scroll.roamCurrent=0:i.scroll.roamCurrent<0&&(i.scroll.roamCurrent=i.scrolls.length-1);let o=new THREE.Vector3(0,0,0).copy(i.scrolls[i.scroll.roamCurrent]);o.z*=-1,e.roamCamera.GetEl().object3D.position.copy(o)}};document.addEventListener("keydown",(e=>{"ArrowUp"===e.key?y(!1):"ArrowDown"===e.key?y(!0):("ArrowLeft"===e.key||"ArrowRight"===e.key)&&g()})),i.head={},i.head.attached=!0;const g=()=>{i.head.attached?(e.roamCamera.ChangeSelf({property:"camera",value:{active:!0}}),e.camera.ChangeSelf({property:"camera",value:{active:!1}})):(e.camera.ChangeSelf({property:"camera",value:{active:!0}}),e.roamCamera.ChangeSelf({property:"camera",value:{active:!1}})),i.head.attached=!i.head.attached},v=()=>{let t;e.player.layer.teleporting||(e.player.layer.teleporting=!0,"blink"===e.player.layer.transition.teleport?(e.blink1Screen.ChangeSelf({property:"visible",value:"true"}),e.blink2Screen.ChangeSelf({property:"visible",value:"true"}),e.blink1Screen.EmitEvent("blinkquick"),e.blink2Screen.EmitEvent("blinkquick"),t=setTimeout((()=>{e.blink1Screen.ChangeSelf({property:"visible",value:"false"}),e.blink2Screen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),500)):"fade"===e.player.layer.transition.teleport?(e.fadeScreen.ChangeSelf({property:"visible",value:"true"}),e.fadeScreen.EmitEvent("fadequick"),t=setTimeout((()=>{e.fadeScreen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),500)):"sphere"===e.player.layer.transition.teleport?(e.sphereScreen.ChangeSelf({property:"visible",value:"true"}),e.sphereScreen.EmitEvent("spherequick"),t=setTimeout((()=>{e.sphereScreen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),500)):"instant"===e.player.layer.transition.teleport?t=setTimeout((()=>{e.player.layer.teleporting=!1,clearTimeout(t)}),50):"locomotion"===e.player.layer.transition.teleport&&(t=setTimeout((()=>{e.player.layer.teleporting=!1,clearTimeout(t)}),500)))},b=(t,i)=>{let o={name:"camYAnim",property:"object3D.position.y",from:t||0,to:i||0,dur:750,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0};e.playerBody.Animate(o)};i.flashlight=!1;const f=t=>{t&&(i.beltText=t),i.beltDisplay&&e.playerBeltText.ChangeSelf({property:"text",value:{value:i.beltText}})};i.actions={};const E=()=>{document.getElementById("beltUIParent")&&e.locomotionUILayer.DespawnLayer()},w=()=>{i.equipped=!1,i.equippedObject="none",f(e.systemText)},x=()=>({layer:i,id:i.layer.all.parent.core.core.id,pos:e.playerRig.GetEl().object3D.position,bodyRot:e.playerBody.GetEl().getAttribute("rotation"),headRot:e.camera.GetEl().getAttribute("rotation"),grid:i.gridPos}),T=e=>e.distanceTo(x().pos),R=(t,o,a)=>{let n=new THREE.Vector3;i.position=new THREE.Vector3,i.quaternion=new THREE.Quaternion,i.rigQuaternion=new THREE.Quaternion,i.quaternion.copy(o.object3D.quaternion),i.rigQuaternion.copy(e.playerRig.GetEl().object3D.quaternion),i.position.copy(o.object3D.position),i.position.add(e.playerRig.GetEl().object3D.position);let s=a||new THREE.Vector3(0,0,-1);return s.applyQuaternion(i.quaternion),s.multiplyScalar(t),e.playerRig.GetEl().object3D.quaternion.equals(new THREE.Quaternion(0,0,0,1))||s.applyQuaternion(i.rigQuaternion),n.copy(i.position.clone().add(s)),n},k=()=>{let t=new THREE.Vector3;return e.camera.GetEl().object3D.getWorldDirection(t),t},D=e=>{let t=new THREE.Vector3;return e.object3D.getWorldDirection(t),t},C=(t,i)=>{let o=new THREE.Vector3;t.object3D.getWorldDirection(o);let a=new THREE.Quaternion;return a.copy(e.playerRig.GetEl().object3D.quaternion),e.playerRig.GetEl().object3D.quaternion.equals(new THREE.Quaternion(0,0,0,1))||o.applyQuaternion(a),i&&o.multiplyScalar(i),o},M=(e,t,i)=>{let o=new THREE.Vector3,a=new THREE.Quaternion,n=t||1.5,s=i||new THREE.Vector3(0,0,-1);return"vrController1"!==e.id&&"vrController2"!==e.id||(s=e.getAttribute("raycaster").direction,i&&s.add(i)),e.object3D.getWorldQuaternion(a),s.applyQuaternion(a),e.object3D.getWorldPosition(o),o.add(s.clone().multiplyScalar(n)),{position:o,direction:s}};i.tracking=!1,i.track2DInterval,new THREE.Vector3(0,0,0);let S=new THREE.Vector3(0,0,0);const P=e=>{let t=e||1e3;L();let i=setTimeout((function(){H(),clearTimeout(i)}),t)},L=()=>{"Desktop"===e.controls||"Mobile"===e.controls?e.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}}):"VR"===e.controls&&("bothRight"===e.vrHand||"right"===e.vrHand?e.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"bothLeft"===e.vrHand||"left"===e.vrHand?e.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"both"===e.vrHand&&(e.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}),e.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}})))},H=()=>{"Desktop"===e.controls||"Mobile"===e.controls?e.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}}):"VR"===e.controls&&("bothRight"===e.vrHand||"right"===e.vrHand?e.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"bothLeft"===e.vrHand||"left"===e.vrHand?e.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"both"===e.vrHand&&(e.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}),e.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}})))};let A=new THREE.Vector3(0,0,0);const z=e=>{e&&e.detail&&e.detail.intersections&&e.detail.intersections[0]&&e.detail.intersections[0].point?A.copy(e.detail.intersections[0].point):e&&e.detail&&e.detail.intersection&&A.copy(e.detail.intersection.point),e&&e.target&&("mouseController"===e.target.id?i.raycasters.hmdmouse.intersection.copy(A):"vrController1"===e.target.id?i.raycasters.hand1.intersection.copy(A):"vrController2"===e.target.id&&i.raycasters.hand2.intersection.copy(A))},I=e=>{z(e)},O=e=>{z(e)};(t=>{e.mouseController.GetEl().addEventListener("mouseleave",O(t)),e.mouseController.GetEl().addEventListener("mouseenter",I(t)),e.vrController1.GetEl().addEventListener("mouseleave",O(t)),e.vrController1.GetEl().addEventListener("mouseenter",I(t)),e.vrController2.GetEl().addEventListener("mouseleave",O(t)),e.vrController2.GetEl().addEventListener("mouseenter",I(t))})(),i.playerPhysics=!1,i.worldGravity=new THREE.Vector3(0,0,0),i.localAxis=new THREE.Vector3(0,0,0),i.worldAxis=new THREE.Vector3(0,0,0),i.gravity=new THREE.Vector3(0,0,0),i.axis=new THREE.Vector3(0,0,0),i.physMove=!0,i.rotation=new THREE.Quaternion(0,0,0,0),i.rotation.copy(e.playerRig.GetEl().object3D.quaternion);i.body={type:"dynamic",shape:"none",mass:2.2,angularDamping:.425,linearDamping:.225};i.material={friction:.01,restitution:.0075};i.shape={shape:"cylinder",height:1.7,radiusTop:.1,radiusBottom:.01,offset:"0 0.85 0"},i.jumping=!1,i.jumpDistance=4,i.jumpTimeout,e.playerRig.GetEl().addEventListener("collide",(function(t){const o=new CANNON.Vec3;let a=new THREE.Vector3;a.copy(e.playerRig.GetEl().components.gravitycontrol.axis);let n=new THREE.Vector3;n.copy(a),n.negate();const s=t.detail.contact;s.bi.id==e.playerRig.GetEl().body.id?s.ni.negate(o):o.copy(s.ni),o.dot(n)>.5&&(i.jumping=!1)}));const N=t=>{(t.type||0===t.type)&&(e.playerRig.GetEl().components.gravitycontrol.setTypes(t.type),e.playerRig.GetEl().components.gravitycontrol.setWorldTypes(t.type)),(t.axis||0===t.axis)&&(e.playerRig.GetEl().components.gravitycontrol.setAxis(t.axis),e.playerRig.GetEl().components.gravitycontrol.setWorldAxis(t.axis))},F=e=>{let t=!1;if("mouseController"===e)t=i.raycasters.hmdmouse;else if("vrController1"===e)t=i.raycasters.hand1;else{if("vrController2"!==e)return;t=i.raycasters.hand2}ne(t.linkCore),t.power=1e3,clearInterval(t.linkInterval),t.linkInterval=setInterval((()=>{t.power>=15?t.power-=15:clearInterval(t.linkInterval)}),1)};i.boostDistance=25;const V=t=>{if(i.toggle4){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}B(a,o)}},j=e=>{i.toggle4&&F(e.target.id)},B=(t,o)=>{let a=new THREE.Vector3;a.copy(D(t)),a.multiplyScalar(i.boostDistance),a.negate(),e.playerRig.GetEl().body.applyLocalImpulse(a,new THREE.Vector3(0,0,0))};i.backBoostDistance=20;const G=t=>{if(i.toggle5){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}q(a,o.power)}},U=e=>{i.toggle5&&F(e.target.id)},q=(t,o)=>{let a=new THREE.Vector3;a.copy(D(t)),a.multiplyScalar(i.backBoostDistance),e.playerRig.GetEl().body.applyLocalImpulse(a,new THREE.Vector3(0,0,0))},W=()=>{e.playerRig.GetEl().body.sleep()},_=()=>{e.playerRig.GetEl().body.wakeUp()};i.brakeDoubleTapSet=!1,i.playerRedirect=new THREE.Vector3;const J=t=>{if(i.toggle3){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}clearInterval(i.redirectInterval),Z(a,o)}},K=t=>{i.velocitySpeed=0,i.brakeOff=i.body.linearDamping,i.braking=i.brakeOff/32,clearInterval(i.redirectInterval),i.redirectInterval=setInterval((()=>{i.velocitySpeed<121?i.velocitySpeed++:clearInterval(i.redirectInterval),e.playerRig.GetEl().body.linearDamping<.9&&(e.playerRig.GetEl().body.linearDamping+=i.braking)}),1)},Z=(t,o)=>{e.playerRig.GetEl().body.linearDamping=i.brakeOff,i.playerRedirect.copy(C(t)),i.playerRedirect.normalize().multiplyScalar(i.velocitySpeed).negate(),e.playerRig.GetEl().body.applyLocalImpulse(i.playerRedirect,new THREE.Vector3(0,0,0))},X=t=>{if(i.toggle0){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}Y(a,o)}},Q=e=>{i.toggle0&&F(e.target.id)},Y=(e,t)=>{t.power/=1e3;let i=t.distance||42,o=0;t.power>.85&&(o=15);let a=new THREE.Vector3;T(t.intersection)<=i?a.copy(t.intersection):a.copy(M(e,i).position);let n=i*t.power+o;t.linkConstraint.Connect({type:"auxspring",restLength:n,damping:.5,stiffness:0,maxForce:1e6}),t.linkCore.core.inScene?t.linkCore.PhysPos(a):(t.linkCore.core.position=a,t.linkCore.SpawnCore())};i.teleDistance=5;const $=t=>{if(i.toggle2){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}te(a,o)}},ee=e=>{i.toggle2&&F(e.target.id)},te=(t,o)=>{o.power<100&&(o.power=100),o.power/=1e3;let a=i.teleDistance+i.teleDistance/o.power,n=new THREE.Vector3;T(o.intersection)<=a?n.copy(o.intersection):n.copy(R(a,t));let s=setTimeout((()=>{e.playerRig.PhysPos(n),W();let t=setTimeout((()=>{_(),clearTimeout(s),clearTimeout(t)}),275)}),225);v()};i.bulletLasts=15e3,i.bulletAt=0;const ie=t=>{if(i.toggle1){let o=!1,a=!1;if("mouseController"===t.target.id)clearInterval(i.raycasters.hmdmouse.linkInterval),a=e.camera.GetEl(),o=i.raycasters.hmdmouse;else if("vrController1"===t.target.id)clearInterval(i.raycasters.hand1.linkInterval),a=e.vrController1.GetEl(),o=i.raycasters.hand1;else{if("vrController2"!==t.target.id)return;clearInterval(i.raycasters.hand2.linkInterval),a=e.vrController2.GetEl(),o=i.raycasters.hand2}ae(a,o)}},oe=e=>{i.toggle1&&F(e.target.id)},ae=(e,t)=>{if(!t.shooting){t.shooting=!0,t.power/=1e3,t.power>.75&&(t.power=.5);let o=M(e,.35),a=30;o.direction.multiplyScalar((1-t.power)*a);let n=!1;t.bullets[i.bulletAt].core.inScene?(t.bullets[i.bulletAt].PhysPos(o.position),t.bullets[i.bulletAt].RemoveComponent("velocity"),t.bullets[i.bulletAt].GetEl().body.velocity.x=o.direction.x,t.bullets[i.bulletAt].GetEl().body.velocity.y=o.direction.y,t.bullets[i.bulletAt].GetEl().body.velocity.z=o.direction.z,n=!0):(t.bullets[i.bulletAt].core.components.velocity={},t.bullets[i.bulletAt].core.components.velocity.x=o.direction.x,t.bullets[i.bulletAt].core.components.velocity.y=o.direction.y,t.bullets[i.bulletAt].core.components.velocity.z=o.direction.z,t.bullets[i.bulletAt].core.position=o.position,t.bullets[i.bulletAt].SpawnCore()),clearTimeout(t.shootTimeout),t.shootTimeout=setTimeout((()=>{i.bulletAt++,i.bulletAt>=t.bullets.length&&(i.bulletAt=0),t.shooting=!1,clearTimeout(t.shootTimeout)}),3);let s=i.bulletAt;n&&clearTimeout(t["bulletTimeout"+s]),t["bulletTimeout"+s]=setTimeout((()=>{t.bullets[s].DespawnCore(),clearTimeout(t["bullet"+s])}),i.bulletLasts)}},ne=e=>{e.core.inScene&&e.DespawnCore()};return{layer:i,player:d,Reset:()=>{i.transition={},i.transition.id="000000",i.transition.scene="fade",i.transition.teleport="fade",i.teleporting=!1,i.roomScaleStand=!1,i.bodyCrouch=!1,i.animating=!1,i.snapRotating=!1,i.headSnapRotating=!1,i.beltDisplay=!0,i.beltDefaultText="Hello World!",i.beltText="Hello World!",i.flashlight=!1,i.infoText="Player :\n"},CameraSwitch:t=>{e[i.raycasters.activeCamera].ChangeSelf({property:"active",value:!1}),e[t].ChangeSelf({property:"active",value:!0}),i.raycasters.previousCamera=i.raycasters.activeCamera,i.raycasters.activeCamera=t},CameraSwitchBack:()=>{e[i.raycasters.activeCamera].ChangeSelf({property:"active",value:!1}),e[i.raycasters.previousCamera].ChangeSelf({property:"active",value:!0}),i.raycasters.previousCamera=i.raycasters.activeCamera,i.raycasters.activeCamera=i.raycasters.previousCamera},PlayerSceneAnim:()=>{let t=setTimeout((()=>{e.loadingScene||(e.loadingScene=!0),clearTimeout(t)}),800);i.teleporting||(i.teleporting=!0,"blink"===i.transition.scene?(L(),i.GetChild("blink1Screen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("blink2Screen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("blink1Screen").EmitEvent("blinkScene1"),i.GetChild("blink2Screen").EmitEvent("blinkScene1")):"fade"===i.transition.scene?(L(),i.GetChild("fadeScreen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("fadeScreen").EmitEvent("fadeScene1")):"sphere"===i.transition.scene?(L(),i.GetChild("sphereScreen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("sphereScreen").EmitEvent("sphereScene1")):"instant"===i.transition.scene&&L())},UpdateSceneTransitionStyle:e=>{i.transition.scene=e},PlayerTeleportAnim:()=>{let t;e.player.layer.teleporting||(e.player.layer.teleporting=!0,"blink"===e.player.layer.transition.teleport?(e.player.TempDisableClick(),e.blink1Screen.ChangeSelf({property:"visible",value:"true"}),e.blink2Screen.ChangeSelf({property:"visible",value:"true"}),e.blink1Screen.EmitEvent("blink"),e.blink2Screen.EmitEvent("blink"),t=setTimeout((()=>{e.blink1Screen.ChangeSelf({property:"visible",value:"false"}),e.blink2Screen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),1200)):"fade"===e.player.layer.transition.teleport?(e.player.TempDisableClick(),e.fadeScreen.ChangeSelf({property:"visible",value:"true"}),e.fadeScreen.EmitEvent("fade"),t=setTimeout((()=>{e.fadeScreen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),1200)):"sphere"===e.player.layer.transition.teleport?(e.player.TempDisableClick(),e.sphereScreen.ChangeSelf({property:"visible",value:"true"}),e.sphereScreen.EmitEvent("sphere"),t=setTimeout((()=>{e.sphereScreen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,clearTimeout(t)}),1200)):"instant"===e.player.layer.transition.teleport?t=setTimeout((()=>{e.player.layer.teleporting=!1,clearTimeout(t)}),500):"locomotion"===e.player.layer.transition.teleport&&(t=setTimeout((()=>{e.player.layer.teleporting=!1,clearTimeout(t)}),1e3)))},PlayerQuickAnim:v,PlayerFadeOut:()=>{if(!e.player.layer.teleporting&&!e.player.layer.faded){let t;L(),e.player.layer.teleporting=!0,e.fadeScreen.ChangeSelf({property:"visible",value:"true"}),e.fadeScreen.EmitEvent("fadeout"),t=setTimeout((()=>{e.player.layer.faded=!0,clearTimeout(t)}),500)}},PlayerFadeIn:()=>{if(e.player.layer.faded){let t;e.fadeScreen.EmitEvent("fadein"),t=setTimeout((()=>{H(),e.fadeScreen.ChangeSelf({property:"visible",value:"false"}),e.player.layer.teleporting=!1,e.player.layer.faded=!1,clearTimeout(t)}),500)}},UpdateTeleportTransitionStyle:e=>{i.transition.teleport=e},UpdateTransitionColor:t=>{e.fadeScreen.ChangeSelf({property:"material",value:{color:t}}),e.sphereScreen.ChangeSelf({property:"material",value:{color:t}}),e.blink1Screen.ChangeSelf({property:"material",value:{color:t}}),e.blink2Screen.ChangeSelf({property:"material",value:{color:t}})},GetCameraDirection:k,ToggleVRText:()=>{i.vrUI=!i.vrUI,"VR"===e.controls&&("bothRight"===e.vrHand?e.vrController2.ChangeSelf({property:"visible",value:i.vrUI}):"bothLeft"===e.vrHand?e.vrController1.ChangeSelf({property:"visible",value:i.vrUI}):"both"===e.vrHand?(e.vrController1.ChangeSelf({property:"visible",value:i.vrUI}),e.vrController2.ChangeSelf({property:"visible",value:i.vrUI})):"right"===e.vrHand?e.vrController2.ChangeSelf({property:"visible",value:i.vrUI}):"left"===e.vrHand&&e.vrController1.ChangeSelf({property:"visible",value:i.vrUI}))},UpdateUIText:t=>{UpdateSystemText(t),"VR"===e.controls&&i.vrUI&&("bothRight"===e.vrHand?e.vrController2.ChangeSelf({property:"text",value:t}):"bothLeft"===e.vrHand?e.vrController1.ChangeSelf({property:"text",value:t}):"both"===e.vrHand?(e.vrController1.ChangeSelf({property:"text",value:t}),e.vrController2.ChangeSelf({property:"text",value:t})):"right"===e.vrHand?e.vrController2.ChangeSelf({property:"text",value:t}):"left"===e.vrHand&&e.vrController1.ChangeSelf({property:"text",value:t}))},ToggleBeltText:t=>{t||!i.beltDisplay?(e.playerBeltText.ChangeSelf({property:"visible",value:!0}),e.playerBeltTitleText.ChangeSelf({property:"visible",value:!0}),f(),i.beltDisplay=!0):i.beltDisplay&&(e.playerBeltText.ChangeSelf({property:"visible",value:!1}),e.playerBeltTitleText.ChangeSelf({property:"visible",value:!1}),i.beltDisplay=!1)},UpdateBeltText:f,Notification:t=>{s=t.time||2750,s<500&&(console.log({msg:"Error. Too short of a time. Min is 1000ms",notificationInfo:t}),s=1e3),P(s),clearTimeout(a),clearTimeout(n),e.cameraUI.ChangeSelf({property:"text",value:{value:t.message,width:.5,color:"#FFFFFF",align:"center",font:"exo2bold",side:"double",opacity:0}}),e.cameraUI.ChangeSelf({property:"visible",value:"true"}),e.cameraUI.EmitEvent("cameraMsg"),a=setTimeout((()=>{e.cameraUI.EmitEvent("cameraMsgFadeOut"),clearTimeout(a)}),s-501),n=setTimeout((()=>{e.cameraUI.ChangeSelf({property:"visible",value:"false"}),clearTimeout(n)}),s)},UpdateActions:({actions:t,remove:o,tracker:a,limit:n})=>{if(o){if(a&&i.actions[a]?i.actionArray={...i.actions[a]}:i.actionArray=t?{...t}:{},i.actionArray)for(let t in i.actionArray)i.actions[t]?(e.controller[t+"Func"]=i.actions[t].func,e.controller[t+"Params"]=i.actions[t].params,i.actions[t].name&&(e.controlsInfo[t]={name:i.actions[t].name,info:i.actions[t].info}),delete i.actions[t]):e.controller.disableAction({[t]:i.actionArray[t]})}else{for(let o in t)if(e.controller[o+"Func"]&&(i.actions[o]={},i.actions[o].func=e.controller[o+"Func"],i.actions[o].params=e.controller[o+"Params"],e.controlsInfo[o]&&(i.actions[o].name=e.controlsInfo[o].name,i.actions[o].info=e.controlsInfo[o].info)),a&&(i.actions[a]||(i.actions[a]={}),i.actions[a][o]=i.actions[o]),n)switch(n.type){case"scenario":case"zone":case"scene":case"time":case"uses":case"flag":break;default:console.log("Other")}e.controller.updateAction(t)}e.UpdateControlText()},TempDisableClick:P,DisableClick:L,EnableClick:H,UnlockLocomotion:()=>{i.move=!0},LockLocomotion:()=>{i.move=!1},EnableVRLocomotion:()=>{E(),e.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"vr"})},EnableVRHoverLocomotion:t=>{e.locomotionUILayer.GetParentEl()||e.locomotionUILayer.SpawnLayer(),e.playerRig.GetEl().setAttribute("locomotion",{uiid:"beltUIParent",courserid:"mouseController",movetype:"vrHover"})},EnableDesktopLocomotion:()=>{E(),e.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"desktop"})},EnableMobileLocomotion:()=>{E(),e.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"mobile"})},ChangeLocomotionType:t=>{t.pov&&(i.moveType.pov=t.pov),t.axis&&(i.moveType.axis=t.axis),t.style&&(i.moveType.style=t.style),e.playerRig.GetEl().setAttribute("locomotion",{pov:i.moveType.pov,axis:i.moveType.axis,style:i.moveType.style})},RemoveBelt:E,ToggleSittingMode:()=>{if(i.animating);else{i.animating=!0,l=setTimeout((()=>{i.animating=!1,clearTimeout(l)}),775);let t=e.playerBody.GetEl().getAttribute("position").y;i.roomScaleStand?b(t,t-.75):b(t,t+.75),i.roomScaleStand=!i.roomScaleStand}},ToggleCrouch:()=>{if(i.animating);else{if(i.animating=!0,r=setTimeout((()=>{i.animating=!1,clearTimeout(r)}),775),i.bodyCrouch){let t=new THREE.Vector3(0,0,0);if(t.copy(i.gridPos),t.y+=1,!e.map.CheckMapObstaclesDiagonal(t,i.gridPos))return}let t=e.playerBody.GetEl().getAttribute("position").y;i.bodyCrouch?b(t,t+.75):b(t,t-.75),i.bodyCrouch=!i.bodyCrouch}},SnapRight45:()=>{if(i.snapRotating);else{i.snapRotating=!0;let t=e.playerBody.GetEl().getAttribute("rotation").y;p.from=t,p.to=t-45,e.playerBody.Animate(p),c=setTimeout((()=>{i.snapRotating=!1,clearTimeout(c)}),p.dur+10)}},SnapLeft45:()=>{if(i.snapRotating);else{i.snapRotating=!0;let t=e.playerBody.GetEl().getAttribute("rotation").y;p.from=t,p.to=t+45,e.playerBody.Animate(p),c=setTimeout((()=>{i.snapRotating=!1,clearTimeout(c)}),p.dur+10)}},SnapRight90:()=>{if(i.snapRotating);else{i.snapRotating=!0;let t=e.playerBody.GetEl().getAttribute("rotation").y;u.from=t,u.to=t-90,e.playerBody.Animate(u),c=setTimeout((()=>{i.snapRotating=!1,clearTimeout(c)}),u.dur+10)}},SnapLeft90:()=>{if(i.snapRotating);else{i.snapRotating=!0;let t=e.playerBody.GetEl().getAttribute("rotation").y;u.from=t,u.to=t+90,e.playerBody.Animate(u),c=setTimeout((()=>{i.snapRotating=!1,clearTimeout(c)}),u.dur+10)}},ToggleFlashlight:t=>{let o=i.flashlight;t.on?o=!1:t.off&&(o=!0),o?("Desktop"===e.controls||"Mobile"===e.controls?e.camera.RemoveComponent("light"):"VR"===e.controls&&("bothRight"===e.vrHand||"bothRightLoco"===e.vrHand||"right"===e.vrHand?e.vrController2.RemoveComponent("light"):e.vrController1.RemoveComponent("light")),i.flashlight=!1):("Desktop"===e.controls||"Mobile"===e.controls?e.camera.ChangeSelf({property:"light",value:{type:"spot",intensity:.35,distance:15,decay:.3,penumbra:.15,angle:25}}):"VR"===e.controls&&("bothRight"===e.vrHand||"bothRightLoco"===e.vrHand||"right"===e.vrHand?e.vrController2.ChangeSelf({property:"light",value:{type:"spot",intensity:.3,distance:15,decay:.3,penumbra:.15,angle:35}}):e.vrController1.ChangeSelf({property:"light",value:{type:"spot",intensity:.3,distance:15,decay:.3,penumbra:.15,angle:35}})),i.flashlight=!0)},ResetUserPosRot:()=>{e.playerRig.ChangeSelf({property:"position",value:new THREE.Vector3(0,0,1)}),i.gridPos.copy(e.playerRig.GetEl().getAttribute("position"));let t=e.camera.GetEl().getAttribute("rotation").y;t>0?t<360&&(t%=360):t<0&&t<-360&&(t%=360),e.playerBody.ChangeSelf({property:"rotation",value:new THREE.Vector3(0,-1*t+1,0)})},GetPlayerInfo:x,ToggleRayHelp:m,CamRigPoint:(t,o)=>{let a=new THREE.Vector3;i.position=new THREE.Vector3,i.quaternion=new THREE.Quaternion,i.rigQuaternion=new THREE.Quaternion,i.quaternion.copy(e.camera.GetEl().object3D.quaternion),i.rigQuaternion.copy(e.playerRig.GetEl().object3D.quaternion),i.position.copy(e.camera.GetEl().object3D.position),i.position.add(e.playerRig.GetEl().object3D.position);let n=o||new THREE.Vector3(0,0,-1);return n.applyQuaternion(i.quaternion),n.multiplyScalar(t),e.playerRig.GetEl().object3D.quaternion.equals(new THREE.Quaternion(0,0,0,1))||n.applyQuaternion(i.rigQuaternion),a.copy(i.position.clone().add(n)),a},RigPoint:R,RaySpawnPoint:(t,i,o)=>{let a=new THREE.Vector3;t.object3D.getWorldDirection(a);let n=new THREE.Vector3;e.playerRig.GetEl().components.gravitycontrol?n.copy(e.playerRig.GetEl().components.gravitycontrol.axis):n.copy(new THREE.Vector3(0,-1,0));let s=0,r=0,l=0;n.equals(new THREE.Vector3)?(s=a.x,r=0,l=a.z):0!==n.x?(s=0,r=a.y,l=a.z):0!==n.y?(s=a.x,r=0,l=a.z):0!==n.z&&(s=a.x,r=a.y,l=0);let c=new THREE.Vector3(s,r,l).normalize().multiplyScalar(o);return 0===s?c.x=i:0===r?c.y=i:0===l&&(c.z=i),c},RayDir:M,RayDistanceDirection:(t,i,o)=>{!1===t&&(t=e.camera.GetEl());let a=(new THREE.Quaternion).copy(t.object3D.quaternion),n=(new THREE.Quaternion).copy(e.playerBody.GetEl().object3D.quaternion);a.multiply(n);let s=i||1,r=o||new THREE.Vector3(0,0,-1);return r.applyQuaternion(a),(new THREE.Vector3).copy(r).normalize().multiplyScalar(s)},GetRayDirectionRig:C,AttachToPlayer:(e,t)=>{let o=new THREE.Vector3(0,0,0);t&&(o.x+=t.x,o.y+=t.y,o.z+=t.z),e.setAttribute("sync-pos",{idname:i.id,position:o})},Equip:t=>{let o=!1;if(i.equipped&&t===i.equippedObject?w():o=!0,o){i.equipped=!0,i.equippedObject=t;let o="Equipped : "+e[t].name;f(o)}},Unequip:w,MainMenuAction:()=>{if(i.menuToggle){i.menuToggle=!1;let t=setTimeout((()=>{i.menuToggle=!0,clearTimeout(t)}),350);e.comp.comp.inScene?e.mainMenu.multiMenu.menuOpen?e.mainMenu.ToggleMenu():e.comp.DespawnComp():e.comp.SpawnComp()}},DetachFromPlayer:e=>{e.removeAttribute("sync-pos")},EnablePhysics:t=>{t&&t.body&&(i.body=t.body),t&&t.shape&&(i.shape=t.shape),e.playerRig.EnablePhysics({body:i.body,shape:i.shape}),i.worldBody=e.playerRig.GetEl().body,i.playerPhysics=!0,e.playerRig.ChangeSelf({property:"bodymaterial",value:i.material}),e.playerRig.ChangeSelf({property:"gravitycontrol",value:{type:"float",axis:new THREE.Vector3(0,0,0),customGravity:1e-5,velocityExpo:1e3,gravityObject:"none"}}),e.playerRig.GetEl().body.fixedRotation=!0,e.playerRig.GetEl().body.updateMassProperties(),e.mouseController.RemoveComponent(["animation__hoverenter","animation__hoverleave"]),m(!0)},setAllGravity:N,setAllGravityAxis:e=>{N({axis:e})},setAllGravityTypes:e=>{N({type:e})},cycleAllGravityTypes:()=>{e.playerRig.GetEl().components.gravitycontrol.cycleTypes(),e.playerRig.GetEl().components.gravitycontrol.cycleWorldTypes()},cycleWorldGravityAxis:()=>{e.playerRig.GetEl().components.gravitycontrol.cycleWorldAxis()},ToggleAction:e=>{i.toggle0=!1,i.toggle1=!1,i.toggle2=!1,i.toggle3=!1,i.toggle4=!1,i.toggle5=!1,"0"===e?i.toggle0=!0:"1"===e?i.toggle1=!0:"2"===e?i.toggle2=!0:"3"===e?i.toggle3=!0:"4"===e?i.toggle4=!0:"5"===e?i.toggle5=!0:(ne(i.raycasters.hmdmouse.linkCore),ne(i.raycasters.hand1.linkCore),ne(i.raycasters.hand2.linkCore))},Rubberband:Y,TeleportTo:te,BoostTo:B,BackBoost:q,ChuteUp:()=>{e.playerRig.GetEl().components.gravitycontrol.data.chuteOpen=!1},ChuteDown:()=>{e.playerRig.GetEl().components.gravitycontrol.data.chuteOpen=!0},BrakeUp:t=>{e.playerRig.GetEl().body.linearDamping=i.brakeOff,clearInterval(i.brakeInterval),i.brakeDoubleTapSet=!0,i.brakeDoubleTapTimeout=setTimeout((()=>{i.brakeDoubleTapSet=!1}),500)},BrakeDown:t=>{i.brakeDoubleTapSet?(i.brakeOff=i.body.linearDamping,e.playerRig.GetEl().body.linearDamping=.9,i.brakeDoubleTapSet=!1,clearTimeout(i.brakeDoubleTapTimeout)):(i.brakeOff=i.body.linearDamping,i.braking=i.brakeOff/32,clearInterval(i.brakeInterval),i.brakeInterval=setInterval((()=>{e.playerRig.GetEl().body.linearDamping<.9?e.playerRig.GetEl().body.linearDamping+=i.braking:clearInterval(i.brakeInterval)}),1))},RedirectUp:J,RedirectDown:K,Redirect:Z,Freeze:W,UnFreeze:_,DelinkCore:ne,LinkUp:()=>{i.linkCore.core.inScene&&(i.linkLength<maxLinkLength&&i.linkLength++,i.linkConstraint.Connect({restLength:i.linkLength}))},LinkDown:()=>{i.linkCore.core.inScene&&(i.linkLength>1&&i.linkLength--,i.linkConstraint.Connect({restLength:i.linkLength}))},LinkGrab:(e,t)=>{console.log("Link Grab"),console.log(t)},LinkDrop:(e,t)=>{console.log("Link Drop"),console.log(t)},LinkShoot:(e,t)=>{console.log("Link Shoot"),console.log(t)},LinkHit:(e,t)=>{console.log("Link Hit"),console.log(t.target),console.log(t.detail),console.log(t.detail.intersection.point);let i=k();i.x*=-2,i.y*=-2,i.z*=-2,t.target.body.applyLocalImpulse(i,new THREE.Vector3(0,0,0))},PhysJump:(t,o,a)=>{if(!i.jumping){i.jumping=!0;let o=t||4;THREE.MathUtils.degToRad(45);let a=new THREE.Vector3;a.copy(e.playerRig.GetEl().components.gravitycontrol.axis);let n=new THREE.Vector3;n.copy(a),n.negate();let s=new THREE.Vector3;e.camera.GetEl().object3D.getWorldDirection(s),s.negate();let r=new THREE.Vector3(0,0,0);r.copy(s).add(n).multiplyScalar(o),e.playerRig.GetEl().body.velocity.x=r.x,e.playerRig.GetEl().body.velocity.y=r.y,e.playerRig.GetEl().body.velocity.z=r.z}},UpdatePlayerPosition:t=>{let o=new THREE.Vector3(0,0,0);o.x=t.x||0,o.y=t.y||0,o.z=t.z||0,e.playerRig.ChangeSelf({property:"position",value:o}),i.gridPos.copy(o)},TwistTo:t=>{let i=e.camera.GetEl().getAttribute("rotation").y;i>0?i<360&&(i%=360):i<-360&&(i%=360);let o=new THREE.Vector3(0,-1*i+1+t,0);e.playerBody.ChangeSelf({property:"rotation",value:o})},ToggleBackgroundAudio:()=>{e.backgroundAudio=!e.backgroundAudio,e.backgroundAudio?e.playerAudio.SpawnCore(e.playerRig):e.playerAudio.DespawnCore()},Ticker:()=>{"Desktop"===e.controls||"Mobile"===e.controls?i.raycasters.hmdmouse.linkDisplay&&e.mouseController.GetEl().components.raycaster.intersections.length>0&&(i.raycasters.hmdmouse.intersection=new THREE.Vector3(0,0,0),i.raycasters.hmdmouse.intersection.copy(e.mouseController.GetEl().components.raycaster.intersections[0].point),i.raycasters.hmdmouse.linkAnchor.core.inScene?i.raycasters.hmdmouse.linkAnchor.ChangeSelf({property:"position",value:i.raycasters.hmdmouse.intersection}):(i.raycasters.hmdmouse.linkAnchor.core.position=new THREE.Vector3(0,0,0),i.raycasters.hmdmouse.linkAnchor.core.position.copy(i.raycasters.hmdmouse.intersection),i.raycasters.hmdmouse.linkAnchor.SpawnCore())):"VR"===e.controls&&(["bothLeft","bothLeftLoco","left"].includes(e.vrHand)?i.raycasters.hand1.linkDisplay&&e.vrController1.GetEl().components.raycaster.intersections.length>0&&(i.raycasters.hand1.intersection=new THREE.Vector3(0,0,0),i.raycasters.hand1.intersection.copy(e.vrController1.GetEl().components.raycaster.intersections[0].point),i.raycasters.hand1.linkAnchor.core.inScene?i.raycasters.hand1.linkAnchor.ChangeSelf({property:"position",value:i.raycasters.hand1.intersection}):(i.raycasters.hand1.linkAnchor.core.position=new THREE.Vector3(0,0,0),i.raycasters.hand1.linkAnchor.core.position.copy(i.raycasters.hand1.intersection),i.raycasters.hand1.linkAnchor.SpawnCore())):["bothRight","bothRightLoco","right"].includes(e.vrHand)&&i.raycasters.hand2.linkDisplay&&e.vrController2.GetEl().components.raycaster.intersections.length>0&&(i.raycasters.hand2.intersection=new THREE.Vector3(0,0,0),i.raycasters.hand2.intersection.copy(e.vrController2.GetEl().components.raycaster.intersections[0].point),i.raycasters.hand2.linkAnchor.core.inScene?i.raycasters.hand2.linkAnchor.ChangeSelf({property:"position",value:i.raycasters.hand2.intersection}):(i.raycasters.hand2.linkAnchor.core.position=new THREE.Vector3(0,0,0),i.raycasters.hand2.linkAnchor.core.position.copy(i.raycasters.hand2.intersection),i.raycasters.hand2.linkAnchor.SpawnCore())))},TriggerEnter:I,TriggerDown:e=>{i.playerPhysics&&(e=>{z(e),i.toggle0?Q(e):i.toggle1?oe(e):i.toggle2?ee(e):i.toggle3?K(e):i.toggle4?j(e):i.toggle5&&U(e)})(e)},TriggerUp:e=>{i.playerPhysics&&(e=>{z(e),i.toggle0?X(e):i.toggle1?ie(e):i.toggle2?$(e):i.toggle3?J(e):i.toggle4?V(e):i.toggle5&&G(e)})(e)},TriggerLeave:O,Track2D:t=>{let o=t||new THREE.Vector3(0,0,0);if(o.equals(new THREE.Vector3(0,0,0)))return;S.copy(e.playerRig.GetEl().getAttribute("position"));let a=new THREE.Vector3(0,0,0),n=new THREE.Vector3(0,0,0),s=0;i.track2DInterval=setInterval((()=>{s++,a.equals(new THREE.Vector3(0,0,0))?a.copy(e.mouseController.GetEl().components.raycaster.intersections[0].point):n.equals(new THREE.Vector3(0,0,0))&&n.copy(e.mouseController.GetEl().components.raycaster.intersections[0].point),s>1&&(i.localAxis=function(e,t,i){let o=function(e,t,i){const o=(new THREE.Vector3).subVectors(t,e),a=(new THREE.Vector3).subVectors(i,e);return(new THREE.Vector3).crossVectors(o,a).normalize()}(e,t,i);const a=[new THREE.Vector3(0,-1,0),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,0)];let n=null,s=-1;for(const e of a){const t=e.dot(o);t>s&&(s=t,n=e)}return n}(o,a,n),s=0,clearInterval(i.track2DInterval))}),300)},EmitEvent:(t,i)=>{e.playerRig.EmitEvent(t,i)},TestFunc:e=>{console.log(e)},TogglePlayerPhysics:t=>{t?e.playerRig.GetEl().body.wakeUp():e.playerRig.GetEl().body.sleep()},CycleCameraZoom:y,HeadSnapRight45:()=>{if(i.headSnapRotating);else{i.headSnapRotating=!0;let t=e.playerCamRoam.GetEl().getAttribute("rotation").y;p.from=t,p.to=t-45,e.playerCamRoam.Animate(p),h=setTimeout((()=>{i.headSnapRotating=!1,clearTimeout(h)}),p.dur+10)}},HeadSnapLeft45:()=>{if(i.headSnapRotating);else{i.headSnapRotating=!0;let t=e.playerCamRoam.GetEl().getAttribute("rotation").y;p.from=t,p.to=t+45,e.playerCamRoam.Animate(p),h=setTimeout((()=>{i.headSnapRotating=!1,clearTimeout(h)}),p.dur+10)}},RoamCamSwap:g}},o=(e,t,i,o)=>{console.log({auxl:e,id:t,layer:i,data:o});let a={id:"uniRayDefault",name:"uniRayDefault"};a.pos=new THREE.Vector3(0,0,0),a.intersection=new THREE.Vector3(0,0,0),a.powers={},a.power="select",a.active=!1,o&&(a.id=o.id,a.name=o.name,a.pos=o.pos,a.intersection=new THREE.Vector3(0,0,0),a.powers=o.powers,a.power=o.power),a.rigData={data:"rigData",id:a.id+"Rig",sources:!1,text:!1,geometry:!1,material:!1,position:a.pos,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","rig",a.id],components:{"wasd-controls":{enabled:!0},light:{type:"point",intensity:.075,distance:5,decay:.75}}},a.rig=e.Core(a.rigData),a.bodyData={data:"bodyData",id:a.id+"Body",sources:!1,text:!1,geometry:{primitive:"box",width:.5,height:.5,depth:.5},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,1,0),scale:new THREE.Vector3(1,1,1),animations:{crouchdownstanding:{property:"object3D.position.y",from:0,to:-.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchDownStanding"},crouchupstanding:{property:"object3D.position.y",from:-.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchUpStanding"},crouchdownsitting:{property:"object3D.position.y",from:.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchDownSitting"},crouchupsitting:{property:"object3D.position.y",from:0,to:.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchUpSitting"},sit:{property:"object3D.position.y",from:0,to:.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sit"},stand:{property:"object3D.position.y",from:.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"stand"}},mixins:!1,classes:["a-ent","body",a.id],components:!1},a.body=e.Core(a.bodyData),a.cameraRayData={data:"cameraRayData",id:a.id+"CameraRay",entity:"a-camera",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.005,radiusOuter:.01},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-.5),position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","cameraray",a.id],components:{active:!1,"look-controls":{enabled:!0,reverseMouseDrag:!1,reverseTouchDrag:!1,touchEnabled:!0,mouseEnabled:!0,pointerLockEnabled:!0,magicWindowTrackingEnabled:!0},"wasd-controls":{enabled:!1},raycaster:{enabled:"true",autoRefresh:"true",objects:".clickable",origin:new THREE.Vector3(0,0,0),direction:new THREE.Vector3(0,0,-1),far:"Infinity",near:0,interval:0,lineColor:"white",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"},cursor:{fuse:"false",rayOrigin:a.id+"CameraRay",mouseCursorStylesEnabled:"true"}}},a.cameraRay=e.Core(a.cameraRayData),a.rayUIData={data:"rayUIData",id:a.id+"RayUI",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.005,radiusOuter:.01},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{opacinbk:{property:"components.material.material.opacity",from:0,to:.82,dur:750,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacoutbk:{property:"components.material.material.opacity",from:.82,to:0,dur:750,delay:2e3,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacintxt:{property:"text.opacity",from:0,to:.82,dur:750,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacouttxt:{property:"text.opacity",from:.82,to:0,dur:750,delay:2e3,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},click:{property:"scale",from:"0.75 0.75 0.75",to:"0.4 0.4 0.4",dur:100,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mousedown"},clickreset:{property:"scale",from:"0.4 0.4 0.4",to:"0.75 0.75 0.75",dur:300,delay:0,loop:"false",dir:"normal",easing:"easeOutCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseup"},hoverenter:{property:"material.color",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"material.color",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["clickable","a-ent","rayui",a.id],components:{visible:!0}},a.rayUI=e.Core(a.rayUIData),a.bodyBeltUIData={data:"bodyBeltUIData",id:a.id+"BodyBeltUI",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"look-at-xyz":{match:"camera",x:!1,y:!0,z:!1}}},a.bodyBeltUI=e.Core(a.bodyBeltUIData),a.bodyBeltTextData={data:"bodyBeltTextData",id:a.id+"bodyBeltText",sources:!1,text:{value:"Hello World!",color:"#FFFFFF",align:"left",font:"exo2bold",width:.9,zOffset:.03,side:"front",wrapCount:45,baseline:"center"},geometry:{primitive:"box",depth:.025,width:1,height:.25},material:{shader:"standard",color:"#4bb8c1",opacity:.75,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{visible:!1}},a.bodyBeltText=e.Core(a.bodyBeltTextData),a.rayVehicleData={data:"rayVehicleData",id:a.id+"RayVehicle",sources:!1,text:!1,geometry:{primitive:"circle",radius:1,segments:32,thetaStart:0,thetaLength:360},material:{shader:"flat",repeat:"1 1",color:"#3EB489",opacity:.42,side:"double"},position:new THREE.Vector3(0,.05,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:!0}},a.rayVehicle=e.Core(a.rayVehicleData),a.mouseControllerData={data:"mouseControllerData",id:a.id+"MouseController",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.005,radiusOuter:.01},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.75,.75,.75),animations:{click:{property:"scale",from:"0.75 0.75 0.75",to:"0.4 0.4 0.4",dur:100,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mousedown"},clickreset:{property:"scale",from:"0.4 0.4 0.4",to:"0.75 0.75 0.75",dur:300,delay:0,loop:"false",dir:"normal",easing:"easeOutCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseup"},hoverenter:{property:"material.color",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"material.color",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["clickable","a-ent","player"],components:{raycaster:{enabled:"true",autoRefresh:"true",objects:".clickable",origin:new THREE.Vector3(0,0,0),direction:new THREE.Vector3(0,0,-1),far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"},cursor:{fuse:"false",rayOrigin:a.id+"MouseController",mouseCursorStylesEnabled:"true"}}},a.mouseController=e.Core(a.mouseControllerData),a.vrController1Data={data:"vrController1Data",id:"vrController1",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},a.vrController1=e.Core(a.vrController1Data),a.vrController1UIData={data:"vrController1UIData",id:"vrController1UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},a.vrController1UI=e.Core(a.vrController1UIData),a.vrController2Data={data:"vrController2Data",id:"vrController2",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},a.vrController2=e.Core(a.vrController2Data),a.vrController2UIData={data:"vrController2UIData",id:"vrController2UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},a.vrController2UI=e.Core(a.vrController2UIData),a.fadeScreenData={data:"Fade Screen",id:"fadeScreen",sources:!1,text:!1,geometry:{primitive:"plane",width:1,height:.5},material:{shader:"flat",color:"#000000",opacity:0},position:new THREE.Vector3(0,0,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{fadein:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene1"},fadeoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene2"}},mixins:!1,classes:["a-ent","player","clickable"],components:{visible:!1}},a.fadeScreen=e.Core(a.fadeScreenData),a.sphereScreenData={data:"Sphere Screen",id:"sphereScreen",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.125,segmentsWidth:36,segmentsHeight:18,phiLength:360,phiStart:0,thetaLength:0,thetaStart:90},material:{shader:"flat",color:"#000000",opacity:1,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{spherein1:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein2:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout1:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout2:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein1scene:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},spherein2scene:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},sphereout1scene:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"},sphereout2scene:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},a.sphereScreen=e.Core(a.sphereScreenData),a.blink1ScreenData={data:"Blink 1 Screen",id:"blink1Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinscene:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},a.blink1Screen=e.Core(a.blink1ScreenData),a.blink2ScreenData={data:"Blink 2 Screen",id:"blink2Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,-2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinscene:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},a.blink2Screen=e.Core(a.blink2ScreenData),a.uniRayAll={parent:{core:a.rig},child0:{parent:{core:a.body},child0:{parent:{core:a.cameraRay},child0:{core:a.rayUI}},child1:{parent:{core:a.bodyBeltUI},child0:{core:a.rayBeltText}}},child1:{core:a.rayVehicle}},a.uniRayLayer=e.Layer("uniRayLayer",a.uniRayAll);const n=t=>{a.active=!0,e.camera.ChangeSelf({property:"active",value:!1}),a.cameraRay.ChangeSelf({property:"active",value:!0})},s=t=>{a.active=!1,a.cameraRay.ChangeSelf({property:"active",value:!1}),e.camera.ChangeSelf({property:"active",value:!0})};return{uniRay:a,SpawnUniRay:e=>{a.uniRayLayer.SpawnLayer(e)},DespawnUniRay:()=>{a.uniRayLayer.DespawnLayer()},Activate:n,Deactivate:s,Toggle:e=>{a.active?s():n()},RayDisable:()=>{a.cameraRay.GetEl().setAttribute("visible",!1),a.cameraRay.GetEl().removeAttribute("raycaster"),a.cameraRay.GetEl().removeAttribute("cursor"),controllerBlock.style.display="none"},RayEnable:()=>{a.cameraRay.GetEl().setAttribute("visible",!0),a.cameraRay.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),a.cameraRay.GetEl().setAttribute("cursor",{fuse:"false",mouseCursorStylesEnabled:"true",rayOrigin:a.id}),controllerBlock.style.display="flex",e.playerRig.GetEl().setAttribute("uniray",{update:6}),e.player.EnableMobileLocomotion(),e.locomotionText="Arrow Buttons"},RayControls:e=>{e=e||".clickable,",a.cameraRay.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:e,far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"})},ModeVRRight:e=>{e.setAttribute("laser-controls",{hand:"right"})},ModeVRLeft:e=>{e.setAttribute("laser-controls",{hand:"left"})},ModeVROff:e=>{e.removeAttribute("laser-controls")},disableVRControls:function(){e.vrController1.GetEl().setAttribute("visible",!1),e.vrController2.GetEl().setAttribute("visible",!1),e.vrController1UI.GetEl().setAttribute("visible",!1),e.vrController2UI.GetEl().setAttribute("visible",!1),e.vrController1.GetEl().removeAttribute("cursor"),e.vrController2.GetEl().removeAttribute("cursor"),e.vrController1.GetEl().removeAttribute("laser-controls"),e.vrController2.GetEl().removeAttribute("laser-controls")},enableVRControls:function(){"bothRight"===e.vrHand?(e.vrController1.GetEl().setAttribute("visible",!0),e.vrController2.GetEl().setAttribute("visible",!0),e.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),e.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),e.vrController1.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),e.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),e.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),e.playerRig.GetEl().setAttribute("uniray",{update:1}),e.player.EnableVRLocomotion(),e.locomotionText="Left Controller Joystick"):"bothLeft"===e.vrHand?(e.vrController1.GetEl().setAttribute("visible",!0),e.vrController2.GetEl().setAttribute("visible",!0),e.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),e.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),e.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),e.vrController2.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),e.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),e.playerRig.GetEl().setAttribute("uniray",{update:2}),e.player.EnableVRLocomotion(),e.locomotionText="Right Controller Joystick"):"bothRightLoco"===e.vrHand||"bothLeftLoco"===e.vrHand?(e.vrController1.GetEl().setAttribute("visible",!0),e.vrController2.GetEl().setAttribute("visible",!0),e.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),e.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),e.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:"false"}),e.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),vrController1.setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),e.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),e.playerRig.GetEl().setAttribute("uniray",{update:3}),e.player.EnableVRLocomotion(),"bothLeftLoco"===e.vrHand?e.locomotionText="Left Controller Joystick":"bothRightLoco"===e.vrHand&&(e.locomotionText="Right Controller Joystick")):"right"===e.vrHand?(e.vrController2.GetEl().setAttribute("visible",!0),e.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),e.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),e.vrController2.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),e.playerRig.GetEl().setAttribute("uniray",{update:4}),e.player.EnableVRHoverLocomotion("vrController2"),e.locomotionText="Hover on Forward/Backward Belt."):"left"===e.vrHand&&(e.vrController1.GetEl().setAttribute("visible",!0),e.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),e.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),e.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),e.playerRig.GetEl().setAttribute("uniray",{update:5}),e.player.EnableVRHoverLocomotion("vrController1"),e.locomotionText="Hover on Forward/Backward Belt.")},disableDesktopControls:function(){a.cameraRay.GetEl().setAttribute("visible",!1),a.cameraRay.GetEl().removeAttribute("raycaster"),a.cameraRay.GetEl().removeAttribute("cursor")},enableDesktopControls:function(){a.cameraRay.GetEl().setAttribute("visible",!0),a.cameraRay.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),a.cameraRay.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:a.cameraRay.id,mouseCursorStylesEnabled:"true"}),e.playerRig.GetEl().setAttribute("uniray",{update:0}),e.player.EnableDesktopLocomotion(),e.locomotionText="WASD Keys"},disableMobileControls:function(){a.cameraRay.GetEl().setAttribute("visible",!1),a.cameraRay.GetEl().removeAttribute("raycaster"),a.cameraRay.GetEl().removeAttribute("cursor"),controllerBlock.style.display="none"},enableMobileControls:function(){a.cameraRay.GetEl().setAttribute("visible",!0),a.cameraRay.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),a.cameraRay.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:a.cameraRay.id,mouseCursorStylesEnabled:"true"}),controllerBlock.style.display="flex",e.playerRig.GetEl().setAttribute("uniray",{update:6}),e.player.EnableMobileLocomotion(),e.locomotionText="Arrow Buttons"},RayIntersected:e=>{console.log({event:"raycaster-intersected"})},RayIntersectCleared:e=>{console.log({event:"raycaster-intersected-cleared"})},RayIntersection:e=>{console.log({event:"raycaster-intersection"})},RayIntersectionCleared:e=>{console.log({event:"raycaster-intersection-cleared"})},RayIntersectUpdate:e=>{console.log({event:"raycaster-closest-entity-changed"})}}},a=(e,t)=>{let i,o=Object.assign({},t),a=e.Core(e.sceneTextData),n=e.SpeechSystem(a);const s=(t,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(e[i].GetFlag)if(e[i].GetFlag(o))for(let e in a)for(let t in a[e])h(e,t,a[e][t]);else for(let e in n)for(let t in n[e])h(e,t,n[e][t]);else if(e[i].GetFlagParent)if(e[i].GetFlagParent(o))for(let e in a)for(let t in a[e])h(e,t,a[e][t]);else for(let e in n)for(let t in n[e])h(e,t,n[e][t])},r=(t,i,o)=>{let a=[];for(let e in o)"default"===e||a.push(e);if(e[i].GetFlag){let t=e[i].GetFlag(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])h(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])h(e,t,o.default[e][t])}else if(e[i].GetFlagParent){let t=e[i].GetFlagParent(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])h(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])h(e,t,o.default[e][t])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},l=({name:t,type:i,id:o,method:a,params:n,event:s})=>{let r=t+o;"timeout"===i||"interval"===i?e.running[r]={type:i,name:t,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(e.running[r]={type:i,name:t,id:o,nameId:r,method:a,params:n,event:s})},c=t=>{delete e.running[t]},h=(t,i,o)=>{for(let o in e.objGenTracking)i!==e.objGenTracking[o].spawn&&i!==e.objGenTracking[o].altSpawn||e.spawnTracker(t,"node");e[t][i](o)};function d(t){if("controls"!==t){"info"===t&&(o[t].fog?e.sceneEl.setAttribute("fog",o[t].fog):e.sceneEl.setAttribute("fog",{type:"linear",near:999,far:1e3,color:"#FFF"}));for(let i in o[t])if("delay"===t)for(let a in o[t][i])for(let n in o[t][i][a])if("IfElse"===n)for(let r in o[t][i][a][n])l({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){s(0,r,o[t][i][a][n][r]),clearTimeout(e.timeouts[i+a])}),i);else if("Switch"===n)for(let s in o[t][i][a][n])l({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){r(0,s,o[t][i][a][n][s]),clearTimeout(e.timeouts[i+a])}),i);else l({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){h(a,n,o[t][i][a][n]),clearTimeout(e.timeouts[i+a])}),i);else if("interval"===t)for(let a in o[t][i]){let n,d=0,p=o[t][i].loop;if(o[t][i].end&&(n=o[t][i].end),"run"===a)for(let u in o[t][i][a])for(let m in o[t][i][a][u])if("IfElse"===m)for(let r in o[t][i][a][u][m])l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),c(i+u)),s(0,r,o[t][i][a][u][m][r]),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i);else if("Switch"===m)for(let s in o[t][i][a][u][m])l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),c(i+u)),r(0,s,o[t][i][a][u][m][s]),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i);else{let s=m,r=o[t][i][a][u][m];l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),c(i+u)),h(u,s,r),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i)}}else if("interaction"===t)for(let a in o[t][i])for(let n in o[t][i][a])if("IfElse"===n)for(let r in o[t][i][a][n]){let c=a,h=o[t][i][a][n][r];l({name:c,type:"interaction",id:a,method,params:h,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){s(0,r,h)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){s(0,r,h)}))}else if("Switch"===n)for(let s in o[t][i][a][n]){let c=a,h=o[t][i][a][n][s];l({name:c,type:"interaction",id:a,method,params:h,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){r(0,s,h)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){r(0,s,h)}))}else if("relay"===n)for(let s in o[t][i][a][n])for(let r in o[t][i][a][n][s]){let c=a,d=s,p=r,u=o[t][i][a][n][s][r];l({name:c,type:"interaction",id:a,method:p,params:u,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){h(d,p,u),console.log({object:c,relay:d,method:p,params:u})})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){h(d,p,u)}))}else{let s=a,r=n,c=o[t][i][a][n];l({name:s,type:"interaction",id:a,method:r,params:c,event:i}),e[s].GetEl?e[s].GetEl().addEventListener(i,(function(){h(s,r,c)})):e[s].GetParentEl&&e[s].GetParentEl().addEventListener(i,(function(){h(s,r,c)}))}else if("event"===t)for(let a in o[t][i])for(let n in o[t][i][a]){let c,d,p,u;if("IfElse"===n)for(let r in o[t][i][a][n])c=a,p=o[t][i][a][n][r],l({name:c,type:"event",id:a,method:d,params:p,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){s(0,r,p)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){s(0,r,p)}));else if("Switch"===n)for(let s in o[t][i][a][n])c=a,p=o[t][i][a][n][s],l({name:c,type:"event",id:a,method:d,params:p,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){r(0,s,p)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){r(0,s,p)}));else if("relay"===n)for(let s in o[t][i][a][n])for(let r in o[t][i][a][n][s])c=a,u=s,d=r,p=o[t][i][a][n][s][r],l({name:c,type:"event",id:a,method:d,params:p,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){h(u,d,p)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){h(u,d,p)}));else c=a,d=n,p=o[t][i][a][n],l({name:c,type:"event",id:a,method:d,params:p,event:i}),e[c].GetEl?e[c].GetEl().addEventListener(i,(function(){h(c,d,p)})):e[c].GetParentEl&&e[c].GetParentEl().addEventListener(i,(function(){h(c,d,p)}))}else if("info"===t);else for(let e in o[t][i])if("start"===t)if("IfElse"===e)for(let a in o[t][i][e])s(0,a,o[t][i][e][a]);else if("Switch"===e)for(let a in o[t][i][e])r(0,a,o[t][i][e][a]);else h(i,e,o[t][i][e]);else if("exit"===t)if("IfElse"===e)for(let a in o[t][i][e])s(0,a,o[t][i][e][a]);else if("Switch"===e)for(let a in o[t][i][e])r(0,a,o[t][i][e][a]);else h(i,e,o[t][i][e]);else console.log(t),console.log(i),console.log(e),console.log("Hit Other Timeline, Please Investigate")}else e.controller.updateAction(o[t])}const p=()=>{e.map.grid.edgeSpawned&&e.map.DespawnEdges(),e.map.ClearWaiting(),e.map.ClearTriggers()},u=()=>{"other"===o.info.spawnPos||(o.info.spawnPos?e.player.UpdatePlayerPosition(o.info.spawnPos):e.player.UpdatePlayerPosition(new THREE.Vector3(0,0,0)))};return{core:o,ClearScene:()=>{d("exit"),e.controller.disableAction(o.controls),p(),e.player.EmitEvent("sceneExit",!0),o.info.sceneText&&n.KillStop(),(()=>{for(let t in e.running)"timeout"===e.running[t].type?(clearTimeout(e.timeouts[e.running[t].nameId]),delete e.timeouts[e.running[t].nameId]):"interval"===e.running[t].type?(clearInterval(e.intervals[e.running[t].nameId]),delete e.intervals[e.running[t].nameId]):"interaction"!==e.running[t].type&&"event"!==e.running[t].type||(e[e.running[t].name].GetEl?e[e.running[t].name].GetEl().removeEventListener(e.running[t].event,(function(){h(e.running[t].object,e.running[t].method,e.running[t].params)})):e[e.running[t].name].GetParentEl&&e[e.running[t].name].GetParentEl().removeEventListener(e.running[t].event,(function(){h(e.running[t].object,e.running[t].method,e.running[t].params)}))),c(t)})(),e.clearSpawned(e.nodeSpawned)},StartScene:()=>{e.sceneReading=!0,e.SceneLoadTimeout(),u(),d("info"),o.info.map&&(e.map.BuildMap(o.info.map.size,o.info.map.height),e.mapEdge=o.info.map.edge||!1,e.mapEdge&&o.info.map.spawnEdge&&e.map.SpawnEdges(o.info.map.edgeUpdate)),d("start"),d("delay"),d("interval"),d("event"),d("interaction"),d("controls"),e.UpdateControlText(),(()=>{if(o.info.sceneText){n.Start(),n.DisplaySpeech({role:o.info.name,speech:"... ... ..."});let e=setTimeout((()=>{n.DisplaySpeech({role:o.info.name,speech:o.info.description}),clearTimeout(e)}),1250)}})(),i=setTimeout((()=>{e.sceneReading=!1,clearTimeout(i)}),400),e.local.location.scene=o.info.id,e.saveToProfile(),e.local.location.load&&(e.local.location.load=!1)},ScenePlayerPosition:u}},n=(e,t)=>{let i,o,a=Object.assign({},t);a.mapMenuData=!1,a.mapMainMenuData=!1,a.mapMenu,a.nodes={},a.currentNode,a.zoneLoaded=!1,a.displayBasicTravelMenu=a.info.travelMenu||!1;const n=(t,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(e[i].GetFlag)if(e[i].GetFlag(o))for(let e in a)for(let t in a[e])r(e,t,a[e][t]);else for(let e in n)for(let t in n[e])r(e,t,n[e][t]);else if(e[i].GetFlagParent)if(e[i].GetFlagParent(o))for(let e in a)for(let t in a[e])r(e,t,a[e][t]);else for(let e in n)for(let t in n[e])r(e,t,n[e][t])},s=(t,i,o)=>{let a=[];for(let e in o)"default"===e||a.push(e);if(e[i].GetFlag){let t=e[i].GetFlag(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])r(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])r(e,t,o.default[e][t])}else if(e[i].GetFlagParent){let t=e[i].GetFlagParent(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])r(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])r(e,t,o.default[e][t])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},r=(t,i,o)=>{for(let o in e.objGenTracking)i!==e.objGenTracking[o].spawn&&i!==e.objGenTracking[o].altSpawn||e.spawnTracker(t,"zone");e[t][i](o)},l=({name:t,type:i,id:o,method:a,params:n,event:s})=>{let r=t+o;"timeout"===i||"interval"===i?e.zoneRunning[r]={type:i,name:t,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(e.zoneRunning[r]={type:i,name:t,id:o,nameId:r,method:a,params:n,event:s})},c=t=>{delete e.zoneRunning[t]};function h(t){if("controls"!==t)for(let i in a[t])if("delay"===t)for(let o in a[t][i])for(let c in a[t][i][o])if("IfElse"===c)for(let s in a[t][i][o][c])l({name:i,type:"timeout",id:o}),e.timeouts[i+o]=setTimeout((function(){n(0,s,a[t][i][o][c][s]),clearTimeout(e.timeouts[i+o])}),i);else if("Switch"===c)for(let n in a[t][i][o][c])l({name:i,type:"timeout",id:o}),e.timeouts[i+o]=setTimeout((function(){s(0,n,a[t][i][o][c][n]),clearTimeout(e.timeouts[i+o])}),i);else l({name:i,type:"timeout",id:o}),e.timeouts[i+o]=setTimeout((function(){r(o,c,a[t][i][o][c]),clearTimeout(e.timeouts[i+o])}),i);else if("interval"===t)for(let o in a[t][i]){let h,d=0,p=a[t][i].loop;if(a[t][i].end&&(h=a[t][i].end),"run"===o)for(let u in a[t][i][o])for(let m in a[t][i][o][u])if("IfElse"===m)for(let s in a[t][i][o][u][m])l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(h)&&(clearInterval(e.intervals[i+u]),c(i+u)),n(0,s,a[t][i][o][u][m][s]),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i);else if("Switch"===m)for(let n in a[t][i][o][u][m])l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(h)&&(clearInterval(e.intervals[i+u]),c(i+u)),s(0,n,a[t][i][o][u][m][n]),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i);else{let n=m,s=a[t][i][o][u][m];l({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(h)&&(clearInterval(e.intervals[i+u]),c(i+u)),r(u,n,s),"infinite"===p||(d++,d>=p&&(clearInterval(e.intervals[i+u]),c(i+u)))}),i)}}else if("interaction"===t)for(let o in a[t][i])for(let c in a[t][i][o]){let h,d,p;if("IfElse"===c)for(let s in a[t][i][o][c])h=o,p=a[t][i][o][c][s],l({name:h,type:"interaction",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){n(0,s,p)}));else if("Switch"===c)for(let n in a[t][i][o][c])h=o,p=a[t][i][o][c][n],l({name:h,type:"interaction",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){s(0,n,p)}));else h=o,d=c,p=a[t][i][o][c],l({name:h,type:"interaction",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){r(h,d,p)}))}else if("event"===t)for(let o in a[t][i])for(let c in a[t][i][o]){let h,d,p;if("IfElse"===c)for(let s in a[t][i][o][c])h=o,p=a[t][i][o][c][s],l({name:h,type:"event",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){n(0,s,p)}));else if("Switch"===c)for(let n in a[t][i][o][c])h=o,p=a[t][i][o][c][n],l({name:h,type:"event",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){s(0,n,p)}));else h=o,d=c,p=a[t][i][o][c],l({name:h,type:"event",id:o,method:d,params:p,event:i}),e[h].GetEl().addEventListener(i,(function(){r(h,d,p)}))}else if("info"===t);else for(let e in a[t][i])if("start"===t)if("IfElse"===e)for(let o in a[t][i][e])n(0,o,a[t][i][e][o]);else if("Switch"===e)for(let o in a[t][i][e])s(0,o,a[t][i][e][o]);else r(i,e,a[t][i][e]);else if("exit"===t)if("IfElse"===e)for(let o in a[t][i][e])n(0,o,a[t][i][e][o]);else if("Switch"===e)for(let o in a[t][i][e])s(0,o,a[t][i][e][o]);else r(i,e,a[t][i][e]);else console.log("Hit Other Timeline, Please Investigate");else e.controller.updateAction(a[t])}const d=()=>{e.controller.disableAction(a.controls)},p=t=>{e.local.location.load?a.currentNode=e.local.location.scene:a.currentNode=t||a.info.start,a.currentZone=a.info.id,e.currentZone=a.info.id,a.zoneLoaded||(h("start"),h("delay"),h("interval"),h("event"),h("interaction"),h("controls"),e.audioEnabled&&e.backgroundAudio&&!e.isFalsey(a.info.backgroundAudio)?e.currentWorld.MusicPlaylist(a.info.backgroundAudio):"none"===a.info.backgroundAudio&&e.currentWorld.MusicPlaylist(!1),e.local.location.zone=a.info.id,a.zoneLoaded=!0),e[a.currentNode].StartScene(),y(),a.displayBasicTravelMenu&&m(),e.player.UnlockLocomotion()},u=()=>{e[a.currentNode].ClearScene()},m=()=>{a.mapMenuData={id:"moveMenu",prompt:"Move to...",options:{option0:"0"},actions:{action0:"0"},data:e.menuBaseData,cursorObj:a.currentZone,method:"MenuMoveClick",pos:new THREE.Vector3(-1.5,1.5,-1)};let t,i=0;for(let o in a.map[a.currentNode])t=a.nodes[a.map[a.currentNode][o].node]?a.nodes[a.map[a.currentNode][o].node]:e[a.map[a.currentNode][o].node],a.map[a.currentNode][o].locked&&!e.comp.CheckForKey(a.map[a.currentNode][o].keyId)?a.mapMenuData.options["option"+i]=t.core.info.name+" [Locked]":a.map[a.currentNode][o].locked&&e.comp.CheckForKey(a.map[a.currentNode][o].keyId)?a.mapMenuData.options["option"+i]=t.core.info.name+" [Unlocked]":a.mapMenuData.options["option"+i]=t.core.info.name,a.mapMenuData.actions["action"+i]=o,i++;a.mapMenu=e.Menu(a.mapMenuData),a.mapMenu.SpawnMenu()},y=()=>{a.mapMainMenuData={};let t,i,o={},n={},s=1,r=1,l=Object.keys(a.map[a.currentNode]).length,c=Math.ceil(l/7),h="travel"+r;e.local.location.load||""===e.local.location.scenario||e[e.local.location.scenario].UpdateZoneMap();for(let d in a.map[a.currentNode])t=a.nodes[a.map[a.currentNode][d].node]?a.nodes[a.map[a.currentNode][d].node]:e[a.map[a.currentNode][d].node],i=a.map[a.currentNode][d].locked&&!e.comp.CheckForKey(a.map[a.currentNode][d].keyId)?t.core.info.name+" [Locked]":a.map[a.currentNode][d].locked&&e.comp.CheckForKey(a.map[a.currentNode][d].keyId)?t.core.info.name+" [Unlocked]":t.core.info.name,o={id:"action"+s,style:!1,title:i,description:"Travel to "+i,subMenu:!1,action:{auxlObj:a.currentZone,component:!1,method:"Move",params:d,menu:"close"}},n={id:"action"+s,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},a.mapMainMenuData["button"+s]=o,s===l?e.mainMenu.UpdateSubMenu(h,a.mapMainMenuData):s++,c>1&&s%7==0&&(r++,n.id="action"+s,n.subMenu="travel"+r,a.mapMainMenuData["button"+s]=n,e.mainMenu.UpdateSubMenu(h,a.mapMainMenuData),a.mapMainMenuData={},h="travel"+r)},g=t=>{o=a.map[a.currentNode][t],o.locked&&!e.comp.CheckForKey(o.keyId)?(clearTimeout(void 0),e.player.Notification({message:"Requires : "+o.keyName})):(e.player.LockLocomotion(),e.player.PlayerSceneAnim(),o.locked&&e.comp.CheckForKey(o.keyId)&&!o.keepKey&&e.comp.RemoveFromInventory(o.keyId),i=setTimeout((()=>{a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu(),u(),a.nodes[o.node]?p(o.node):(v(),a.zoneLoaded=!1,e[o.inZone].StartScene(o.node)),clearTimeout(i)}),425))},v=()=>{h("exit"),d(),e.player.EmitEvent("zoneExit",!0),a.zoneLoaded=!1,(()=>{for(let t in e.zoneRunning)"timeout"===e.zoneRunning[t].type?(clearTimeout(e.timeouts[e.zoneRunning[t].nameId]),delete e.timeouts[e.zoneRunning[t].nameId]):"interval"===e.zoneRunning[t].type?(clearInterval(e.intervals[e.zoneRunning[t].nameId]),delete e.intervals[e.zoneRunning[t].nameId]):"interaction"!==e.zoneRunning[t].type&&"event"!==e.zoneRunning[t].type||e[e.zoneRunning[t].name].GetEl().removeEventListener(e.zoneRunning[t].event,(function(){r(e.zoneRunning[t].object,e.zoneRunning[t].method,e.zoneRunning[t].params)})),c(t)})(),d(),e.clearSpawned(e.zoneSpawned),a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu()};return{core:a,UpdateMap:t=>{a.nodes={},a.map=t;for(let i in t)a.nodes[i]=e[i]},StartScene:p,MoveSpawnMenu:m,MenuMoveClick:e=>{let t=e.getAttribute("result");g(t)},Move:g,Change:(t,o)=>{e.player.PlayerSceneAnim(),i=setTimeout((()=>{a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu(),u(),a.info.id===t?p(o):(v(),a.zoneLoaded=!1,e[t].StartScene(o)),clearTimeout(i)}),425)},ClearZone:v}},s=(e,t)=>{let i,o=Object.assign({},t);o.scenarioLoaded=!1;let a=o.info.startZone,n=o.info.name,s=o.info.instructions;const r=(t,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(e[i].GetFlag)if(e[i].GetFlag(o))for(let e in a)for(let t in a[e])c(e,t,a[e][t]);else for(let e in n)for(let t in n[e])c(e,t,n[e][t]);else if(e[i].GetFlagParent)if(e[i].GetFlagParent(o))for(let e in a)for(let t in a[e])c(e,t,a[e][t]);else for(let e in n)for(let t in n[e])c(e,t,n[e][t])},l=(t,i,o)=>{let a=[];for(let e in o)"default"===e||a.push(e);if(e[i].GetFlag){let t=e[i].GetFlag(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])c(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])c(e,t,o.default[e][t])}else if(e[i].GetFlagParent){let t=e[i].GetFlagParent(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])c(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])c(e,t,o.default[e][t])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},c=(t,i,o)=>{for(let o in e.objGenTracking)i!==e.objGenTracking[o].spawn&&i!==e.objGenTracking[o].altSpawn||e.spawnTracker(t,"scenario");e[t][i](o)},h=({name:t,type:i,id:o,method:a,params:n,event:s})=>{let r=t+o;"timeout"===i||"interval"===i?e.scenarioRunning[r]={type:i,name:t,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(e.scenarioRunning[r]={type:i,name:t,id:o,nameId:r,method:a,params:n,event:s})},d=t=>{delete e.scenarioRunning[t]};function p(t){if("controls"!==t)for(let i in o[t])if("delay"===t)for(let a in o[t][i])for(let n in o[t][i][a])if("IfElse"===n)for(let s in o[t][i][a][n])h({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){r(0,s,o[t][i][a][n][s]),clearTimeout(e.timeouts[i+a])}),i);else if("Switch"===n)for(let s in o[t][i][a][n])h({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){l(0,s,o[t][i][a][n][s]),clearTimeout(e.timeouts[i+a])}),i);else h({name:i,type:"timeout",id:a}),e.timeouts[i+a]=setTimeout((function(){c(a,n,o[t][i][a][n]),clearTimeout(e.timeouts[i+a])}),i);else if("interval"===t)for(let a in o[t][i]){let n,s=0,p=o[t][i].loop;if(o[t][i].end&&(n=o[t][i].end),"run"===a)for(let u in o[t][i][a])for(let m in o[t][i][a][u])if("IfElse"===m)for(let l in o[t][i][a][u][m])h({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),d(i+u)),r(0,l,o[t][i][a][u][m][l]),"infinite"===p||(s++,s>=p&&(clearInterval(e.intervals[i+u]),d(i+u)))}),i);else if("Switch"===m)for(let r in o[t][i][a][u][m])h({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),d(i+u)),l(0,r,o[t][i][a][u][m][r]),"infinite"===p||(s++,s>=p&&(clearInterval(e.intervals[i+u]),d(i+u)))}),i);else{let r=m,l=o[t][i][a][u][m];h({name:i,type:"interval",id:u}),e.intervals[i+u]=setInterval((function(){!0===e[u].GetFlag(n)&&(clearInterval(e.intervals[i+u]),d(i+u)),c(u,r,l),"infinite"===p||(s++,s>=p&&(clearInterval(e.intervals[i+u]),d(i+u)))}),i)}}else if("interaction"===t)for(let a in o[t][i])for(let n in o[t][i][a]){let s,d,p;if("IfElse"===n)for(let l in o[t][i][a][n])s=a,p=o[t][i][a][n][l],h({name:s,type:"interaction",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){r(0,l,p)}));else if("Switch"===n)for(let r in o[t][i][a][n])s=a,p=o[t][i][a][n][r],h({name:s,type:"interaction",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){l(0,r,p)}));else s=a,d=n,p=o[t][i][a][n],h({name:s,type:"interaction",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){c(s,d,p)}))}else if("event"===t)for(let a in o[t][i])for(let n in o[t][i][a]){let s,d,p;if("IfElse"===n)for(let l in o[t][i][a][n])s=a,p=o[t][i][a][n][l],h({name:s,type:"event",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){r(0,l,p)}));else if("Switch"===n)for(let r in o[t][i][a][n])s=a,p=o[t][i][a][n][r],h({name:s,type:"event",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){l(0,r,p)}));else s=a,d=n,p=o[t][i][a][n],h({name:s,type:"event",id:a,method:d,params:p,event:i}),e[s].GetEl().addEventListener(i,(function(){c(s,d,p)}))}else if("info"===t);else for(let e in o[t][i])if("start"===t)if("IfElse"===e)for(let a in o[t][i][e])r(0,a,o[t][i][e][a]);else if("Switch"===e)for(let a in o[t][i][e])l(0,a,o[t][i][e][a]);else c(i,e,o[t][i][e]);else if("exit"===t)if("IfElse"===e)for(let a in o[t][i][e])r(0,a,o[t][i][e][a]);else if("Switch"===e)for(let a in o[t][i][e])l(0,a,o[t][i][e][a]);else c(i,e,o[t][i][e]);else console.log("Hit Other Timeline, Please Investigate");else e.controller.updateAction(o[t])}const u=()=>{e.controller.disableAction(o.controls)},m=()=>{for(let t in o.map)e[t].UpdateMap(o.map[t])};return{core:o,StartScenario:()=>{o.scenarioLoaded||(e.player.PlayerSceneAnim(),m(),scenarioHeaderTitle.innerHTML=n,scenarioMenuTitle.innerHTML=n,instructions.innerHTML=s,i=setTimeout((()=>{p("start"),p("delay"),p("interval"),p("event"),p("interaction"),p("controls"),a=e.local.location.load?e.local.location.zone:o.info.startZone,e[a].StartScene(),o.scenarioLoaded=!0,e.local.location.scenario=o.info.id,clearTimeout(i)}),425))},ClearScenario:()=>{e[e[e.currentZone].core.currentNode].ClearScene(),e[e.currentZone].ClearZone(),p("exit"),u(),e.player.EmitEvent("scenarioExit",!0),(()=>{for(let t in e.scenarioRunning)"timeout"===e.scenarioRunning[t].type?(clearTimeout(e.timeouts[e.scenarioRunning[t].nameId]),delete e.timeouts[e.scenarioRunning[t].nameId]):"interval"===e.scenarioRunning[t].type?(clearInterval(e.intervals[e.scenarioRunning[t].nameId]),delete e.intervals[e.scenarioRunning[t].nameId]):"interaction"!==e.scenarioRunning[t].type&&"event"!==e.scenarioRunning[t].type||e[e.scenarioRunning[t].name].GetEl().removeEventListener(e.scenarioRunning[t].event,(function(){c(e.scenarioRunning[t].object,e.scenarioRunning[t].method,e.scenarioRunning[t].params)})),d(t)})(),u(),e.clearSpawned(e.scenarioSpawned),o.scenarioLoaded=!1},UpdateZoneMap:m}},r=(AFRAME.registerComponent("scenenode",{dependencies:["auxl"],multiple:!0,schema:{bar:{type:"number"},baz:{type:"string"}},init:function(){this.scene=document.querySelector("a-scene"),this.auxl=this.scene.systems.auxl},update:function(){},remove:function(){},tick:function(e,t){},tock:function(e,t,i){},play:function(){},pause:function(){},updateSchema:function(){},events:{click:function(e){}},whatever:function(){}}),(e,t)=>{let i={};i.data=Object.assign({},t),i.inScene=!1,i.menuOpen=!1,i.descriptionOpen=!1,i.buttonHover="",i.currentMenu="menu0",i.menuPath=["menu0"],i.switching=!1,i.switchingTimeout,i.id=t.info.id||"multiMenu",i.layout=t.info.layout||"circleUp",i.posOffset=t.info.posOffset||new THREE.Vector3(0,0,0),i.offset=t.info.offset||-1,i.parent=i.data.info.parent||!1,i.stare=i.data.info.stare||!1,i.npc=i.data.info.npc||!1;let o=-45,a=0,n=250;i.buttonData=JSON.parse(JSON.stringify(i.data.info.buttonData)),i.hoverData=JSON.parse(JSON.stringify(i.data.info.hoverData)),i.nullParentData={data:"nullParentData",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:i.posOffset,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},(i.stare||i.look)&&(i.nullParentData.components={},i.stare&&(i.nullParentData.components.stare=i.stare),i.look&&(i.nullParentData.components["look-at-xyz"]=i.look)),i.cores={},i.cores.hover={},i.nullParentData.id=i.id,i.data.info.position&&(i.nullParentData.position=i.data.info.position),i.cores.parent=e.Core(i.nullParentData),i.nullParentData.position=new THREE.Vector3(0,0,0),i.nullParentData.components={},i.buttonData.id=i.data.info.id+"menu","circleUp"!==i.layout&&"circleDown"!==i.layout||(i.buttonData.position.x=i.offset),i.cores.main=e.Core(i.buttonData);for(let t in i.data)if("info"===t);else{i.cores[t]=[],i.cores.hover[t]=[];let n=0;for(let a in i.data[t])n++,i.buttonData.id=i.data[t][a].id,i.buttonData.text.value=i.data[t][a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*n*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*n:"vertical"===i.layout?i.buttonData.position.y=n*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=n*i.offset),i.buttonData.components={},i.data[t][a].action?(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=i.data[t][a].action.auxlObj,i.buttonData.components.clickrun.method=i.data[t][a].action.method,i.data[t][a].action.component&&(i.buttonData.components.clickrun.component=i.data[t][a].action.component),i.data[t][a].action.params&&(i.buttonData.components.clickrun.params=i.data[t][a].action.params),i.data[t][a].action.menu?"stay"===i.data[t][a].action.menu||("back"===i.data[t][a].action.menu?(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ToggleMenu",i.buttonData.components.menurun.params=null):"close"===i.data[t][a].action.menu&&(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="SubMenu",i.buttonData.components.menurun.params=i.data[t][a].subMenu),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=i.data[t][a].id+"hover",i.hoverData.text.value=i.data[t][a].description,i.cores.hover[t][a]=e.Core(i.hoverData),i.cores[t][a]=e.Core(i.buttonData);n>a&&(a=n)}i.cores.nulls=[];for(let t=0;t<=8;t++)i.nullParentData.id=i.id+"null"+t,"circleUp"===i.layout?i.nullParentData.rotation.z=o*t:"circleDown"===i.layout&&(i.nullParentData.rotation.z=o*t*-1),i.cores.nulls.push(e.Core(i.nullParentData));i.menuLayerData={parent:{core:i.cores.parent},child0:{parent:{core:i.cores.nulls[0]},child0:{core:i.cores.main}}};for(let e=1;e<i.cores.nulls.length;e++)i.menuLayerData["child"+e]={},i.menuLayerData["child"+e].core=i.cores.nulls[e];i.menuLayer=e.Layer(i.id,i.menuLayerData);const s=()=>{i.menuPath.length>1?i.cores.main.ChangeSelf({property:"text",value:{value:"Back"}}):i.cores.main.ChangeSelf({property:"text",value:{value:"Close"}}),i.menuOpen=!0,i.switching=!0;let t,o=i.currentMenu,a=1,s=setTimeout((()=>{let n="";for(let e in i.cores[o])t=i.menuLayer.GetChildEl(i.id+"null"+a),i.cores[o][e].SpawnCore(t),a++,n+=" "+i.cores[o][e].core.id;i.npc&&e[i.npc].Speak({role:o,speech:n}),clearTimeout(s)}),n);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),500)},r=e=>{i.menuOpen=!1,i.switching=!0;let t,o=i.currentMenu,a=1,s={};t=e?25:n,i.descriptionOpen&&d(i.buttonHover);let r=setTimeout((()=>{for(let e in i.cores[o])s[e]=i.menuLayer.GetChildEl(i.id+"null"+a),i.cores[o][e].DespawnCore(),a++;clearTimeout(r)}),t);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),2*t)},l=()=>{i.switching||(i.menuOpen?i.menuPath.length>1?h(i.menuPath[i.menuPath.length-2]):c():s())},c=e=>{let t;if(i.cores.main.ChangeSelf({property:"text",value:{value:"Open"}}),t=e?0:n,i.switching);else if(i.menuOpen){let o=setTimeout((()=>{r(e),i.currentMenu="menu0",i.menuPath=["menu0"],i.menuOpen=!1,clearTimeout(o)}),t)}},h=e=>{i.switching||(r(),i.currentMenu=e,i.menuPath.includes(i.currentMenu)?i.menuPath.pop():i.menuPath.push(i.currentMenu),s())},d=e=>{i.descriptionOpen&&(i.cores[i.currentMenu][e].GetEl(),i.cores.hover[i.currentMenu][e].DespawnCore(),i.buttonHover="",i.descriptionOpen=!1)};return{multiMenu:i,SpawnMultiMenu:e=>{i.inScene||(i.menuLayer.SpawnLayer(i.parent),i.menuLayer.GetChildEl(i.id+"null0").addEventListener("click",l),i.cores.main.ChangeSelf({property:"text",value:{value:"Open"}}),e&&l(),i.inScene=!0)},DespawnMultiMenu:()=>{if(i.inScene){c(!0);let t=setTimeout((()=>{i.menuLayer.GetChildEl(i.id+"null0").removeEventListener("click",l),i.menuLayer.DespawnLayer(),i.inScene=!1,e.RemoveFromTracker(i.id),clearTimeout(t)}),n)}},ToggleMenu:l,UpdateParent:e=>{let t=e||!1;i.inScene||(i.parent=t)},UpdateButtons:e=>{console.log(i.cores)},UpdateSubMenu:(t,n)=>{if(i.currentMenu===t);else{i.cores[t]=[],i.cores.hover[t]=[];let s=0;for(let a in n)s++,i.buttonData.id=n[a].id,i.buttonData.text.value=n[a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*s*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*s:"vertical"===i.layout?i.buttonData.position.y=s*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=s*i.offset),i.buttonData.components={},n[a].action?(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=n[a].action.auxlObj,i.buttonData.components.clickrun.method=n[a].action.method,n[a].action.component&&(i.buttonData.components.clickrun.component=n[a].action.component),n[a].action.params&&(i.buttonData.components.clickrun.params=n[a].action.params),n[a].action.menu?"stay"===n[a].action.menu||("back"===n[a].action.menu?(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ToggleMenu",i.buttonData.components.menurun.params=null):"close"===n[a].action.menu&&(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="SubMenu",i.buttonData.components.menurun.params=n[a].subMenu),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=n[a].id+"hover",i.hoverData.text.value=n[a].description,i.cores.hover[t][a]=e.Core(i.hoverData),i.cores[t][a]=e.Core(i.buttonData);s>a&&(a=s)}},SubMenu:h,ResetMenu:c,SpawnDescription:e=>{if(i.descriptionOpen);else{i.buttonHover=e;let t=i.cores[i.currentMenu][e].GetEl();i.cores.hover[i.currentMenu][e].SpawnCore(t),i.descriptionOpen=!0}},DespawnDescription:d}}),l=(e,t)=>{let i={};i.data=Object.assign({},t),i.inScene=!1,i.menuOpen=!1,i.active=!1,i.descriptionOpen=!1,i.buttonHover="",i.currentMenu="menu",i.menuPath=["menu"],i.switching=!1,i.switchingTimeout,i.id=t.info.id||"hoverMenu",i.name=t.info.name||"Quick Menu",i.layout=t.info.layout||"circleUp",i.posOffset=t.info.posOffset||new THREE.Vector3(0,0,0),i.offset=t.info.offset||-1,i.parent=i.data.info.parent||!1,i.spawnPos=new THREE.Vector3(0,0,0),i.attached=i.data.info.attached||!1;let o=-45,a=0;i.buttonData=JSON.parse(JSON.stringify(i.data.info.buttonData)),i.hoverData=JSON.parse(JSON.stringify(i.data.info.hoverData)),i.nullParentData={data:"nullParentData",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:i.posOffset,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},i.cores={},i.cores.hover={},i.nullParentData.id=i.id,i.data.info.position&&(i.nullParentData.position=i.data.info.position),i.cores.parent=e.Core(i.nullParentData),i.nullParentData.position=new THREE.Vector3(0,0,0),i.nullParentData.components={},i.buttonData.id=i.data.info.id+"menu","circleUp"!==i.layout&&"circleDown"!==i.layout||(i.buttonData.position.x=i.offset),i.buttonData.text.value=i.name,i.cores.main=e.Core(i.buttonData);for(let t in i.data)if("info"===t);else{i.cores[t]=[],i.cores.hover[t]=[];let n=0;for(let a in i.data[t])n++,i.buttonData.id=i.data[t][a].id,i.buttonData.text.value=i.data[t][a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*n*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*n:"vertical"===i.layout?i.buttonData.position.y=n*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=n*i.offset),i.buttonData.components={},i.buttonData.components.hoverrun={},i.buttonData.components.hoverrun.menu=i.id,i.buttonData.components.hoverrun.action=a,i.attached&&(i.buttonData.components.hoverrun.attached=i.attached),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=i.data[t][a].id+"hover",i.hoverData.text.value=i.data[t][a].description,i.cores.hover[t][a]=e.Core(i.hoverData),i.cores[t][a]=e.Core(i.buttonData);n>a&&(a=n)}i.cores.nulls=[];for(let t=0;t<=8;t++)i.nullParentData.id=i.id+"null"+t,"circleUp"===i.layout?i.nullParentData.rotation.z=o*t:"circleDown"===i.layout&&(i.nullParentData.rotation.z=o*t*-1),i.cores.nulls.push(e.Core(i.nullParentData));i.menuLayerData={parent:{core:i.cores.parent},child0:{parent:{core:i.cores.nulls[0]},child0:{core:i.cores.main}}};for(let e=1;e<i.cores.nulls.length;e++)i.menuLayerData["child"+e]={},i.menuLayerData["child"+e].core=i.cores.nulls[e];i.menuLayer=e.Layer(i.id,i.menuLayerData);const n=e=>{let t;if(t=e?0:50,i.switching);else if(i.menuOpen){let o=setTimeout((()=>{(e=>{i.menuOpen=!1,i.switching=!0;let t,o=i.currentMenu,a=1,n={};t=e?25:50,i.descriptionOpen&&s(i.buttonHover);let r=setTimeout((()=>{for(let e in i.cores[o])n[e]=i.menuLayer.GetChildEl(i.id+"null"+a),i.cores[o][e].DespawnCore(),a++;clearTimeout(r)}),t);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),2*t)})(e),clearTimeout(o)}),t)}},s=e=>{i.descriptionOpen&&(i.cores[i.currentMenu][e].GetEl(),i.cores.hover[i.currentMenu][e].DespawnCore(),i.buttonHover="",i.descriptionOpen=!1)};return{hoverMenu:i,SpawnHoverMenu:()=>{i.inScene||(i.active=!1,i.menuLayer.layer.all.parent.core.core.position=function(){let t=new THREE.Vector3;e.camera.GetEl().object3D.getWorldDirection(t);let o=new THREE.Vector3;return o.copy(e.camera.GetEl().object3D.position).add(new THREE.Vector3(t.x,t.y,t.z).normalize().multiplyScalar(i.posOffset.z)),o}(),i.menuLayer.SpawnLayer(i.parent),(()=>{i.menuOpen=!0,i.switching=!0;let e,t=i.currentMenu,o=1,a=setTimeout((()=>{for(let a in i.cores[t])e=i.menuLayer.GetChildEl(i.id+"null"+o),i.cores[t][a].SpawnCore(e),o++;clearTimeout(a)}),50);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),100)})(),i.inScene=!0)},DespawnHoverMenu:()=>{if(i.inScene){console.log(i.active),i.active&&function(t){if(t.component&&"null"!==t.component){if(document.getElementById(t.auxlObj)){let e=document.getElementById(t.auxlObj);t.params&&"null"!==t.params?e.components[t.component][t.method](t.params):e.components[t.component][t.method]()}}else e[t.auxlObj][t.method]&&(t.params&&"null"!==t.params?e[t.auxlObj][t.method](t.params):e[t.auxlObj][t.method]())}(i.data.menu[i.active].action),n(!0);let t=setTimeout((()=>{i.menuLayer.DespawnLayer(),i.inScene=!1,clearTimeout(t)}),50)}},UpdateParent:e=>{let t=e||!1;i.inScene||(i.parent=t)},UpdateSubMenu:(t,n)=>{if(i.currentMenu===t);else{i.cores[t]=[],i.cores.hover[t]=[];let s=0;for(let a in n)s++,i.buttonData.id=n[a].id,i.buttonData.text.value=n[a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*s*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*s:"vertical"===i.layout?i.buttonData.position.y=s*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=s*i.offset),i.buttonData.components={},n[a].action&&(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=n[a].action.auxlObj,i.buttonData.components.clickrun.method=n[a].action.method,n[a].action.component&&(i.buttonData.components.clickrun.component=n[a].action.component),n[a].action.params&&(i.buttonData.components.clickrun.params=n[a].action.params)),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=n[a].id+"hover",i.hoverData.text.value=n[a].description,i.cores.hover[t][a]=e.Core(i.hoverData),i.cores[t][a]=e.Core(i.buttonData);s>a&&(a=s)}},ResetMenu:n,SpawnDescription:e=>{if(i.descriptionOpen);else{i.buttonHover=e;let t=i.cores[i.currentMenu][e].GetEl();i.cores.hover[i.currentMenu][e].SpawnCore(t),i.descriptionOpen=!0}},DespawnDescription:s}},c=(e,t,i,o,a,n)=>{let s={};s.id=t;let r=s.id+"layer",l=s.id+"combo0",c=s.id+"combo1",h=s.id+"combo2",d=s.id+"combo3",p=s.id+"combo4";if(s.sequence=o,s.run=a,s.current=0,s.locked=!0,s.correctSoFar=!0,s.lockedTimeout,s.unlockedTimeout,s.position=n||new THREE.Vector3(0,0,0),s.texts=[],i)for(let e in i)s.texts[e]={value:i[e],color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.051,side:"front",wrapCount:2,baseline:"center"};else s.texts[0]=!1,s.texts[1]=!1,s.texts[2]=!1,s.texts[3]=!1,s.texts[4]=!1;s.comboParentData={data:"comboParentData",id:"comboParent",sources:!1,text:!1,geometry:!1,material:!1,position:s.position,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},s.comboParent=e.Core(s.comboParentData),s.combo0Data={data:"combo0Data",id:l,sources:!1,text:s.texts[0],geometry:{primitive:"box",depth:.1,width:.2,height:.3},material:{shader:"standard",color:"#e02574",emissive:"#e02574",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(-.4,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"},locked:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:250,delay:0,loop:!1,dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"locked"},locked2:{property:"material.emissiveIntensity",from:"1",to:"0.25",dur:250,delay:1750,loop:!1,dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"locked"},unlocked:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:250,delay:0,loop:"8",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"unlocked"}},mixins:!1,classes:["clickable","a-ent"],components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"0"}}},s[l]=e.Core(s.combo0Data),s.combo1Data=e.coreDataFromTemplate(s.combo0Data,{id:c,text:s.texts[1],position:new THREE.Vector3(-.2,0,0),material:{shader:"standard",color:"#66e025",emissive:"#66e025",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"1"}}},!0),s[c]=e.Core(s.combo1Data),s.combo2Data=e.coreDataFromTemplate(s.combo0Data,{id:h,text:s.texts[2],position:new THREE.Vector3(0,0,0),material:{shader:"standard",color:"#256de0",emissive:"#256de0",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"2"}}},!0),s[h]=e.Core(s.combo2Data),s.combo3Data=e.coreDataFromTemplate(s.combo0Data,{id:d,text:s.texts[3],position:new THREE.Vector3(.2,0,0),material:{shader:"standard",color:"#e0e025",emissive:"#e0e025",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"3"}}},!0),s[d]=e.Core(s.combo3Data),s.combo4Data=e.coreDataFromTemplate(s.combo0Data,{id:p,text:s.texts[4],position:new THREE.Vector3(.4,0,0),material:{shader:"standard",color:"#e09825",emissive:"#e09825",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"4"}}},!0),s[p]=e.Core(s.combo4Data),s.comboAll={parent:{core:s.comboParent},child0:{core:s[l]},child1:{core:s[c]},child2:{core:s[h]},child3:{core:s[d]},child4:{core:s[p]}},s[r]=e.Layer(r,s.comboAll);const u=()=>{s.locked=!1,m(),g(),s.unlockedTimeout=setTimeout((()=>{s.run.component&&"null"!==s.run.component?document.getElementById(s.run.cursorObj).components[s.run.component][s.run.method](s.run.params):e[s.run.cursorObj][s.run.method](s.run.params),g(),b(),clearTimeout(s.lockedTimeout)}),2250)},m=()=>{s[r].EmitEventAll("unlocked")},y=()=>{s[r].EmitEventAll("locked")},g=()=>{s[r].GetAllChildEl().forEach((e=>e.classList.toggle("clickable")))},v=()=>{s.current=0,s.correctSoFar=!0,s.locked=!0},b=()=>{clearTimeout(s.lockedTimeout),clearTimeout(s.unlockedTimeout),s[r].DespawnLayer()};return{comboLock:s,SpawnComboLock:()=>{s.locked=!0,s[r].SpawnLayer()},DespawnComboLock:b,KeyClick:e=>{s.locked&&(e=>{s.correctSoFar&&(e===s.sequence[s.current]?s.correctSoFar=!0:s.correctSoFar=!1),s.current++,s.current>=s.sequence.length&&(s.correctSoFar?u():(v(),y(),g(),s.unlockedTimeout=setTimeout((()=>{g(),clearTimeout(s.unlockedTimeout)}),2e3)))})(e)},NewSequence:e=>{clearTimeout(s.lockedTimeout),clearTimeout(s.unlockedTimeout),s.sequence=e,v()}}},h=(e,t,i,o)=>{let a,n;t.on=!1,t.speaking=!1,t.blinking=!1,t.blinkNextText="",t.blinkText0="",t.blinkText1="",t.textDisplayInterval;let s="speech";t.type="core",t.core?(t.type="core",s=t.core.id):(t.type="layer",s=t.layer.id);let r=!1;i&&(r=i.avatar.core?"core":"layer");const l=e=>"core"===t.type?!!t.GetEl(e):!!t.GetParentEl(e),c=()=>{l()?"core"===t.type?t.GetEl().emit("skip",{}):t.GetParentEl().emit("skip",{}):console.log({core:t,npc:i,func:"Skip()",msg:"Failed to find speech bubble"})},h=()=>{t.speaking=!1,clearInterval(e.intervals[s]),delete e.intervals[s]},d=()=>{t.blinking=!1,clearInterval(e.intervals[s+"blink"]),delete e.intervals[s+"blink"]},p=()=>{u({name:"blinkDisplayInterval",type:"interval",id:s}),e.intervals[s+"blink"]=setInterval((()=>{l()?t.blinking?("core"===t.type?t.GetEl().setAttribute("text",{value:t.blinkText1}):t.GetParentEl().setAttribute("text",{value:t.blinkText1}),t.blinking=!1):("core"===t.type?t.GetEl().setAttribute("text",{value:t.blinkText0}):t.GetParentEl().setAttribute("text",{value:t.blinkText0}),t.blinking=!0):d()}),1500)},u=({name:t,type:i,id:o,method:a,params:n})=>{let s=t+o;"timeout"===i||"interval"===i?e.running[s]={type:i,name:t,id:o,nameId:s}:"interaction"!==i&&"event"!==i||(e.running[s]={type:i,name:t,id:o,nameId:s,method:a,params:n,event})};return{core:t,Start:()=>{let o=!1;"core"===r?o=i.avatar.GetEl():"layer"===r&&(o=i.avatar.GetParentEl()),"core"===t.type?(t.SpawnCore(o),n=setTimeout((()=>{t.GetEl().addEventListener("mouseenter",c),t.EmitEvent("loadin"),clearTimeout(a)}),25)):(t.SpawnLayer(o),n=setTimeout((()=>{t.layer.all.child0.core.GetEl().addEventListener("click",e[i.id].ResetSpeech),t.layer.all.child1.core.GetEl().addEventListener("click",e[i.id].ForceResetBook),t.GetParentEl().addEventListener("mouseenter",c),t.EmitEventAll("loadin"),clearTimeout(a)}),25)),t.on=!0},Skip:c,KillStop:()=>{h(),d(),(()=>{if(t.on){if(!l())return void console.log({core:t,npc:i,func:"Stop()",msg:"Failed to find speech bubble"});"core"===t.type?(t.GetEl().removeEventListener("mouseenter",c),t.EmitEvent("loadout"),a=setTimeout((()=>{t.DespawnCore(),t.on=!1,clearTimeout(a)}),1e3)):(t.GetParentEl().removeEventListener("mouseenter",c),t.EmitEventAll("loadout"),t.layer.all.child0.core.GetEl().removeEventListener("click",i.ResetSpeech),t.layer.all.child1.core.GetEl().removeEventListener("click",i.ForceResetBook),a=setTimeout((()=>{t.DespawnLayer(),t.on=!1,clearTimeout(a)}),1e3))}})()},ChangeCore:e=>{if(l())if("core"===t.type)if(Array.isArray(e))for(let i in e)t.ChangeSelf(e[i]);else t.ChangeSelf(e);else if(Array.isArray(e))for(let i in e)t.ChangeParent(e[i]);else t.ChangeParent(e);else console.log({core:t,npc:i,func:"ChangeCore()",msg:"Failed to find speech bubble"})},DisplaySpeech:({role:o,speech:a})=>{if("core"===t.type){if(!t.GetEl(!0))return}else if(!t.GetParentEl(!0))return;if(h(),d(),!l())return void console.log({core:t,npc:i,func:"DisplaySpeech()",msg:"Failed to find speech bubble"});let n=o+" : ",r=n,c=0;function m(){"core"===t.type?t.GetEl().setAttribute("text",{value:n+a}):t.GetParentEl().setAttribute("text",{value:n+a}),t.speaking=!1,h(),t.blink&&(t.blinkText0=n+a,t.blinkText1=n+a,i.bookEnd?t.blinkNextText=" X":t.blinkNextText=" ->",t.blinkText1+=t.blinkNextText,p()),"core"===t.type?t.GetEl().removeEventListener("skip",m):t.GetParentEl().removeEventListener("skip",m)}"core"===t.type?t.GetEl(!0).setAttribute("text",{value:r}):t.GetParentEl(!0).setAttribute("text",{value:r}),t.speaking=!0,"core"===t.type?t.GetEl().addEventListener("skip",m):t.GetParentEl().addEventListener("skip",m),u({name:"textDisplayInterval",type:"interval",id:s}),e.intervals[s]=setInterval((()=>{l()?(c<a.length&&(r+=a[c],c++),c>=a.length&&(t.speaking=!1,"core"===t.type?t.GetEl().removeEventListener("skip",m):t.GetParentEl().removeEventListener("skip",m),t.blink&&(t.blinkText0=r,t.blinkText1=r,i.bookEnd?t.blinkNextText=" X":t.blinkNextText=" ->",t.blinkText1+=t.blinkNextText,p()),h()),t.on&&("core"===t.type?t.GetEl().setAttribute("text",{value:r}):t.GetParentEl().setAttribute("text",{value:r}))):h()}),20)}}},d=e=>{let t={size:0,topHeight:0,bottomHeight:0,collide:{},trigger:{},triggersActive:!1,edgeSpawned:!1,edges:{}};t.edge=e.mapEdgeBasic,t.waiting=!1,t.spawnWaiting={},t.waitingMove=!1,t.moveWaiting={};const i=()=>{e.collision=!0};i();const o=()=>{if(t.collide={},e.collisionMap[0]=[],e.collisionMap[1]=[],t.topHeight>0)for(let i=0;i<t.topHeight;i++)a(e.collisionMap[0],i);if(t.bottomHeight>0)for(let i=0;i<t.bottomHeight;i++)a(e.collisionMap[1],i)},a=(e,i)=>{let o=[[],[],[],[]];o[0]=[],o[0]=Array(t.size/2).fill(0,0);for(let e in o[0])o[0][e]=Array(t.size/2).fill(0,0);o[1]=[],o[1]=Array(t.size/2).fill(0,0);for(let e in o[1])o[1][e]=Array(t.size/2).fill(0,0);o[2]=[],o[2]=Array(t.size/2).fill(0,0);for(let e in o[2])o[2][e]=Array(t.size/2).fill(0,0);o[3]=[],o[3]=Array(t.size/2).fill(0,0);for(let e in o[3])o[3][e]=Array(t.size/2).fill(0,0);e.push(o)},n=e=>{for(let i in t.collide)if(i===e.name);else for(let o in t.collide[i])if(t.collide[i][o].pos.x===e.pos.x&&t.collide[i][o].pos.y===e.pos.y&&t.collide[i][o].pos.z===e.pos.z)return!1;return!0},s=(t,i)=>{let o,a=2*t.x,n=t.y,s=2*t.z;o=n>=0?0:1,a<0&&s<0?e.collisionMap[o][n][0][-1*s][-1*a]=i:t.x>=0&&s<0?e.collisionMap[o][n][1][-1*s][a]=i:a<0&&s>=0?e.collisionMap[o][n][2][s][-1*a]=i:a>=0&&s>=0?e.collisionMap[o][n][3][s][a]=i:console.log("Update out of bounds")},r=t=>{let i=e.player.GetPlayerInfo().grid;return!(t.start.x<=i.x&&t.end.x>=i.x&&t.start.y<=i.y&&t.end.y>=i.y&&t.start.z<=i.z&&t.end.z>=i.z||!e.player.layer.bodyCrouch&&t.start.x<=i.x&&t.end.x>=i.x&&t.start.y<=i.y+1&&t.end.y>=i.y+1&&t.start.z<=i.z&&t.end.z>=i.z)},l=t=>{let i,o={};if(o.x=2*t.x,o.y=t.y||0,o.z=2*t.z,Math.abs(o.y)-Math.floor(Math.abs(o.y))>0&&(o.y=Math.floor(o.y)),i=o.y>=0?0:1,o.y>=0){if(e.collisionMap[i].length<=o.y)return console.log("height out of bounds"),!e.mapEdge}else if(e.collisionMap[i].length>=-1*o.y)return console.log("height out of bounds"),!e.mapEdge;return o.x<0&&o.z<0?e.collisionMap[i][o.y][0].length>-1*o.z&&e.collisionMap[i][o.y][0][-1*o.z].length>-1*o.x?0===e.collisionMap[i][o.y][0][-1*o.z][-1*o.x]:!e.mapEdge:o.x>=0&&o.z<0?e.collisionMap[i][o.y][1].length>-1*o.z&&e.collisionMap[i][o.y][1][-1*o.z].length>o.x?0===e.collisionMap[i][o.y][1][-1*o.z][o.x]:!e.mapEdge:o.x<0&&o.z>=0?e.collisionMap[i][o.y][2].length>o.z&&e.collisionMap[i][o.y][2][o.z].length>-1*o.x?0===e.collisionMap[i][o.y][2][o.z][-1*o.x]:!e.mapEdge:o.x>=0&&o.z>=0&&(e.collisionMap[i][o.y][3].length>o.z&&e.collisionMap[i][o.y][3][o.z].length>o.x?0===e.collisionMap[i][o.y][3][o.z][o.x]:!e.mapEdge)},c=()=>{if(t.triggers={},e.triggerMap[0]=[],e.triggerMap[1]=[],t.topHeight>0)for(let i=0;i<t.topHeight;i++)a(e.triggerMap[0],i);if(t.bottomHeight>0)for(let i=0;i<t.bottomHeight;i++)a(e.triggerMap[1],i)},h=e=>{t.trigger[e.name]||(t.trigger[e.name]={}),t.trigger[e.name]["space"+e.spaces]={},t.trigger[e.name]["space"+e.spaces].pos=e.pos},d=e=>{delete t.trigger[e]},p=e=>{for(let i in t.trigger)if(i===e.name);else for(let o in t.trigger[i]){if("active"===o)return!1;if(t.trigger[i][o].pos.x===e.pos.x&&t.trigger[i][o].pos.y===e.pos.y&&t.trigger[i][o].pos.z===e.pos.z)return!1}return!0},u=(t,i)=>{let o,a=2*t.x,n=t.y,s=2*t.z;o=t.y>=0?0:1,a<0&&s<0?e.triggerMap[o][n][0][-1*s][-1*a]=i:t.x>=0&&s<0?e.triggerMap[o][n][1][-1*s][a]=i:a<0&&s>=0?e.triggerMap[o][n][2][s][-1*a]=i:a>=0&&s>=0?e.triggerMap[o][n][3][s][a]=i:console.log("Update out of bounds")},m=(i,o)=>{e[i.name]?o?t.trigger[i.name].active||(e[i.name].EmitEvent?e[i.name].EmitEvent("triggerEnter"):e[i.name].EmitEventParent&&e[i.name].EmitEventParent("triggerEnter"),t.trigger[i.name].active=!0):t.trigger[i.name].active&&(e[i.name].EmitEvent?e[i.name].EmitEvent("triggerExit"):e[i.name].EmitEventParent&&e[i.name].EmitEventParent("triggerExit"),t.trigger[i.name].active=!1):(console.log(i.name),console.log("Trigger is not an AUXL object"))};return{grid:t,BuildMap:(e,i)=>{t.size=e,t.topHeight=i.top||2,t.bottomHeight=i.bottom||0,o(),c()},BlankMap:o,UpdateMap:s,UpdateMapArea:(e,i,o,a)=>{let r,l,c,h,d,p,u,m={x:i.x,y:i.y,z:i.z},y=0;u=a?1:0,i.y===o.y?c=1:(c=Math.abs(i.y)+Math.abs(o.y),c+=1),m.y=i.y,h=c;for(let a=0;a<c;a++){i.z===o.z?d=1:(d=i.z-o.z,d*=2,d<0&&(d*=-1),d+=1),m.z=i.z,p=d;for(let a=0;a<d;a++){i.x===o.x?r=1:(r=i.x-o.x,r*=2,r<0&&(r*=-1),r+=1),m.x=i.x,l=r;for(let i=0;i<r;i++)0===u?(n({name:e,pos:{x:m.x,y:m.y,z:m.z}})&&s(m,u),y++):1===u&&(s(m,u),y++,g={name:e,spaces:y,pos:{x:m.x,y:m.y,z:m.z}},t.collide[g.name]||(t.collide[g.name]={}),t.collide[g.name]["space"+g.spaces]={},t.collide[g.name]["space"+g.spaces].pos=g.pos),l--,l>0&&(m.x+=.5);p--,p>0&&(m.z+=.5)}h--,h>0&&(m.y+=1)}var g;0===u&&(e=>{delete t.collide[e]})(e)},EnableCollision:i,DisableCollision:()=>{e.collision=!1},CheckMapObstacles:l,CheckMapObstaclesDiagonal:(t,i)=>{let o,a={};a.x=i.x,a.y=i.y,a.z=i.z,a.x*=2,a.z*=2,o=a.y>=0?0:1;let n,s,r,l={};if(l.x=t.x,l.y=t.y,l.z=t.z,l.x*=2,l.z*=2,n=l.y>=0?0:1,l.x===a.x&&l.z===a.z?s="same":l.x===a.x||l.z===a.z?l.x===a.x?s="z":l.z===a.z&&(s="x"):s=l.x>a.x?l.z>a.z?"reverseRight":"forwardRight":l.z>a.z?"reverseLeft":"forwardLeft",r=l.y===a.y?"same":l.y>a.y?"up":"down",l.y>=0){if(e.collisionMap[o].length<=l.y)return console.log("height out of bounds"),!e.mapEdge}else if(e.collisionMap[o].length>=-1*l.y)return console.log("height out of bounds"),!e.mapEdge;function c(t,i,o,a,n){if(void 0===e.collisionMap[t][a])0===t?a<0&&("undefined"===e.collisionMap[1]||c(1,i,o,-1*a,n)):1===t&&a<0&&("undefined"===e.collisionMap[0]||c(0,i,o,-1*a,n));else if(void 0===e.collisionMap[t][a][i][n])0===i?n<0&&c(t,2,o,a,-1*n):1===i?n<0&&c(t,3,o,a,-1*n):2===i?n<0&&c(t,0,o,a,-1*n):3===i&&n<0&&c(t,1,o,a,-1*n);else{if(void 0!==e.collisionMap[t][a][i][n][o])return e.collisionMap[t][a][i][n][o];0===i?o<0&&c(t,1,-1*o,a,n):1===i?o<0&&c(t,0,-1*o,a,n):2===i?o<0&&c(t,3,-1*o,a,n):3===i&&o<0&&c(t,2,-1*o,a,n)}}return l.x<0&&l.z<0?e.collisionMap[n][l.y][0].length>-1*l.z&&e.collisionMap[n][l.y][0][-1*l.z].length>-1*l.x?0===c(n,0,-1*l.x,l.y,-1*l.z)&&("forwardRight"===s?0===c(n,0,-1*l.x,l.y,-1*l.z+1)||0===c(n,0,-1*l.x-1,l.y,-1*l.z):"forwardLeft"===s?0===c(n,0,-1*l.x,l.y,-1*l.z+1)||0===c(n,0,-1*l.x+1,l.y,-1*l.z):"reverseRight"===s?0===c(n,0,-1*l.x,l.y,-1*l.z-1)||0===c(n,0,-1*l.x-1,l.y,-1*l.z):"reverseLeft"!==s||0===c(n,0,-1*l.x,l.y,-1*l.z-1)||0===c(n,0,-1*l.x+1,l.y,-1*l.z)):!e.mapEdge:l.x>=0&&l.z<0?e.collisionMap[n][l.y][1].length>-1*l.z&&e.collisionMap[n][l.y][1][-1*l.z].length>l.x?0===c(n,1,l.x,l.y,-1*l.z)&&("forwardRight"===s?0===c(n,1,l.x,l.y,-1*l.z+1)||0===c(n,1,l.x-1,l.y,-1*l.z):"forwardLeft"===s?0===c(n,1,l.x,l.y,-1*l.z+1)||0===c(n,1,l.x+1,l.y,-1*l.z):"reverseRight"===s?0===c(n,1,l.x,l.y,-1*l.z-1)||0===c(n,1,l.x-1,l.y,-1*l.z):"reverseLeft"!==s||0===c(n,1,l.x,l.y,-1*l.z-1)||0===c(n,1,l.x+1,l.y,-1*l.z)):!e.mapEdge:l.x<0&&l.z>=0?e.collisionMap[n][l.y][2].length>l.z&&e.collisionMap[n][l.y][2][l.z].length>-1*l.x?0===c(n,2,-1*l.x,l.y,l.z)&&("forwardRight"===s?0===c(n,2,-1*l.x,l.y,l.z+1)||0===c(n,2,-1*l.x-1,l.y,l.z):"forwardLeft"===s?0===c(n,2,-1*l.x,l.y,l.z+1)||0===c(n,2,-1*l.x+1,l.y,l.z):"reverseRight"===s?0===c(n,2,-1*l.x,l.y,l.z-1)||0===c(n,2,-1*l.x-1,l.y,l.z):"reverseLeft"!==s||0===c(n,2,-1*l.x,l.y,l.z-1)||0===c(n,2,-1*l.x+1,l.y,l.z)):!e.mapEdge:l.x>=0&&l.z>=0&&(e.collisionMap[n][l.y][3].length>l.z&&e.collisionMap[n][l.y][3][l.z].length>l.x?0===c(n,3,l.x,l.y,l.z)&&("forwardRight"===s?0===c(n,3,l.x,l.y,l.z+1)||0===c(n,3,l.x-1,l.y,l.z):"forwardLeft"===s?0===c(n,3,l.x,l.y,l.z+1)||0===c(n,3,l.x+1,l.y,l.z):"reverseRight"===s?0===c(n,3,l.x,l.y,l.z-1)||0===c(n,3,l.x-1,l.y,l.z):"reverseLeft"!==s||0===c(n,3,l.x,l.y,l.z-1)||0===c(n,3,l.x+1,l.y,l.z)):!e.mapEdge)},CheckMapObstaclesArea:(e,t)=>{let i,o,a,n,s={x:e.x,z:e.z};if(e.z===t.z?a=1:(a=e.z-t.z,a*=2,a<0&&(a*=-1),a+=1),s.z=e.z,n=a,!r({start:e,end:t}))return console.log("Hit Player"),!1;for(let r=0;r<a;r++){e.x===t.x?i=1:(i=e.x-t.x,i*=2,i<0&&(i*=-1),i+=1),s.x=e.x,o=i;for(let e=0;e<i;e++){if(!l(s))return console.log("Hit Object"),console.log(s),!1;o--,o>0&&(s.x+=.5)}n--,n>0&&(s.z+=.5)}return!0},CheckMapAreaSansArea:(e,t,i)=>{let o,a,n,s,c,h,d=((e,t,i)=>{let o,a,n,s,r,l,c={x:e.x,y:e.y,z:e.z},h=[],d=Math.abs(e.y)+Math.abs(t.y)+i;for(let e=0;e<d+1;e++)h.push(new Array);e.y===t.y?n=1:(n=Math.abs(e.y)+Math.abs(t.y),n+=1),c.y=e.y,s=n;for(let i=0;i<n;i++){e.z===t.z?r=1:(r=e.z-t.z,r*=2,r<0&&(r*=-1),r+=1),c.z=e.z,l=r;for(let i=0;i<r;i++){e.x===t.x?o=1:(o=e.x-t.x,o*=2,o<0&&(o*=-1),o+=1),c.x=e.x,a=o;for(let e=0;e<o;e++)h[c.y].push({x:c.x,z:c.z}),a--,a>0&&(c.x+=.5);l--,l>0&&(c.z+=.5)}s--,s>0&&(c.y+=1)}return h})(e.start,e.end,i),p=!1,u={x:t.start.x,y:t.start.y,z:t.start.z};if(!r(t))return!1;t.start.y===t.end.y?n=1:(n=Math.abs(t.start.y)+Math.abs(t.end.y),n+=1),u.y=t.start.y,s=n;for(let e=0;e<n;e++){t.start.z===t.end.z?c=1:(c=t.start.z-t.end.z,c*=2,c<0&&(c*=-1),c+=1),u.z=t.start.z,h=c;for(let e=0;e<c;e++){t.start.x===t.end.x?o=1:(o=t.start.x-t.end.x,o*=2,o<0&&(o*=-1),o+=1),u.x=t.start.x,a=o;for(let e=0;e<o;e++){for(let e in d[u.y])if(u.x===d[u.y][e].x&&u.z===d[u.y][e].z){p=!0;break}if(p);else if(!l(u))return!1;p=!1,a--,a>0&&(u.x+=.5)}h--,h>0&&(u.z+=.5)}s--,s>0&&(u.y+=1)}return!0},SpawnEdges:i=>{var o;i&&(o=i,t.edge.core.material=o);let a=t.size/4+1,n=t.size/2+2.5;t.edges.northEdge=e.coreFromTemplate(t.edge,{id:"northEdge",geometry:{primitive:"box",depth:.5,width:n,height:.5},position:new THREE.Vector3(0,.25,-1*a)},!0),t.edges.northEdge.SpawnCore(),t.edges.southEdge=e.coreFromTemplate(t.edge,{id:"southEdge",geometry:{primitive:"box",depth:.5,width:n,height:.5},position:new THREE.Vector3(0,.25,a)},!0),t.edges.southEdge.SpawnCore(),t.edges.westEdge=e.coreFromTemplate(t.edge,{id:"westEdge",geometry:{primitive:"box",depth:n,width:.5,height:.5},position:new THREE.Vector3(-1*a,.25,0)},!0),t.edges.westEdge.SpawnCore(),t.edges.eastEdge=e.coreFromTemplate(t.edge,{id:"eastEdge",geometry:{primitive:"box",depth:n,width:.5,height:.5},position:new THREE.Vector3(a,.25,0)},!0),t.edges.eastEdge.SpawnCore(),t.edgeSpawned=!0},DespawnEdges:e=>{t.edges.northEdge.DespawnCore(),delete t.edges.northEdge,t.edges.southEdge.DespawnCore(),delete t.edges.southEdge,t.edges.westEdge.DespawnCore(),delete t.edges.westEdge,t.edges.eastEdge.DespawnCore(),delete t.edges.eastEdge,t.edgeSpawned=!1},UpdateEdge:e=>{t.edge=e},BlankMapTrigger:c,OnMapTrigger:h,OffMapTrigger:d,CheckMapOverlapTrigger:p,UpdateMapAreaTrigger:(e,t,i,o)=>{let a,n,s,r,l,c,m,y={x:t.x,y:t.y,z:t.z},g=0;m=o?1:0,t.y===i.y?s=1:(s=Math.abs(t.y)+Math.abs(i.y),s+=1),y.y=t.y,r=s;for(let o=0;o<s;o++){t.z===i.z?l=1:(l=t.z-i.z,l*=2,l<0&&(l*=-1),l+=1),y.z=t.z,c=l;for(let o=0;o<l;o++){t.x===i.x?a=1:(a=t.x-i.x,a*=2,a<0&&(a*=-1),a+=1),y.x=t.x,n=a;for(let t=0;t<a;t++)0===m?(p({name:e,pos:{x:y.x,y:y.y,z:y.z}})&&u(y,m),g++):1===m&&(u(y,m),g++,h({name:e,spaces:g,pos:{x:y.x,y:y.y,z:y.z}})),n--,n>0&&(y.x+=.5);c--,c>0&&(y.z+=.5)}r--,r>0&&(y.y+=1)}0===m&&d(e)},UpdateMapTrigger:u,CheckMapTriggers:t=>{let i,o={};if(o.x=2*t.x,o.y=t.y,o.z=2*t.z,i=o.y>=0?0:1,o.x<0&&o.z<0){if(e.triggerMap[i][o.y][0].length>-1*o.z&&e.triggerMap[i][o.y][0][-1*o.z].length>-1*o.x)return 1===e.triggerMap[i][o.y][0][-1*o.z][-1*o.x]}else if(o.x>=0&&o.z<0){if(e.triggerMap[i][o.y][1].length>-1*o.z&&e.triggerMap[i][o.y][1][-1*o.z].length>o.x)return 1===e.triggerMap[i][o.y][1][-1*o.z][o.x]}else if(o.x<0&&o.z>=0){if(e.triggerMap[i][o.y][2].length>o.z&&e.triggerMap[i][o.y][2][o.z].length>-1*o.x)return 1===e.triggerMap[i][o.y][2][o.z][-1*o.x]}else{if(!(o.x>=0&&o.z>=0))return!1;if(e.triggerMap[i][o.y][3].length>o.z&&e.triggerMap[i][o.y][3][o.z].length>o.x)return 1===e.triggerMap[i][o.y][3][o.z][o.x]}},TriggerEnterHit:e=>{let i=[];for(let o in t.trigger)for(let a in t.trigger[o])"active"===a||t.trigger[o][a].pos.x===e.x&&t.trigger[o][a].pos.z===e.z&&i.push({name:o,pos:t.trigger[o][a]});if(i.length>0){t.triggersActive=!0;for(let e in i)m(i[e],!0)}},CheckActiveTriggers:e=>{if(t.triggersActive){let i=!1,o=!1;for(let i in t.trigger)if(o=!1,t.trigger[i].active){for(let a in t.trigger[i])t.trigger[i][a].pos&&t.trigger[i][a].pos.x===e.x&&t.trigger[i][a].pos.z===e.z&&(o=!0);o||m({name:i},!1)}i&&(t.triggersActive=!1)}},ClearTriggers:()=>{for(let e in t.trigger)for(let i in t.trigger[e])"active"===i&&(t.trigger[e][i]=!1);t.triggersActive=!1},WaitToSpawn:e=>{t.waiting||(t.waiting=!0),t.spawnWaiting[e.name]=e},WaitingToSpawn:()=>{if(t.waiting)for(let o in t.spawnWaiting)e[o][t.spawnWaiting[o].func](),e[o].inScene&&(i=o,delete t.spawnWaiting[i],0===Object.keys(t.spawnWaiting).length&&(t.waiting=!1));var i},ClearWaiting:()=>{t.waiting=!1,t.spawnWaiting={}},MoveToGrid:(t,i)=>{console.log(t),console.log(i),console.log(e[i.id])},PathOnGrid:e=>{}}},p=(e,t,i,o)=>{let a={};a.objGen=t,a.worldBody=!1,a.core=!1,a.layer=!1,a.bodyEl=!1,a.rayEl=!1,a.spawnControl=!0,t.core?a.core=t:t.layer&&(a.core=t.layer.all.parent.core,a.layer=t),a.num=Math.random().toFixed(8),a.name=a.core.core.id+"Phys"||0,a.id=a.name+a.num,a.loaded=!1,a.type="static",a.shape="box",a.mass=0,a.friction=0,a.restitution=0,a.connectTo=0,a.linearDamping=.2,a.angularDamping=.2,a.length=0,a.damping=0,a.stiffness=0,a.worldAxis=new THREE.Vector3(0,-1,0),a.worldGravityStyle="earth",a.worldGravity=new THREE.Vector3(0,0,0),a.body={type:a.type,mass:a.mass,shape:"none"},a.fixedRotation=i.fixedRotation||!1,a.shapes={},a.shapes.cylinder={shape:"cylinder",height:1,radiusTop:1,radiusBottom:1,offset:"0 0 0"},a.shapes.box={shape:"box",height:1,width:1,depth:1,offset:"0 1 0"},a.shapes.sphere={shape:"sphere",radius:1,width:1,depth:1,offset:"0 0 0"},a.mainShape=i.shapeData||a.shapes.box,a.avatar=[a.mainShape],a.avatarRemove=[],a.bodymaterial={friction:a.friction,restitution:a.restitution},a.connections=[];const n=()=>{a.fixedRotation&&!a.bodyEl.body.fixedRotation?(a.bodyEl.body.fixedRotation=!0,a.bodyEl.body.updateMassProperties()):!a.fixedRotation&&a.bodyEl.body.fixedRotation&&(a.bodyEl.body.fixedRotation=!1,a.bodyEl.body.updateMassProperties())};const s=()=>{a.core.ChangeSelf({property:"shape",value:a.mainShape}),a.core.ChangeSelf([{property:"body",value:a.body},{property:"bodymaterial",value:a.bodymaterial}]),n()},r=e=>{if(e)for(let t in e)a[t]=e[t];if(a.core.core.components||(a.core.core.components={}),a.avatarRemove.length>0)for(let e in a.avatarRemove)delete a.core.core.components["shapes__"+e];for(let e in a.avatar)a.core.core.components["shapes__"+e]=a.avatar[e];if(a.core.core.components.body={property:"body",value:a.body},a.core.core.components.bodymaterial={property:"bodymaterial",value:a.bodymaterial},a.loaded){if(a.avatarRemove.length>0){for(let e in a.avatarRemove)a.core.RemoveComponent("shapes__"+e);a.avatarRemove=[]}s()}};r(i),a.constraint={};let l={playerPhysics:!1};l.worldGravity=new THREE.Vector3(0,-9.8,0),l.localAxis=new THREE.Vector3(0,0,0),l.worldAxis=new THREE.Vector3(0,-1,0),l.gravity=new THREE.Vector3(0,0,0),l.axis=new THREE.Vector3(0,-1,0),l.gravity.copy(l.worldGravity),l.physMove=!0,l.jumping=!1,l.jumpTimeout,l.gravityStyle="earth",l.velocityStyle="slam",l.currentVelocity=30,l.tracking=!1,l.track2DInterval;const c=t=>{l.distance=40,e.linkHoverMenuData={info:{id:"linkHoverMenu",buttonData:e.menuCylinderData,hoverData:e.menuHoverData,title:"Link Hover Menu",description:"A link hover menu for quick access.",layout:"circleUp",offset:-1,attached:!1,parent:"playerBody",posOffset:new THREE.Vector3(0,1.5,-2)},menu:{button0:{id:"action1",style:!1,title:"Rubber",description:"Launch yourself at link.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"LinkControls",params:"rubber",menu:"close"}},button1:{id:"action2",style:!1,title:"Power",description:"Swing from a far current distance",subMenu:!1,action:{auxlObj:"player",component:!1,method:"LinkControls",params:"power",menu:"close"}},button4:{id:"action5",style:!1,title:"Swing",description:"Swing from current distance",subMenu:!1,action:{auxlObj:"player",component:!1,method:"LinkControls",params:"swing",menu:"close"}}}},e.linkHoverMenu=e.HoverMenu(e.linkHoverMenuData),l.linkLength=1;let i={data:"linkData",id:"linkCore",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.5},material:{shader:"standard",color:"#ebd107",emissive:"#ebd107",emissiveIntensity:.25,opacity:.75},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{body:{type:"static",shape:"none",mass:0},bodymaterial:{friction:0,restitution:0}}};l.linkCore=e.Core(e.coreDataFromTemplate(i,!1,!0)),l.linkConfig={type:"auxspring",to:"playerRig",minOneLength:0,maxOneLength:30,restLength:1,damping:.5,stiffness:10},l.linkCoreConstraint=e.Constraints(l.linkCore,l.linkConfig,!1),l.linkCoreType="rubber";let o={data:"anchorData",id:"anchorCore",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.5},material:{shader:"standard",color:"#eb07bf",emissive:"#eb07bf",emissiveIntensity:.25,opacity:.5},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1};l.anchorCore=e.Core(o),l.linkInterval};c(),console.log("Link ran"),l.boostPower=100;return{one:a,SpawnOne:()=>{a.spawnControl&&(a.layer?a.layer.SpawnLayer():a.core.SpawnCore());let e=setTimeout((()=>{a.loaded=!0,a.bodyEl=a.core.GetEl(),a.worldBody=a.bodyEl.body,o?o.core?a.rayEl=o.GetEl():o.layer&&(a.rayEl=o.GetParentEl()):a.rayEl=a.bodyEl,n(),s(),clearTimeout(e)}),50)},DespawnOne:()=>{a.spawnControl?a.layer?a.layer.DespawnLayer():a.core.DespawnCore():(()=>{if(a.avatarRemove.length>0){for(let e in a.avatarRemove)a.core.RemoveComponent("shapes__"+e);a.avatarRemove=[]}a.core.RemoveComponent(a.avatar),a.core.RemoveComponent(["body","bodymaterial"])})(),a.worldBody=!1,a.loaded=!1},UpdatePhys:r,Link:c,Unlink:()=>{a.core.RemoveComponent("auxspring__"+a.id)},UnlinkAll:()=>{for(let e of a.constraint)a.constraint[e].Disconnect(a);a.constraint={}},Track2D:()=>{let t=l.raycaster.intersection||new THREE.Vector3(0,0,0);if(t.equals(new THREE.Vector3(0,0,0)))return;let i=new THREE.Vector3(0,0,0);l.worldAxis=new THREE.Vector3(0,-1,0),l.tracking=!0,l.track2DInterval=setInterval((()=>{l.tracking&&(i.copy(e.mouseController.GetEl().components.raycaster.intersections[0].point),t.equals(i)||(t.x.toFixed(2)===i.x.toFixed(2)?t.x>0?l.worldAxis=new THREE.Vector3(1,0,0):l.worldAxis=new THREE.Vector3(-1,0,0):t.y.toFixed(2)===i.y.toFixed(2)&&(t.y>0?l.worldAxis=new THREE.Vector3(0,-1,0):l.worldAxis=new THREE.Vector3(0,1,0)),t.z.toFixed(2)===i.z.toFixed(2)&&(t.z>0?l.worldAxis=new THREE.Vector3(0,0,1):l.worldAxis=new THREE.Vector3(0,0,-1)),l.localAxis.copy(l.worldAxis),l.worldAxis.equals(new THREE.Vector3(0,0,0))?console.log({GravitationalAxisFloat:l.worldAxis}):console.log({GravitationalAxisNew:l.worldAxis}),l.tracking=!1,clearInterval(l.track2DInterval)))}),1)},Freeze:()=>{a.bodyEl.body.sleep()},UnFreeze:()=>{a.bodyEl.body.wakeUp()},ToggleAction:e=>{l.toggle0=!1,l.toggle1=!1,l.toggle2=!1,l.toggle3=!1,l.toggle4=!1,l.toggle5=!1,"0"===e?l.toggle0=!0:"1"===e?l.toggle1=!0:"2"===e?l.toggle2=!0:"3"===e?l.toggle3=!0:"4"===e?l.toggle4=!0:"5"===e?l.toggle5=!0:l.linkCore.core.inScene&&(console.log("Delink"),l.linkCore.DespawnCore())}}};AFRAME.registerSystem("auxl",{schema:{id:{type:"string",default:"#FFFFFF"},color:{type:"string",default:"#FFFFFF"},shortname:{type:"string",default:"#FFFFFF"},longname:{type:"string",default:"#FFFFFF"},server:{type:"string",default:"localhost"},onlineKey:{type:"string",default:"FFFFFF"}},init:function(){const i=this;this.auxl=i,this.expStarted=!1,this.defaultWorld,this.currentWorld,this.currentZone,this.worldLoaded=!1,this.local={},this.local.profile={},this.rebuildObjects=[],this.libraries=[],this.worlds=[],this.volume=1,this.backgroundAudio=!1,this.checkSceneLoadThrottled=AFRAME.utils.throttle(this.checkSceneLoad,30,this),this.sceneReading=!1,this.loadingScene=!1,this.loadingObjects=new Map,this.maxLoadTime=5e3,this.jsLoaded={},this.jsAll={"look-at":"https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js","gltf-morph":"https://rawcdn.githack.com/elbobo/aframe-gltf-morph-component/07e9b80bd382cc1c19223468d35c453e7c76e9a2/dist/aframe-gltf-morph-component.js"};const u=document.querySelector("a-scene");i.sceneEl=u,document.querySelector("head");const m=document.querySelector("body"),y=document.getElementById("stickyMenu"),g=document.getElementById("stickyTitle"),v=document.getElementById("systemText"),b=document.getElementById("beginDiv"),f=document.getElementById("startButton"),E=document.getElementById("menuModeButton"),w=document.getElementById("audioButton"),x=document.getElementById("audioVolume"),T=document.getElementById("volDownButton"),R=document.getElementById("volume"),k=document.getElementById("volUpButton"),D=document.getElementById("viewInfo"),C=document.getElementById("viewData"),M=document.getElementById("expInfo"),S=document.getElementById("infoClose"),P=document.getElementById("instructions"),L=document.getElementById("dataInfo"),H=document.getElementById("dataClose"),A=document.getElementById("manageData"),z=document.getElementById("resetData"),I=document.getElementById("scenarioHeaderTitle"),O=document.getElementById("scenarioMenuTitle"),N=document.getElementById("controllerBlock"),F=document.getElementById("vrHandButton"),V=document.getElementById("vrLocomotionType"),j=document.getElementById("upLeft"),B=document.getElementById("up"),G=document.getElementById("upRight"),U=document.getElementById("left"),q=document.getElementById("center"),W=document.getElementById("right"),_=document.getElementById("downLeft"),J=document.getElementById("down"),K=document.getElementById("downRight"),Z=document.getElementById("select"),X=document.getElementById("start"),Q=document.getElementById("a"),Y=document.getElementById("b"),$=document.getElementById("c"),ee=document.getElementById("d"),te=document.getElementById("e"),ie=document.getElementById("f"),oe=document.getElementById("l"),ae=document.getElementById("r");let ne=[m,b,f,E,w,D,C,M,S,P,O,L,H,A,z,N,F,V],se=[y,g,I,N,j,B,G,U,q,W,_,J,K,Z,X,Q,Y,$,ee,te,ie,oe,ae];this.systemLoaded=e=>{ye(e),i.player.infoText="Player : "+i.local.profile.shortname+"\n",re(),le()};const re=()=>{i.map=i.Collision(),console.log({timeSince:this.local.profile.time.span,loadedProfile:i.local})},le=()=>{ce(),he(),de(this.local.profile.systemText)},ce=()=>{for(let e in ne)ne[e].style.setProperty("background-color",this.local.profile.colorScheme.base),ne[e].style.setProperty("color-text",this.local.profile.colorScheme.compl);for(let e in se)se[e].style.setProperty("background-color","transparent"),se[e].style.setProperty("color-text",this.local.profile.colorScheme.compl),se[e].style.setProperty("border-color",this.local.profile.colorScheme.compl);i.cameraUI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.cameraUI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.playerFloor.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.playerFloor.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.vrController1UI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.vrController1UI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.vrController2UI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.vrController2UI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}})},he=()=>{v.innerHTML=this.systemText,i.player.UpdateBeltText(this.systemText),i.cameraUI.ChangeSelf({property:"text",value:{value:this.systemText}}),i.vrController1UI.ChangeSelf({property:"text",value:{value:this.systemText}}),i.vrController2UI.ChangeSelf({property:"text",value:{value:this.systemText}})},de=e=>{this.systemText=e,he()};this.Loaded=e=>{i.libraries.push(e)},this.WorldsLoaded=e=>{i.worlds.push(e)},this.toBeRebuilt=e=>{i.rebuildObjects.push(e),i.Loaded(e)},this.SceneLoadTimeout=()=>{i.sceneLoadTimeout=setTimeout((()=>{i.loadingObjects=new Map,clearTimeout(i.sceneLoadTimeout)}),i.maxLoadTime)},this.save="auxl"+window.location.pathname;const pe=()=>{this.local={},this.local.profile={},this.local.profile.domain=window.location.hostname,this.local.profile.page=window.location.pathname,this.local.profile.controls=this.controls,this.local.profile.vrHand=this.vrHand,this.local.profile.volume=this.volume,this.local.profile.time={},this.local.profile.time.creation=i.Time(),this.local.profile.time.lastVisit=i.Time(),this.local.profile.colorScheme=i.colorTheoryGen(),this.local.profile.id=this.local.profile.colorScheme.base,this.local.profile.color=this.local.profile.colorScheme.base,this.local.profile.shortname=this.local.profile.colorScheme.base,this.local.profile.longname=this.data.longname,this.local.profile.server=this.data.server,this.local.profile.onlineKey=this.data.onlineKey,this.local.profile.systemText="Welcome "+this.local.profile.shortname,this.systemText=this.local.profile.systemText,this.local.location={},this.local.location.load=!1,this.local.location.world="",this.local.location.scenario="",this.local.location.zone="",this.local.location.scene=""},ue=()=>{console.log("New here. Loading default data."),window.localStorage.clear(),pe(),(()=>{clearTimeout(i.sceneLoadTimeout),i.comp.ClearInventoryNotifications(),i.player.Reset();for(let e in i.rebuildObjects)i[i.rebuildObjects[e]]()})(),window.localStorage.setItem(this.save,JSON.stringify(i.local)),le(),we(this.local.profile.vrHand),Ee(this.local.profile.controls),xe()},me=()=>{console.log("Welcome Back! ^-^"),this.local=JSON.parse(window.localStorage.getItem(this.save)),le(),this.local.profile.time.return=this.Time(),this.local.profile.time.span=this.TimeDif(this.local.profile.time.lastVisit,this.local.profile.time.return),this.local.profile.time.lastVisit=this.local.profile.time.return,""===this.local.location.world||""===this.local.location.scenario||""===this.local.location.zone||""===this.local.location.scene?this.local.location.load=!1:this.local.location.load=!0,i.saveToProfile(),ge(),we(this.local.profile.vrHand),Ee(this.local.profile.controls),xe(),this.volume=this.local.profile.volume},ye=e=>{e?ue():localStorage.getItem(this.save)?me():ue()};this.saveToProfile=e=>{e&&(i.local[e.auxlObject]?e.sub?(i.local[e.auxlObject][e.type][e.sub]||(i.local[e.auxlObject][e.type][e.sub]={}),i.local[e.auxlObject][e.type][e.sub][e.name]=e.data):i.local[e.auxlObject][e.type][e.name]=e.data:(i.local[e.auxlObject]={},i.local[e.auxlObject][e.type]={},e.sub?(i.local[e.auxlObject][e.type][e.sub]={},i.local[e.auxlObject][e.type][e.sub][e.name]=e.data):i.local[e.auxlObject][e.type][e.name]=e.data)),window.localStorage.setItem(this.save,JSON.stringify(i.local))};const ge=()=>{for(let e in i.local)if("profile"===e||"location"===e);else for(let t in i.local[e])for(let o in i.local[e][t])i[e]&&(i[e][t][o]=i.local[e][t][o])};function ve(){i.menuOpen?(b.style.display="none",i.menuOpen=!1,i.infoOpen&&Te(),i.backgroundAudio&&!i.playerAudio.core.inScene&&i.playerAudio.SpawnCore(i.playerRig)):(b.style.display="flex",i.menuOpen=!0)}function be(){i.vrController1.GetEl().setAttribute("visible",!1),i.vrController2.GetEl().setAttribute("visible",!1),i.vrController1UI.GetEl().setAttribute("visible",!1),i.vrController2UI.GetEl().setAttribute("visible",!1),i.vrController1.GetEl().removeAttribute("cursor"),i.vrController2.GetEl().removeAttribute("cursor"),i.vrController1.GetEl().removeAttribute("laser-controls"),i.vrController2.GetEl().removeAttribute("laser-controls")}function fe(){"bothRight"===i.vrHand?(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("auxcontroller",{update:Math.random().toFixed(5)}),i.player.EnableVRLocomotion(),i.locomotionText="Left Controller Joystick"):"bothLeft"===i.vrHand?(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),i.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("auxcontroller",{update:Math.random().toFixed(5)}),i.player.EnableVRLocomotion(),i.locomotionText="Right Controller Joystick"):"bothRightLoco"!==i.vrHand&&"bothLeftLoco"!==i.vrHand||(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:"false"}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),i.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("auxcontroller",{update:Math.random().toFixed(5)}),i.player.EnableVRLocomotion(),"bothLeftLoco"===i.vrHand?i.locomotionText="Left Controller Joystick":"bothRightLoco"===i.vrHand&&(i.locomotionText="Right Controller Joystick"))}function Ee(e){"Desktop"===i.controls?(i.mouseController.GetEl().setAttribute("visible",!1),i.mouseController.GetEl().removeAttribute("raycaster"),i.mouseController.GetEl().removeAttribute("cursor")):"Mobile"===i.controls?(i.mouseController.GetEl().setAttribute("visible",!1),i.mouseController.GetEl().removeAttribute("raycaster"),i.mouseController.GetEl().removeAttribute("cursor"),N.style.display="none"):"VR"===i.controls&&(F.style.display="none",V.style.display="none",be()),"Desktop"===e?(E.innerHTML="Mode : Desktop",i.mouseController.GetEl().setAttribute("visible",!0),i.mouseController.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),i.mouseController.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"mouseController",mouseCursorStylesEnabled:"true"}),i.playerRig.GetEl().setAttribute("auxcontroller",{update:Math.random().toFixed(5)}),i.player.EnableDesktopLocomotion(),i.locomotionText="WASD Keys"):"Mobile"===e?(E.innerHTML="Mode : Mobile",i.mouseController.GetEl().setAttribute("visible",!0),i.mouseController.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),i.mouseController.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"mouseController",mouseCursorStylesEnabled:"true"}),N.style.display="flex",i.playerRig.GetEl().setAttribute("auxcontroller",{update:Math.random().toFixed(5)}),i.player.EnableMobileLocomotion(),i.locomotionText="Arrow Buttons"):"VR"===e&&(E.innerHTML="Mode : VR",F.style.display="flex",V.style.display="flex",fe()),i.controls=e,xe()}function we(e){"bothRight"===e?F.innerHTML="2 Hands : Right Ray | Left Move":"bothLeft"===e?F.innerHTML="2 Hands : Left Ray | Right Move":"bothLeftLoco"===e?F.innerHTML="2 Hands : Dual Ray | Left Move":"bothRightLoco"===e&&(F.innerHTML="2 Hands : Dual Ray | Right Move"),i.vrHand=e}function xe(){i.UpdateControlText(),i.local.profile.controls=i.controls,i.local.profile.vrHand=i.vrHand,i.saveToProfile()}function Te(){i.infoOpen?(M.style.display="none",i.infoOpen=!1):(M.style.display="flex",i.infoOpen=!0)}function Re(){i.dataOpen?(L.style.display="none",i.dataOpen=!1):(L.style.display="flex",i.dataOpen=!0)}this.Time=()=>{let e={};return e.time=new Date,e.year=e.time.getFullYear(),e.month=e.time.getMonth(),e.date=e.time.getDate(),e.day=e.time.getDay(),e.hour=e.time.getHours(),e.minute=e.time.getMinutes(),e.second=e.time.getSeconds(),e.ms=e.time.getTime(),e},this.TimeDif=(e,t)=>{let i={},o={};function a(e){let t={};return t.ms=e,t.seconds=Math.floor(t.ms/1e3),t.minutes=Math.floor(t.seconds/60),t.hours=Math.floor(t.minutes/60),t.days=Math.floor(t.hours/24),t.months=Math.floor(t.days/(365/12)),t.years=Math.floor(t.months/12),t}o.total=t.ms-e.ms;let n=t.ms-e.ms;return i=a(n),n-=315576e5*i.years,o.years=i.years,i=a(n),n-=26298e5*i.months,o.months=i.months,i=a(n),n-=864e5*i.days,o.days=i.days,i=a(n),n-=36e5*i.hours,o.hours=i.hours,i=a(n),n-=6e4*i.minutes,o.minutes=i.minutes,i=a(n),n-=1e3*i.seconds,o.seconds=i.seconds,i=a(n),n-=1*i.ms,o.ms=i.ms,i=a(n),o},this.universalControls,this.controls="Desktop",this.vrHand="bothRight",this.directionType="camera",this.locomotionText="WASD Keys",this.joystickLoco=4,this.joystickRot=8,this.controlsInfo={},this.controlsText="",this.menuOpen=!0,this.infoOpen=!1,this.dataOpen=!1,this.audioEnabled=!1,this.mobilePermissionGranted=!1,this.spawned={},this.scenarioSpawned={},this.zoneSpawned={},this.nodeSpawned={},this.bookSpawned={},this.spawnedWaitingForJS={},this.objGenTracking={core:{type:"core",spawn:"SpawnCore",despawn:"DespawnCore",altSpawn:"SpawnCoreOnGrid"},layer:{type:"layer",spawn:"SpawnLayer",despawn:"DespawnLayer",altSpawn:"SpawnLayerOnGrid"},menu:{type:"menu",spawn:"SpawnMenu",despawn:"DespawnMenu"},multiMenu:{type:"multiMenu",spawn:"SpawnMultiMenu",despawn:"DespawnMultiMenu"},singleGen:{type:"singleGen",spawn:"SpawnObjRing",despawn:"DespawnObjRing"},multiGen:{type:"multiGen",spawn:"SpawnMultiAsset",despawn:"DespawnMultiAsset"},comp:{type:"comp",spawn:"SpawnComp",despawn:"DespawnComp"},teleport:{type:"teleport",spawn:"SpawnTeleport",despawn:"DespawnTeleport"},npc:{type:"npc",spawn:"SpawnNPC",despawn:"DespawnNPC"},speechSystem:{type:"speechSystem",spawn:"SpawnSpeech",despawn:"DespawnSpeech"},book:{type:"book",spawn:"SpawnBook",despawn:"DespawnBook"},horizon:{type:"horizon",spawn:"SpawnHorizon",despawn:"DespawnHorizon"},skyBox:{type:"skyBox",spawn:"SpawnSkyBox",despawn:"DespawnSkyBox"},gridLayout:{type:"gridLayout",spawn:"SpawnGridLayout",despawn:"DespawnGridLayout"},gate:{type:"gate",spawn:"SpawnGate",despawn:"DespawnGate"},imageSwapper:{type:"imageSwapper",spawn:"SpawnImgSwap",despawn:"DespawnImgSwap"},imageCarousel:{type:"imageCarousel",spawn:"SpawnImgCarousel",despawn:"DespawnImgCarousel"},comboLock:{type:"comboLock",spawn:"SpawnComboLock",despawn:"DespawnComboLock"}},this.AddObjGenToTracker=(e,t,o,a)=>{i.objGenTracking[e]={},i.objGenTracking[e].type=e,i.objGenTracking[e].spawn=t,i.objGenTracking[e].altSpawn=t,i.objGenTracking[e].despawn=o},this.spawnTracker=(e,t,o)=>{let a,n,s;if(a="scenario"===t?"scenarioSpawned":"zone"===t?"zoneSpawned":"node"===t?"nodeSpawned":"book"===t?"bookSpawned":"nodeSpawned",i[e]){for(let t in i.objGenTracking)if(i[e][i.objGenTracking[t].spawn]||i[e][i.objGenTracking[t].altSpawn]){n=i.objGenTracking[t].type,s=i[e][n].id;break}n||console.log("Tracker type error")}"book"===t?(i[a][o]||(i[a][o]={}),i[a][o][s]={type:n,obj:e}):i[a][s]={type:n,obj:e}},this.clearSpawned=e=>{for(let t in e)i[t]?i[t][i.objGenTracking[e[t].type].despawn]():e[t].parent?e[t].parent[t][i.objGenTracking[e[t].type].despawn]():i[t].obj[i.objGenTracking[e[t].type].despawn](),delete e[t]},this.RemoveFromTracker=(e,t)=>{i.scenarioSpawned[e]?delete i.scenarioSpawned[e]:i.zoneSpawned[e]?delete i.zoneSpawned[e]:i.nodeSpawned[e]?delete i.nodeSpawned[e]:i.bookSpawned[t]&&delete i.bookSpawned[t][e]},this.ExistsInTracker=(e,t)=>{let o=t||!1;return!!i.scenarioSpawned[e]||!!i.zoneSpawned[e]||!!i.nodeSpawned[e]||!!o&&!!i.bookSpawned[o][e]&&void delete i.bookSpawned[o][e]},this.running={},this.zoneRunning={},this.scenarioRunning={},this.timeouts={},this.intervals={},this.interactions={},this.events={},this.timeInDay=36e4,this.TimeInDayUpdate=()=>{},this.worldPhysics=!1,this.EnablePhysics=()=>{console.log("Enabling Physics"),i.physWorld=i.el.systems.physics.driver.world,console.log(i.physWorld)},this.collisionMap=[[],[]],this.triggerMap=[[],[]],this.mapEdge=!1,y.addEventListener("click",ve),f.addEventListener("click",(function(){i.worldLoaded||(""===i.local.location.world?i.defaultWorld.StartWorld():i[i.local.location.world].StartWorld(),f.innerHTML="Resume",xe(),i.worldLoaded=!0),ve()})),this.UpdateControlText=()=>{i.controlsText="Control Configuration : "+i.controls+" mode\n",i.controlsText+="Movement | "+i.locomotionText+"\n";let e="";for(let t in i.controlsInfo)"altDown"===t?"Desktop"===i.controls?e="Mouse Right Click Down":"Mobile"===i.controls?e="Middle Directional Button Down":"VR"===i.controls&&(e="Grip Down"):"altUp"===t?"Desktop"===i.controls?e="Mouse Right Click up":"Mobile"===i.controls?e="Middle Directional Button up":"VR"===i.controls&&(e="Grip up"):"action1Down"===t?"Desktop"===i.controls?e=i.controlConfig.action1Keys[1]+" down":"Mobile"===i.controls?e="A down":"VR"===i.controls&&(e="X down"):"action1Up"===t?"Desktop"===i.controls?e=i.controlConfig.action1Keys[1]+" up":"Mobile"===i.controls?e="A up":"VR"===i.controls&&(e="X up"):"action2Down"===t?"Desktop"===i.controls?e=i.controlConfig.action2Keys[1]+" down":"Mobile"===i.controls?e="B down":"VR"===i.controls&&(e="Y down"):"action2Up"===t?"Desktop"===i.controls?e=i.controlConfig.action2Keys[1]+" up":"Mobile"===i.controls?e="B up":"VR"===i.controls&&(e="Y up"):"action3Down"===t?"Desktop"===i.controls?e=i.controlConfig.action3Keys[1]+" down":"Mobile"===i.controls?e="C down":"VR"===i.controls&&(e="A down"):"action3Up"===t?"Desktop"===i.controls?e=i.controlConfig.action3Keys[1]+" up":"Mobile"===i.controls?e="C up":"VR"===i.controls&&(e="A up"):"action4Down"===t?"Desktop"===i.controls?e=i.controlConfig.action4Keys[1]+" down":"Mobile"===i.controls?e="D down":"VR"===i.controls&&(e="B down"):"action4Up"===t?"Desktop"===i.controls?e=i.controlConfig.action4Keys[1]+" up":"Mobile"===i.controls?e="D up":"VR"===i.controls&&(e="B up"):"action5Down"===t?"Desktop"===i.controls?e=i.controlConfig.action5Keys[1]+" down":"Mobile"===i.controls?e="E down":"VR"===i.controls&&(e="Action Joystick down"):"action5Up"===t?"Desktop"===i.controls?e=i.controlConfig.action5Keys[1]+" up":"Mobile"===i.controls?e="E up":"VR"===i.controls&&(e="Action Joystick reset"):"action6Down"===t?"Desktop"===i.controls?e=i.controlConfig.action6Keys[1]+" down":"Mobile"===i.controls?e="F down":"VR"===i.controls&&(e="Action Joystick up"):"action6Up"===t?"Desktop"===i.controls?e=i.controlConfig.action6Keys[1]+" up":"Mobile"===i.controls?e="F up":"VR"===i.controls&&(e="Action Joystick reset"):"action7Down"===t?"Desktop"===i.controls?e=i.controlConfig.action7Keys[1]+" down":"Mobile"===i.controls?e="<- down":"VR"===i.controls&&(e="Action Joystick left"):"action7Up"===t?"Desktop"===i.controls?e=i.controlConfig.action7Keys[1]+" up":"Mobile"===i.controls?e="<- up":"VR"===i.controls&&(e="Action Joystick reset"):"action8Down"===t?"Desktop"===i.controls?e=i.controlConfig.action8Keys[1]+" down":"Mobile"===i.controls?e="-> down":"VR"===i.controls&&(e="Action Joystick right"):"action8Up"===t?"Desktop"===i.controls?e=i.controlConfig.action8Keys[1]+" up":"Mobile"===i.controls?e="-> up":"VR"===i.controls&&(e="Action Joystick reset"):console.log("Failed to identify action"),"  down"===e?e="Spacebar down":"  up"===e&&(e="Spacebar up"),i.controlsText+="| "+e+" | "+i.controlsInfo[t].name+" : "+i.controlsInfo[t].info+"\n";i.controlsText+="Click to Close Window"},E.addEventListener("click",(function(){"Desktop"===i.controls?Ee("VR"):"VR"===i.controls?Ee("Mobile"):"Mobile"===i.controls&&Ee("Desktop"),xe()})),F.addEventListener("click",(function(){be(),"bothRight"===i.vrHand?we("bothLeft"):"bothLeft"===i.vrHand?we("bothLeftLoco"):"bothLeftLoco"===i.vrHand?we("bothRightLoco"):"bothRightLoco"===i.vrHand&&we("bothRight"),xe(),fe()})),V.addEventListener("click",(function(){"camera"===i.directionType?(i.directionType="controller",V.innerHTML="Direction : Controller"):(i.directionType="camera",V.innerHTML="Direction : Camera"),xe()})),w.addEventListener("click",(function(){i.audioEnabled?(i.audioEnabled=!1,x.style.display="none",w.innerHTML="Sound : Disabled",function(){for(let e in i.playerAudioData.sounds)i.playerAudio.removeComponent("auxsound__"+e)}()):(i.audioEnabled=!0,w.innerHTML="Sound : Enabled",x.style.display="flex",R.innerHTML=i.volume.toFixed(1),function(){let e;for(let t in i.playerAudioData.sounds)e=JSON.parse(JSON.stringify(i.playerAudioData.sounds[t])),e.volume||(e.volume=1),e.volume*=i.volume,i.playerAudio.ChangeSelf({property:"auxsound__"+t,value:i.playerAudioData.sounds[t]})}())})),k.addEventListener("click",(function(){i.volume+=.1,i.volume>2&&(i.volume=2),R.innerHTML=i.volume.toFixed(1),i.local.profile.volume=i.volume,i.saveToProfile(),i.playerAudio.core.inScene&&i.playerAudio.DespawnCore()})),T.addEventListener("click",(function(){i.volume-=.1,i.volume<0&&(i.volume=0),R.innerHTML=i.volume.toFixed(1),i.local.profile.volume=i.volume,i.saveToProfile(),i.playerAudio.core.inScene&&i.playerAudio.DespawnCore()})),this.ToggleBackgroundAudio=e=>{i.backgroundAudio=!i.backgroundAudio,i.backgroundAudio?i.isFalsey(e)?["entranceZone","xrcadeZone"].includes(i.currentZone)?i.currentWorld.MusicPlaylist("town3"):i.currentWorld.MusicPlaylist("spookymusic1"):i.currentWorld.MusicPlaylist(e):i.currentWorld.MusicPlaylist(!1)},D.addEventListener("click",Te),S.addEventListener("click",Te),C.addEventListener("click",Re),H.addEventListener("click",Re),z.addEventListener("click",(function(){i.comp.inScene&&i.comp.DespawnComp();let e=setTimeout((function(){i.worldLoaded&&(i.currentWorld.StopWorld(),f.innerHTML="Restart",i.worldLoaded=!1),i.systemLoaded(!0),Re(),clearTimeout(e)}),750)})),this.ToggleHTML=(e,t)=>{document.getElementById(e).style.display=t?"l"===e||"r"===e?"block":"flex":"none"},this.CloneDom=(e,t)=>{let o=e.CloneNode(t);for(;i.checkDupeName(o.id);)o.id=i.ranNameGen(8,o.id);return o},this.ConvertHTMLScene=()=>({}),this.isFalsey=e=>null==e||!1===e||NaN===e||""===e||"false"===e,this.OpenLink=(e,t)=>{let i=!1;t&&(i="_blank"),open(e,i)},this.findInScene=e=>{let t=e;return t.core?t=!!t.core.inScene&&t.GetEl():t.layer?t=!!t.layer.inScene&&t.GetParentEl():t.id||"string"==typeof t&&(t=!!document.getElementById(t)&&document.getElementById(t)),t},this.attach=(e,t)=>{let o=i.findInScene(e),a=i.findInScene(t);o&&a?a.appendChild(o):console.log("Failed to find Child or Parent")},this.detach=e=>{let t=i.findInScene(e);t?i.sceneEl.appendChild(t):console.log("Failed to find Child")},this.randomOfArray=e=>e[Math.floor(Math.random()*e.length)],this.ShallowOmit=(e,...t)=>{let i={...e};return t.forEach((e=>{const{[e]:t,...o}=i;i={...o}})),i},this.colorTheoryGen=(e,t)=>{let i,o,a,n,s,r,l,c,h=!1;const d=["red","orange","yellow","lime","blue","cyan","magenta","maroon","olive","green","purple","teal","navy","silver","grey","black","white"];function p(e,t,i){let o=(1-Math.abs(2*i-1))*t,a=o*(1-Math.abs(e/60%2-1)),n=i-o/2,s=0,r=0,l=0;return 0<=e&&e<60?(s=o,r=a,l=0):60<=e&&e<120?(s=a,r=o,l=0):120<=e&&e<180?(s=0,r=o,l=a):180<=e&&e<240?(s=0,r=a,l=o):240<=e&&e<300?(s=a,r=0,l=o):300<=e&&e<360&&(s=o,r=0,l=a),s=Math.round(255*(s+n)),r=Math.round(255*(r+n)),l=Math.round(255*(l+n)),{r:s,g:r,b:l}}function u(e,t,i){return e=e.toString(16),t=t.toString(16),i=i.toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i}function m(){return d[Math.floor(Math.random()*(d.length-4))]}if(e&&("#"===e[0]&&4===e.length||"#"===e[0]&&7===e.length||(e=!1)),t){for(let e in d)if(t===d[e]){h=!0;break}h||(t=m())}e?(l=e,c=function(e){let t=0,i=0,o=0;return 4==e.length?(t="0x"+e[1]+e[1],i="0x"+e[2]+e[2],o="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],i="0x"+e[3]+e[4],o="0x"+e[5]+e[6]),{r:t,g:i,b:o}}(l),i=c.r,o=i/255,a=c.g,n=a/255,s=c.b,r=s/255):(t||(t=m()),"red"===t?(i=Math.floor(55*Math.random())+200,a=s=0):"orange"===t?(i=Math.floor(105*Math.random())+150,a=Math.floor(.65*i),s=0):"yellow"===t?(i=a=Math.floor(55*Math.random())+200,s=0):"lime"===t?(a=Math.floor(55*Math.random())+200,i=s=0):"blue"===t?(s=Math.floor(55*Math.random())+200,i=a=0):"cyan"===t?(a=s=Math.floor(55*Math.random())+200,i=0):"magenta"===t?(i=s=Math.floor(55*Math.random())+200,a=0):"maroon"===t?(i=Math.floor(28*Math.random())+100,s=a=0):"olive"===t?(i=a=Math.floor(28*Math.random())+100,s=0):"green"===t?(a=Math.floor(28*Math.random())+100,i=s=0):"purple"===t?(i=s=Math.floor(28*Math.random())+100,a=0):"teal"===t?(a=s=Math.floor(28*Math.random())+100,i=0):"navy"===t?(s=Math.floor(28*Math.random())+100,i=a=0):"black"===t?i=a=s=Math.floor(42*Math.random()):"white"===t?i=a=s=Math.floor(35*Math.random())+220:"silver"===t?i=a=s=Math.floor(42*Math.random())+170:"grey"===t&&(i=a=s=Math.floor(28*Math.random())+100),o=i/255,n=a/255,r=s/255,l=u(i,a,s));let y,g,v=Math.max(o,n,r),b=Math.min(o,n,r),f=.5*(v+b);v===o?y=b===n?6*(r-n)/(o-n)*60:(n-r)/(o-r)*60:v===n?y=b===r?60*(2-(o-r)/(n-r)):60*(2+(r-o)/(n-o)):v===r&&(y=b===o?60*(4-(n-o)/(r-o)):60*(4+(o-n)/(r-n))),g=1===f?0:(v-b)/(1-(2*f-1));let E=p(Math.abs(y+180-360),g,f),w=u(E.r,E.g,E.b),x=[p(Math.abs(y+150-360),g,f),p(Math.abs(y+210-360),g,f)],T=[u(x[0].r,x[0].g,x[0].b),u(x[1].r,x[1].g,x[1].b)],R=[p(Math.abs(y+120-360),g,f),p(Math.abs(y+240-360),g,f)],k=[u(R[0].r,R[0].g,R[0].b),u(R[1].r,R[1].g,R[1].b)],D=[p(Math.abs(y+90-360),g,f),p(Math.abs(y+180-360),g,f),p(Math.abs(y+270-360),g,f)],C=[u(D[0].r,D[0].g,D[0].b),u(D[1].r,D[1].g,D[1].b),u(D[2].r,D[2].g,D[2].b)],M=[p(Math.abs(y+30-360),g,f),p(Math.abs(y+60-360),g,f),p(Math.abs(y+90-360),g,f)],S=[u(M[0].r,M[0].g,M[0].b),u(M[1].r,M[1].g,M[1].b),u(M[2].r,M[2].g,M[2].b)],P=[];const L=.42;let H=u(1.42*i,1.42*a,1.42*s);P.push(H);let A=u(i*(1-L),a*(1-L),s*(1-L));return P.push(A),{base:l,light:H,dark:A,compl:w,splitCompl:T,triadic:k,tetradic:C,analog:S}},this.checkDupeName=e=>{let t=e,o=-1;for(;;){if(!i[t])return e===t||console.log(e+" changed to "+t),t;o++,t=e+"Copy"+o}},this.ranNameGen=(e,t)=>{let o="",a=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n=n=e?Math.floor(Math.random()*e):Math.floor(12*Math.random())+4;for(let e=0;e<n;e++)o+=i.randomOfArray(a);return o=t?t+o:o,o},this.pronoun=e=>{let t={};"male"===e?(t.sex="male",t.sexe="man",t.sexes="men"):"female"===e?(t.sex="female",t.sexe="woman",t.sexes="women"):"other"===e&&(t.sex="person",t.sexe="person",t.sexes="people")},this.objGenType=e=>"string"==typeof e?Object.keys(i[e])[0]:Object.keys(e)[0],this.distance=(e,t,i,o)=>Math.sqrt(Math.pow(i-e,2)+1*Math.pow(o-t,2)),this.randomPosition=(e,t)=>{let i=Math.random()*(2*e)-e,o=Math.random()*(2*e)-e;return new THREE.Vector3(i,t,o)},this.Core=t=>e(i,t),this.coreDataFromTemplate=(e,t,o)=>((e,t,i,o)=>{let a=e.ShallowOmit(t,"el","parent");if(a=JSON.parse(JSON.stringify(a)),i)for(let e in i)a[e]=i[e];if(o||(i.id||(a.id=e.ranNameGen()),a.id=e.checkDupeName(a.id)),o)return a;e[a.id]=a})(i,e,t,o),this.coreFromTemplate=(e,t,o)=>((e,t,i,o)=>{o||(i?i.id||(i.id=e.ranNameGen()):(i={}).id=e.ranNameGen(),i.id=e.checkDupeName(i.id));let a=e.coreDataFromTemplate(t.core,i,!0);if(o)return e.Core(a);e[a.id]=e.Core(a)})(i,e,t,o),this.Layer=(e,t,o)=>((e,t,i,o)=>{let a={id:t};if(a.config=i.config||!1,a.all=e.ShallowOmit(i,"config"),a.inScene=!1,a.allNames=[],a.children={},a.tempParents=[],a.parent=!1,a.gridSpawned=!1,a.gridPath=[],a.pathSpeed=1e3,a.pathWait=1e3,a.pathRoute="any",a.pathLoop="infinite",a.pathType="jump",a.currentPath=-1,a.gridPathInterval,a.gridPathTimeout,a.config)for(let e in a.config)a[e]=a.config[e];if(o)for(let e in o)a[e]=o[e];let n=[];const s=e=>{if(a.parent=e||!1,e&&(e.core?e.core.inScene?a.parent=e.GetEl():a.parent=!1:e.layer?e.layer.inScene?a.parent=e.GetParentEl():a.parent=!1:e.id?a.parent=e:"string"==typeof e&&(document.getElementById(e)?a.parent=document.getElementById(e):a.parent=!1),a.parent||(console.log(t),console.log(e),console.log(document.getElementById(e)),console.log("Parent is not in scene!"))),a.inScene);else{let i=a.parent;function o(e,t,s){i=e||!1,t.parent&&(a.tempParents[s]=t.parent.core.core.id);for(let e in t)t.hasOwnProperty(e)&&("core"===e?(n.length===s&&n.push([]),n[s].push(t[e]),a.allNames.push(t[e].core.id),t[e].core.id===a.all.parent.core.core.id||t[e].core.id===i||t[e].core.id===a.tempParents[s]||t[e].core.id===a.tempParents[s-1]||(a.children[t[e].core.id]={obj:t[e],parent:i},t[e].SpawnCore(i))):"parent"===e&&t[e].hasOwnProperty("core")?(n.length===s&&n.push([]),n[s].push(t[e].core),i=t[e].core.core.id===a.all.parent.core.core.id?a.parent:t[e].core.core.id===i||t[e].core.core.id===a.tempParents[s]?a.tempParents[s-1]:a.tempParents[s],a.children[t[e].core.id]={obj:t[e],parent:i},t[e].core.SpawnCore(i),o(i,t[e],s+1)):"object"==typeof t[e]&&(i=t[e].parent?t[e].parent:a.tempParents[s],o(i,t[e],s+1)))}o(a.parent,a.all,0),a.inScene=!0}},r=()=>{if(a.inScene){clearTimeout(a.gridPathTimeout),clearInterval(a.gridPathInterval),a.gridSpawned&&(a.grid.collide?e.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,!1):a.grid.trigger&&e.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,!1));let t,i=[...n];i.reverse();for(let e of i){t=[...e],t.reverse();for(let e of t)e.DespawnCore()}e.ExistsInTracker(a.id)&&e.RemoveFromTracker(a.id),a.inScene=!1}};function l(e){let t=new THREE.Vector3(0,0,0);if(e.start.x===e.end.x&&e.start.z===e.end.z)t.x=e.start.x,t.z=e.start.z;else{let i=-1*(e.start.x-e.end.x),o=-1*(e.start.z-e.end.z);i/=2,o/=2,t.x=e.start.x+i,t.z=e.start.z+o}return t.y=e.start.y,t}const c=(t,i)=>{let o={start:{},end:{}};o.start.x=a.grid.start.x,o.start.y=a.grid.start.y,o.start.z=a.grid.start.z,o.end.x=a.grid.end.x,o.end.y=a.grid.end.y,o.end.z=a.grid.end.z,t.x&&(o.start.x+=t.x,o.end.x+=t.x),t.y&&(o.start.y+=t.y,o.end.y+=t.y),t.z&&(o.start.z+=t.z,o.end.z+=t.z);let n=l(o);return n.y=a.all.parent.core.core.position.y+n.y,a.grid.collide?!!e.map.CheckMapAreaSansArea(a.grid,o,a.grid.height)&&(e.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,!1),e.map.UpdateMapArea(a.id,o.start,o.end,!0),"anim"===a.pathType?t.x?d("animstartx"+n.x):t.y?d("animstarty"+n.y):t.z&&d("animstartz"+n.z):"jump"===a.pathType&&p({property:"position",value:n}),a.grid.start.x=o.start.x,a.grid.start.y=o.start.y,a.grid.start.z=o.start.z,a.grid.end.x=o.end.x,a.grid.end.y=o.end.y,a.grid.end.z=o.end.z,!0):a.grid.trigger?(e.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,!1),e.map.UpdateMapAreaTrigger(a.id,o.start,o.end,!0),"anim"===a.pathType?t.x?d("animstartx"+n.x):t.y?d("animstarty"+n.y):t.z&&d("animstartz"+n.z):"jump"===a.pathType&&p({property:"position",value:n}),a.grid.start.x=o.start.x,a.grid.start.y=o.start.y,a.grid.start.z=o.start.z,a.grid.end.x=o.end.x,a.grid.end.y=o.end.y,a.grid.end.z=o.end.z,!0):void 0},h=(e,t)=>{let i=m(e);if(i)return i.GetEl(t)},d=e=>{if(Array.isArray(e))for(let t in e)a.all.parent.core.EmitEvent(e[t]);else a.all.parent.core.EmitEvent(e)},p=(e,t)=>{if(Array.isArray(e))for(let i in e)a.all.parent.core.ChangeSelf(e[i],t);else a.all.parent.core.ChangeSelf(e,t)},u=e=>{if(Array.isArray(e))for(let t in e)a.all.parent.core.Animate(e[t]);else a.all.parent.core.Animate(e)},m=e=>{let t=[];return function i(o,a){for(let n in o)if(o.hasOwnProperty(n))if("core"===n){if(o[n].core.id===e)return void t.push(o[n])}else if("parent"===n&&o[n].hasOwnProperty("core")){if(o[n].core.core.id===e)return void t.push(o[n].core)}else"object"==typeof o[n]&&i(o[n],a+1)}(a.all,0),t[0]?t[0]:(console.log("Unable to find child"),console.log(e),!1)};return{layer:a,SpawnLayer:s,DespawnLayer:r,ToggleSpawn:e=>{let t=e||!1;t&&(a.parent=t),a.inScene?r():s(a.parent)},SpawnLayerOnGrid:t=>{if(a.inScene);else{t&&(a.grid=t),a.grid.start.y||(a.grid.start.y=0),a.grid.end.y||(a.grid.end.y=0),a.grid.yOffset||(a.grid.yOffset=0),a.grid.height=Math.abs(a.grid.start.y)+Math.abs(a.grid.end.y)+1;let i=e.player.GetPlayerInfo().grid;if(a.grid.start.x<=i.x&&a.grid.end.x>=i.x&&a.grid.start.y<=i.y&&a.grid.end.y>=i.y&&a.grid.start.z<=i.z&&a.grid.end.z>=i.z)e.map.WaitToSpawn({name:a.id,func:"SpawnLayerOnGrid"});else{let t=l(a.grid);a.all.parent.core.core.position.x=t.x,a.all.parent.core.core.position.y=a.grid.yOffset+t.y,a.all.parent.core.core.position.z=t.z,s(),a.grid.collide?e.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,a.grid.collide):a.grid.trigger&&e.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,a.grid.trigger),a.gridSpawned=!0}}},ToggleLayerGridSpawn:e=>{a.inScene?DespawnFromGrid():SpawnOnGrid(e)},GridMove:c,GridPath:e=>{a.pathSpeed=e.speed||1e3,a.pathWait=e.wait||1e3,a.pathPatience=e.patience||3,a.pathRoute=e.route||"any",a.pathLoop=e.loop||"infinite",a.pathType=e.type||"jump";let t=l(a.grid);a.all.parent.core.core.position.x=t.x,t.y&&(a.all.parent.core.core.position.y=a.all.parent.core.core.position.y+t.y),a.all.parent.core.core.position.z=t.z;let i,o,n=.5;for(let t in e.path){let i=1;for(let o in e.path[t]){n=e.path[t][o]>0?.5:-.5,i="y"===o?Math.abs(e.path[t][o]):Math.abs(e.path[t][o])/.5;for(let e=0;e<i;e++)a.gridPath.push({[o]:n})}}let s=a.all.parent.core.core.position.x,r=a.all.parent.core.core.position.y,c=a.all.parent.core.core.position.z;if("anim"===a.pathType)for(let e in a.gridPath){let t={name:"animmove",property:"object3D.position.x",to:0,dur:a.pathSpeed,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"moveXStart",pauseEvents:"moveXStop"};i=Object.keys(a.gridPath[e])[0],o=a.gridPath[e][i],t.property="object3D.position."+i,"x"===i?(t.to=s+=o,t.name="animmove"+i+s,t.startEvents="animstart"+i+s,t.pauseEvents="animstop"+i+s):"y"===i?(t.to=r+=o,t.name="animmove"+i+r,t.startEvents="animstart"+i+r,t.pauseEvents="animstop"+i+r):"z"===i&&(t.to=c+=o,t.name="animmove"+i+c,t.startEvents="animstart"+i+c,t.pauseEvents="animstop"+i+c),a.inScene?u(t):(0===Object.keys(a.all.parent.core.core.animations).length&&(a.all.parent.core.core.animations={}),delete t.name,a.all.parent.core.core.animations["move"+e]=t)}},WalkPath:()=>{let e=!0,t=!1,i=!0,o=!1,n=!0,s=!1,r=0,l=!1,h=0;function d(){l=!l}function p(){a.currentPath=0}function u(){a.currentPath=a.gridPath.length-1}"any"===a.pathRoute&&100*Math.random()>50&&(l=!0),a.gridPathInterval=setInterval((()=>{e&&i&&n&&(("circuit"===a.pathRoute||"alternate"===a.pathRoute||"any"===a.pathRoute)&&(l?(a.currentPath--,a.currentPath<0&&("infinite"===a.pathLoop||(r>=a.pathLoop?clearInterval(a.gridPathInterval):r++),"circuit"===a.pathRoute?l&&(p(),d()):"alternate"===a.pathRoute?(p(),d()):"any"===a.pathRoute&&(100*Math.random()>50?(p(),d()):u()))):(a.currentPath++,a.currentPath>=a.gridPath.length&&("infinite"===a.pathLoop||(r>=a.pathLoop?clearInterval(a.gridPathInterval):r++),"circuit"===a.pathRoute?p():"alternate"===a.pathRoute?(u(),d()):"any"===a.pathRoute&&(100*Math.random()>50?p():(u(),d()))))),e=!1,i=!1,n=!1,t=!!a.gridPath[a.currentPath].x,o=!!a.gridPath[a.currentPath].y,s=!!a.gridPath[a.currentPath].z),t?(e=c(l?{x:-1*a.gridPath[a.currentPath].x}:{x:a.gridPath[a.currentPath].x}),e?(t=!1,h=0,o||(i=!0),s||(n=!0)):(h++,h>=a.pathPatience&&(e=!0,i=!0,n=!0,d()))):o?(i=c(l?{y:-1*a.gridPath[a.currentPath].y}:{y:a.gridPath[a.currentPath].y}),i?(o=!1,h=0,t||(e=!0),s||(n=!0)):(h++,h>=a.pathPatience&&(e=!0,i=!0,n=!0,d()))):s&&(n=c(l?{z:-1*a.gridPath[a.currentPath].z}:{z:a.gridPath[a.currentPath].z}),n?(s=!1,h=0,t||(e=!0),o||(i=!0)):(h++,h>=a.pathPatience&&(e=!0,i=!0,n=!0,d())))}),a.pathSpeed+a.pathWait)},GetParentEl:e=>a.all.parent.core.GetEl(e),GetChildEl:h,GetAllChildEl:e=>{let t=[];for(let i in a.allNames)a.allNames[i]===a.all.parent.core.core.id||t.push(h(a.allNames[i],e));return t},GetAllEl:e=>{let t=[];for(let i in a.allNames)t.push(h(a.allNames[i],e));return t},EmitEventParent:d,EmitEventChild:(e,t)=>{let i=m(e);if(Array.isArray(t))for(let e in t)i.EmitEvent(t[e]);else i.EmitEvent(t)},EmitEventAll:e=>{if(Array.isArray(e))for(let t in e)for(let i of n)for(let o of i)o.EmitEvent(e[t]);else for(let t of n)for(let i of t)i.EmitEvent(e)},ChangeParent:p,ChangeChild:(e,t,i)=>{let o=m(e);if(Array.isArray(t))for(let e in t)o.ChangeSelf(t[e]);else o.ChangeSelf(t)},ChangeAll:(e,t)=>{if(Array.isArray(e))for(let i in e)for(let o of n)for(let a of o)a.ChangeSelf(e[i],t);else for(let i of n)for(let o of i)o.ChangeSelf(e,t)},RemoveComponentParent:e=>{if(Array.isArray(e))for(let t in e)a.all.parent.core.RemoveComponent(e[t]);else a.all.parent.core.RemoveComponent(e)},RemoveComponentChild:(e,t)=>{let i=m(e);if(Array.isArray(t))for(let e in t)i.RemoveComponent(t[e]);else i.RemoveComponent(t)},RemoveComponentAll:e=>{if(Array.isArray(e))for(let t in e)for(let i of n)for(let o of i)o.RemoveComponent(e[t]);else for(let t of n)for(let i of t)i.RemoveComponent(e)},AnimateParent:u,AnimateChild:(e,t)=>{let i=m(e);if(Array.isArray(t))for(let e in t)i.Animate(t[e]);else i.Animate(t)},AnimateAll:e=>{if(Array.isArray(e))for(let t in e)for(let i of n)for(let o of i)o.Animate(e[t]);else for(let t of n)for(let i of t)i.Animate(e)},SetFlagParent:e=>{if(Array.isArray(e))for(let t in e)a.all.parent.core.SetFlag(e[t]);else a.all.parent.core.SetFlag(e)},SetFlagChild:(e,t)=>{let i=m(e);if(Array.isArray(t))for(let e in t)i.SetFlag(t[e]);else i.SetFlag(t)},SetFlagAll:e=>{if(Array.isArray(e))for(let t in e)for(let i of n)for(let o of i)o.SetFlag(e[t]);else for(let t of n)for(let i of t)i.SetFlag(e)},GetFlagParent:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(a.all.parent.core.GetFlag(e[i]));return t}return a.all.parent.core.GetFlag(e)},GetFlagChild:(e,t)=>{let i=m(e);if(Array.isArray(t)){let e=[];for(let o in t)e.push(i.GetFlag(t[o]));return e}return i.GetFlag(t)},GetFlagAll:e=>{let t=[];if(Array.isArray(e)){for(let i in e){let o=[];for(let t of n)for(let a of t)o.push(a.GetFlag(e[i]));t.push(o)}return t}for(let i of n)for(let o of i)t.push(o.GetFlag(e));return t},DomClassParent:(e,t,i)=>{a.all.parent.core.DomClass(e,t,i)},DomClassChild:(e,t,i,o)=>{m(e).DomClass(t,i,o)},DomClassAll:(e,t,i)=>{for(let o of n)for(let a of o)a.DomClass(e,t,i)},EnableDetailParent:e=>{a.all.parent.core.EnableDetail(e)},EnableDetailChild:(e,t)=>{m(e).EnableDetail(t)},EnableDetailAll:e=>{for(let t of n)for(let i of t)i.EnableDetail(e)},DisableDetailParent:()=>{a.all.parent.core.DisableDetail()},DisableDetailChild:e=>{m(e).DisableDetail()},DisableDetailAll:()=>{for(let e of n)for(let t of e)t.DisableDetail()},GetChild:m}})(i,e,t,o),this.layerDataFromTemplate=(e,t,o,a,n)=>((e,t,i,o,a,n)=>{let s=i||e.ranNameGen();s=e.checkDupeName(s);let r={},l=0;if(o?o.id||(o.id=s+l):(o={}).id=s+l,o.id=e.checkDupeName(o.id),function t(i,a){for(let n in i)i[n].core?(a[n]={},a[n].core=0===l?e.coreFromTemplate(i[n].core,o,!0):e.coreFromTemplate(i[n].core,{id:e.checkDupeName(s+l)},!0),l++):(a[n]={},t(i[n],a[n]))}(t,r),o)for(let e in o)r.parent.core.core[e]=o[e];if(a&&(r.config={...a}),n)return r;e[s]=r})(i,e,t,o,a,n),this.layerFromTemplate=(e,t,o,a,n)=>((e,t,i,o,a,n)=>{let s,r={},l=0;if(n||(i||(i=e.ranNameGen()),i=e.checkDupeName(i)),o?o.id||(o.id=i+l):(o={}).id=i+l,o.id=e.checkDupeName(o.id),s=t.layer?t.layer.all:t,function t(a,n){for(let s in a)a[s].core?(n[s]={},n[s].core=0===l?e.coreFromTemplate(a[s].core,o,!0):e.coreFromTemplate(a[s].core,{id:e.checkDupeName(i+l)},!0),l++):(n[s]={},t(a[s],n[s]))}(s,r),o)for(let e in o)r.parent.core.core[e]=o[e];if(a&&(r.config={...a}),n)return e.Layer(i,r);e[i]=e.Layer(i,r)})(i,e,t,o,a,n),this.UniRay=(e,t,a)=>o(i,e,t,a),this.Player=(e,o)=>t(i,e,o),this.Companion=(e,t,o)=>((e,t,i,o)=>{let a,n={};function s(){let t=e.player.RayDistanceDirection(e.camera.GetEl());t.negate();let i=new THREE.Vector3;return i=t.clone().multiplyScalar(n.distance),i.setY(n.height),i}function r(){let t=new THREE.Vector3(0,-1,0);return e.playerRig.GetEl().components.gravitycontrol&&(t.copy(e.playerRig.GetEl().components.gravitycontrol.axis),t.equals(new THREE.Vector3)&&t.copy(new THREE.Vector3(0,-1,0))),t.negate(),t}n.avatarType="",n.menuParentId,i.SpawnCore?(n.avatarType="core",n.menuParentId=i.core.id,a=i.core.id):i.SpawnLayer&&(n.avatarType="layer",n.menuParentId=i.layer.all.parent.core.core.id,a=i.layer.id),n.avatar=Object.assign({},i),n.shapes={default:a,Cube:"compCubeLayer",Sphere:"compSphereLayer"},n.id=t,n.el=!1,n.inScene=!1,n.infoDisplay=!1,n.pos=e.playerRig.GetEl().getAttribute("position"),n.height=1.5,n.distance=-2,n.firstSpawn=!0,n.spawnToggling=!1,n.viewConfig=!1,n.bookData=e.compBookData,e.compNPC=e.NPC("compNPC",n.avatar,n.bookData,e.compBubbleLayer,!0),n.enableInventory=o||!1,n.inventoryTimeouts=[],n.items={},n.tools={},n.keys={},n.specials={},n.mainMenuData={info:{id:"mainMenu",buttonData:e.menuCylinderData,hoverData:e.menuHoverData,title:"Main Menu",description:"Main menu for travel, system and settings.",layout:"circleUp",offset:-1.25,posOffset:new THREE.Vector3(1.625,.13,.11),parent:"ghostParent",stare:!1,npc:"compNPC"},menu0:{button1:{id:"subMenu2",style:!1,title:"Travel to",description:"Select your next travel destination.",subMenu:"travel1",action:!1},button2:{id:"subMenu3",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu3",action:!1},button3:{id:"subMenu4",style:!1,title:"Controls",description:"View current control configuration.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"ToggleControlView",params:null,menu:"close"}}},travel1:{button0:{id:"subMenu4",style:!1,title:"Sub Menu 4 Test",description:"A test sub menu.",subMenu:"menu4",action:!1},button1:{id:"subMenu5",style:!1,title:"Sub Menu 5 Test",description:"A test sub menu.",subMenu:"menu5",action:!1}},menu2:{button0:{id:"action1",style:!1,title:"Toggle Flashlight",description:"Turn On/Off your flashlight.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleFlashlight",params:null,menu:"close"}}},menu3:{button0:{id:"action1",style:!1,title:"Sit/Stand Toggle",description:"Toggle between sitting or standing mode.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleSittingMode",params:null,menu:"stay"}},button5:{id:"action5",style:!1,title:"Ray Helper Toggle",description:"Toggle between ray helpers on or off.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleRayHelp",params:"toggle",menu:"close"}},button5:{id:"TargettingSystem",style:!1,title:"Target Assistant Helper Toggles.",description:"Toggle between ray helpers on or off.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleTargetHelp",params:"toggle",menu:"close"}},button1:{id:"subMenu1",style:!1,title:"Companion Avatar",description:"Change the companion avatar shape.",subMenu:"compShape1",action:!1},button2:{id:"subMenu2",style:!1,title:"Scene Transition Type",description:"Change the scene transition animation style.",subMenu:"menu4",action:!1},button3:{id:"subMenu3",style:!1,title:"Teleport Transition Type",description:"Change the teleport transition animation style.",subMenu:"menu5",action:!1},button4:{id:"subMenu4",style:!1,title:"Transition Color",description:"Change the transition animation color.",subMenu:"menu6",action:!1}},menu4:{button0:{id:"action1",style:!1,title:"Instant",description:"Disable animation.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"instant",menu:"back"}},button1:{id:"action2",style:!1,title:"Blink",description:"Blink in and out in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"blink",menu:"back"}},button2:{id:"action3",style:!1,title:"Fade",description:"Fade in and out in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"fade",menu:"back"}},button3:{id:"action4",style:!1,title:"Sphere",description:"Close and open a sphere in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"sphere",menu:"back"}}},menu5:{button0:{id:"action1",style:!1,title:"Instant",description:"Disable animation.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"instant",menu:"back"}},button1:{id:"action2",style:!1,title:"Locomotion",description:"Slide to teleport position.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"locomotion",menu:"back"}},button2:{id:"action3",style:!1,title:"Blink",description:"Blink in and out in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"blink",menu:"back"}},button3:{id:"action4",style:!1,title:"Fade",description:"Fade in and out in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"fade",menu:"back"}},button4:{id:"action5",style:!1,title:"Sphere",description:"Close and open a sphere in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"sphere",menu:"back"}}},menu6:{button0:{id:"action1",style:!1,title:"Black",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"black",menu:"back"}},button1:{id:"action2",style:!1,title:"Grey",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"grey",menu:"back"}},button2:{id:"action3",style:!1,title:"White",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"white",menu:"back"}},button3:{id:"action4",style:!1,title:"Red",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"red",menu:"back"}},button4:{id:"action5",style:!1,title:"Green",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"green",menu:"back"}},button5:{id:"action6",style:!1,title:"Blue",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"blue",menu:"back"}}},compShape1:{},inventory:{button0:{id:"subMenu1",style:!1,title:"Items",description:"View your items.",subMenu:"items1",action:!1},button1:{id:"subMenu2",style:!1,title:"Tools",description:"View your tools.",subMenu:"tools1",action:!1},button2:{id:"subMenu3",style:!1,title:"Keys",description:"View your keys.",subMenu:"keys1",action:!1},button3:{id:"subMenu4",style:!1,title:"Special",description:"View your special objects.",subMenu:"specials1",action:!1}},items1:{},tools1:{},keys1:{},specials1:{}},n.enableInventory&&(n.mainMenuData.menu0.button0={id:"subMenu1",style:!1,title:"Inventory",description:"View your inventory.",subMenu:"inventory",action:!1},n.mainMenuData.menu0.button4={id:"subMenu5",style:!1,title:"Unequip",description:"Unequip your held object.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"Unequip",params:null,menu:"stay"}}),e.mainMenu=e.MultiMenu(n.mainMenuData);const l=()=>{let t=(new THREE.Vector3).copy(e.camera.GetEl().object3D.position),i=r().clone();i.multiplyScalar(e.camera.GetEl().object3D.position.y),e.comp.GetEl().object3D.up.copy(i),e.comp.GetEl().object3D.lookAt(t)},c=()=>{n.shapeButtons={};let t={},i={},o=1,a=1,s=Object.keys(n.shapes).length,r=Math.ceil(s/8),l="compShape"+a;for(let c in n.shapes)t={id:"action"+o,style:!1,title:c,description:"Change to a "+c+" avatar.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"UpdateShape",params:n.shapes[c],menu:"close"}},i={id:"action"+o,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},n.shapeButtons["button"+o]=t,o===s?e.mainMenu.UpdateSubMenu(l,n.shapeButtons):o++,r>1&&o%7==0&&(a++,i.id="action"+o,i.subMenu="compShape"+a,n.shapeButtons["button"+o]=i,e.mainMenu.UpdateSubMenu(l,n.shapeButtons),n.shapeButtons={},l="compShape"+a)},h=()=>{e.playerFloor.GetEl().classList.toggle("clickable")};e.playerFloor.GetEl().addEventListener("click",(()=>{if(!n.spawnToggling){n.spawnToggling=!0,n.inScene?p():d();let e=setTimeout((()=>{n.spawnToggling=!1,clearTimeout(e)}),500)}}));const d=()=>{if(n.inScene);else{h(),e.compNPC.SpawnNPC(e.headRig.GetEl()),"core"===n.avatarType?n.firstSpawn?n.firstSpawn=!1:n.avatar.ChangeSelf({property:"position",value:s()}):n.firstSpawn?n.firstSpawn=!1:n.avatar.ChangeParent({property:"position",value:s()});let t=setTimeout((()=>{l(),clearTimeout(t)}),10),i=setTimeout((()=>{n.enableInventory&&g(),e.mainMenu.multiMenu.parent=n.menuParentId,e.mainMenu.SpawnMultiMenu(),h(),n.inScene=!0,e.player.ToggleBeltText(!0),e.build.SpawnBuild(),clearTimeout(i)}),100)}},p=()=>{if(n.inScene){n.playerQuat0=e.playerRig.GetEl().object3D.quaternion.clone(),h(),e.player.ToggleBeltText(),e.mainMenu.DespawnMultiMenu();let t=setTimeout((()=>{e.compNPC.DespawnNPC(),e.RemoveFromTracker(n.id),n.inScene=!1,h(),e.build.DespawnBuild(),clearTimeout(t)}),300)}},u=(t,i)=>{let o=e.player.RayDistanceDirection(e.camera.GetEl());o.negate();let a=new THREE.Vector3;return a=o.clone().multiplyScalar(t),a.setY(i),a},m=()=>{for(let e in n.inventoryTimeouts)clearTimeout(n.inventoryTimeouts[e]);n.inventoryTimeouts=[]},y=t=>{n.inventoryButtons={};let i={},o={},a=1,s=1,r=Object.keys(n[t]).length,l=Math.ceil(r/8),c=t+s,h="stay";for(let d in n[t]){let p;p="limited"===n[t][d].persist?n[t][d].name+" x"+n[t][d].amount:n[t][d].name,h=n[t][d].menu?n[t][d].menu:"stay",i={id:"action"+a,style:n[t][d].style,title:p,description:n[t][d].description,subMenu:!1,action:{auxlObj:n[t][d].auxlObj,component:n[t][d].component,method:n[t][d].method,params:n[t][d].params,menu:h}},n[t][d].action||(i.action=!1),o={id:"action"+a,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},n.inventoryButtons["button"+a]=i,a===r?e.mainMenu.UpdateSubMenu(c,n.inventoryButtons):a++,l>1&&a%7==0&&(s++,o.id="action"+a,o.subMenu=t+s,n.inventoryButtons["button"+a]=o,e.mainMenu.UpdateSubMenu(c,n.inventoryButtons),n.inventoryButtons={},c=t+s)}},g=()=>{y("items"),y("tools"),y("keys"),y("specials")};return{comp:n,TestFunc:e=>{console.log(e)},AddAvatar:(e,t)=>{n.shapes[e]=t,c()},UpdateShape:t=>{let i=!1;n.inScene&&(i=!0,p());let o=setTimeout((()=>{e[t].SpawnCore?(n.avatarType="core",n.menuParentId=e[t].core.id):e[t].SpawnLayer?(n.avatarType="layer",n.menuParentId=e[t].layer.all.parent.core.core.id):(console.log(t),console.log("failed to detect type")),n.avatar=Object.assign({},e[t]),e.compNPC=e.NPC("compNPC",n.avatar,e.compBookData,e.compBubbleLayer,!0),i&&d(),clearTimeout(o)}),400)},UpdateBook:t=>{let i=!1;n.inScene&&(i=!0,p()),n.bookData=t;let o=setTimeout((()=>{e.compNPC=e.NPC("compNPC",n.avatar,n.bookData,e.compBubbleLayer,!0),i&&d(),clearTimeout(o)}),400)},SpawnComp:d,DespawnComp:p,GetEl:()=>"core"===n.avatarType?n.avatar.GetEl():n.avatar.GetParentEl(),SetFlag:t=>{if(Array.isArray(t))for(let i in t)n[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:n.id,type:"comp",sub:!1,name:t[i].flag,data:t[i].value});else n[t.flag]=t.value,e.saveToProfile({auxlObject:n.id,type:"comp",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(n(e[i]));return t}return n[e]},TurnToPlayer:l,UpdatePosition:()=>{"core"===n.avatarType?n.avatar.ChangeSelf({property:"position",value:s()}):n.avatar.ChangeParent({property:"position",value:s()})},ToggleControlView:()=>{if(n.viewConfig)e.configurationView.DespawnCore(),n.viewConfig=!1;else{e.configurationView.SpawnCore(e.playerRig.GetEl()),e.configurationView.ChangeSelf([{property:"text",value:{value:e.controlsText}},{property:"position",value:u(-1,1.5)}]),n.viewConfig=!0;let t=setTimeout((()=>{(t=>{let i=(new THREE.Vector3).copy(e.playerRig.GetEl().object3D.position),o=r().clone();o.multiplyScalar(e.camera.GetEl().object3D.position.y),i.add(o),t.object3D.up.copy(o),t.object3D.lookAt(i)})(e.configurationView.GetEl()),clearTimeout(t)}),10)}},UpdateMainMenu:t=>{let i=!1;e.mainMenu.inScene&&(e.mainMenu.DespawnMultiMenu(),i=!0),Object.keys(t).forEach((e=>{n.mainMenuData[e]?n.mainMenuData[e][t[e].id]=t[e]:n.mainMenuData[e]=t[e]})),e.mainMenu=e.MultiMenu(n.mainMenuData),g(),c(),i&&e.mainMenu.SpawnMultiMenu()},UpdateMainMenuStyle:t=>{let i=!1;e.mainMenu.inScene&&(e.mainMenu.DespawnMultiMenu(),i=!0),n.mainMenuData.info.buttonData=t,e.mainMenu=e.MultiMenu(n.mainMenuData),g(),c(),i&&e.mainMenu.SpawnMultiMenu()},EnableInventory:()=>{n.enableInventory=!0,n.mainMenuData.menu0={button0:{id:"subMenu1",style:!1,title:"Inventory",description:"View your inventory.",subMenu:"inventory",action:!1},button4:{id:"subMenu5",style:!1,title:"Unequip",description:"Unequip your held object.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"Unequip",params:null,menu:"stay"}},button1:{id:"subMenu2",style:!1,title:"Travel to",description:"Select your next travel destination.",subMenu:"menu1",action:!1},button2:{id:"subMenu3",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu3",action:!1},button3:{id:"subMenu4",style:!1,title:"Controls",description:"View current control configuration.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"ToggleControlView",params:null,menu:"close"}}},e.mainMenu=e.MultiMenu(n.mainMenuData),g()},AddToInventory:({item:t,hide:i})=>{function o(t){n[t.category][t.name]?"limited"===n[t.category][t.name].persist&&(n[t.category][t.name].amount+=t.amount):n[t.category][t.name]=t,e.saveToProfile({auxlObject:n.id,type:"comp",sub:t.category,name:t.name,data:t})}if(Array.isArray(t))for(let e in t)o(t[e]);else o(t);if(g(),m(),i);else if(Array.isArray(t))for(let i in t){let o=3800;o*=i,n.inventoryTimeouts[i]=setTimeout((()=>{e.player.Notification({message:"Acquired : "+t[i].name}),clearTimeout(n.inventoryTimeouts[i])}),o)}else e.player.Notification({message:"Acquired : "+t.name})},ClearInventoryNotifications:m,RemoveFromInventory:t=>{function i(t){n[t.category][t.name]?"limited"===n[t.category][t.name].persist&&(n[t.category][t.name].amount--,n[t.category][t.name].amount<=0&&delete n[t.category][t.name]):delete n[t.category][t.name],e.saveToProfile({auxlObject:n.id,type:"comp",sub:t.category,name:t.name,data:t})}if(Array.isArray(t))for(let e in t)i(t[e]);else i(t);g()},CheckInventory:e=>{let t;function i(e){return!!n[e.category][e.name]}if(Array.isArray(e))for(let o in e)t.push(i(e[o]));else t=i(e);return t},CheckForKey:e=>{let t=!1;if(0===Object.keys(n.keys).length)t=!1;else for(let i in n.keys)if(n.keys[i].id===e){t=!0;break}return t},UpdateInventoryMenu:g}})(i,e,t,o),this.Powers=(e,t,i,o,a)=>((e,t,i,o,a)=>{let n={};n.on=atStart||!1,n.one=i||!1,n.core=o||!1,n.layer=a||!1,n.type=t.type||"select",n.to=t.to||"playerRig",n.id="power"+o.id+Math.floor(1e7*Math.random().toFixed(8)),n.amount=0,n.pos=new THREE.Vector3(0,0,0),n.always=!0;const s=e=>{e&&(e.type&&(n.type=e.type),e.restLength&&(n.restLength=e.restLength),e.damping&&(n.damping=e.damping),e.stiffness&&(n.stiffness=e.stiffness),e.maxForce&&(n.maxForce=e.maxForce)),"lock"===n.type&&(n.connect={name:"auxpower__"+n.id,type:n.type,connectTo:n.to,maxForce:1e6,collideConnected:n.collideConnected,always:n.always})};s(t);const r=e=>{s(e)};return n.on&&r(),{power:n,Update:s,Connect:r,Disconnect:()=>{n.core.RemoveComponent(n.connect.name)},Disable:()=>{delete n.core.core.components[n.connect.name]},Activate:e=>{},Deactivate:e=>{},Start:e=>{},Continue:e=>{},Stop:e=>{},Click:e=>{},Toggle:e=>{},Menu:e=>{},Directional:e=>{},Rotational:e=>{},Running:()=>{}}})(0,e,t,i,o),this.SceneNode=e=>a(i,e),this.MapZone=e=>n(i,e),this.Scenario=e=>s(i,e),this.World=e=>((e,t)=>{let i={};i.data=Object.assign({},t),i.id=i.data.info.id,i.name=i.data.info.name,i.scenarios=i.data.scenarios,i.current=0,i.loaded=!1,i.scenarioLoaded=!1,i.soundtrack=!1,i.soundtracks=!1;const o=e=>{i.current=e,i.scenarios[e].StartScenario(),i.scenarioLoaded=!0},a=e=>{i.scenarios[e].ClearScenario(),i.scenarioLoaded=!1};return{world:i,SetAsDefault:()=>{e.defaultWorld=e[i.id]},StartWorld:()=>{(()=>{if(i.data.info.maxLoadtime?e.maxLoadTime=i.data.info.maxLoadtime:e.maxLoadTime=5e3,i.data.info.dayTime?e.timeInDay=i.data.info.dayTime:e.timeInDay=36e4,i.data.info.inventory?e.comp.EnableInventory():e.comp.enableInventory=!1,i.data.info.collision?(e.collision=!0,e.compassDisplay=i.data.info.collision.compass||!1):(e.collision=!1,e.compassDisplay=!1),e.playerFloor.ChangeSelf({property:"visible",value:e.compassDisplay}),i.data.info.physics?(e.worldPhysics=i.data.info.physics,e.EnablePhysics(),e.player.EnablePhysics()):e.worldPhysics=!1,i.data.info.menuStyle&&e.comp.UpdateMainMenuStyle(i.data.info.menuStyle),i.data.info.menuOptions&&e.comp.UpdateMainMenu(i.data.info.menuOptions),i.data.info.backgroundAudio){i.soundtracks=JSON.parse(JSON.stringify(i.data.info.backgroundAudio));for(let t in i.soundtracks)e.playerAudio.ChangeSelf({property:"auxsound__"+t,value:i.soundtracks[t]});e.backgroundAudio=!0}if(i.data.info.soundEffects){i.soundEffects=JSON.parse(JSON.stringify(i.data.info.soundEffects));for(let t in i.soundEffects)e.playerAudio.ChangeSelf({property:"auxsound__"+t,value:i.soundEffects[t]})}i.data.info.compBookUpdate&&e.comp.UpdateBook(i.data.info.compBookUpdate)})(),o(i.current),e.currentWorld=e[i.id],e.worldLoaded=!0,e.local.location.world=i.id},StopWorld:()=>{a(i.current),e.worldLoaded=!1},StartScenario:o,ClearScenario:a,NextScenario:()=>{a(i.current),i.current++,o(i.current)},LoadScenario:e=>{a(i.current),i.current=e,o(i.current)},MusicPlaylist:t=>{i.soundtrack&&(e.playerAudio.GetEl().components["auxsound__"+i.soundtrack].stopSound(),i.soundtrack=!1),e.isFalsey(t)||(i.soundtracks.hasOwnProperty(t)?(e.playerAudio.EmitEvent(t),i.soundtrack=t):console.log({world:i,track:t,msg:"Unable to find track"}))}}})(i,e),this.Menu=e=>((e,t)=>{let i={inScene:!1};i.data=Object.assign({},t.data),i.id=t.id||"menu",i.prompt=t.prompt,i.options=t.options,i.actions=t.actions,i.layers={},i.layer={};let o={},a={},n=[],s=0,r=Object.keys(i.options).length;return i.clickrun={},i.clickrun.cursorObj=t.cursorObj||!1,i.clickrun.method=t.method||"Click",i.clickrun.params=t.params||"target",i.layout=t.layout,i.data.position=new THREE.Vector3(0,0,0),i.data.position.x=t.pos.x,i.data.position.y=t.pos.y,i.data.position.z=t.pos.z,{menu:i,SpawnMenu:()=>{if(i.inScene);else{s=0,n=[],a={},i.data.id=i.id,i.data.text.value=i.prompt,i.data.material.color,i.data.material.emissive=e.colorTheoryGen().base,o=e.Core(i.data),i.layers={parent:{core:o}},i.data.position.x=1.15*i.data.geometry.width,i.data.position.z=0,1===r||"horizontal"===i.layout?i.data.position.y=0:i.data.position.y=.75*i.data.geometry.height*r/2,i.data.sources={},i.data.components={},i.data.components.clickrun={},i.data.components.clickrun.cursorObj=i.clickrun.cursorObj,i.data.components.clickrun.method=i.clickrun.method,i.data.components.clickrun.params=i.clickrun.params;for(let t in i.options)1===r||0===s||("vertical"===i.layout?i.data.position.y-=1.15*i.data.geometry.height:"horizontal"===i.layout?i.data.position.x+=1.15*i.data.geometry.width:i.data.position.y-=1.15*i.data.geometry.height),i.data.material.color,i.data.material.emissive=e.colorTheoryGen().base,i.data.text.value=i.options[t],i.data.id=i.id+"option"+s,i.data.components.result=i.actions["action"+s],a=e.Core(i.data),n.push(a),i.layers["child"+s]={core:n[s]},s++;i.layer=e.Layer(i.id,i.layers),i.layer.SpawnLayer(),i.inScene=!0}},DespawnMenu:()=>{i.inScene&&(i.layer.DespawnLayer(),i.inScene=!1)},AddToParentSpawnTracker:(t,o)=>{e.scenarioSpawned[o.id]?e.scenarioSpawned[i.id]={type:"menu",obj:t,parent:o}:e.zoneSpawned[o.id]?e.zoneSpawned[i.id]={type:"menu",obj:t,parent:o}:e.nodeSpawned[o.id]?e.nodeSpawned[i.id]={type:"menu",obj:t,parent:o}:e.bookSpawned[o.id]&&(e.bookSpawned[i.id]={type:"menu",obj:t,parent:o})},RemoveMenuFromSceneTracker:()=>{e.scenarioSpawned[i.id]?delete e.scenarioSpawned[i.id]:e.zoneSpawned[i.id]?delete e.zoneSpawned[i.id]:e.nodeSpawned[i.id]?delete e.nodeSpawned[i.id]:e.bookSpawned[i.id]&&delete e.bookSpawned[i.id]}}})(i,e),this.MultiMenu=e=>r(i,e),this.HoverMenu=e=>l(i,e),this.ComboLock=(e,t,o,a,n)=>c(i,e,t,o,a,n),this.ScrollMenu=e=>((e,t)=>{let i={};return i.id=t,i.AllParentData={data:"AllParentData",id:"allParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,1.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},i.allParent=e.Core(i.AllParentData),i.scrollBkgdData={data:"scrollBkgdData",id:"scrollBkgd",sources:!1,text:!1,geometry:{primitive:"box",depth:.1,width:.5,height:1.4},material:{shader:"standard",color:"#e02574",emissive:"#e02574",emissiveIntensity:.25,opacity:.5},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{scroll:{type:"plane",axis:"vertical",parent:"scrollParent",length:1,options:5,elements:["scroll0","scroll1","scroll2","scroll3","scroll4","scroll5","scroll6","scroll7"]}}},i.scrollBkgd=e.Core(i.scrollBkgdData),i.scrollParentData={data:"scrollParentData",id:"scrollParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},i.scrollParent=e.Core(i.scrollParentData),i.scroll0Data={data:"scroll0Data",id:"scroll0",sources:!1,text:!1,geometry:{primitive:"box",depth:.025,width:.1,height:.1},material:{shader:"standard",color:"#e02574",emissive:"#e02574",opacity:0},position:new THREE.Vector3(0,-.6,.1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},i.scroll0=e.Core(i.scroll0Data),i.scroll1Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll1",position:new THREE.Vector3(0,-.4,.1),material:{shader:"standard",color:"#66e025",emissive:"#66e025",opacity:1}},!0),i.scroll1=e.Core(i.scroll1Data),i.scroll2Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll2",position:new THREE.Vector3(0,-.2,.1),material:{shader:"standard",color:"#256de0",emissive:"#256de0",opacity:1}},!0),i.scroll2=e.Core(i.scroll2Data),i.scroll3Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll3",position:new THREE.Vector3(0,0,.1),material:{shader:"standard",color:"#e0e025",emissive:"#e0e025",opacity:1}},!0),i.scroll3=e.Core(i.scroll3Data),i.scroll4Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll4",position:new THREE.Vector3(0,.2,.1),material:{shader:"standard",color:"#e09825",emissive:"#e09825",opacity:1}},!0),i.scroll4=e.Core(i.scroll4Data),i.scroll5Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll5",position:new THREE.Vector3(0,.4,.1),material:{shader:"standard",color:"#e02525",emissive:"#e02525",opacity:1}},!0),i.scroll5=e.Core(i.scroll5Data),i.scroll6Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll6",position:new THREE.Vector3(0,.6,.1),material:{shader:"standard",color:"#25e0d9",emissive:"#25e0d9",opacity:0}},!0),i.scroll6=e.Core(i.scroll6Data),i.scroll7Data=e.coreDataFromTemplate(i.scroll0Data,{id:"scroll7",position:new THREE.Vector3(0,.8,.1),material:{shader:"standard",color:"#ffffff",emissive:"#ffffff",opacity:0}},!0),i.scroll7=e.Core(i.scroll7Data),i.scrollAllData={parent:{core:i.allParent},child0:{core:i.scrollBkgd},child1:{parent:{core:i.scrollParent},child0:{core:i.scroll0},child1:{core:i.scroll1},child2:{core:i.scroll2},child3:{core:i.scroll3},child4:{core:i.scroll4},child5:{core:i.scroll5},child6:{core:i.scroll6},child7:{core:i.scroll7}}},i.scrollAll=e.Layer("scrollAll",i.scrollAllData),{scrollMenu:i,SpawnScrollMenu:()=>{i.scrollAll.SpawnLayer()},DespawnScrollMenu:()=>{i.scrollAll.DespawnLayer()}}})(i,e),this.SkyBox=e=>((e,t)=>{let i,o,a=Object.assign({},t);a.inScene=!1,a.time=5.5,a.day=!1;const n=()=>{a.inScene||((()=>{for(let e in a.lights)a.lights[e].SpawnCore?a.lights[e].SpawnCore():a.lights[e].SpawnLayer?a.lights[e].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.lights[e]))})(),(()=>{for(let e in a.sky)a.sky[e].SpawnCore?a.sky[e].SpawnCore():a.sky[e].SpawnLayer?a.sky[e].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.sky[e]))})(),(()=>{for(let e in a.space)a.space[e].SpawnCore?a.space[e].SpawnCore():a.space[e].SpawnLayer?a.space[e].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.space[e]))})(),a.inScene=!0)},s=()=>{a.inScene&&(clearTimeout(i),clearInterval(o),(()=>{for(let e in a.lights)a.lights[e].DespawnCore?a.lights[e].DespawnCore():a.lights[e].DespawnLayer?a.lights[e].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.lights[e]))})(),(()=>{for(let e in a.sky)a.sky[e].DespawnCore?a.sky[e].DespawnCore():a.sky[e].DespawnLayer?a.sky[e].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.sky[e]))})(),(()=>{for(let e in a.space)a.space[e].DespawnCore?a.space[e].DespawnCore():a.space[e].DespawnLayer?a.space[e].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.space[e]))})(),e.RemoveFromTracker(a.id),a.inScene=!1)},r=(e,t)=>{for(let i in e)e[i].SpawnCore?e[i].EmitEvent(t):e[i].SpawnLayer?e[i].EmitEventAll(t):(console.log("Failed to emit event to object"),console.log(e[i]))},l=()=>{a.day=!0,r(a.lights,"sunrise"),r(a.sky,"sunrise"),r(a.space,"sunrise")},c=()=>{a.day=!1,r(a.lights,"sunset"),r(a.sky,"sunset"),r(a.space,"sunset")},h=()=>{r(a.lights,"pauseDayNight"),r(a.sky,"pauseDayNight"),r(a.space,"pauseDayNight")},d=t=>{t&&"number"==typeof t&&t>=24e3&&(e.timeInDay=t),l(),i=setTimeout((()=>{c(),o=setInterval((()=>{a.day?c():l()}),e.timeInDay/2)}),e.timeInDay/2-e.timeInDay/24)};return{skyBox:a,SpawnSkyBox:n,DespawnSkyBox:s,ToggleSpawn:()=>{a.inScene?s():n()},SetFlag:t=>{if(Array.isArray(t))for(let i in t)a[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:a.id,type:"skyBox",sub:!1,name:t[i].flag,data:t[i].value});else a[t.flag]=t.value,e.saveToProfile({auxlObject:a.id,type:"skyBox",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(a(e[i]));return t}return a[e]},DayNightCycle:d,PauseDayNight:h,ResumeDayNight:()=>{r(a.lights,"resumeDayNight"),r(a.sky,"resumeDayNight"),r(a.space,"resumeDayNight")},RestartDayNight:e=>{h(),Despawn(),Spawn(),d(e)},SetTime:t=>{h(),a.day=t>=6&&t<=18,a.time=t;let i=15*a.time-90;e.sunLayer.layer.inScene&&e.sunLayer.GetChild("sunOuter").ChangeSelf({property:"rotation",value:new THREE.Vector3(i,45,0)});let o=15*a.time+90;e.moonLayer.layer.inScene&&e.moonLayer.GetChild("moonOuter").ChangeSelf({property:"rotation",value:new THREE.Vector3(o,45,0)})}}})(i,e),this.Horizon=e=>((e,t)=>{let i,o,a,n,s,r,l,c,h=Object.assign({},t);h.inScene=!1,"low"===h.density?s=5:"normal"===h.density?s=10:"high"===h.density&&(s=20),"low"===h.height?r=.5:"normal"===h.height?r=1:"high"===h.height&&(r=1.5),"low"===h.width?l=.5:"normal"===h.width?l=1:"high"===h.width&&(l=1.5);let d,p=new THREE.Vector3(0,0,-1*h.radius),u=new THREE.Vector3(1,1,1);"mountains"===h.type?(d=100*r,c={primitive:"cone",height:d,radiusBottom:50,radiusTop:0,openEnded:!0,segmentsHeight:1,segmentsRadial:9,thetaLength:180,thetaStart:90},u.x=1.5*l):"hills"===h.type?(d=50*r,c={primitive:"circle",radius:d,thetaStart:0,thetaLength:180},u.x=1.5*l):"buildings"===h.type?(d=100*r,c={primitive:"plane",width:40*l,height:d}):"cylinderWall"===h.type?(d=50*r,c={primitive:"cylinder",openEnded:!0,radius:h.radius,height:d,segmentsHeight:10,segmentsRadial:512,thetaStart:0,thetaLength:360},p.z=0,s=1,u=new THREE.Vector3(1,1,1)):"squareWall"===h.type&&(d=40*r,c={primitive:"plane",width:2*h.radius,height:d},s=4);let m={data:"horizonAllData",id:"horizonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,-5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},y={parent:{core:e.Core(m)}},g={data:"horizonParentData",id:"horizonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},v="horizonParent",b=[],f={data:"horizonChildData",id:"horizonChild",sources:!1,text:!1,geometry:c,material:!1,position:p,rotation:new THREE.Vector3(0,0,0),scale:u,animations:!1,mixins:!1,classes:["a-ent"],components:!1},E="horizonChild",w=[];for(let t=0;t<s;t++){v="horizonParent"+t;let r,c,p,u=new THREE.Vector3(0,0,0);u.y=360/s*t,g.id=v,g.rotation=u,b[t]=e.Core(g),E="horizonChild"+t,f.id=E,"squareWall"===h.type||(f.scale.x=1.5*l+(.1*Math.random()-.2),f.scale.y=.2*Math.random()-.4+1),"mountains"===h.type||"buildings"===h.type||"squareWall"===h.type?f.position.y=f.scale.y*d/2-1:"hills"===h.type&&(f.position.y=-1),h.texture?(n=h.baseColor?e.colorTheoryGen(h.baseColor):h.baseColorFamily?e.colorTheoryGen(!1,h.baseColorFamily):e.colorTheoryGen(),p=n.base,r={shader:"standard",side:"double",color:p},h.texture.src&&(c=Array.isArray(h.texture.src)?h.texture.src[Math.floor(Math.random()*h.texture.src.length)]:h.texture.src,r.src=c),h.texture.repeat&&(r.repeat=h.texture.repeat),h.texture.opacity&&(r.opacity=h.texture.opacity),h.texture.metalness&&(r.metalness=h.texture.metalness),h.texture.roughness&&(r.roughness=h.texture.roughness),h.texture.emissive&&(r.emissive=p),h.texture.emissiveIntensity&&(r.emissiveIntensity=h.texture.emissiveIntensity)):h.baseColor?(n=e.colorTheoryGen(h.baseColor),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}):h.baseColorFamily?(n=e.colorTheoryGen(!1,h.baseColorFamily),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}):(n=e.colorTheoryGen(),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}),f.material=r,"cylinderWall"===h.type&&(f.scale=new THREE.Vector3(1,1,1)),w[t]=e.Core(f),y["child"+t]={parent:{core:b[t]},child0:{core:w[t]}}}let x=e.Layer("horizonLayer",y);const T=()=>{h.inScene||(x.SpawnLayer(),h.inScene=!0)},R=()=>{h.inScene&&(x.DespawnLayer(),e.RemoveFromTracker(h.id),h.inScene=!1)};return{horizon:h,SpawnHorizon:T,DespawnHorizon:R,ToggleSpawn:()=>{h.inScene?R():T()},SetFlag:t=>{if(Array.isArray(t))for(let i in t)h[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:h.id,type:"horizon",sub:!1,name:t[i].flag,data:t[i].value});else h[t.flag]=t.value,e.saveToProfile({auxlObject:h.id,type:"horizon",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(h(e[i]));return t}return h[e]}}})(i,e),this.ObjsGenRing=e=>((e,t)=>{let i=Object.assign({},t);i.inScene=!1;let o,a,n,s,r,l,c,h,d,p,u,m=Object.assign({},t.objData),y=JSON.parse(JSON.stringify(t.objData));function g(e,t,i,o){return Math.sqrt(Math.pow(i-e,2)+1*Math.pow(o-t,2))}function v(e,t){return o=Math.random()*(2*e)-e,n=Math.random()*(2*e)-e,new THREE.Vector3(o,t,n)}i.all=[];const b=()=>{if(i.inScene);else{(()=>{for(let t=0;t<i.total;t++){y.id=m.id+t,i.ranColor&&(u=e.colorTheoryGen().base,y.material.color=u,y.material.emissive&&(y.material.emissive=u)),i.ranTexture&&(y.material.src=e.patterns[Math.floor(Math.random()*e.patterns.length)]),h=y.rotation.x,d=y.rotation.y,p=y.rotation.z,i.ranRotX&&(h+=360*Math.random()),i.ranRotY&&(d+=360*Math.random()),i.ranRotZ&&(p+=360*Math.random()),y.rotation=new THREE.Vector3(h,d,p),r=i.objData.scale.x,l=i.objData.scale.y,c=i.objData.scale.z,i.ranScaleX&&(r+=Math.random()*i.scaleFlex),i.ranScaleY&&(l+=Math.random()*i.scaleFlex),i.ranScaleZ&&(c+=Math.random()*i.scaleFlex),y.scale=new THREE.Vector3(r,l,c),a=i.objData.position.y,i.ranYPos&&(a+=Math.random()*i.yPosFlex),s=v(i.outerRingRadius,a),y.position=s;let o=42;e:for(;o>0;){if(0===t){if(g(s.x,s.z,0,0)<i.innerRingRadius){s=v(i.outerRingRadius,a),o--;continue e}y.position=s}for(let e=0;e<i.all.length;e++){if(g(s.x,s.z,i.all[e].core.position.x,i.all[e].core.position.z)<i.sameTypeRadius||g(s.x,s.z,0,0)<i.innerRingRadius){s=v(i.outerRingRadius,a),o--;continue e}y.position=s}break}i.all.push(e.Core(y))}})();for(let e=0;e<i.total;e++)i.all[e].SpawnCore();i.inScene=!0}},f=()=>{if(i.inScene){for(let e=0;e<i.total;e++)i.all[e].DespawnCore();e.RemoveFromTracker(i.id),i.inScene=!1}};return{singleGen:i,SpawnObjRing:b,DespawnObjRing:f,ToggleSpawn:()=>{i.inScene?f():b()},SetFlag:t=>{if(Array.isArray(t))for(let o in t)i[t[o].flag]=t[o].value,e.saveToProfile({auxlObject:i.id,type:"singleGen",sub:!1,name:t[o].flag,data:t[o].value});else i[t.flag]=t.value,e.saveToProfile({auxlObject:i.id,type:"singleGen",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let o in e)t.push(i(e[o]));return t}return i[e]}}})(i,e),this.MultiAssetGen=e=>((e,t)=>{let i=Object.assign({},t);i.inScene=!1,i.maxRadius=t.maxRadius||500,i.style=t.style||"normal",i.assets={},i.assets.tiny=[],i.assets.small=[],i.assets.med=[],i.assets.large=[],i.assets.huge=[];let o=["tiny","small","med","large","huge"];i.grid=[],i.ring0=[],i.ring1=[],i.ring2=[],i.ring3=[],i.ring4=[],i.ring5=[],t.hasOwnProperty("ring")||(i.ring={i0:5,o0:20,i1:15,o1:40,i2:30,o2:60,i3:60,o3:100,i4:80,o4:150,i5:100,o5:200});let a=[],n=[],s=[],r=[],l=[],c=[],h=x("ring5",i.ring.o5,i.ring.i5),d=x("ring4",i.ring.o4,i.ring.i4,h),p=x("ring3",i.ring.o3,i.ring.i3,d),u=x("ring2",i.ring.o2,i.ring.i2,p),m=x("ring1",i.ring.o1,i.ring.i1,u),y=(x("ring0",i.ring.o0,i.ring.i0,m),0),g=0,v=0,b=0,f=0,E=0;for(let e in a)a[e][0]-=i.ring.o5/2,a[e][1]-=i.ring.o5/2,0===a[e][0]&&0===a[e][1]&&(a[e][0]=a[e][1]=i.ring.o5/2);for(let e in n)n[e][0]-=i.ring.o4/2,n[e][1]-=i.ring.o4/2,0===n[e][0]&&0===n[e][1]&&(n[e][0]=n[e][1]=i.ring.o4/2);for(let e in s)s[e][0]-=i.ring.o3/2,s[e][1]-=i.ring.o3/2,0===s[e][0]&&0===s[e][1]&&(s[e][0]=s[e][1]=i.ring.o3/2);for(let e in r)r[e][0]-=i.ring.o2/2,r[e][1]-=i.ring.o2/2,0===r[e][0]&&0===r[e][1]&&(r[e][0]=r[e][1]=i.ring.o2/2);for(let e in l)l[e][0]-=i.ring.o1/2,l[e][1]-=i.ring.o1/2,0===l[e][0]&&0===l[e][1]&&(l[e][0]=l[e][1]=i.ring.o1/2);for(let e in c)c[e][0]-=i.ring.o0/2,c[e][1]-=i.ring.o0/2,0===c[e][0]&&0===c[e][1]&&(c[e][0]=c[e][1]=i.ring.o0/2);function w(e){e.sort((()=>Math.random()-.5))}function x(e,t,i,o){let h,d;d=!!o&&o.center;let p=function*(d,p,u,m){const y=u*u,g=u*Math.SQRT1_2,v=Math.ceil(d/g),b=Math.ceil(p/g);let f=[];if(h=new Array(v*b),o)for(let e in o)h[e]=o[e],f[e]=o[e];m?yield{add:w(m,m)}:yield{add:w(d/2,p/2)};e:for(;f.length;){const e=Math.trunc(Math.random()*f.length),o=f[e],a=Math.random(),n=1e-7;for(let e=0;e<15;++e){const s=2*Math.PI*(a+1*e/15),r=u+n,l=o[0]+r*Math.cos(s),c=o[1]+r*Math.sin(s);if(i<=l&&l<t&&i<=c&&c<t&&E(l,c)){yield{add:w(l,c),parent:o};continue e}}const s=f.pop();e<f.length&&(f[e]=s),yield{remove:o}}function E(e,t){const i=Math.trunc(e/g),o=Math.trunc(t/g),a=Math.max(i-2,0),n=Math.max(o-2,0),s=Math.min(i+3,v),r=Math.min(o+3,b);for(let i=n;i<r;++i){const o=i*v;for(let i=a;i<s;++i){const a=h[o+i];if(a){const i=a[0]-e,o=a[1]-t;if(i*i+o*o<y)return!1}}}return!0}function w(t,i,o){const d=h[v*Math.trunc(i/g)+Math.trunc(t/g)]=[t,i];return f.push(d),"ring5"===e?a.push(d):"ring4"===e?n.push(d):"ring3"===e?s.push(d):"ring2"===e?r.push(d):"ring1"===e?l.push(d):"ring0"===e&&c.push(d),d}}(t,t,i,d);!function e(){p.done=p.next().done,p.done||e()}();let u=[];for(let e in h)h[e]&&u.push(h[e]);return u}w(a),w(n),w(s),w(r),w(l),w(c);const T=()=>{if(i.inScene);else{(()=>{for(let t in o){let h=Object.assign({},i[o[t]]);for(let d in h.objs){let p,u,m,w,x,T,R,k,D,C,M=Object.assign({},h.objs[d]),S=JSON.parse(JSON.stringify(h.objs[d]));M.hasOwnProperty("position")||(M.position=new THREE.Vector3),M.hasOwnProperty("rotation")||(M.rotation=new THREE.Vector3),M.hasOwnProperty("scale")||(M.scale=new THREE.Vector3(1,1,1));for(let d=0;d<h.max/h.objs.length;d++)S.id=M.id+d,h.ranColor&&(C=e.colorTheoryGen().base,S.material.color=C,S.material.emissive&&(S.material.emissive=C)),h.ranTexture&&(S.material.src=e.patterns[Math.floor(Math.random()*e.patterns.length)]),R=M.rotation.x,k=M.rotation.y,D=M.rotation.z,h.ranRotX&&(R+=360*Math.random()),h.ranRotY&&(k+=360*Math.random()),h.ranRotZ&&(D+=360*Math.random()),S.rotation=new THREE.Vector3(R,k,D),w=M.scale.x,x=M.scale.y,"tall"===i.style&&(x*=40),T=M.scale.z,h.ranScaleX&&(w+=Math.random()*h.scaleFlex),h.ranScaleY&&(x+=Math.random()*h.scaleFlex,h.scaleFlexY&&(x+=Math.random()*h.scaleFlexY)),h.ranScaleZ&&(T+=Math.random()*h.scaleFlex),S.scale=new THREE.Vector3(w,x,T),u=M.position.y,h.ranYPos&&(u+=Math.random()*h.yPosFlex),0===h.rings?E<c.length?(p=c[E][0],m=c[E][1],E++):(p=Math.random()*(2*i.ring.o0)-i.ring.o0+i.ring.i0,m=Math.random()*(2*i.ring.o0)-i.ring.o0+i.ring.i0):1===h.rings?f<l.length?(p=l[f][0],m=l[f][1],f++):(p=Math.random()*(2*i.ring.o1)-i.ring.o1+i.ring.i1,m=Math.random()*(2*i.ring.o1)-i.ring.o1+i.ring.i1):2===h.rings?b<r.length?(p=r[b][0],m=r[b][1],b++):(p=Math.random()*(2*i.ring.o2)-i.ring.o2+i.ring.i2,m=Math.random()*(2*i.ring.o2)-i.ring.o2+i.ring.i2):3===h.rings?v<s.length?(p=s[v][0],m=s[v][1],v++):(p=Math.random()*(2*i.ring.o3)-i.ring.o3+i.ring.i3,m=Math.random()*(2*i.ring.o3)-i.ring.o3+i.ring.i3):4===h.rings?g<n.length?(p=n[g][0],m=n[g][1],g++):(p=Math.random()*(2*i.ring.o4)-i.ring.o4+i.ring.i4,m=Math.random()*(2*i.ring.o4)-i.ring.o4+i.ring.i4):5===h.rings&&(y<a.length?(p=a[y][0],m=a[y][1],y++):(p=Math.random()*(2*i.ring.o5)-i.ring.o5+i.ring.i5,m=Math.random()*(2*i.ring.o5)-i.ring.o5+i.ring.i5)),S.position=new THREE.Vector3(p,u,m),i.assets[o[t]].push(e.Core(S))}}})();for(let e in o){let t=i.assets[o[e]];for(let e in t)t[e].core?t[e].SpawnCore():t[e].layer&&t[e].SpawnLayer()}i.inScene=!0}},R=()=>{if(i.inScene){for(let e in o){let t=i.assets[o[e]];for(let e in t)t[e].core?t[e].DespawnCore():t[e].layer&&t[e].DespawnLayer()}e.RemoveFromTracker(i.id),i.inScene=!1}};return{multiGen:i,SpawnMultiAsset:T,DespawnMultiAsset:R,ToggleSpawn:()=>{i.inScene?R():T()},SetFlag:t=>{if(Array.isArray(t))for(let o in t)i[t[o].flag]=t[o].value,e.saveToProfile({auxlObject:i.id,type:"multiGen",sub:!1,name:t[o].flag,data:t[o].value});else i[t.flag]=t.value,e.saveToProfile({auxlObject:i.id,type:"multiGen",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let o in e)t.push(i(e[o]));return t}return i[e]}}})(i,e),this.Teleport=(e,t)=>((e,t,i)=>{let o,a,n={};n.id=t,n.inScene=!1,n.all=[];let s,r,l,c="",h="",d="";for(let t in i)l=e.colorTheoryGen().base,c="teleport"+t+"Parent",e.teleportParentData.id=c,e.teleportParentData.position=i[t],a=e.Core(e.teleportParentData),h="teleport"+t+"Confirm",e.teleportConfirmData.id=h,e.teleportConfirmData.material.color=l,e.teleportConfirmData.material.emissive=l,s=e.Core(e.teleportConfirmData),d="teleport"+t+"Cancel",e.teleportCancelData.id=d,e.teleportCancelData.material.color=l.compl,e.teleportCancelData.material.emissive=l.compl,r=e.Core(e.teleportCancelData),o={parent:{core:a},child0:{core:s},child1:{core:r}},n.all[t]=e.Layer("teleport"+t,o);const p=()=>{if(n.inScene);else{for(let e in n.all)n.all[e].SpawnLayer();n.inScene=!0}},u=()=>{if(n.inScene){for(let e in n.all)n.all[e].DespawnLayer();e.RemoveFromTracker(n.id),n.inScene=!1}};return{teleport:n,SpawnTeleport:p,DespawnTeleport:u,ToggleSpawn:()=>{n.inScene?u():p()},SetFlag:t=>{if(Array.isArray(t))for(let i in t)n[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:n.id,type:"teleport",sub:!1,name:t[i].flag,data:t[i].value});else n[t.flag]=t.value,e.saveToProfile({auxlObject:n.id,type:"teleport",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(n(e[i]));return t}return n[e]}}})(i,e,t),this.Book=(e,t)=>((e,t,i)=>{let o=0,a=0,n=0;for(let e in t.pages)n+=Object.keys(t.pages[e]).length-1;let s=t.pages["page"+a].info.timeline,r=t.idle.page0.info.timeline,l=Object.keys(t.pages.page0).length,c=Math.floor(Math.random()*l-1)+1,h=0,d=Object.keys(t.idle.page0).length,p=Math.floor(Math.random()*d-1)+1,u=0;const m=(t,o,a)=>{"self"===t&&(t=i.id);for(let a in e.objGenTracking)o!==e.objGenTracking[a].spawn&&o!==e.objGenTracking[a].altSpawn||e.spawnTracker(t,"book",i.id);e[t][o](a)};function*y(a,s){if(o++,o>=n){if(t.jumping)return console.log({msg:"reset",npc:i,bookData:t}),void e[i.id].BackwardJump();i.bookEnd=!0}else i.bookEnd=!1;for(let t in s)if("id"===t||"description"===t||"tags"===t||"nextPage"===t||"prevPage"===t||"timeline"===t);else if("pureFunction"===t)e[t](s[t]);else for(let e in s[t])m(t,e,s[t][e]);yield}function*g(e,i){for(let o in i)e.currentTimeline=o,e.timelineQue.push([o,i[o]]),o===t.jumpTo&&(t.jumping=!1),t.jumping||(yield*y(0,i[o]))}let v=function*(e){e.currentTimeline=0,e.currentEntry=0,e.currentDialog=0,e.pageQue=[],e.timelineQue=[],e.entryQue=[],e.textBubbleQue=[],e.speaker="",e.speaking=!1,e.jumping=!1,e.jumpTo,e.selectJumpMenu,o=0,i.bookEnd=!1,yield*function*(e){for(let t in e.pages)e.currentPage=t,e.pageQue.push([t,e.pages[t]]),yield*g(e,e.pages[t])}(e)}(t);function*b(t,i){for(let t in i)if("id"===t||"description"===t||"tags"===t||"nextPage"===t||"prevPage"===t||"timeline"===t);else if("pureFunction"===t)e[t](i[t]);else for(let e in i[t])m(t,e,i[t][e]);yield}function*f(e,i){for(let o in i)e.currentTimeline=o,e.timelineQue.push([o,i[o]]),o===t.jumpTo&&(t.jumping=!1),t.jumping||(yield*b(0,i[o]))}let E=!1;t.idle&&(E=function*(e){e.currentPage=0,e.currentTimeline=0,e.currentEntry=0,e.currentDialog=0,e.pageQue=[],e.timelineQue=[],e.entryQue=[],e.textBubbleQue=[],e.speaker="",e.speaking=!1,e.jumping=!1,e.jumpTo,e.selectJumpMenu,yield*function*(e){for(let t in e.idle)e.currentPage=t,e.pageQue.push([t,e.idle[t]]),yield*f(e,e.idle[t])}(e)}(t));const w=e=>{"random"===s&&x(e),v.done=v.next().done;let t=setTimeout((()=>{i.loadingTimeline=!1,clearTimeout(t)}),750)},x=t=>{if(t)c=t;else{for(c=Math.floor(Math.random()*l);c>=l-1||c===h;)c=Math.floor(Math.random()*l-1)+1;c<=h&&e[i.id].ResetBookRandom(!0)}k({timeline:"timeline"+c,page:"page"+a}),h=c},T=t=>{if(t)p=t;else{for(p=Math.floor(Math.random()*d)+1;p>=d-1||p===u;)p=Math.floor(Math.random()*d-1)+1;p<=u&&e[i.id].ResetIdleRandom(!0,p)}R({timeline:"timeline"+p,page:"page0"}),u=p},R=({timeline:e,page:i})=>{let o=i||t.currentPage;t.jumpTo=e,t.idle[o][t.jumpTo]&&(t.jumping=!0)},k=({timeline:e,page:o,now:a})=>{let n=o||t.currentPage;t.jumpTo=e,t.pages[n][t.jumpTo]?(t.jumping=!0,i.jumpData={timeline:e,page:n}):console.log({msg:"Failed to jump to",page:o,timeline:e,now:a}),a&&(v.done=v.next().done)};return{bookData:t,book:v,idleBook:E,Init:e=>{if(v.done=v.next().done,e){let t=setTimeout((()=>{k({now:!0,...e}),clearTimeout(t)}),100)}else v.done=v.next().done;i.loadingTimeline=!1},Next:w,NewPage:({page:e,timeline:i})=>{let o;e?o=e:(a+=1,o="page"+a),k({timeline:i||"timeline0",page:o});let n=setTimeout((function(){w(),clearTimeout(n)}),250);s=t.pages["page"+a].info.timeline},Random:x,IdleInit:()=>{E.done=E.next().done,i.loadingTimeline=!1},IdleNext:e=>{"random"===r&&T(e),E.done=E.next().done;let t=setTimeout((function(){i.loadingTimeline=!1,clearTimeout(t)}),1e3)},RandomIdle:T,Jump:k,JumpIdle:R,SelectJump:o=>{let a=(new THREE.Vector3).copy(e[i.id].GetMainNPCEl().getAttribute("position")),n=new THREE.Vector3;t.info.offset&&n.copy(t.info.offset),a.add(n);let s={id:"selectJumpMenu",prompt:o[0],options:{},actions:{},data:e.menuBaseData,cursorObj:i.id,pos:a,method:"Click"};for(let e=1;e<o.length;e++)s.options["option"+(e-1)]=o[e][0],s.actions["action"+(e-1)]=o[e][1];if(i.selectJumpMenu=e.Menu(s),i.selectJumpMenu.SpawnMenu(),i.selectJumpMenu.AddToParentSpawnTracker(i.selectJumpMenu,i,"book"),"core"===i.bubble.type?i.bubble.GetEl().classList.toggle("clickable",!1):i.bubble.GetParentEl().classList.toggle("clickable",!1),"core"===i.avatarType)i.avatar.GetEl().classList.toggle("clickable",!1);else{let e=i.avatar.GetAllEl();for(let t in e)e[t].classList.toggle("clickable",!1)}},readTimeline:function({page:i,time:o}){for(let a in t.pages[i][o])if("pureFunction"===a)e[a](o[a]);else for(let n in t.pages[i][o][a])e[a][n](t.pages[i][o][a][n])}}})(i,e,t),this.SpeechSystem=(e,t,o)=>h(i,e,t),this.NPC=(e,t,o,a,n)=>((e,t,i,o,a,n)=>{let s,r={};r.avatar=Object.assign({},i),r.avatarType,r.parentId,i.SpawnCore?(r.avatarType="core",r.parentId=i.core.id):i.SpawnLayer&&(r.avatarType="layer",r.parentId=i.layer.all.parent.core.core.id),r.id=t,r.special=n||!0,r.inScene=!1,r.speaking=!1,r.jumpData={page:"page0",timeline:"timeline0"},r.bookEnd=!1,r.idle=!1,r.idleSpeech=!1,r.loadingTimeline=!1,o.info.name?r.name=o.info.name:r.name=r.id,r.bubble=Object.assign({},a),r.bubble.blink=!0;let l,c,h=e.SpeechSystem(r.bubble,r);o.idle&&(r.idleSpeech=!0);let d,p,u=o.info.idleDelay||7e3,m=o.info.idleInterval||1e4;const y=(e,t)=>{if("core"===r.avatarType)r.avatar.GetEl().addEventListener(e,t);else{let i=r.avatar.GetAllEl();for(let o in i)i[o].addEventListener(e,t)}},g=(e,t)=>{if("core"===r.avatarType)r.avatar.GetEl().removeEventListener(e,t);else{let i=r.avatar.GetAllEl();for(let o in i)i[o].removeEventListener(e,t)}},v=(e,t)=>{if("core"===r.avatarType)r.avatar.GetEl().addEventListener(e,t);else{let i=r.avatar.GetAllChildEl();for(let o in i)i[o].addEventListener(e,t)}},b=(e,t)=>{if("core"===r.avatarType)r.avatar.GetEl().removeEventListener(e,t);else{let i=r.avatar.GetAllChildEl();for(let o in i)i[o].removeEventListener(e,t)}},f=t=>{if(r.inScene);else{let i=t||!1;s=e.Book(o,r),"core"===r.avatarType?r.avatar.SpawnCore(i):r.avatar.SpawnLayer(i),l=setTimeout((()=>{r.special?v("mouseenter",x):y("mouseenter",x),clearTimeout(l)}),25),r.idleSpeech&&(c=setTimeout((()=>{k(),clearTimeout(c)}),u)),r.inScene=!0}},E=()=>{r.inScene&&(w(),clearTimeout(l),clearTimeout(c),T(),D(),r.speaking?r.special?b("mouseenter",R):g("mouseenter",R):r.special?b("mouseenter",x):g("mouseenter",x),"core"===r.avatarType?r.avatar.DespawnCore():r.avatar.DespawnLayer(),e.RemoveFromTracker(r.id),r.inScene=!1)},w=()=>{e.clearSpawned(e.bookSpawned[r.id]),delete e.bookSpawned[r.id]},x=()=>{r.idle&&D(),clearTimeout(c),r.speaking=!0,r.special?b("mouseenter",x):g("mouseenter",x),h.Start(),s.Init(),r.special?v("mouseenter",R):y("mouseenter",R)},T=()=>{h.KillStop(),r.special?b("mouseenter",R):g("mouseenter",R)},R=e=>{h.core.on?h.core.speaking||r.loadingTimeline||(r.loadingTimeline=!0,s.Next(e)):r.loadingTimeline||(r.loadingTimeline=!0,s.Next(e))},k=()=>{r.idle=!0,h.Start(),s.IdleInit(),C(),d=setInterval((()=>{C()}),m)},D=()=>{clearInterval(d),r.idle=!1},C=e=>{h.core.on?h.core.speaking||r.loadingTimeline||(r.loadingTimeline=!0,s.IdleNext(e)):r.loadingTimeline||(r.loadingTimeline=!0,s.IdleNext(e))},M=({timeline:e,page:t,now:i})=>{s.Jump({timeline:e,page:t,now:i})},S=(t,i,o)=>{"self"===t&&(t=r.id),e[t][i](o)};return{npc:r,GetAllNPCEl:()=>{let e;return e="core"===r.avatarType?r.avatar.GetEl():r.avatar.GetAllEl(),e},GetMainNPCEl:()=>{let e;return e="core"===r.avatarType?r.avatar.GetEl():r.avatar.GetParentEl(),e},AddNPCEventsAll:y,RemoveNPCEventsAll:g,SpawnNPC:f,DespawnNPC:E,ToggleSpawn:()=>{r.inScene?E():f()},EnableSpeech:x,DisableSpeech:T,EnableIdleSpeech:k,DisableIdleSpeech:D,Speak:({role:e,speech:t})=>{e?"self"===e&&(e=r.name):e=r.name,h.DisplaySpeech({role:e,speech:t})},NextTimeline:R,NewPage:({page:e,timeline:t})=>{s.NewPage({page:e,timeline:t})},ResetSpeech:()=>{if(r.selectJumpMenu&&r.selectJumpMenu.menu.inScene)if(r.selectJumpMenu.DespawnMenu(),"core"===r.bubble.type?r.bubble.GetEl().classList.toggle("clickable",!0):r.bubble.GetParentEl().classList.toggle("clickable",!0),"core"===r.avatarType)r.avatar.GetEl().classList.toggle("clickable",!0);else{let e=r.avatar.GetAllEl();for(let t in e)e[t].classList.toggle("clickable",!0)}T(),w(),s=e.Book(o,r),r.special?v("mouseenter",x):y("mouseenter",x)},ResetBook:t=>{(s.book.done||t)&&(w(),s=e.Book(o,r),s.Init())},ForceResetBook:()=>{w(),s=e.Book(o,r),s.Init()},ResetBookRandom:(t,i)=>{(s.book.done||t)&&(w(),s=e.Book(o,r),s.Init(),R(i))},IdleNextTimeline:C,IdleReset:t=>{(s.idleBook.done||t)&&(w(),s=e.Book(o,r),s.IdleInit())},ResetIdleRandom:(t,i)=>{(s.idleBook.done||t)&&(w(),s=e.Book(o,r),s.IdleInit(),C(i))},UpdateBook:()=>{console.log(o),console.log(o.pages),console.log(o.idle)},Click:e=>{h.Skip();let t=e.getAttribute("result");if(M({timeline:t}),s.Next(),"core"===r.bubble.type?r.bubble.GetEl().classList.toggle("clickable",!0):r.bubble.GetParentEl().classList.toggle("clickable",!0),"core"===r.avatarType)r.avatar.GetEl().classList.toggle("clickable",!0);else{let e=r.avatar.GetAllEl();for(let t in e)e[t].classList.toggle("clickable",!0)}p=setTimeout((function(){r.selectJumpMenu.DespawnMenu(),r.selectJumpMenu.RemoveMenuFromSceneTracker(),clearTimeout(p)}),250)},Jump:M,BackwardJump:(t,i)=>{t&&(r.jumpData=t),i&&w(),s=e.Book(o,r),s.Init(r.jumpData)},SelectJump:e=>{s.SelectJump(e)},auxlObjMethod:S,IfElse:t=>{let i=Object.keys(t)[0],o=t[i].cond,a=t[i].ifTrue,n=t[i].ifFalse;if("self"===i&&(i=r.id),e[i].GetFlag)if(e[i].GetFlag(o))for(let e in a)for(let t in a[e])S(e,t,a[e][t]);else for(let e in n)for(let t in n[e])S(e,t,n[e][t]);else if(e[i].GetFlagParent)if(e[i].GetFlagParent(o))for(let e in a)for(let t in a[e])S(e,t,a[e][t]);else for(let e in n)for(let t in n[e])S(e,t,n[e][t])},Switch:t=>{let i=Object.keys(t)[0],o=t[i];"self"===i&&(i=r.id);let a=[];for(let e in o)"cond"===e||"default"===e||a.push(e);if(e[i].GetFlag){let t=e[i].GetFlag(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])S(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])S(e,t,o.default[e][t])}else if(e[i].GetFlagParent){let t=e[i].GetFlagParent(o.cond);for(let e in a)if(t===a[e]){for(let t in o[a[e]])for(let i in o[a[e]][t])S(t,i,o[a[e]][t][i]);return}for(let e in o.default)for(let t in o.default[e])S(e,t,o.default[e][t])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},SetFlag:t=>{if(Array.isArray(t))for(let i in t)r[t[i].flag]=t[i].value,e.saveToProfile({auxlObject:r.id,type:"npc",sub:!1,name:t[i].flag,data:t[i].value});else r[t.flag]=t.value,e.saveToProfile({auxlObject:r.id,type:"npc",sub:!1,name:t.flag,data:t.value})},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(r(e[i]));return t}return r[e]}}})(i,e,t,o,a,n),this.InfoBubble=(e,t,o,a)=>((e,t,i,o,a)=>{let n={};n.id=t;let s=n.id+"bubble",r=n.id+"text";n.parent=i,i.SpawnCore?n.parentType="core":i.SpawnLayer&&(n.parentType="layer"),n.custom={},n.inScene=!1,n.position=new THREE.Vector3(0,.5,0),n.rotation=new THREE.Vector3(0,0,0),n.color=a||"#14d9a4",o&&(o.x?(n.position.x=o.x,n.position.y=o.y,n.position.z=o.z):n.position.y=o),n.infoBubbleData={data:"infoBubbleData",id:s,sources:!1,sounds:{maximize:{src:e.maximize6,autoplay:!0,loop:!1,volume:.75},minimize:{src:e.minimize6,autoplay:!1,loop:!1,volume:.75,on:"spawnOut"}},text:!1,geometry:{primitive:"circle",radius:.3,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:n.color,opacity:1,metalness:.2,roughness:.8,emissive:n.color,emissiveIntensity:.6,side:"double"},position:n.position,rotation:n.rotation,scale:new THREE.Vector3(.01,.01,.01),animations:{spawnin:{property:"scale",from:"0.01 0.01 0.01",to:"1 1 1",dur:1500,delay:500,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!0,enabled:!0},spawnout:{property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},n[s]=e.Core(n.infoBubbleData),n.emotiTextData={data:"emotiTextData",id:r,sources:!1,text:{value:"!",wrapCount:2,color:"#FFFFFF",font:"exo2bold",zOffset:0,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(.025,.1,.025),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},n[r]=e.Core(n.emotiTextData),n.emotiLayerData={parent:{core:n[s]},child0:{core:n[r]}},n[n.id]=e.Layer(n.id,n.emotiLayerData);const l=()=>{n.inScene||(n[n.id].layer.all.parent.core.core.animations.spawnout={property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0},n[n.id].SpawnLayer(n.parent),n.inScene=!0,n.soundTimeout=setTimeout((()=>{n[n.id].EmitEventParent("spawnOut"),clearTimeout(n.soundTimeout)}),3e3),n.timeout=setTimeout((()=>{c(),clearTimeout(n.timeout)}),4050))},c=()=>{n.inScene&&(n[n.id].DespawnLayer(),n.inScene=!1,e.RemoveFromTracker(n.id))},h=()=>{n.inScene||(n[n.id].layer.all.parent.core.core.animations.spawnout={property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"spawnOut"},n[n.id].SpawnLayer(n.parent),n.inScene=!0,u("mouseenter",d))},d=()=>{n.inScene&&(m("mouseenter",d),n[n.id].EmitEventParent("spawnOut"),n.timeout=setTimeout((()=>{c(),e.RemoveFromTracker(n.id),clearTimeout(n.timeout)}),1050))},p=(e,t,i)=>{n[r].core.text.value=e,n[r].core.text.wrapCount=e.length+2,i?(i.x?n[r].core.text.xOffset=i.x:n[r].core.text.xOffset=0,i.x?n[r].core.text.yOffset=i.y:n[r].core.text.yOffset=0):(n[r].core.text.xOffset=0,n[r].core.text.zOffset=0),n[r].core.rotation.z=t||0},u=(e,t)=>{"core"===n.parentType?n.parent.GetEl().addEventListener(e,t):n.parent.GetParentEl().addEventListener(e,t)},m=(e,t)=>{"core"===n.parentType?n.parent.GetEl().removeEventListener(e,t):n.parent.GetParentEl().removeEventListener(e,t)},y=e=>{for(let t in n.custom)if(e.type===t){n.custom[t].rotation?p(n.custom[t].text,n.custom[t].rotation,n.custom[t].offset):p(n.custom[t].text),n.custom[t].alert?h():l();break}},g=()=>{p("!"),l()},v=()=>{p("!"),h()},b=()=>{p("?"),l()},f=()=>{p("?"),h()},E=()=>{p(":)",-90),l()},w=()=>{p("^-^"),l()},x=()=>{p("@"),l()},T=()=>{p("^^"),l()},R=()=>{p('"'),l()},k=()=>{p("*"),l()},D=()=>{p("?"),l()},C=()=>{p("%"),l()},M=()=>{p("zzz"),l()},S=()=>{p("+"),l()},P=()=>{p("~"),l()},L=()=>{p("!"),l()},H=()=>{p("="),l()},A=()=>{p("$"),l()},z=()=>{p("<3\n",90,{x:-.1}),l()},I=()=>{p("#"),l()};return"core"===n.parentType?(0===Object.keys(n.parent.core.components).length&&(n.parent.core.components={}),n.parent.core.components.onspawnrun__emote={cursorObj:n.id,component:null,method:"AddEmotes",params:null},n.parent.core.components.ondespawnrun__emote={cursorObj:n.id,component:null,method:"RemoveEmotes",params:null}):(0===Object.keys(n.parent.layer.all.parent.core.core.components).length&&(n.parent.layer.all.parent.core.core.components={}),n.parent.layer.all.parent.core.core.components.onspawnrun__emote={cursorObj:n.id,component:null,method:"AddEmotes",params:null},n.parent.layer.all.parent.core.core.components.ondespawnrun__emote={cursorObj:n.id,component:null,method:"RemoveEmotes",params:null}),{infoBubble:n,AddEmotes:()=>{u("alert1",v),u("alert2",f),u("emote1",g),u("emote2",b),u("emote3",E),u("emote4",w),u("casual",x),u("happy",T),u("sad",R),u("angry",k),u("confused",D),u("tired",C),u("asleep",M),u("annoyed",S),u("smug",P),u("shocked",L),u("scared",H),u("confident",A),u("love",z),u("shy",I);for(let e in n.custom)u(e,y)},RemoveEmotes:()=>{n.inScene&&(clearTimeout(n.soundTimeout),clearTimeout(n.timeout),c()),m("alert1",v),m("alert2",f),m("emote1",g),m("emote2",b),m("emote3",E),m("emote4",w),m("casual",x),m("happy",T),m("sad",R),m("angry",k),m("confused",D),m("tired",C),m("asleep",M),m("annoyed",S),m("smug",P),m("shocked",L),m("scared",H),m("confident",A),m("love",z),m("shy",I);for(let e in n.custom)m(e,y)},NewBubble:e=>{n.custom[e.eventName]=e}}})(i,e,t,o,a),this.Creature=(e,t,o)=>((e,t,i,o)=>{let a={};a.id=t,a.auxlId=t+"layer",a.bubbleId=t+"bubble",a.parent=i||!1,a.inScene=!1;let n="parent"+a.id,s="head"+a.id,r="eye1Socket"+a.id,l="eyebrow1"+a.id,c="eye1Pupil"+a.id,h="eye1PupilAccent"+a.id,d="eye1Blink"+a.id,p="eye1LidOffset"+a.id,u="eye1Lid"+a.id,m="eye2Socket"+a.id,y="eyebrow2"+a.id,g="eye2Pupil"+a.id,v="eye2PupilAccent"+a.id,b="eye2Blink"+a.id,f="eye2LidOffset"+a.id,E="eye2Lid"+a.id,w="ear1Offset"+a.id,x="ear1"+a.id,T="ear2Offset"+a.id,R="ear2"+a.id,k="body"+a.id,D=(a.id,"leg1"+a.id),C="leg2"+a.id,M="leg3"+a.id,S="leg4"+a.id;a.id,a.custom=o||!1;let P=!1,L=["egg","circle","square","rectangle","triangle"],H=!1,A=["egg","circle","square","rectangle","triangle"],z=!1,I=["*","!","x","&","<3","z"],O=!1,N=["bun","bunny","mouse","ant","horn"];a.custom&&(a.custom.eye&&(P=a.custom.eye),a.custom.pupil&&(H=a.custom.pupil),a.custom.accent&&(z=a.custom.accent),a.custom.ear&&(O=a.custom.ear)),P||(P=L[Math.floor(Math.random()*L.length)]),H||(H=A[Math.floor(Math.random()*A.length)]),z||(z=I[Math.floor(Math.random()*I.length)]),O||(O=N[Math.floor(Math.random()*N.length)]),a.position=new THREE.Vector3(0,3,-3),a.rotation=new THREE.Vector3(0,0,0),a.scale=new THREE.Vector3(1,1,1),a.custom&&(o.offset&&(o.offset.x?(a.position.x=o.offset.x,a.position.y=o.offset.y,a.position.z=o.offset.z):a.position.z=o.offset),o.rotation&&(o.rotation.x?(a.rotation.x=o.rotation.x,a.rotation.y=o.rotation.y,a.rotation.z=o.rotation.z):a.rotation.y=o.rotation),o.scale&&(o.scale.x?(a.scale.x=o.scale.x,a.scale.y=o.scale.y,a.scale.z=o.scale.z):a.scale.y=o.scale)),a.color=e.colorTheoryGen(!1,!0),a.pupilColor=a.color.base,a.pupilMaterial={shader:"standard",color:a.pupilColor,emissive:a.pupilColor,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.skinColor0=a.color.splitCompl[1],a.skinMaterial={shader:"standard",color:a.skinColor0,emissive:a.skinColor0,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.skinColor1=e.colorTheoryGen(a.skinColor0).base,a.browMaterial={shader:"standard",color:a.skinColor1,emissive:a.skinColor1,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.accentColor="white",a.accentText={value:z,wrapCount:3,color:a.accentColor,font:"exo2bold",side:"double",align:"center",baseline:"center",zOffset:.0175};let F=Math.random();a.custom&&("small"===o.browSize?F=0:"medium"===o.browSize?F=.5:"large"===o.browSize&&(F=1)),a.browThickness=.04*F+.01;let V=Math.random();a.custom&&("small"===o.eyeSize?V=0:"medium"===o.eyeSize?V=.5:"large"===o.eyeSize&&(V=1));let j=.08*V+.125,B={primitive:"cylinder",radius:j,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},G=new THREE.Vector3(.75,1,1),U={primitive:"cylinder",radius:j,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},q=new THREE.Vector3(0,0,j),W=new THREE.Vector3(0,0,-1*j),_={primitive:"cylinder",radius:j,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},J={primitive:"cylinder",radius:j/3,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},K=.0575*V+.1,Z={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},X=new THREE.Vector3(1,1,1),Q={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Y=new THREE.Vector3(0,0,K),$=new THREE.Vector3(0,0,-1*K),ee={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},te={primitive:"cylinder",radius:K/3,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},ie=.125*V+.175,oe={primitive:"box",depth:ie,width:ie,height:.015},ae=new THREE.Vector3(1,1,1),ne={primitive:"box",depth:ie,width:ie,height:.015},se=new THREE.Vector3(0,0,ie),re=new THREE.Vector3(0,0,-1*ie),le={primitive:"box",depth:ie,width:ie,height:.015},ce={primitive:"box",depth:ie/3,width:ie/3,height:.015},he=.25*V+.225,de=.66*he,pe={primitive:"box",depth:he,width:de,height:.015},ue=new THREE.Vector3(1,1,1),me={primitive:"box",depth:he,width:de,height:.015},ye=new THREE.Vector3(0,0,de),ge=new THREE.Vector3(0,0,-1*de),ve={primitive:"box",depth:he,width:de,height:.015},be={primitive:"box",depth:he/3,width:de/3,height:.015},fe=.15*V+.1,Ee={primitive:"triangle",vertexA:new THREE.Vector3(0,0,fe),vertexB:new THREE.Vector3(-1*fe,0,-1*fe),vertexC:new THREE.Vector3(fe,0,-1*fe)},we=new THREE.Vector3(1,1.5,1),xe={primitive:"triangle",vertexA:new THREE.Vector3(0,0,fe),vertexB:new THREE.Vector3(-1*fe,0,-1*fe),vertexC:new THREE.Vector3(fe,0,-1*fe)},Te=new THREE.Vector3(0,.05,fe),Re=new THREE.Vector3(0,0,-1*fe),ke={primitive:"triangle",vertexA:new THREE.Vector3(0,0,fe),vertexB:new THREE.Vector3(-1*fe,0,-1*fe),vertexC:new THREE.Vector3(fe,0,-1*fe)},De={primitive:"triangle",vertexA:new THREE.Vector3(0,0,.33*fe),vertexB:new THREE.Vector3(-.33*fe,0,-.33*fe),vertexC:new THREE.Vector3(.33*fe,0,-.33*fe)},Ce=.05*V+.075;"egg"===H?a.pupilShape=J:"circle"===H?a.pupilShape=te:"square"===H?a.pupilShape=ce:"rectangle"===H?a.pupilShape=be:"triangle"===H&&(a.pupilShape=De),"egg"===P?(a.socketShape=B,a.socketScale=G,a.lidShape=U,a.lidPosition=q,a.lidOffsetPosition=W,a.blinkShape=_,a.blinkAnim={property:"object3D.scale.z",from:.65,to:1.3,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"flux",pauseEvents:"stopFlux"},a.wideAnim={property:"object3D.scale.z",to:.5,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"wide"},a.normalAnim={property:"object3D.scale.z",to:.65,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"normal"},a.squintAnim={property:"object3D.scale.z",to:1.3,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"squint"},a.tiredAnim={property:"object3D.scale.z",to:1.1,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"tired"}):"circle"===P?(a.socketShape=Z,a.socketScale=X,a.lidShape=Q,a.lidPosition=Y,a.lidOffsetPosition=$,a.blinkShape=ee,a.blinkAnim={property:"object3D.scale.z",from:.65,to:1.3,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"square"===P?(a.socketShape=oe,a.socketScale=ae,a.lidShape=ne,a.lidPosition=se,a.lidOffsetPosition=re,a.blinkShape=le,a.blinkAnim={property:"object3D.scale.z",from:.45,to:.8,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"rectangle"===P?(a.socketShape=pe,a.socketScale=ue,a.lidShape=me,a.lidPosition=ye,a.lidOffsetPosition=ge,a.blinkShape=ve,a.blinkAnim={property:"object3D.scale.z",from:.35,to:.75,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"triangle"===P&&(a.socketShape=Ee,a.socketScale=we,a.lidShape=xe,a.lidPosition=Te,a.lidOffsetPosition=Re,a.blinkShape=ke,a.blinkAnim={property:"object3D.scale.z",from:.325,to:.6,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0});let Me=Math.random();a.custom&&("small"===o.earSize?Me=0:"medium"===o.earSize?Me=.5:"large"===o.earSize&&(Me=1));let Se=.15*Me+.1,Pe=new THREE.Vector3(-.25,.5,.4),Le=new THREE.Vector3(.25,.5,.4),He=new THREE.Vector3(.9,1,.9),Ae={primitive:"cylinder",radius:Se,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},ze=new THREE.Vector3(0,0,.175),Ie=new THREE.Vector3(1,1,1),Oe=.1*Me+.15,Ne=new THREE.Vector3(-.25,.5,.4),Fe=new THREE.Vector3(.25,.5,.4),Ve=new THREE.Vector3(.5,1,.5),je={primitive:"cylinder",radius:Oe,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Be=new THREE.Vector3(0,0,.175),Ge=new THREE.Vector3(1,1,5),Ue=.175*Me+.075,qe=new THREE.Vector3(-.125,.51,.4),We=new THREE.Vector3(.125,.51,.4),_e=new THREE.Vector3(.5,1,.5),Je={primitive:"cylinder",radius:Ue,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Ke=new THREE.Vector3(0,0,.175),Ze=new THREE.Vector3(.35,.35,6),Xe=.2*Me+.125,Qe=new THREE.Vector3(-.25,.5,.4),Ye=new THREE.Vector3(.25,.5,.4),$e=new THREE.Vector3(.5,1,.5),et={primitive:"cylinder",radius:Xe,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},tt=new THREE.Vector3(0,0,.175),it=new THREE.Vector3(.4,.4,2),ot=.15*Me+.1,at=new THREE.Vector3(-.325,.625,.4),nt=new THREE.Vector3(.325,.625,.4),st=new THREE.Vector3(1,1,1),rt={primitive:"cylinder",radius:ot,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},lt=new THREE.Vector3(0,0,.175),ct=new THREE.Vector3(1,1,1);"bun"===O?(a.ear1OffsetPos=Pe,a.ear2OffsetPos=Le,a.earOffsetScale=He,a.earShape=Ae,a.earPos=ze,a.earScale=Ie):"bunny"===O?(a.ear1OffsetPos=Ne,a.ear2OffsetPos=Fe,a.earOffsetScale=Ve,a.earShape=je,a.earPos=Be,a.earScale=Ge):"mouse"===O?(a.ear1OffsetPos=at,a.ear2OffsetPos=nt,a.earOffsetScale=st,a.earShape=rt,a.earPos=lt,a.earScale=ct):"ant"===O?(a.ear1OffsetPos=qe,a.ear2OffsetPos=We,a.earOffsetScale=_e,a.earShape=Je,a.earPos=Ke,a.earScale=Ze):"horn"===O&&(a.ear1OffsetPos=Qe,a.ear2OffsetPos=Ye,a.earOffsetScale=$e,a.earShape=et,a.earPos=tt,a.earScale=it),a.faceParentData={data:"faceParentData",id:n,sources:!1,text:!1,geometry:!1,material:!1,position:a.position,rotation:a.rotation,scale:a.scale,animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},a[n]=e.Core(a.faceParentData),a.headData={data:"headData",id:s,sources:!1,text:!1,geometry:{primitive:"sphere",radius:.4,phiStart:0,phiLength:180,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:180},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.15,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},a[s]=e.Core(a.headData),a.faceEye1SocketData={data:"faceEye1SocketData",id:r,sources:!1,text:!1,geometry:a.socketShape,material:{shader:"standard",color:"#fcfafd",emissive:"#fcfafd",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.15,.1,.4),rotation:new THREE.Vector3(90,0,0),scale:a.socketScale,animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[r]=e.Core(a.faceEye1SocketData),a.faceEye2SocketData=e.coreDataFromTemplate(a.faceEye1SocketData,{id:m,position:new THREE.Vector3(.15,.1,.4)},!0),a[m]=e.Core(a.faceEye2SocketData),a.faceEye1PupilData={data:"faceEye1PupilData",id:c,sources:!1,text:!1,geometry:a.pupilShape,material:a.pupilMaterial,position:new THREE.Vector3(0,.01,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{lookdown:{property:"position",to:new THREE.Vector3(0,.01,.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookDown"},lookup:{property:"position",to:new THREE.Vector3(0,.01,-.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookUp"},lookright:{property:"position",to:new THREE.Vector3(.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookRight"},lookleft:{property:"position",to:new THREE.Vector3(-.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookLeft"}},mixins:!1,classes:["a-ent"],components:!1},a[c]=e.Core(a.faceEye1PupilData),a.faceEye2PupilData=e.coreDataFromTemplate(a.faceEye1PupilData,{id:g},!0),a[g]=e.Core(a.faceEye2PupilData),a.faceEye1PupilAccentData={data:"faceEye1PupilAccentData",id:h,sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(Ce,Ce,Ce),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[h]=e.Core(a.faceEye1PupilAccentData),a.faceEye2PupilAccentData=e.coreDataFromTemplate(a.faceEye1PupilAccentData,{id:v},!0),a[v]=e.Core(a.faceEye2PupilAccentData),a.faceEyebrow1Data={data:"faceEyebrow1Data",id:l,sources:!1,text:!1,geometry:{primitive:"box",depth:a.browThickness,width:.25,height:.025},material:a.browMaterial,position:new THREE.Vector3(0,0,-.25),rotation:new THREE.Vector3(0,10,0),scale:new THREE.Vector3(1,1,1),animations:{updown:{property:"object3D.position.z",from:-.3,to:-.225,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},a[l]=e.Core(a.faceEyebrow1Data),a.faceEyebrow2Data=e.coreDataFromTemplate(a.faceEyebrow1Data,{id:y,rotation:new THREE.Vector3(0,-10,0)},!0),a[y]=e.Core(a.faceEyebrow2Data),a.faceEye1LidOffsetData={data:"faceEye1LidOffsetData",id:p,sources:!1,text:!1,geometry:!1,material:!1,position:a.lidOffsetPosition,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{flux:a.blinkAnim,wide:a.wideAnim,normal:a.normalAnim,squint:a.squintAnim,tired:a.tiredAnim},mixins:!1,classes:["a-ent"],components:!1},a[p]=e.Core(a.faceEye1LidOffsetData),a.faceEye2LidOffsetData=e.coreDataFromTemplate(a.faceEye1LidOffsetData,{id:f},!0),a[f]=e.Core(a.faceEye2LidOffsetData),a.faceEye1LidData={data:"faceEye1LidData",id:u,sources:!1,text:!1,geometry:a.lidShape,material:a.skinMaterial,position:a.lidPosition,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.06,4,1.06),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[u]=e.Core(a.faceEye1LidData),a.faceEye2LidData=e.coreDataFromTemplate(a.faceEye1LidData,{id:E},!0),a[E]=e.Core(a.faceEye2LidData),a.faceEye1BlinkData={data:"faceEye1BlinkData",id:d,sources:!1,text:!1,geometry:a.blinkShape,material:a.skinMaterial,position:new THREE.Vector3(0,.05,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.05,1.05,1.05),animations:{blinkin:{property:"visible",from:!1,to:!0,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"visible",from:!0,to:!1,dur:1,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},close:{property:"visible",from:!1,to:!0,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"},open:{property:"visible",from:!0,to:!1,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"open"}},mixins:!1,classes:["a-ent"],components:{visible:!1}},a[d]=e.Core(a.faceEye1BlinkData),a.faceEye2BlinkData=e.coreDataFromTemplate(a.faceEye1BlinkData,{id:b},!0),a[b]=e.Core(a.faceEye2BlinkData),a.faceEar1OffsetData={data:"faceEar1OffsetData",id:w,sources:!1,text:!1,geometry:!1,material:!1,position:a.ear1OffsetPos,rotation:new THREE.Vector3(90,0,0),scale:a.earOffsetScale,animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[w]=e.Core(a.faceEar1OffsetData),a.faceEar2OffsetData=e.coreDataFromTemplate(a.faceEar1OffsetData,{id:T,position:a.ear2OffsetPos},!0),a[T]=e.Core(a.faceEar2OffsetData),a.faceEar1Data={data:"faceEar1Data",id:x,sources:!1,text:!1,geometry:a.earShape,material:a.skinMaterial,position:a.earPos,rotation:new THREE.Vector3(0,30,0),scale:a.earScale,animations:{twitch:{property:"object3D.rotation.y",from:25,to:35,dur:3e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},a[x]=e.Core(a.faceEar1Data),a.faceEar2Data=e.coreDataFromTemplate(a.faceEar1Data,{id:R,rotation:new THREE.Vector3(0,-30,0),animations:{twitch:{property:"object3D.rotation.y",from:-25,to:-35,dur:3e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}}},!0),a[R]=e.Core(a.faceEar2Data),a.bodyData={data:"bodyData",id:k,sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.4,height:.3,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},a[k]=e.Core(a.bodyData),a.legData={data:"legData",id:"leg",sources:!1,text:!1,geometry:{primitive:"cone",radiusBottom:0,radiusTop:.15,height:.2,openEnded:!1,segmentsHeight:4,segmentsRadial:8,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.25,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a.leg1Data=e.coreDataFromTemplate(a.legData,{id:D},!0),a[D]=e.Core(a.leg1Data),a.leg2Data=e.coreDataFromTemplate(a.legData,{id:C,position:new THREE.Vector3(.25,-.25,0)},!0),a[C]=e.Core(a.leg2Data),a.leg3Data=e.coreDataFromTemplate(a.legData,{id:M,position:new THREE.Vector3(0,-.25,-.25)},!0),a[M]=e.Core(a.leg3Data),a.leg4Data=e.coreDataFromTemplate(a.legData,{id:S,position:new THREE.Vector3(0,-.25,.25)},!0),a[S]=e.Core(a.leg4Data),a.faceLayerData={parent:{core:a[n]},child0:{parent:{core:a[s]},child0:{parent:{core:a[r]},child0:{core:a[l]},child1:{parent:{core:a[c]},child0:{core:a[h]}},child2:{core:a[d]},child3:{parent:{core:a[p]},child0:{core:a[u]}}},child1:{parent:{core:a[m]},child0:{core:a[y]},child1:{parent:{core:a[g]},child0:{core:a[v]}},child2:{core:a[b]},child3:{parent:{core:a[f]},child0:{core:a[E]}}},child2:{parent:{core:a[w]},child0:{core:a[x]}},child3:{parent:{core:a[T]},child0:{core:a[R]}}},child1:{parent:{core:a[k]},child0:{core:a[D]},child1:{core:a[C]},child2:{core:a[M]},child3:{core:a[S]}}},e[a.auxlId]=e.Layer(a.auxlId,a.faceLayerData),e[a.bubbleId]=e.InfoBubble(a.bubbleId,e[a.auxlId],.75,a.color.base);const ht=()=>{a[p].EmitEvent("normal"),a[f].EmitEvent("normal"),e[a.auxlId].EmitEventParent("casual")},dt=()=>{a[p].EmitEvent("wide"),a[f].EmitEvent("wide"),e[a.auxlId].EmitEventParent("happy")},pt=()=>{a[p].EmitEvent("squint"),a[f].EmitEvent("squint"),e[a.auxlId].EmitEventParent("sad")},ut=()=>{a[p].EmitEvent("squint"),a[f].EmitEvent("squint"),e[a.auxlId].EmitEventParent("angry")},mt=()=>{a[p].EmitEvent("wide"),a[f].EmitEvent("squint"),e[a.auxlId].EmitEventParent("confused")},yt=()=>{a[p].EmitEvent("tired"),a[f].EmitEvent("tired"),e[a.auxlId].EmitEventParent("tired")},gt=()=>{a[d].EmitEvent("close"),a[b].EmitEvent("close"),e[a.auxlId].EmitEventParent("asleep")},vt=()=>{a[d].EmitEvent("open"),a[b].EmitEvent("open"),e[a.auxlId].EmitEventParent("shocked")},bt=()=>{a[p].EmitEvent("normal"),a[f].EmitEvent("normal"),e[a.auxlId].EmitEventParent("annoyed")},ft=()=>{a[p].EmitEvent("squint"),a[f].EmitEvent("squint"),e[a.auxlId].EmitEventParent("smug")},Et=()=>{a[p].EmitEvent("wide"),a[f].EmitEvent("wide"),e[a.auxlId].EmitEventParent("shocked")},wt=()=>{a[p].EmitEvent("wide"),a[f].EmitEvent("wide"),e[a.auxlId].EmitEventParent("scared")},xt=()=>{a[p].EmitEvent("normal"),a[f].EmitEvent("normal"),e[a.auxlId].EmitEventParent("confident")},Tt=()=>{a[p].EmitEvent("wide"),a[f].EmitEvent("wide"),e[a.auxlId].EmitEventParent("love")},Rt=()=>{a[p].EmitEvent("squint"),a[f].EmitEvent("squint"),e[a.auxlId].EmitEventParent("shy")};return{creature:a,SpawnCreature:()=>{a.inScene||(e[a.auxlId].SpawnLayer(a.parent),(()=>{let e=.25;a.blinkInterval=setInterval((()=>{Math.random()>=e?(a[d].EmitEvent("blink"),a[b].EmitEvent("blink"),e=.25):e+=.25}),3e3)})(),a.inScene=!0)},DespawnCreature:()=>{a.inScene&&(clearInterval(a.blinkInterval),clearTimeout(a.accentTimeout),clearTimeout(a.emoteTimeout),clearInterval(a.intervalTest),clearTimeout(a.timeoutTest),e[a.auxlId].DespawnLayer(),a.inScene=!1)},Emote:e=>{console.log(e),"casual"===e?ht():"happy"===e?dt():"sad"===e?pt():"angry"===e?ut():"confused"===e?mt():"tired"===e?yt():"asleep"===e?gt():"wakeUp"===e?vt():"annoyed"===e?bt():"smug"===e?ft():"shocked"===e?Et():"scared"===e?wt():"confident"===e?xt():"love"===e?Tt():"shy"===e&&Rt()}}})(i,e,t,o),this.Collision=()=>d(i),this.GridLayout=e=>((e,t)=>{let i=Object.assign({},t);i.inScene=!1,i.current=!1,i.type,i.objInfo="single",i.coreData?(i.type="coreData",Array.isArray(i.coreData)&&(i.objInfo="array")):i.core?(i.type="core",Array.isArray(i.core)&&(i.objInfo="array")):i.layerData?(i.type="layerData",Array.isArray(i.layerData)&&(i.objInfo="array")):i.layer&&(i.type="layer",Array.isArray(i.layer)&&(i.objInfo="array")),i.objs=[],i.amount=0;for(let e in i.grids)i.grids[e].length>i.amount&&(i.amount=i.grids[e].length);return"single"===i.objInfo?(()=>{for(let t=0;t<i.amount;t++){let o={},a={};"coreData"===i.type?(o=e.coreDataFromTemplate(i.coreData,{id:i.id+t},!0),a=e.Core(o),i.objs.push(a)):"core"===i.type?(a=e.coreFromTemplate(i.core,{id:i.id+t},!0),i.objs.push(a)):"layerData"===i.type?(o=e.layerDataFromTemplate(i.layerData,{id:i.id+t},!1,!0),a=e.Layer(i.id+"layer",o),i.objs.push(a)):"layer"===i.type&&(a=e.layerFromTemplate(i.layer,i.id+t,{id:i.id+t},!1,!0),i.objs.push(a))}})():(()=>{let t=0,o=1;"coreData"===i.type?o=i.coreData.length:"core"===i.type?o=i.core.length:"layerData"===i.type?o=i.layerData.length:"layer"===i.type&&(o=i.layer.length);for(let a=0;a<i.amount;a++){let n={},s={};"coreData"===i.type?(n=e.coreDataFromTemplate(i.coreData[t],{id:i.id+a},!0),s=e.Core(n),i.objs.push(s)):"core"===i.type?(s=e.coreFromTemplate(i.core[t],{id:i.id+a},!0),i.objs.push(s)):"layerData"===i.type?(n=e.layerDataFromTemplate(i.layerData[t],{id:i.id+a},!1,!0),s=e.Layer(i.id+"layer",n),i.objs.push(s)):"layer"===i.type&&(s=e.layerFromTemplate(i.layer[t],i.id+a,{id:i.id+a},!1,!0),i.objs.push(s)),t++,t>=o&&(t=0)}})(),{gridLayout:i,SpawnGridLayout:e=>{if(i.inScene);else{(e=>{for(let t in i.grids[e])"coreData"===i.type||"core"===i.type?i.objs[t].core.grid=i.grids[e][t]:"data"!==i.type&&"core"!==i.type||(i.objs[t].layer.grid=i.grids[e][t])})(e);for(let t in i.grids[e])"coreData"===i.type||"core"===i.type?i.objs[t].SpawnCoreOnGrid():"layerData"!==i.type&&"layer"!==i.type||i.objs[t].SpawnLayerOnGrid();i.current=e,i.inScene=!0}},DespawnGridLayout:()=>{if(i.inScene){for(let e in i.grids[i.current])"coreData"===i.type||"core"===i.type?i.objs[e].DespawnCore():"layerData"!==i.type&&"layer"!==i.type||i.objs[e].DespawnLayer();i.current=!1,i.inScene=!1,e.RemoveFromTracker(i.id)}}}})(i,e),this.Gate=(e,t,o)=>((e,t,i,o)=>{let a={};a.id=t,a.object=i,a.objType,a.object.core?a.objType="core":a.object.core&&(a.objType="layer"),a.direction=o,a.directions=[],a.inScene=!1,a.open=!1;const n=e=>{e&&(a.direction=e,a.directions=[],"forward"===a.direction?(a.directions.push("forwardright"),a.directions.push("forwardleft"),a.directions.push("forward")):"reverse"===a.direction?(a.directions.push("reverseright"),a.directions.push("reverseleft"),a.directions.push("reverse")):"right"===a.direction?(a.directions.push("forwardright"),a.directions.push("reverseright"),a.directions.push("right")):"left"===a.direction&&(a.directions.push("reverseleft"),a.directions.push("forwardleft"),a.directions.push("left"))),"core"===a.objType?(0===Object.keys(a.object.core.components).length&&(a.object.core.components={}),a.object.core.components.oneventrun__closegate={event:"triggerExit",cursorObj:a.id,component:"null",method:"CloseGate",params:"null"}):"layer"===a.objType&&(Object.keys(0===a.object.layer.all.parent.core.core.components.length)&&(a.object.layer.all.parent.core.core.components={}),a.object.layer.all.parent.core.core.components.oneventrun__closegate={event:"triggerExit",cursorObj:a.id,component:"null",method:"CloseGate",params:"null"}),a.open=!0},s=()=>{a.inScene||("core"===a.objType?a.object.SpawnCoreOnGrid():"layer"===a.objType&&a.object.SpawnLayerOnGrid(),a.inScene=!0)},r=()=>{a.inScene&&("core"===a.objType?a.object.DespawnCore():"layer"===a.objType&&a.object.DespawnLayer(),a.inScene=!1)},l=()=>{a.open||(console.log("opening gate"),r(),"core"===a.objType?(a.object.core.grid.collide=!1,a.object.core.grid.trigger=!0,a.object.core.material.opacity=0):"layer"===a.objType&&(a.object.layer.all.parent.core.core.grid.collide=!1,a.object.layer.all.parent.core.core.grid.trigger=!0,a.object.layer.all.parent.core.core.material.opacity=0),n(),s())};return n(a.direction),{gate:a,SpawnGate:s,DespawnGate:()=>{a.inScene&&("core"===a.objType?a.object.DespawnCore():"layer"===a.objType&&a.object.DespawnLayer(),a.inScene=!1,e.RemoveFromTracker(a.id))},CloseGate:()=>{if(a.open)for(let t in a.directions)if(e.player.layer.gridDirection===a.directions[t]){console.log("closing gate"),"core"===a.objType?(a.object.core.grid.trigger=!1,a.object.core.grid.collide=!0,delete a.object.core.components.oneventrun__closegate,a.object.core.material.opacity=1):"layer"===a.objType&&(a.object.layer.all.parent.core.core.grid.trigger=!1,a.object.layer.all.parent.core.core.grid.collide=!0,delete a.object.layer.all.parent.core.core.components.oneventrun__closegate,a.object.layer.all.parent.core.core.material.opacity=1),r(),s(),a.open=!1;let e=setTimeout((()=>{console.log("Re-opening Gate"),l(),clearTimeout(e)}),3e3)}},OpenGate:l,ResetGate:n}})(i,e,t,o),this.Constraints=(e,t,i)=>((e,t,i,o)=>{let a={};a.on=o||!1,a.core=t,a.type=i.type||"auxspring",a.to=i.to||"playerRig",a.id="constraint"+t.id+Math.floor(1e7*Math.random().toFixed(8)),a.minLength=0,a.maxLength=20,a.pivotA=new THREE.Vector3(0,0,0),a.pivotB=new THREE.Vector3(0,0,0),a.axisA=new THREE.Vector3(0,0,0),a.axisB=new THREE.Vector3(0,0,0),a.maxForce=1e6,a.restLength=i.restLength||1,a.damping=i.damping||.5,a.stiffness=i.stiffness||10,a.collideConnected=!0,a.always=!0;const n=e=>{e&&(e.type&&(a.type=e.type),e.restLength&&(a.restLength=e.restLength),e.damping&&(a.damping=e.damping),e.stiffness&&(a.stiffness=e.stiffness),e.maxForce&&(a.maxForce=e.maxForce)),"lock"===a.type?a.connect={name:"auxconstraint__"+a.id,type:a.type,connectTo:a.to,maxForce:1e6,collideConnected:a.collideConnected,always:a.always}:"pointToPoint"===a.type?a.connect={name:"auxconstraint__"+a.id,type:a.type,connectTo:a.to,pivotA:a.pivotA,pivotB:a.pivotB,maxForce:a.maxForce,collideConnected:a.collideConnected,always:a.always}:"coneTwist"===a.type||"hinge"===a.type?a.connect={name:"auxconstraint__"+a.id,type:a.type,connectTo:a.to,pivotA:a.pivotA,pivotB:a.pivotB,axisA:a.axisA,axisB:a.axisB,maxForce:a.maxForce,collideConnected:a.collideConnected,always:a.always}:"auxspring"===a.type&&(a.connect={name:"auxspring__"+a.id,connectTo:a.to,restLength:a.restLength,damping:a.damping,stiffness:a.stiffness,collideConnected:a.collideConnected,always:a.always})};n(i);const s=e=>{n(e),a.core.core.components[a.connect.name]=a.connect,a.core.ChangeSelf({property:a.connect.name,value:a.connect},!0)};return a.on&&s(),{constraint:a,Update:n,Connect:s,Disconnect:()=>{a.core.RemoveComponent(a.connect.name)},Disable:()=>{delete a.core.core.components[a.connect.name]}}})(0,e,t,i),this.One=(e,t)=>p(i,e,t),this.BuildIn3D=()=>(e=>{let t={id:"build"};return t.player=e.player.GetPlayerInfo(),t.core={},t.core.data={},t.core.made=[],t.layer={},t.objGen={},t.null={},t.templates={},t.core.blank={data:"blankData",id:"blank",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.states=["ready","building","editing","deleting","settings"],t.state=t.states[0],t.building={},t.building.current=!1,t.building.prepped=!1,t.building.building=!1,t.buildCoreData={data:"buildCoreData",id:"buildCore",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#b011c4",opacity:1,metalness:.2,roughness:.8,emissive:"#b011c4",emissiveIntensity:.4,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{hoveron:{property:"components.material.material.emissiveIntensity",from:.4,to:.6,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"components.material.material.emissiveIntensity",from:.6,to:.4,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.buildMenuData={info:{id:"buildMenu",buttonData:t.buildCoreData,hoverData:e.buildHoverData,title:"Build Mode",description:"Build objects.",layout:"circleUp",posOffset:new THREE.Vector3(-1.625,.13,.11),offset:1.25,parent:"ghostParent",stare:!1},menu0:{button0:{id:"subMenu1",style:!1,title:"Build",description:"Build a new object.",subMenu:"menu1",action:!1},button1:{id:"subMenu2",style:!1,title:"Edit",description:"Edit an object in-scene.",subMenu:"menu22",action:!1},button2:{id:"subMenu3",style:!1,title:"Delete",description:"Delete an object in-scene.",subMenu:"menu23",action:!1},button3:{id:"subMenu4",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu24",action:!1}},menu1:{button0:{id:"subMenu2",style:!1,title:"Core",description:"Build a Core object.",subMenu:"menu2",action:!1},button1:{id:"subMenu3",style:!1,title:"Layer",description:"Build a Layer object.",subMenu:"end",action:!1},button2:{id:"subMenu4",style:!1,title:"ObjGen",description:"Build an object.",subMenu:"end",action:!1},button3:{id:"subMenu5",style:!1,title:"Null",description:"Build a Null object.",subMenu:"end",action:!1},button4:{id:"subMenu6",style:!1,title:"Templates",description:"Build a from a Template.",subMenu:"end",action:!1}},menu2:{button0:{id:"subMenu0",style:!1,title:"Generate",description:"Generate a default Core object.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"StartBuilding",params:null,menu:"stay"}},button1:{id:"subMenu1",style:!1,title:"Name",description:"Update core Name.",subMenu:"coreName",action:!1},button2:{id:"subMenu2",style:!1,title:"Geometry",description:"Update core Geometry.",subMenu:"coreGeometry",action:!1},button3:{id:"subMenu3",style:!1,title:"Material",description:"Update core Material.",subMenu:"coreMaterial",action:!1},button4:{id:"subMenu4",style:!1,title:"Text",description:"Update core Text.",subMenu:"coreText",action:!1},button5:{id:"subMenu5",style:!1,title:"Position",description:"Update core Position.",subMenu:"corePosition",action:!1},button6:{id:"subMenu6",style:!1,title:"More",description:"More options.",subMenu:"menu3",action:!1}},menu3:{button0:{id:"subMenu0",style:!1,title:"Rotation",description:"Update core Rotation.",subMenu:"coreRotation",action:!1},button1:{id:"subMenu1",style:!1,title:"Scale",description:"Update core Scale.",subMenu:"coreScale",action:!1},button2:{id:"subMenu2",style:!1,title:"Animations",description:"Update core Animations.",subMenu:"coreAnimations",action:!1},button3:{id:"subMenu3",style:!1,title:"Clickable",description:"Toggle core to be clickable in-scene.",subMenu:"coreClickable",action:!1},button4:{id:"subMenu4",style:!1,title:"Components",description:"Update core Components.",subMenu:"coreComponents",action:!1},button5:{id:"subMenu5",style:!1,title:"Done",description:"Finalize core updates.",subMenu:"coreDone",action:!1}},coreName:{button0:{id:"action1",style:!1,title:"Update Name",description:"Update the cores name and id.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateName",params:null,menu:"stay"}}},coreGeometry:{button0:{id:"action0",style:!1,title:"Plane",description:"A 2D plane.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"plane",menu:"stay"}},button1:{id:"action1",style:!1,title:"Cube",description:"A 3D cube.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"box",menu:"stay"}},button2:{id:"action2",style:!1,title:"Circle",description:"A 2D circle.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"circle",menu:"stay"}},button3:{id:"action3",style:!1,title:"Cylinder",description:"A 3D cylinder.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"cylinder",menu:"stay"}},button4:{id:"action4",style:!1,title:"Sphere",description:"A 3D sphere.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"sphere",menu:"stay"}}},coreMaterial:{button0:{id:"subMenu0",style:!1,title:"Page 0",description:"Go to Color Page 0",subMenu:"coreMaterialColorPage0",action:!1},button1:{id:"subMenu1",style:!1,title:"Page 1",description:"Go to Color Page 1",subMenu:"coreMaterialColorPage1",action:!1},button2:{id:"subMenu2",style:!1,title:"Page 2",description:"Go to Color Page 2",subMenu:"coreMaterialColorPage2",action:!1}},coreMaterialColorPage0:{},coreMaterialColorPage1:{},coreMaterialColorPage2:{},coreMaterialColorPage3:{},coreText:{button0:{id:"action1",style:!1,title:"Update Text",description:"Update the cores text.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateText",params:null,menu:"stay"}}},corePosition:{button0:{id:"action1",style:!1,title:"Update Position",description:"Update the cores position.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdatePosition",params:null,menu:"stay"}},button0:{id:"PosX",style:!1,title:"X",description:"Update the X axis.",subMenu:"menu1",action:{auxlObj:"build",component:!1,method:"UpdatePosition",params:"x",menu:"stay"}},button1:{id:"PosY",style:!1,title:"Y",description:"Update the Y axis.",subMenu:"menu22",action:{auxlObj:"build",component:!1,method:"UpdatePosition",params:"y",menu:"stay"}},button2:{id:"PosZ",style:!1,title:"Z",description:"Update the Z axis.",subMenu:"menu23",action:{auxlObj:"build",component:!1,method:"UpdatePosition",params:"z",menu:"stay"}}},coreRotation:{button0:{id:"action1",style:!1,title:"Update Rotation",description:"Update the cores rotation.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateRotation",params:null,menu:"stay"}}},coreScale:{button0:{id:"action1",style:!1,title:"Update Scale",description:"Update the cores scale.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateScale",params:null,menu:"stay"}}},coreAnimations:{button0:{id:"action1",style:!1,title:"Update Animations",description:"Update the cores animations.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateAnimations",params:null,menu:"stay"}}},coreClickable:{button0:{id:"action1",style:!1,title:"Toggle Clickable",description:"Toggle the core being interactable. ",subMenu:!1,action:{auxlObj:"build",component:!1,method:"ToggleClickable",params:null,menu:"stay"}}},coreComponents:{button0:{id:"action1",style:!1,title:"Update Components",description:"Update the cores components.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateComponents",params:null,menu:"stay"}}},coreDone:{button0:{id:"action1",style:!1,title:"Done",description:"Finalize the core.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"Done",params:null,menu:"close"}}},end:{button0:{id:"subMenu2",style:!1,title:"Core",description:"Build a Core object.",subMenu:"menu0",action:!1}}},function(){let e=["red","orange","yellow","lime","blue","cyan","magenta","maroon","olive","green","purple","teal","navy","silver","grey","black","white"],i=0,o=0;t.buildMenuData["coreMaterialColorPage"+o]={};for(let a in e){t.buildMenuData["coreMaterialColorPage"+o]["button"+i]={};let n={id:"action"+i,style:!1,title:e[a],description:"Update the core Material to "+e[a],subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateMaterial",params:e[a],menu:"stay"}},s={id:"subMenu"+o,style:!1,title:"Page "+(o+1),description:"Next Page > "+o,subMenu:"coreMaterialColorPage"+(o+1),action:!1};i>=6?(t.buildMenuData["coreMaterialColorPage"+o]["button"+i]=s,o++,i=0):t.buildMenuData["coreMaterialColorPage"+o]["button"+i]=n,i++}}(),e.buildMenu=e.MultiMenu(t.buildMenuData),e.numberStyle0Data={data:"numberStyle0Data",id:"numberStyle0",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#d3be1d",opacity:1,metalness:.2,roughness:.8,emissive:"#d3be1d",emissiveIntensity:.4,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{hoveron:{property:"components.material.material.emissiveIntensity",from:.4,to:.6,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"components.material.material.emissiveIntensity",from:.6,to:.4,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.numberInputs0Data={info:{id:"numberInputs0",buttonData:e.numberStyle0Data,hoverData:e.buildHoverData,title:"Update Number",description:"Update the Number.",layout:"circleUp",posOffset:new THREE.Vector3(-1.75,.13,-.11),offset:1,parent:"ghostParent",stare:!1},menu0:{button0:{id:"0",style:!1,title:"0",description:"Zero",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"0",menu:"stay"}},button1:{id:"1",style:!1,title:"1",description:"One",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"1",menu:"stay"}},button2:{id:"2",style:!1,title:"2",description:"Two",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"2",menu:"stay"}},button3:{id:"3",style:!1,title:"3",description:"Three",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"3",menu:"stay"}},button4:{id:"4",style:!1,title:"4",description:"Four",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"4",menu:"stay"}},button5:{id:"5",style:!1,title:"5",description:"Five",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"5",menu:"stay"}},button6:{id:"6",style:!1,title:"6",description:"Six",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"6",menu:"stay"}}}},e.numberInputs0=e.MultiMenu(t.numberInputs0Data),e.menuStyle4=e.coreDataFromTemplate(e.numberStyle0Data,{id:"menuStyle4",material:{shader:"standard",color:"#d31d9b",opacity:1,metalness:.2,roughness:.8,emissive:"#d31d9b",emissiveIntensity:.4,side:"double"}},!0),t.buildSubMenuData={info:{id:"buildSubMenu",buttonData:e.menuStyle4,hoverData:e.buildHoverData,title:"Update",description:"Update the selection.",layout:"circleUp",posOffset:new THREE.Vector3(1.75,.13,-.11),offset:-1,parent:"ghostParent",stare:!1},menu0:{button0:{id:"more0",style:!1,title:"More 0",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button1:{id:"more1",style:!1,title:"More 1",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button2:{id:"more2",style:!1,title:"More 2",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button3:{id:"more3",style:!1,title:"More 3",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button4:{id:"more4",style:!1,title:"More 4",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button5:{id:"more5",style:!1,title:"More 5",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}},button6:{id:"more",style:!1,title:"More 6",description:"...",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"other",menu:"stay"}}}},e.buildSubMenu=e.MultiMenu(t.buildSubMenuData),e.numberStyle1Data=e.coreDataFromTemplate(e.numberStyle0Data,{id:"numberStyle1",material:{shader:"standard",color:"#d3391d",opacity:1,metalness:.2,roughness:.8,emissive:"#d3391d",emissiveIntensity:.4,side:"double"}},!0),t.numberInputs1Data={info:{id:"numberInputs1",buttonData:e.numberStyle1Data,hoverData:e.buildHoverData,title:"Update Number",description:"Update the Number.",layout:"circleUp",posOffset:new THREE.Vector3(-1.75,.15,-.22),offset:.6,parent:"ghostParent",stare:!1},menu0:{button0:{id:"7",style:!1,title:"7",description:"Seven",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"0",menu:"stay"}},button1:{id:"8",style:!1,title:"8",description:"Eight",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"1",menu:"stay"}},button2:{id:"9",style:!1,title:"9",description:"Nine",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"2",menu:"stay"}},button3:{id:"10",style:!1,title:"10",description:"Ten",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"10",menu:"stay"}},button4:{id:"25",style:!1,title:"25",description:"Twenty Five",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"25",menu:"stay"}},button5:{id:"50",style:!1,title:"50",description:"Fifty",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"50",menu:"stay"}},button6:{id:"100",style:!1,title:"100",description:"One Hundred",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"100",menu:"stay"}}}},e.numberInputs1=e.MultiMenu(t.numberInputs1Data),e.numberStyle2Data=e.coreDataFromTemplate(e.numberStyle0Data,{id:"numberStyle2",material:{shader:"standard",color:"#24d31d",opacity:1,metalness:.2,roughness:.8,emissive:"#24d31d",emissiveIntensity:.4,side:"double"}},!0),t.buildPosMenuData={info:{id:"buildMenuNumber",buttonData:e.numberStyle2Data,hoverData:e.buildHoverData,title:"Update Pos",description:"Update the position of selection.",layout:"circleUp",posOffset:new THREE.Vector3(1.75,.15,-.22),offset:-.6,parent:"ghostParent",stare:!1},menu0:{button0:{id:"PositiveA",style:!1,title:"+Positive",description:"Flip Amount to Positive",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"+",menu:"stay"}},button1:{id:"NegativeA",style:!1,title:"-Negative",description:"Flip Amount to Negative",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"-",menu:"stay"}},button2:{id:"AddA",style:!1,title:"Add +A",description:"Add Amount of units to selection.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"add",menu:"stay"}},button3:{id:"SubtractA",style:!1,title:"Subtract -A",description:"Subtract Amount of units.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"subtract",menu:"stay"}},button4:{id:"DivideA",style:!1,title:"Half A/2",description:"Divide Amount of units by 2.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"divide",menu:"stay"}},button5:{id:"DoubleA",style:!1,title:"Double A*2",description:"Double Amount of units.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"double",menu:"stay"}},button6:{id:"Cancel",style:!1,title:"Cancel",description:"Cancel & Reset.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateNumber",params:"cancel",menu:"close"}}}},e.buildMenuNumber=e.MultiMenu(t.buildPosMenuData),t.building.geometry={},t.building.geometry.plane={primitive:"plane",width:.5,height:.5},t.building.geometry.box={primitive:"box",depth:.5,width:.5,height:.5},t.building.geometry.circle={primitive:"circle",radius:.5,segments:32},t.building.geometry.cylinder={primitive:"cylinder",radius:.25,height:.75,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},t.building.geometry.sphere={primitive:"sphere",radius:.4,phiStart:0,phiLength:360,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:360},t.building.text={},t.building.text.toggle=!1,t.building.text.input="",t.building.text.backups=[],t.building.text.history=[],document.addEventListener("keyup",(i=>{(i=>{if(!t.building.text.toggle)return;let o=i.key;if("Backspace"===o)console.log(t.building.text.backups),t.building.text.backups.length>0?(t.building.text.input=t.building.text.backups[t.building.text.backups.length-1],t.building.text.backups.pop(),t.building.text.next=!1,t.building.text.backups.length<=0&&t.building.text.backups.push(" "),console.log(t.building.text.backups)):t.building.text.input=" ";else{if("Spacebar"===o)o=" ";else{if("Shift"===o)return void(t.building.text.shift=!t.building.text.shift);if("Enter"===o)o="\n";else{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(o))return;if(["Alt","Control","CapsLock","Tab","Escape","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(o))return}}t.building.text.shift&&(o.toUpperCase(),t.building.text.shift=!1),t.building.text.input+=o,t.building.text.backups.push(t.building.text.input)}t.building.text.history.push(o),t.building.text.history.length>=t.building.text.history.maxLength&&t.building.text.history.shift(),e.player.UpdateBeltText(t.building.text.input),t.building.current.ChangeSelf({property:"text",value:{value:t.building.text.input}}),console.log(t.building.text.input)})(i)})),{one:t,SpawnBuild:()=>{e.buildMenu.SpawnMultiMenu(),e.buildSubMenu.SpawnMultiMenu(),e.numberInputs0.SpawnMultiMenu(),e.numberInputs1.SpawnMultiMenu(),e.buildMenuNumber.SpawnMultiMenu()},DespawnBuild:()=>{e.buildMenu.DespawnMultiMenu(),e.buildSubMenu.DespawnMultiMenu(),e.numberInputs0.DespawnMultiMenu(),e.numberInputs1.DespawnMultiMenu(),e.buildMenuNumber.DespawnMultiMenu()},StartBuilding:()=>{console.log("Start Building"),(()=>{if(t.building.prepped)console.log("Already Prepped");else{console.log("New Core");let i=t.core.made.length;t.core.data[i+"data"]={data:i+"data",id:i,sources:!1,text:{value:"Hello World!",color:"#FFFFFF",align:"center",font:"exo2bold",width:.45,zOffset:.275,side:"front",wrapCount:16,baseline:"center"},geometry:{primitive:"box",depth:.5,width:.5,height:.5},material:{shader:"standard",color:"#2aad7b",emissive:"#2aad7b",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(0,1.6,-2),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.core[i]=e.Core(t.core.data[i+"data"]),t.building.current=t.core[i],t.building.prepped=!0,t.building.building=!0,t.building.current.SpawnCore(e.playerRig.GetEl())}})()},UpdateName:()=>{console.log("UpdateName")},UpdateGeometry:e=>{let i;console.log("UpdateGeometry"),"plane"===e?i=t.building.geometry.plane:"box"===e?i=t.building.geometry.box:"circle"===e?i=t.building.geometry.circle:"cylinder"===e?i=t.building.geometry.cylinder:"sphere"===e&&(i=t.building.geometry.sphere),t.core.data[t.building.current.core.id+"data"].geometry=i,t.building.current.RemoveComponent("geometry"),t.building.current.ChangeSelf({property:"geometry",value:i})},UpdateMaterial:i=>{console.log("UpdateMaterial");let o=t.building.current.GetEl().material?t.building.current.GetEl().material:{shader:"standard",color:"#2aad7b",emissive:"#2aad7b",emissiveIntensity:.25,opacity:1},a=e.colorTheoryGen(!1,i);o.color=a.base,o.emissive&&(o.emissive=a.base),t.core.data[t.building.current.core.id+"data"].color=a.base,t.core.data[t.building.current.core.id+"data"].materialData=a,t.building.current.ChangeSelf({property:"material",value:o})},UpdateText:()=>{t.building.text.toggle=!t.building.text.toggle,t.building.text.toggle?e.playerBeltTitleText.ChangeSelf({property:"text",value:{value:"Write"}}):e.playerBeltTitleText.ChangeSelf({property:"text",value:{value:"Read"}})},UpdateNumber:e=>{console.log("UpdateNumber"),console.log(e)},UpdatePosition:e=>{console.log("UpdatePosition")},UpdateRotation:()=>{console.log("UpdateRotation")},UpdateScale:()=>{console.log("UpdateScale")},UpdateAnimations:()=>{console.log("UpdateAnimations")},UpdateClickable:()=>{console.log("UpdateClickable")},UpdateComponents:()=>{console.log("UpdateComponents")},UpdateDone:()=>{console.log("UpdateDone")},Testing:()=>{console.log(t)}}})(i),this.ImageSwapper=(e,t,o,...a)=>((e,t,i,o,...a)=>{let n,s={};s.id=t,s.inScene=!1,s.thumbnailCores=[];let r=new THREE.Vector3(0,-.3,.05);s.layerData={};for(let t in a)"0"===t?(i.material=a[t],n=e.Core(i),s.layerData.parent={},s.layerData.parent.core=n):(o.id="thumbnail"+t,o.material=a[t],3===a.length?"1"===t?r.x=-.25:"2"===t&&(r.x=.25):4===a.length?"1"===t?r.x=-.33:"2"===t?r.x=0:"3"===t&&(r.x=.33):5===a.length&&("1"===t?r.x=-.375:"2"===t?r.x=-.125:"3"===t?r.x=.125:"4"===t&&(r.x=.375)),o.position=r,s.thumbnailCores[t]=e.Core(o),s.layerData["child"+t]={},s.layerData["child"+t].core=s.thumbnailCores[t]);s.layer=e.Layer("imageSwapper",s.layerData);const l=()=>{s.inScene||(s.layer.SpawnLayer(),s.inScene=!0)},c=()=>{s.inScene&&(s.layer.DespawnLayer(),RemoveFromTracker(s.id),s.inScene=!1)};return{imageSwapper:s,Click:e=>{let t=e.getAttribute("material").src,i=JSON.parse(JSON.stringify(e.parentNode.getAttribute("material").src));e.parentNode.setAttribute("material",{src:t}),e.setAttribute("material",{src:i})},SpawnImgSwap:l,DespawnImgSwap:c,ToggleSpawn:()=>{s.inScene?c():l()},SetFlag:e=>{if(Array.isArray(e))for(let t in e)s[e[t].flag]=e[t].value;else s[e.flag]=e.value},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(s(e[i]));return t}return s[e]}}})(i,e,t,o,...a),this.ImageCarousel=e=>((e,t)=>{let i,o,a,n=Object.assign({},t);n.inScene=!1,n.frames=8,n.framesPerPage=8,currentImageForward=-1,currentImageBackward=n.images.length-n.framesPerPage,n.framesPerPage;let s=0;currentRotation=-1;let r=!0,l=!0,c=!1,h=!1,d=0,p=!1,u={data:"artFrameParentData",id:"artFrameParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},m={data:"artFrameData",id:"artFrame",sources:!1,text:!1,geometry:{primitive:"box",depth:.01,width:4.4,height:2.55},material:{shader:"flat",color:"#55a5be",opacity:1,alphaTest:.1},position:new THREE.Vector3(0,1.75,-6),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{scale0:{property:"scale",from:"1 1 1",to:"2 2 2",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to0"},position0:{property:"position",from:"0 1.75 -6",to:"0 3.5 -12",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to0"},scale1:{property:"scale",from:"2 2 2",to:"1 1 1",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to1"},position1:{property:"position",from:"0 3.5 -12",to:"0 1.75 -6",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to1"}},mixins:!1,classes:["a-ent"],components:!1},y={data:"artFrameTextData",id:"artFrameText",sources:!1,text:{value:"Art Frame Text",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:0,side:"double"},geometry:!1,material:!1,position:new THREE.Vector3(0,-1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1};u.id="artFrameParentAll",u.rotation=new THREE.Vector3(0,1,0);let g={parent:{core:e.Core(u)}},v="artFrameParent",b=[],f="artFrame",E=[],w="artFrameText",x=[];for(let t=0;t<n.frames;t++){0===t?s=-45:1===t?s=0:2===t?s=-315:3===t?s=-270:4===t?s=-225:5===t?s=-180:6===t?s=-135:7===t&&(s=-90),v="artFrameParent"+t;let i=new THREE.Vector3(0,0,0);i.y=s,u.id=v,u.rotation=i,b[t]=e.Core(u),f="artFrame"+t,m.id=f,E[t]=e.Core(m),w="artFrameText"+t,y.id=w,x[t]=e.Core(y),g["child"+t]={parent:{core:b[t]},child0:{parent:{core:E[t]},child0:{core:x[t]}}}}let T=e.Layer("artFrameAllLayer",g),R=e.colorTheoryGen("#6ab0db"),k={data:"Button Parent",id:"buttonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,80,0),scale:new THREE.Vector3(1,1,1),animations:{scaleclick:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["a-ent"],components:!1},D={data:"Button Obj",id:"buttonObj",sources:!1,text:!1,geometry:!1,material:{shader:"flat",color:R.base,opacity:1},position:new THREE.Vector3(0,.4,-2.5),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(.1,.1,.1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},C={data:"Button Border",id:"buttonBorder",sources:!1,text:!1,geometry:!1,material:{shader:"flat",color:R.splitCompl[0],opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"obj-model":{obj:"./assets/3d/buttons/border.obj"}}},M={data:"Button Click Background",id:"buttonClick",sources:!1,text:!1,geometry:{primitive:"circle",radius:2,segments:12},material:{shader:"flat",color:R.splitCompl[1],opacity:.5,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},S={data:"Button Text",id:"buttonText",sources:!1,text:{value:"Button",width:20,color:R.base,align:"center",font:"exo2bold",zOffset:0,side:"double"},geometry:!1,material:!1,position:new THREE.Vector3(0,-2.75,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1};k.id="buttonBackwardParent",k.rotation=new THREE.Vector3(0,22.5,0);let P=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/backward.obj"}},D.id="buttonBackward",C.id="buttonBackwardBorder",M.id="buttonBackwardClick",S.id="buttonBackwardText",S.text.value="Back";let L=e.Core(D),H=e.Core(C),A=e.Core(M),z=e.Core(S),I={parent:{core:P},child0:{parent:{core:L},child0:{core:H},child1:{core:A},child2:{core:z}}},O=e.Layer("buttonBackwardLayer",I);k.id="buttonForwardParent",k.rotation=new THREE.Vector3(0,-22.5,0);let N=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/forward.obj"}},D.id="buttonForward",C.id="buttonForwardBorder",M.id="buttonForwardClick",S.id="buttonForwardText",S.text.value="Forward";let F=e.Core(D),V=e.Core(C),j=e.Core(M),B=e.Core(S),G={parent:{core:N},child0:{parent:{core:F},child0:{core:V},child1:{core:j},child2:{core:B}}},U=e.Layer("buttonForwardLayer",G);k.id="buttonLeftSkipParent",k.rotation=new THREE.Vector3(0,37.5,0);let q=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/left_skip.obj"}},D.id="buttonLeftSkip",C.id="buttonLeftSkipBorder",M.id="buttonLeftSkipClick",S.id="buttonLeftSkipText",S.text.value="Back Page";let W=e.Core(D),_=e.Core(C),J=e.Core(M),K=e.Core(S),Z={parent:{core:q},child0:{parent:{core:W},child0:{core:_},child1:{core:J},child2:{core:K}}},X=e.Layer("buttonLeftSkipLayer",Z);k.id="buttonPlayParent",k.rotation=new THREE.Vector3(0,-7.5,0);let Q=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/play.obj"}},D.id="buttonPlay",C.id="buttonPlayBorder",M.id="buttonPlayClick",S.id="buttonPlayText",S.text.value="Play";let Y=e.Core(D),$=e.Core(C),ee=e.Core(M),te=e.Core(S),ie={parent:{core:Q},child0:{parent:{core:Y},child0:{core:$},child1:{core:ee},child2:{core:te}}},oe=e.Layer("buttonPlayLayer",ie);k.id="buttonRightSkipParent",k.rotation=new THREE.Vector3(0,-37.5,0);let ae=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/right_skip.obj"}},D.id="buttonRightSkip",C.id="buttonRightSkipBorder",M.id="buttonRightSkipClick",S.id="buttonRightSkipText",S.text.value="Next Page";let ne=e.Core(D),se=e.Core(C),re=e.Core(M),le=e.Core(S),ce={parent:{core:ae},child0:{parent:{core:ne},child0:{core:se},child1:{core:re},child2:{core:le}}},he=e.Layer("buttonRightSkipLayer",ce);k.id="buttonSettingsParent",k.rotation=new THREE.Vector3(0,-52.5,0);let de=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/settings.obj"}},D.id="buttonSettings",C.id="buttonSettingsBorder",M.id="buttonSettingsClick",S.id="buttonSettingsText",S.text.value="Scale";let pe=e.Core(D),ue=e.Core(C),me=e.Core(M),ye=e.Core(S),ge={parent:{core:de},child0:{parent:{core:pe},child0:{core:ue},child1:{core:me},child2:{core:ye}}},ve=e.Layer("buttonSettingsLayer",ge);k.id="buttonStopParent",k.rotation=new THREE.Vector3(0,7.5,0),buttonStopParent=e.Core(k),D.components={"obj-model":{obj:"./assets/3d/buttons/stop.obj"}},D.id="buttonStop",C.id="buttonStopBorder",M.id="buttonStopClick",S.id="buttonStopText",S.text.value="Info";let be=e.Core(D),fe=e.Core(C),Ee=e.Core(M),we=e.Core(S),xe={parent:{core:buttonStopParent},child0:{parent:{core:be},child0:{core:fe},child1:{core:Ee},child2:{core:we}}},Te=e.Layer("buttonStopLayer",xe);k.id="buttonHashtagParent",k.rotation=new THREE.Vector3(0,52.5,0);let Re=e.Core(k);D.components={"obj-model":{obj:"./assets/3d/buttons/hashtag.obj"}},D.id="buttonHashtag",C.id="buttonHashtagBorder",M.id="buttonHashtagClick",S.id="buttonHashtagText",S.text.value="Random Page";let ke=e.Core(D),De=e.Core(C),Ce=e.Core(M),Me=e.Core(S),Se={parent:{core:Re},child0:{parent:{core:ke},child0:{core:De},child1:{core:Ce},child2:{core:Me}}},Pe=e.Layer("buttonHashtagLayer",Se),Le={name:"anim90",property:"object3D.rotation.y",from:"0",to:"90",dur:2500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0},He={name:"anim360",property:"object3D.rotation.y",from:"0",to:"360",dur:12e4,delay:0,loop:"true",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"play",pauseEvents:"pause"};const Ae=(e,t,i)=>{g[e].child0.parent.core.ChangeSelf({property:"material",value:{src:i,shader:"flat",color:"#FFFFFF",opacity:1}}),g[e].child0.child0.core.ChangeSelf({property:"text",value:{value:t,width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:0,side:"double"}})},ze=(e,t)=>{"forward"===t?(currentImageForward++,currentImageBackward++,currentImageForward>=n.images.length&&(currentImageForward=0),currentImageBackward>=n.images.length&&(currentImageBackward=0),Ae("child"+e,n.images[currentImageForward].text,n.images[currentImageForward].image)):"backward"===t&&(currentImageBackward--,currentImageForward--,currentImageBackward<0&&(currentImageBackward=n.images.length-1),currentImageForward<0&&(currentImageForward=n.images.length-1),Ae("child"+e,n.images[currentImageBackward].text,n.images[currentImageBackward].image))},Ie=e=>{for(let t=0;t<n.frames;t++)ze(t,e);c=!1},Oe=e=>{let t,i=[];"forward"===e?0===currentRotation?i=[0,1]:1===currentRotation?i=[2,3]:2===currentRotation?i=[4,5]:3===currentRotation&&(i=[6,7]):"backward"===e&&(0===currentRotation?i=[6,7]:1===currentRotation?i=[0,1]:2===currentRotation?i=[2,3]:3===currentRotation&&(i=[4,5]),i.reverse());for(let o in i)t=i[o],ze(t,e)},Ne=()=>{n.inScene||(T.SpawnLayer(),O.SpawnLayer(),Pe.SpawnLayer(),U.SpawnLayer(),X.SpawnLayer(),oe.SpawnLayer(),he.SpawnLayer(),ve.SpawnLayer(),Te.SpawnLayer(),A.GetEl().addEventListener("click",je),j.GetEl().addEventListener("click",Ve),J.GetEl().addEventListener("click",Ue),ee.GetEl().addEventListener("click",Be),re.GetEl().addEventListener("click",Ge),me.GetEl().addEventListener("click",We),Ce.GetEl().addEventListener("click",qe),_e(),n.inScene=!0)},Fe=()=>{n.inScene&&(A.GetEl().removeEventListener("click",je),j.GetEl().removeEventListener("click",Ve),J.GetEl().removeEventListener("click",Ue),ee.GetEl().removeEventListener("click",Be),re.GetEl().removeEventListener("click",Ge),me.GetEl().removeEventListener("click",We),Ce.GetEl().removeEventListener("click",qe),T.DespawnLayer(),O.DespawnLayer(),Pe.DespawnLayer(),U.DespawnLayer(),X.DespawnLayer(),oe.DespawnLayer(),he.DespawnLayer(),ve.DespawnLayer(),Te.DespawnLayer(),RemoveFromTracker(n.id),n.inScene=!1)},Ve=()=>{if(r){r=!1;let e=T.GetParentEl().getAttribute("rotation").y;Le.from=e,Le.to=e-90,T.AnimateParent(Le),o=setTimeout((()=>{currentRotation++,currentRotation>3&&(currentRotation=0),Oe("forward"),r=!0,clearTimeout(o)}),Le.dur+10)}},je=()=>{if(r){r=!1;let e=T.GetParentEl().getAttribute("rotation").y;Le.from=e,Le.to=e+90,T.AnimateParent(Le),o=setTimeout((()=>{currentRotation--,currentRotation<0&&(currentRotation=3),console.log(currentRotation),Oe("backward"),r=!0,clearTimeout(o)}),Le.dur+10)}},Be=()=>{if(l){l=!1,r=!1,i=setInterval((()=>{(e=>{let t;t=3,ze(3,void 0)})(),currentRotation=0,7===currentRotation?currentRotation=0:currentRotation++}),He.dur/8);let e=T.GetParentEl().getAttribute("rotation").y;He.from=e,He.to=e-360,T.AnimateParent(He),T.layer.all.parent.core.EmitEvent("play"),Y.ChangeSelf({property:"obj-model",value:{obj:"./assets/3d/buttons/pause.obj"}}),te.ChangeSelf({property:"text",value:{value:"Pause",width:20,color:R.base,align:"center",font:"exo2bold",zOffset:0,side:"double"}})}else l=!0,r=!0,clearInterval(i),T.layer.all.parent.core.EmitEvent("pause"),Y.ChangeSelf({property:"obj-model",value:{obj:"./assets/3d/buttons/play.obj"}}),te.ChangeSelf({property:"text",value:{value:"Play",width:20,color:R.base,align:"center",font:"exo2bold",zOffset:0,side:"double"}})},Ge=()=>{c||(c=!0,Ie("forward"))},Ue=()=>{c||(c=!0,Ie("backward"))},qe=()=>{c||(c=!0,currentImageForward=Math.floor(Math.random()*n.images.length),Ie("forward"))},We=()=>{h||(h=!0,a=setTimeout((()=>{h=!1,clearTimeout(a)}),2050),0===d?(d=1,g.child0.child0.parent.core.EmitEvent("to0"),g.child1.child0.parent.core.EmitEvent("to0"),g.child2.child0.parent.core.EmitEvent("to0"),g.child3.child0.parent.core.EmitEvent("to0"),g.child4.child0.parent.core.EmitEvent("to0"),g.child5.child0.parent.core.EmitEvent("to0"),g.child6.child0.parent.core.EmitEvent("to0"),g.child7.child0.parent.core.EmitEvent("to0")):(d=0,g.child0.child0.parent.core.EmitEvent("to1"),g.child1.child0.parent.core.EmitEvent("to1"),g.child2.child0.parent.core.EmitEvent("to1"),g.child3.child0.parent.core.EmitEvent("to1"),g.child4.child0.parent.core.EmitEvent("to1"),g.child5.child0.parent.core.EmitEvent("to1"),g.child6.child0.parent.core.EmitEvent("to1"),g.child7.child0.parent.core.EmitEvent("to1")))},_e=()=>{Ee.EnableDetail({text:n.description,position:new THREE.Vector3(0,1.5,-2)}),Ie("forward")};return{imageCarousel:n,SpawnImgCarousel:Ne,DespawnImgCarousel:Fe,ToggleSpawn:()=>{n.inScene?Fe():Ne()},SetFlag:e=>{if(Array.isArray(e))for(let t in e)n[e[t].flag]=e[t].value;else n[e.flag]=e.value},GetFlag:e=>{if(Array.isArray(e)){let t=[];for(let i in e)t.push(n(e[i]));return t}return n[e]},PlayPause:Be,Forward:Ve,Backward:je,NextPage:Ge,PrevPage:Ue,RandomPage:qe,Scale:We,Info:()=>{p=!p}}})(i,e)},checkSceneLoad:function(e,t){if(this.loadingObjects.size<=0){let e;"blink"===this.player.layer.transition.scene?(this.blink1Screen.EmitEvent("blinkScene2"),this.blink2Screen.EmitEvent("blinkScene2"),this.loadingScene=!1,e=setTimeout((()=>{this.blink1Screen.ChangeSelf({property:"visible",value:"false"}),this.blink2Screen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(e)}),800)):"fade"===this.player.layer.transition.scene?(this.fadeScreen.EmitEvent("fadeScene2"),this.loadingScene=!1,e=setTimeout((()=>{this.fadeScreen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(e)}),800)):"sphere"===this.player.layer.transition.scene?(this.sphereScreen.EmitEvent("sphereScene2"),this.loadingScene=!1,e=setTimeout((()=>{this.sphereScreen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(e)}),800)):"instant"===this.player.layer.transition.scene&&(this.loadingScene=!1,this.player.layer.teleporting=!1,this.player.EnableClick()),this.auxl.el.emit("sceneLoaded",{})}},tick:function(e,t){this.loadingScene&&(this.sceneReading||this.checkSceneLoadThrottled())}}),AFRAME.registerComponent("auxcontroller",{dependencies:["auxl"],schema:{update:{type:"number",default:0},id:{type:"string",default:"player"}},init:function(){this.id=this.data.id,this.time=0,this.aScene=document.querySelector("a-scene"),this.auxl=document.querySelector("a-scene").systems.auxl,this.locomotion,this.gimbal,this.vrController1,this.vrController2,this.controls={directionForwardKeys:["w","W"],directionLeftKeys:["a","A"],directionBackwardKeys:["s","S"],directionRightKeys:["d","D"],rotationForwardKeys:[null],rotationLeftKeys:[null],rotationBackwardKeys:[null],rotationRightKeys:[null],action1Keys:[" "," "],action2Keys:["q","Q"],action3Keys:["e","E"],action4Keys:["r","R"],action5Keys:["t","T"],action6Keys:["x","X"],action7Keys:["c","C"],action8Keys:["v","V"]},this.auxl.controlConfig=this.controls,this.mobileUpLeft=document.getElementById("upLeft"),this.mobileUp=document.getElementById("up"),this.mobileUpRight=document.getElementById("upRight"),this.mobileLeft=document.getElementById("left"),this.mobileCenter=document.getElementById("center"),this.mobileRight=document.getElementById("right"),this.mobileDownLeft=document.getElementById("downLeft"),this.mobileDown=document.getElementById("down"),this.mobileDownRight=document.getElementById("downRight"),this.mobileSelect=document.getElementById("select"),this.mobileStart=document.getElementById("start"),this.mobileA=document.getElementById("a"),this.mobileB=document.getElementById("b"),this.mobileC=document.getElementById("c"),this.mobileD=document.getElementById("d"),this.mobileE=document.getElementById("e"),this.mobileF=document.getElementById("f"),this.mobileL=document.getElementById("l"),this.mobileR=document.getElementById("r"),this.altDownFunc=!1,this.altDownParams=!1,this.altUpFunc=!1,this.altUpParams=!1,this.action1DownFunc=!1,this.action1DownParams=!1,this.action1UpFunc=!1,this.action1UpParams=!1,this.action2DownFunc=!1,this.action2DownParams=!1,this.action2UpFunc=!1,this.action2UpParams=!1,this.action3DownFunc=!1,this.action3DownParams=!1,this.action3UpFunc=!1,this.action3UpParams=!1,this.action4DownFunc=!1,this.action4DownParams=!1,this.action4UpFunc=!1,this.action4UpParams=!1,this.action5DownFunc=!1,this.action5DownParams=!1,this.action5UpFunc=!1,this.action5UpParams=!1,this.action6DownFunc=!1,this.action6DownParams=!1,this.action6UpFunc=!1,this.action6UpParams=!1,this.action7DownFunc=!1,this.action7DownParams=!1,this.action7UpFunc=!1,this.action7UpParams=!1,this.action8DownFunc=!1,this.action8DownParams=!1,this.action8UpFunc=!1,this.action8UpParams=!1,this.mainClickDetail={info:"Main Click",click:null},this.mainClickEvent=new CustomEvent("mainClick",{bubbles:!1,cancelable:!0,detail:this.mainClickDetail}),this.altClickDetail={info:"Alt Click",click:null},this.altClickEvent=new CustomEvent("altClick",{bubbles:!1,cancelable:!0,detail:this.altClickDetail}),this.directionEventDetail={info:"Direction",direction:null},this.directionEvent=new CustomEvent("direction",{bubbles:!1,cancelable:!0,detail:this.directionEventDetail}),this.rotationEventDetail={info:"Rotation",rotation:null},this.rotationEvent=new CustomEvent("rotation",{bubbles:!1,cancelable:!0,detail:this.rotationEventDetail}),this.action1EventDetail={info:"Action 1",action:null},this.action1Event=new CustomEvent("action1",{bubbles:!1,cancelable:!0,detail:this.action1EventDetail}),this.action2EventDetail={info:"Action 2",action:null},this.action2Event=new CustomEvent("action2",{bubbles:!1,cancelable:!0,detail:this.action2EventDetail}),this.action3EventDetail={info:"Action 3",action:null},this.action3Event=new CustomEvent("action3",{bubbles:!1,cancelable:!0,detail:this.action3EventDetail}),this.action4EventDetail={info:"Action 4",action:null},this.action4Event=new CustomEvent("action4",{bubbles:!1,cancelable:!0,detail:this.action4EventDetail}),this.action5EventDetail={info:"Action 5",action:null},this.action5Event=new CustomEvent("action5",{bubbles:!1,cancelable:!0,detail:this.action5EventDetail}),this.action6EventDetail={info:"Action 6",action:null},this.action6Event=new CustomEvent("action6",{bubbles:!1,cancelable:!0,detail:this.action6EventDetail}),this.action7EventDetail={info:"Action 7",action:null},this.action7Event=new CustomEvent("action7",{bubbles:!1,cancelable:!0,detail:this.action7EventDetail}),this.action8EventDetail={info:"Action 8",action:null},this.action8Event=new CustomEvent("action8",{bubbles:!1,cancelable:!0,detail:this.action8EventDetail}),this.mainClickHit=e=>{this.mainClick(e)},this.mainClickE=()=>{this.mainClickDetail.click="click",document.dispatchEvent(this.mainClickEvent)},this.mainClickDown=()=>{this.mainClickDetail.click="clickDown",document.dispatchEvent(this.mainClickEvent)},this.mainClickUp=()=>{this.mainClickDetail.click="clickUp",document.dispatchEvent(this.mainClickEvent)},this.altClickHit=e=>{this.altClick(e)},this.altClickDown=()=>{this.altClickDetail.click="altClickHit",document.dispatchEvent(this.altClickEvent)},this.altClickUp=()=>{this.altClickDetail.click="altClickRelease",document.dispatchEvent(this.altClickEvent)},this.dispatchAlt=()=>{document.dispatchEvent(this.altClickEvent)},this.directionHit=e=>{this.direction(e)},this.directionForwardLeftDown=()=>{this.directionForwardDown(),this.directionLeftDown()},this.directionForwardLeftUp=()=>{this.directionForwardUp(),this.directionLeftUp()},this.directionForwardDown=()=>{this.directionEventDetail.direction="forwardHit",document.dispatchEvent(this.directionEvent)},this.directionForwardUp=()=>{this.directionEventDetail.direction="forwardRelease",document.dispatchEvent(this.directionEvent)},this.directionForwardRightDown=()=>{this.directionForwardDown(),this.directionRightDown()},this.directionForwardRightUp=()=>{this.directionForwardUp(),this.directionRightUp()},this.directionLeftDown=()=>{this.directionEventDetail.direction="leftHit",document.dispatchEvent(this.directionEvent)},this.directionLeftUp=()=>{this.directionEventDetail.direction="leftRelease",document.dispatchEvent(this.directionEvent)},this.directionBackwardLeftDown=()=>{this.directionBackwardDown(),this.directionLeftDown()},this.directionBackwardLeftUp=()=>{this.directionBackwardUp(),this.directionLeftUp()},this.directionBackwardDown=()=>{this.directionEventDetail.direction="backwardHit",document.dispatchEvent(this.directionEvent)},this.directionBackwardUp=()=>{this.directionEventDetail.direction="backwardRelease",document.dispatchEvent(this.directionEvent)},this.directionBackwardRightDown=()=>{this.directionBackwardDown(),this.directionRightDown()},this.directionBackwardRightUp=()=>{this.directionBackwardUp(),this.directionRightUp()},this.directionRightDown=()=>{this.directionEventDetail.direction="rightHit",document.dispatchEvent(this.directionEvent)},this.directionRightUp=()=>{this.directionEventDetail.direction="rightRelease",document.dispatchEvent(this.directionEvent)},this.rotationHit=e=>{this.rotation(e)},this.rotationForwardLeftDown=()=>{this.rotationForwardDown(),this.rotationLeftDown()},this.rotationForwardLeftUp=()=>{this.rotationForwardUp(),this.rotationLeftUp()},this.rotationForwardDown=()=>{this.rotationEventDetail.rotation="forwardHit",document.dispatchEvent(this.rotationEvent)},this.rotationForwardUp=()=>{this.rotationEventDetail.rotation="forwardRelease",document.dispatchEvent(this.rotationEvent)},this.rotationForwardRightDown=()=>{this.rotationForwardDown(),this.rotationRightDown()},this.rotationForwardRightUp=()=>{this.rotationForwardUp(),this.rotationRightUp()},this.rotationLeftDown=()=>{this.rotationEventDetail.rotation="leftHit",document.dispatchEvent(this.rotationEvent)},this.rotationLeftUp=()=>{this.rotationEventDetail.rotation="leftRelease",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardLeftDown=()=>{this.rotationBackwardDown(),this.rotationLeftDown()},this.rotationBackwardLeftUp=()=>{this.rotationBackwardUp(),this.rotationLeftUp()},this.rotationBackwardDown=()=>{this.rotationEventDetail.rotation="backwardHit",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardUp=()=>{this.rotationEventDetail.rotation="backwardRelease",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardRightDown=()=>{this.rotationBackwardDown(),this.rotationRightDown()},this.rotationBackwardRightUp=()=>{this.rotationBackwardUp(),this.rotationRightUp()},this.rotationRightDown=()=>{this.rotationEventDetail.rotation="rightHit",document.dispatchEvent(this.rotationEvent)},this.rotationRightUp=()=>{this.rotationEventDetail.rotation="rightRelease",document.dispatchEvent(this.rotationEvent)},this.action1Hit=e=>{this.action1(e)},this.action1Down=()=>{this.action1EventDetail.action="action1Hit",document.dispatchEvent(this.action1Event)},this.action1Up=()=>{this.action1EventDetail.action="action1Release",document.dispatchEvent(this.action1Event)},this.action2Hit=e=>{this.action2(e)},this.action2Down=()=>{this.action2EventDetail.action="action2Hit",document.dispatchEvent(this.action2Event)},this.action2Up=()=>{this.action2EventDetail.action="action2Release",document.dispatchEvent(this.action2Event)},this.action3Hit=e=>{this.action3(e)},this.action3Down=()=>{this.action3EventDetail.action="action3Hit",document.dispatchEvent(this.action3Event)},this.action3Up=()=>{this.action3EventDetail.action="action3Release",document.dispatchEvent(this.action3Event)},this.action4Hit=e=>{this.action4(e)},this.action4Down=()=>{this.action4EventDetail.action="action4Hit",document.dispatchEvent(this.action4Event)},this.action4Up=()=>{this.action4EventDetail.action="action4Release",document.dispatchEvent(this.action4Event)},this.action5Hit=e=>{this.action5(e)},this.action5Down=()=>{this.action5EventDetail.action="action5Hit",document.dispatchEvent(this.action5Event)},this.action5Up=()=>{this.action5EventDetail.action="action5Release",document.dispatchEvent(this.action5Event)},this.action6Hit=e=>{this.action6(e)},this.action6Down=()=>{this.action6EventDetail.action="action6Hit",document.dispatchEvent(this.action6Event)},this.action6Up=()=>{this.action6EventDetail.action="action6Release",document.dispatchEvent(this.action6Event)},this.action7Hit=e=>{this.action7(e)},this.action7Down=()=>{this.action7EventDetail.action="action7Hit",document.dispatchEvent(this.action7Event)},this.action7Up=()=>{this.action7EventDetail.action="action7Release",document.dispatchEvent(this.action7Event)},this.action8Hit=e=>{this.action8(e)},this.action8Down=()=>{this.action8EventDetail.action="action8Hit",document.dispatchEvent(this.action8Event)},this.action8Up=()=>{this.action8EventDetail.action="action8Release",document.dispatchEvent(this.action8Event)},this.keyboardDownHit=e=>{this.keyboardDown(e)},this.keyboardUpHit=e=>{this.keyboardUp(e)},this.blankHit=e=>{this.blank(e)},this.questLeftMainClickDown=()=>{this.mainClickDetail.click="leftClickDown",document.dispatchEvent(this.mainClickEvent)},this.questLeftMainClickUp=()=>{this.mainClickDetail.click="leftClickUp",document.dispatchEvent(this.mainClickEvent)},this.questLeftAltClickDown=()=>{this.altClickDetail.click="leftAltClickDown",document.dispatchEvent(this.altClickEvent)},this.questLeftAltClickUp=()=>{this.altClickDetail.click="leftAltClickUp",document.dispatchEvent(this.altClickEvent)},this.questJoystickLocomotionEvent=e=>{1===this.auxl.joystickLoco||(4===this.auxl.joystickLoco?this.questJoystick4Locomotion(e):8===this.auxl.joystickLoco&&this.questJoystick8Locomotion(e))},this.deadzoneLoco=.1,this.xNumLoco=0,this.yNumLoco=0,this.angleLoco=0,this.angleDegLoco=0,this.questRightMainClickDown=()=>{this.mainClickDetail.click="rightClickDown",document.dispatchEvent(this.mainClickEvent)},this.questRightMainClickUp=()=>{this.mainClickDetail.click="rightClickUp",document.dispatchEvent(this.mainClickEvent)},this.questRightAltClickDown=()=>{this.altClickDetail.click="rightAltClickDown",document.dispatchEvent(this.altClickEvent)},this.questRightAltClickUp=()=>{this.altClickDetail.click="rightAltClickUp",document.dispatchEvent(this.altClickEvent)},this.questJoystickOtherEvent=e=>{this.questJoystick4Other(e)},this.deadzoneOther=.1,this.xNumOther=0,this.yNumOther=0,this.angleOther=0,this.angleDegOther=0,this.questJoystickRotationEvent=e=>{1===this.auxl.joystickRotation||(4===this.auxl.joystickRotation?this.questJoystick4Rotation(e):8===this.auxl.joystickRotation&&this.questJoystick8Rotation(e))},this.deadzoneRot=.1,this.xNumRot=0,this.yNumRot=0,this.angleRot=0,this.angleDegRot=0,this.toggled={},document.addEventListener("mainClick",this.mainClickHit),document.addEventListener("altClick",this.altClickHit),document.addEventListener("direction",this.directionHit),document.addEventListener("rotation",this.rotationHit),document.addEventListener("action1",this.action1Hit),document.addEventListener("action2",this.action2Hit),document.addEventListener("action3",this.action3Hit),document.addEventListener("action4",this.action4Hit),document.addEventListener("action5",this.action5Hit),document.addEventListener("action6",this.action6Hit),document.addEventListener("action7",this.action7Hit),document.addEventListener("action8",this.action8Hit),document.addEventListener("contextmenu",this.dispatchAlt),document.addEventListener("keydown",this.keyboardDownHit),document.addEventListener("keyup",this.keyboardUpHit),setTimeout((()=>{this.auxl.mouseController.GetEl().addEventListener("mousedown",this.mainClickDown),this.auxl.mouseController.GetEl().addEventListener("mouseup",this.mainClickUp),this.locomotion=this.el.components.locomotion,this.vrController1=document.getElementById("vrController1"),this.vrController2=document.getElementById("vrController2"),this.vrController1.addEventListener("triggerdown",this.questLeftMainClickDown),this.vrController1.addEventListener("triggerup",this.questLeftMainClickUp),this.vrController1.addEventListener("gripdown",this.questLeftAltClickDown),this.vrController1.addEventListener("gripup",this.questLeftAltClickUp),this.vrController1.addEventListener("xbuttondown",this.action1Down),this.vrController1.addEventListener("xbuttonup",this.action1Up),this.vrController1.addEventListener("ybuttondown",this.action2Down),this.vrController1.addEventListener("ybuttonup",this.action2Up),this.vrController2.addEventListener("triggerdown",this.questRightMainClickDown),this.vrController2.addEventListener("triggerup",this.questRightMainClickUp),this.vrController2.addEventListener("gripdown",this.questRightAltClickDown),this.vrController2.addEventListener("gripup",this.questRightAltClickUp),this.vrController2.addEventListener("abuttondown",this.action3Down),this.vrController2.addEventListener("abuttonup",this.action3Up),this.vrController2.addEventListener("bbuttondown",this.action4Down),this.vrController2.addEventListener("bbuttonup",this.action4Up),this.addJoystickEvents(),this.initDone=!0}),100),this.mobileUpLeft.addEventListener("touchstart",this.directionForwardLeftDown),this.mobileUpLeft.addEventListener("touchend",this.directionForwardLeftUp),this.mobileUp.addEventListener("touchstart",this.directionForwardDown),this.mobileUp.addEventListener("touchend",this.directionForwardUp),this.mobileUpRight.addEventListener("touchstart",this.directionForwardRightDown),this.mobileUpRight.addEventListener("touchend",this.directionForwardRightUp),this.mobileLeft.addEventListener("touchstart",this.directionLeftDown),this.mobileLeft.addEventListener("touchend",this.directionLeftUp),this.mobileCenter.addEventListener("touchstart",this.blankHit),this.mobileCenter.addEventListener("touchend",this.blankHit),this.mobileRight.addEventListener("touchstart",this.directionRightDown),this.mobileRight.addEventListener("touchend",this.directionRightUp),this.mobileDownLeft.addEventListener("touchstart",this.directionBackwardLeftDown),this.mobileDownLeft.addEventListener("touchend",this.directionBackwardLeftUp),this.mobileDown.addEventListener("touchstart",this.directionBackwardDown),this.mobileDown.addEventListener("touchend",this.directionBackwardUp),this.mobileDownRight.addEventListener("touchstart",this.directionBackwardRightDown),this.mobileDownRight.addEventListener("touchend",this.directionBackwardRightUp),this.mobileSelect.addEventListener("touchstart",this.blankHit),this.mobileStart.addEventListener("touchstart",this.blankHit),this.mobileA.addEventListener("touchstart",this.action1Down),this.mobileA.addEventListener("touchend",this.action1Up),this.mobileB.addEventListener("touchstart",this.action2Down),this.mobileB.addEventListener("touchend",this.action2Up),this.mobileC.addEventListener("touchstart",this.action3Down),this.mobileC.addEventListener("touchend",this.action3Up),this.mobileD.addEventListener("touchstart",this.action4Down),this.mobileD.addEventListener("touchend",this.action4Up),this.mobileE.addEventListener("touchstart",this.action5Down),this.mobileE.addEventListener("touchend",this.action5Up),this.mobileF.addEventListener("touchstart",this.action6Down),this.mobileF.addEventListener("touchend",this.action6Up),this.mobileL.addEventListener("touchstart",this.action7Down),this.mobileL.addEventListener("touchend",this.action7Up),this.mobileR.addEventListener("touchstart",this.action8Down),this.mobileR.addEventListener("touchend",this.action8Up)},updateInput:function(e){},updateAction:function(e){for(let t in e){let i,o,a;if("altDown"===t)i="altDownFunc",o="altDownParams",a="center";else if("altUp"===t)i="altUpFunc",o="altUpParams",a="center";else if("action1Down"===t)i="action1DownFunc",o="action1DownParams",a="a";else if("action1Up"===t)i="action1UpFunc",o="action1UpParams",a="a";else if("action2Down"===t)i="action2DownFunc",o="action2DownParams",a="b";else if("action2Up"===t)i="action2UpFunc",o="action2UpParams",a="b";else if("action3Down"===t)i="action3DownFunc",o="action3DownParams",a="c";else if("action3Up"===t)i="action3UpFunc",o="action3UpParams",a="c";else if("action4Down"===t)i="action4DownFunc",o="action4DownParams",a="d";else if("action4Up"===t)i="action4UpFunc",o="action4UpParams",a="d";else if("action5Down"===t)i="action5DownFunc",o="action5DownParams",a="e";else if("action5Up"===t)i="action5UpFunc",o="action5UpParams",a="e";else if("action6Down"===t)i="action6DownFunc",o="action6DownParams",a="f";else if("action6Up"===t)i="action6UpFunc",o="action6UpParams",a="f";else if("action7Down"===t)i="action7DownFunc",o="action7DownParams",a="l";else if("action7Up"===t)i="action7UpFunc",o="action7UpParams",a="l";else if("action8Down"===t)i="action8DownFunc",o="action8DownParams",a="r";else{if("action8Up"!==t)return void console.log("Failed to identify action");i="action8UpFunc",o="action8UpParams",a="r"}if(e[t]){let n=e[t].auxlObj,s=!1;e[t].component&&(s=e[t].component);let r=e[t].func;this[o]=!1,e[t].params&&(this[o]=e[t].params),this[i]=s?document.getElementById(n).components[s][r].bind(document.getElementById(n).components[s]):this.auxl[n][r],e[t].name&&(this.auxl.controlsInfo[t]={name:e[t].name,info:e[t].info}),this.auxl.ToggleHTML(a,!0)}else this[i]=!1,this[o]=!1}},disableAction:function(e){for(let t in e){let i,o,a;if("altDown"===t)i="altDownFunc",o="altDownParams",a="center";else if("altUp"===t)i="altUpFunc",o="altUpParams",a="center";else if("action1Down"===t)i="action1DownFunc",o="action1DownParams",a="a";else if("action1Up"===t)i="action1UpFunc",o="action1UpParams",a="a";else if("action2Down"===t)i="action2DownFunc",o="action2DownParams",a="b";else if("action2Up"===t)i="action2UpFunc",o="action2UpParams",a="b";else if("action3Down"===t)i="action3DownFunc",o="action3DownParams",a="c";else if("action3Up"===t)i="action3UpFunc",o="action3UpParams",a="c";else if("action4Down"===t)i="action4DownFunc",o="action4DownParams",a="d";else if("action4Up"===t)i="action4UpFunc",o="action4UpParams",a="d";else if("action5Down"===t)i="action5DownFunc",o="action5DownParams",a="e";else if("action5Up"===t)i="action5UpFunc",o="action5UpParams",a="e";else if("action6Down"===t)i="action6DownFunc",o="action6DownParams",a="f";else if("action6Up"===t)i="action6UpFunc",o="action6UpParams",a="f";else if("action7Down"===t)i="action7DownFunc",o="action7DownParams",a="l";else if("action7Up"===t)i="action7UpFunc",o="action7UpParams",a="l";else if("action8Down"===t)i="action8DownFunc",o="action8DownParams",a="r";else{if("action8Up"!==t)return console.log("Failed to identify action"),console.log(t),void console.log(e[t]);i="action8UpFunc",o="action8UpParams",a="r"}this.auxl.controlsInfo[t]&&delete this.auxl.controlsInfo[t],this.auxl.ToggleHTML(a,!1),this[i]=!1,this[o]=!1}},mainClick:function(e){e.target&&e.target.URL||(["clickDown","leftClickDown","rightClickDown"].includes(e.detail.click)?this.auxl.player.TriggerDown(e):["clickUp","leftClickUp","rightClickUp"].includes(e.detail.click)&&this.auxl.player.TriggerUp(e))},altClick:function(e){"altClickHit"===e.detail.action?this.altDownFunc&&(this.altDownParams?this.altDownFunc(this.altDownParams):this.altDownFunc()):"altClickRelease"===e.detail.action&&this.altUpFunc&&(this.altUpParams?this.altUpFunc(this.altUpParams):this.altUpFunc())},direction:function(e){"forwardHit"===e.detail.direction?this.locomotion.movingForward():"forwardRelease"===e.detail.direction?this.locomotion.cancelForward():"leftHit"===e.detail.direction?this.locomotion.movingLeft():"leftRelease"===e.detail.direction?this.locomotion.cancelLeft():"backwardHit"===e.detail.direction?this.locomotion.movingReverse():"backwardRelease"===e.detail.direction?this.locomotion.cancelReverse():"rightHit"===e.detail.direction?this.locomotion.movingRight():"rightRelease"===e.detail.direction&&this.locomotion.cancelRight()},rotation:function(e){"forwardHit"===e.detail.rotation?this.gimbal.movingForward():"forwardRelease"===e.detail.rotation?this.gimbal.cancelForward():"leftHit"===e.detail.rotation?this.gimbal.movingLeft():"leftRelease"===e.detail.rotation?this.gimbal.cancelLeft():"backwardHit"===e.detail.rotation?this.gimbal.movingReverse():"backwardRelease"===e.detail.rotation?this.gimbal.cancelReverse():"rightHit"===e.detail.rotation?this.gimbal.movingRight():"rightRelease"===e.detail.rotation&&this.gimbal.cancelRight()},action1:function(e){"action1Hit"===e.detail.action?this.action1DownFunc&&(this.action1DownParams?this.action1DownFunc(this.action1DownParams):this.action1DownFunc()):"action1Release"===e.detail.action&&this.action1UpFunc&&(this.action1UpParams?this.action1UpFunc(this.action1UpParams):this.action1UpFunc())},action2:function(e){"action2Hit"===e.detail.action?this.action2DownFunc&&(this.action2DownParams?this.action2DownFunc(this.action2DownParams):this.action2DownFunc()):"action2Release"===e.detail.action&&this.action2UpFunc&&(this.action2UpParams?this.action2UpFunc(this.action2UpParams):this.action2UpFunc())},action3:function(e){"action3Hit"===e.detail.action?this.action3DownFunc&&(this.action3DownParams?this.action3DownFunc(this.action3DownParams):this.action3DownFunc()):"action3Release"===e.detail.action&&this.action3UpFunc&&(this.action3UpParams?this.action3UpFunc(this.action3UpParams):this.action3UpFunc())},action4:function(e){"action4Hit"===e.detail.action?this.action4DownFunc&&(this.action4DownParams?this.action4DownFunc(this.action4DownParams):this.action4DownFunc()):"action4Release"===e.detail.action&&this.action4UpFunc&&(this.action4UpParams?this.action4UpFunc(this.action4UpParams):this.action4UpFunc())},action5:function(e){"action5Hit"===e.detail.action?this.action5DownFunc&&(this.action5DownParams?this.action5DownFunc(this.action5DownParams):this.action5DownFunc()):"action5Release"===e.detail.action&&this.action5UpFunc&&(this.action5UpParams?this.action5UpFunc(this.action5UpParams):this.action5UpFunc())},action6:function(e){"action6Hit"===e.detail.action?this.action6DownFunc&&(this.action6DownParams?this.action6DownFunc(this.action6DownParams):this.action6DownFunc()):"action6Release"===e.detail.action&&this.action6UpFunc&&(this.action6UpParams?this.action6UpFunc(this.action6UpParams):this.action6UpFunc())},action7:function(e){"action7Hit"===e.detail.action?this.action7DownFunc&&(this.action7DownParams?this.action7DownFunc(this.action7DownParams):this.action7DownFunc()):"action7Release"===e.detail.action&&this.action7UpFunc&&(this.action7UpParams?this.action7UpFunc(this.action7UpParams):this.action7UpFunc())},action8:function(e){"action8Hit"===e.detail.action?this.action8DownFunc&&(this.action8DownParams?this.action8DownFunc(this.action8DownParams):this.action8DownFunc()):"action8Release"===e.detail.action&&this.action8UpFunc&&(this.action8UpParams?this.action8UpFunc(this.action8UpParams):this.action8UpFunc())},keyboardDown:function(e){Object.keys(this.toggled).includes(e.key)||(this.toggled[e.key]=!0,this.controls.directionForwardKeys.includes(e.key)?this.directionForwardDown():this.controls.directionLeftKeys.includes(e.key)?this.directionLeftDown():this.controls.directionBackwardKeys.includes(e.key)?this.directionBackwardDown():this.controls.directionRightKeys.includes(e.key)?this.directionRightDown():this.controls.rotationForwardKeys.includes(e.key)?this.rotationForwardDown():this.controls.rotationLeftKeys.includes(e.key)?this.rotationLeftDown():this.controls.rotationBackwardKeys.includes(e.key)?this.rotationBackwardDown():this.controls.rotationRightKeys.includes(e.key)?this.rotationRightDown():this.controls.action1Keys.includes(e.key)?this.action1Down():this.controls.action2Keys.includes(e.key)?this.action2Down():this.controls.action3Keys.includes(e.key)?this.action3Down():this.controls.action4Keys.includes(e.key)?this.action4Down():this.controls.action5Keys.includes(e.key)?this.action5Down():this.controls.action6Keys.includes(e.key)?this.action6Down():this.controls.action7Keys.includes(e.key)?this.action7Down():this.controls.action8Keys.includes(e.key)&&this.action8Down())},keyboardUp:function(e){delete this.toggled[e.key],this.controls.directionForwardKeys.includes(e.key)?this.directionForwardUp():this.controls.directionLeftKeys.includes(e.key)?this.directionLeftUp():this.controls.directionBackwardKeys.includes(e.key)?this.directionBackwardUp():this.controls.directionRightKeys.includes(e.key)?this.directionRightUp():this.controls.rotationForwardKeys.includes(e.key)?this.rotationForwardUp():this.controls.rotationLeftKeys.includes(e.key)?this.rotationLeftUp():this.controls.rotationBackwardKeys.includes(e.key)?this.rotationBackwardUp():this.controls.rotationRightKeys.includes(e.key)?this.rotationRightUp():this.controls.action1Keys.includes(e.key)?this.action1Up():this.controls.action2Keys.includes(e.key)?this.action2Up():this.controls.action3Keys.includes(e.key)?this.action3Up():this.controls.action4Keys.includes(e.key)?this.action4Up():this.controls.action5Keys.includes(e.key)?this.action5Up():this.controls.action6Keys.includes(e.key)?this.action6Up():this.controls.action7Keys.includes(e.key)?this.action7Up():this.controls.action8Keys.includes(e.key)&&this.action8Up()},questJoystick4Locomotion:function(e){this.xNumLoco=e.detail.x,this.yNumLoco=e.detail.y,this.angleLoco=Math.atan2(this.xNumLoco,this.yNumLoco),this.angleDegLoco=this.angleLoco/(Math.PI/180),this.yNumLoco<this.deadzoneLoco&&this.yNumLoco>-1*this.deadzoneLoco&&this.xNumLoco>-1*this.deadzoneLoco&&this.xNumLoco<this.deadzoneLoco?(this.locomotion.clearMovement(),this.updateInput("Locomotion Clear")):this.yNumLoco>this.deadzoneLoco||this.yNumLoco<-1*this.deadzoneLoco||this.xNumLoco<-1*this.deadzoneLoco||this.xNumLoco>this.deadzoneLoco?this.angleDegLoco>-45&&this.angleDegLoco<45?(this.locomotion.clearMovement(),this.locomotion.movingReverse()):this.angleDegLoco>45&&this.angleDegLoco<135?(this.locomotion.clearMovement(),this.locomotion.movingRight()):this.angleDegLoco>135||this.angleDegLoco<-135?(this.locomotion.clearMovement(),this.locomotion.movingForward()):this.angleDegLoco<-45&&this.angleDegLoco>-135&&(this.locomotion.clearMovement(),this.locomotion.movingLeft()):this.locomotion.clearMovement()},questJoystick8Locomotion:function(e){this.xNumLoco=e.detail.x,this.yNumLoco=e.detail.y,this.angleLoco=Math.atan2(this.xNumLoco,this.yNumLoco),this.angleDegLoco=this.angleLoco/(Math.PI/180),this.yNumLoco<this.deadzoneLoco&&this.yNumLoco>-1*this.deadzoneLoco&&this.xNumLoco>-1*this.deadzoneLoco&&this.xNumLoco<this.deadzoneLoco?this.locomotion.clearMovement():this.yNumLoco>this.deadzoneLoco||this.yNumLoco<-1*this.deadzoneLoco||this.xNumLoco<-1*this.deadzoneLoco||this.xNumLoco>this.deadzoneLoco?(this.locomotion.clearMovement(),this.angleDegLoco>-22.5&&this.angleDegLoco<22.5?this.directionBackwardDown():this.angleDegLoco>22.5&&this.angleDegLoco<67.5?this.directionBackwardRightDown():this.angleDegLoco>67.5&&this.angleDegLoco<112.5?this.directionRightDown():this.angleDegLoco>112.5&&this.angleDegLoco<157.5?this.directionForwardRightDown():this.angleDegLoco>157.5||this.angleDegLoco<-157.5?this.directionForwardDown():this.angleDegLoco<-112.5&&this.angleDegLoco>-157.5?this.directionForwardLeftDown():this.angleDegLoco<-67.5&&this.angleDegLoco>-112.5?this.directionLeftDown():this.angleDegLoco<-22.5&&this.angleDegLoco>-67.5&&this.directionBackwardLeftDown()):this.locomotion.clearMovement()},questJoystick4Rotation:function(e){this.xNumRot=e.detail.x,this.yNumRot=e.detail.y,this.angleRot=Math.atan2(this.xNumRot,this.yNumRot),this.angleDegRot=this.angleRot/(Math.PI/180),this.yNumRot<this.deadzoneRot&&this.yNumRot>-1*this.deadzoneRot&&this.xNumRot>-1*this.deadzoneRot&&this.xNumRot<this.deadzoneRot?(this.gimbal.clearMovement(),this.updateInput("Rotation Clear")):this.yNumRot>this.deadzoneRot||this.yNumRot<-1*this.deadzoneRot||this.xNumRot<-1*this.deadzoneRot||this.xNumRot>this.deadzoneRot?this.angleDegRot>-45&&this.angleDegRot<45?(this.gimbal.clearMovement(),this.gimbal.movingReverse()):this.angleDegRot>45&&this.angleDegRot<135?(this.gimbal.clearMovement(),this.gimbal.movingRight()):this.angleDegRot>135||this.angleDegRot<-135?(this.gimbal.clearMovement(),this.gimbal.movingForward()):this.angleDegRot<-45&&this.angleDegRot>-135&&(this.gimbal.clearMovement(),this.gimbal.movingLeft()):this.gimbal.clearMovement()},questJoystick8Rotation:function(e){this.xNumRot=e.detail.x,this.yNumRot=e.detail.y,this.angleRot=Math.atan2(this.xNumRot,this.yNumRot),this.angleDegRot=this.angleRot/(Math.PI/180),this.yNumRot<this.deadzoneRot&&this.yNumRot>-1*this.deadzoneRot&&this.xNumRot>-1*this.deadzoneRot&&this.xNumRot<this.deadzoneRot?(this.gimbal.clearMovement(),this.updateInput("Rotation Clear")):this.yNumRot>this.deadzoneRot||this.yNumRot<-1*this.deadzoneRot||this.xNumRot<-1*this.deadzoneRot||this.xNumRot>this.deadzoneRot?this.angleDegRot>-22.5&&this.angleDegRot<22.5?(this.gimbal.clearMovement(),this.gimbal.movingReverse()):this.angleDegRot>22.5&&this.angleDegRot<67.5?(this.gimbal.clearMovement(),this.gimbal.movingReverse(),this.gimbal.movingRight()):this.angleDegRot>67.5&&this.angleDegRot<112.5?(this.gimbal.clearMovement(),this.gimbal.movingRight()):this.angleDegRot>112.5&&this.angleDegRot<157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward(),this.gimbal.movingRight()):this.angleDegRot>157.5||this.angleDegRot<-157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward()):this.angleDegRot<-112.5&&this.angleDegRot>-157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward(),this.gimbal.movingLeft()):this.angleDegRot<-67.5&&this.angleDegRot>-112.5?(this.gimbal.clearMovement(),this.gimbal.movingLeft()):this.angleDegRot<-22.5&&this.angleDegRot>-67.5&&(this.gimbal.clearMovement(),this.gimbal.movingReverse(),this.gimbal.movingLeft()):this.gimbal.clearMovement()},questJoystick4Other:function(e){this.xNumOther=e.detail.x,this.yNumOther=e.detail.y,this.angleOther=Math.atan2(this.xNumOther,this.yNumOther),this.angleDegOther=this.angleOther/(Math.PI/180),this.yNumOther<this.deadzoneOther&&this.yNumOther>-1*this.deadzone&&this.xNumOther>-1*this.deadzoneOther&&this.xNumOther<this.deadzoneOther?this.updateInput("Rotation|Duck Clear"):(this.yNumOther>this.deadzoneOther||this.yNumOther<-1*this.deadzoneOther||this.xNumOther<-1*this.deadzoneOther||this.xNumOther>this.deadzoneOther)&&(this.angleDegOther>-45&&this.angleDegOther<45?this.action6Down():this.angleDegOther>45&&this.angleDegOther<135?this.action8Down():this.angleDegOther>135||this.angleDegOther<-135?this.action5Down():this.angleDegOther<-45&&this.angleDegOther>-135&&this.action7Down())},addJoystickEvents:function(){["bothRight","bothLeftLoco"].includes(this.auxl.vrHand)?(this.vrController1.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.addEventListener("thumbstickmoved",this.questJoystickOtherEvent)):["bothLeft","bothRightLoco"].includes(this.auxl.vrHand)?(this.vrController2.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController1.addEventListener("thumbstickmoved",this.questJoystickOtherEvent)):(this.vrController1.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.addEventListener("thumbstickmoved",this.questJoystickOtherEvent)),this.questJoystickLocomotionEvent=e=>{1===this.auxl.joystickLoco||(4===this.auxl.joystickLoco?this.questJoystick4Locomotion(e):8===this.auxl.joystickLoco&&this.questJoystick8Locomotion(e))},this.deadzoneLoco=.1,this.xNumLoco=0,this.yNumLoco=0,this.angleLoco=0,this.angleDegLoco=0,this.questJoystickRotationEvent=e=>{1===this.auxl.joystickRotation||(4===this.auxl.joystickRotation?this.questJoystick4Rotation(e):8===this.auxl.joystickRotation&&this.questJoystick8Rotation(e))},this.deadzoneOther=.1,this.xNumOther=0,this.yNumOther=0,this.angleOther=0,this.angleDegOther=0},clearJoystickEvents:function(){["bothRight","bothLeftLoco"].includes(this.auxl.vrHand)?(this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent)):["bothLeft","bothRightLoco"].includes(this.auxl.vrHand)?(this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent)):(this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent))},blank:function(e){console.log(e)},update:function(){this.initDone&&(this.clearJoystickEvents(),setTimeout((()=>{this.addJoystickEvents()}),100))},remove:function(){document.removeEventListener("mainClick",this.mainClickHit),document.removeEventListener("altClick",this.altClickHit),document.removeEventListener("direction",this.directionHit),document.removeEventListener("rotation",this.rotationHit),document.removeEventListener("action1",this.action1Hit),document.removeEventListener("action2",this.action2Hit),document.removeEventListener("action3",this.action3Hit),document.removeEventListener("action4",this.action4Hit),document.removeEventListener("action5",this.action5Hit),document.removeEventListener("action6",this.action6Hit),document.removeEventListener("action7",this.action7Hit),document.removeEventListener("action8",this.action8Hit),document.removeEventListener("contextmenu",this.dispatchAlt),document.removeEventListener("keydown",this.keyboardDownHit),document.removeEventListener("keyup",this.keyboardUpHit),this.auxl.mouseController.GetEl().removeEventListener("mousedown",this.mainClickDown),this.auxl.mouseController.GetEl().removeEventListener("mouseup",this.mainClickUp),this.vrController1.removeEventListener("triggerdown",this.questLeftMainClickDown),this.vrController1.removeEventListener("triggerup",this.questLeftMainClickUp),this.vrController1.removeEventListener("gripdown",this.questLeftAltClickDown),this.vrController1.removeEventListener("gripup",this.questLeftAltClickUp),this.vrController1.removeEventListener("xbuttondown",this.action1Down),this.vrController1.removeEventListener("xbuttonup",this.action1Up),this.vrController1.removeEventListener("ybuttondown",this.action2Down),this.vrController1.removeEventListener("ybuttonup",this.action2Up),this.vrController2.removeEventListener("triggerdown",this.questRightMainClickDown),this.vrController2.removeEventListener("triggerup",this.questRightMainClickUp),this.vrController2.removeEventListener("gripdown",this.questRightAltClickDown),this.vrController2.removeEventListener("gripup",this.questRightAltClickUp),this.vrController2.removeEventListener("abuttondown",this.action3Down),this.vrController2.removeEventListener("abuttonup",this.action3Up),this.vrController2.removeEventListener("bbuttondown",this.action4Down),this.vrController2.removeEventListener("bbuttonup",this.action4Up),this.clearJoystickEvents(),this.mobileUpLeft.removeEventListener("mousedown",this.directionForwardLeftDown),this.mobileUpLeft.removeEventListener("mouseup",this.directionForwardLeftUp),this.mobileUp.removeEventListener("mousedown",this.directionForwardDown),this.mobileUp.removeEventListener("mouseup",this.directionForwardUp),this.mobileUpRight.removeEventListener("mousedown",this.directionForwardRightDown),this.mobileUpRight.removeEventListener("mouseup",this.directionForwardRightUp),this.mobileLeft.removeEventListener("mousedown",this.directionLeftDown),this.mobileLeft.removeEventListener("mouseup",this.directionLeftUp),this.mobileCenter.removeEventListener("mousedown",this.blankHit),this.mobileCenter.removeEventListener("mouseup",this.blankHit),this.mobileRight.removeEventListener("mousedown",this.directionRightDown),this.mobileRight.removeEventListener("mouseup",this.directionRightUp),this.mobileDownLeft.removeEventListener("mousedown",this.directionBackwardLeftDown),this.mobileDownLeft.removeEventListener("mouseup",this.directionBackwardLeftUp),this.mobileDown.removeEventListener("mousedown",this.directionBackwardDown),this.mobileDown.removeEventListener("mouseup",this.directionBackwardUp),this.mobileDownRight.removeEventListener("mousedown",this.directionBackwardRightDown),this.mobileDownRight.removeEventListener("mouseup",this.directionBackwardRightUp),this.mobileSelect.removeEventListener("mousedown",this.blankHit),this.mobileStart.removeEventListener("mousedown",this.blankHit),this.mobileA.removeEventListener("mousedown",this.action1Down),this.mobileA.removeEventListener("mouseup",this.action1Up),this.mobileB.removeEventListener("mousedown",this.action2Down),this.mobileB.removeEventListener("mouseup",this.action2Up),this.mobileC.removeEventListener("mousedown",this.action3Down),this.mobileC.removeEventListener("mouseup",this.action3Up),this.mobileD.removeEventListener("mousedown",this.action4Down),this.mobileD.removeEventListener("mouseup",this.action4Up),this.mobileE.removeEventListener("mousedown",this.action5Down),this.mobileE.removeEventListener("mouseup",this.action5Up),this.mobileF.removeEventListener("mousedown",this.action6Down),this.mobileF.removeEventListener("mouseup",this.action6Up),this.mobileL.removeEventListener("touchstart",this.action7Down),this.mobileL.removeEventListener("touchend",this.action7Up),this.mobileR.removeEventListener("touchstart",this.action8Down),this.mobileR.removeEventListener("touchend",this.action8Up)},events:{"raycaster-intersected":function(e){},"raycaster-intersected-cleared":function(e){},"raycaster-intersection":function(e){},"raycaster-intersection-cleared":function(e){},"raycaster-closest-entity-changed":function(e){},mouseenter:function(e){this.auxl[this.id].TriggerEnter(e)},mousedown:function(e){this.Measure(),this.auxl[this.id].TriggerDown(e)},mouseup:function(e){this.auxl[this.id].TriggerUp(e),this.Measure(!0)},mouseleave:function(e){this.auxl[this.id].TriggerLeave(e)},collide:function(e){},click:function(e){},altclick:function(e){},keydown:function(e){},keyup:function(e){}},tick:function(e,t){this.measure?this.time>1?this.time--:(this.time=0,this.Measure(!0)):this.time=1,this.auxl[this.id]&&this.auxl[this.id].Ticker(this.time,this)},Measure:function(e){this.measure=!e}}),AFRAME.registerComponent("locomotion",{dependencies:["auxl"],schema:{uiid:{type:"string",default:"ui"},ray:{type:"string",default:"camera"},courserid:{type:"string",default:"mouseCursor"},movetype:{type:"string",default:"vr"},pov:{type:"string",default:"1st"},style:{type:"string",default:"free"},axis:{type:"string",default:"posXZ"},speedFast:{type:"number",default:.15},speedSlow:{type:"number",default:.075}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.freeStepThrottled=AFRAME.utils.throttle(this.freeStep,30,this),this.gridStepThrottled=AFRAME.utils.throttle(this.gridStep,400,this),this.mouseCursor=document.getElementById(this.data.courserid),this.data.uuid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,this.pov=this.data.pov,this.style=this.data.style,this.axis=this.data.axis,this.directionForward,this.directionReverse,this.directionBrake1,this.directionBrake2,this.directionBrake3,this.directionBrake4,this.camera=document.getElementById(this.data.ray),this.ray=document.getElementById(this.data.ray),this.rayBody=document.getElementById("playerRig"),this.rayRot=new THREE.Vector3,this.player=document.getElementById("playerRig"),this.avatar,this.avatarSphere,this.ui=document.getElementById("beltUIParent"),this.positionCam=new THREE.Vector3,this.positionPlayer=new THREE.Vector3,this.rotationPlayer=new THREE.Vector3,this.positionAvatar=new THREE.Vector3,this.rotationAvatar=new THREE.Vector3,this.positionNew=new THREE.Vector3,this.rotationNew=new THREE.Vector3,this.positionTemp=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.vector,this.angle,this.directionObject,this.directionVector=new THREE.Vector3,this.posRound=new THREE.Vector3,this.newPosRound=new THREE.Vector3,this.newPosStandRound=new THREE.Vector3,this.newPosTemp=new THREE.Vector3,this.mapX,this.mapZ,this.elPosVec3New=new THREE.Vector3,this.velocity,this.userPreviousPos=this.player.getAttribute("position"),this.userPos,this.userRot,this.userPov,this.userTravel,this.userView,this.newX,this.newZ,this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveUp=!1,this.moveDown=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault=this.data.speedFast,this.moveSpeedSlow=this.data.speedSlow,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridUpTimeout,this.gridDownTimeout,this.gridMove=!1,this.gridSpeed=400,setTimeout((()=>{"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere"),"angleXY"===this.axis&&(this.avatar.object3D.position.copy(new THREE.Vector3(0,0,-10)),this.player.object3D.position.copy(new THREE.Vector3(0,1.6,2)))}),500))}),1e3)},round:function(e){return Math.round(e)},roundHalf:function(e){return Math.round(2*e)/2},movingForward:function(){clearTimeout(this.gridForwardTimeout),this.moveTo||(this.moveTo=!0)},cancelForward:function(){this.moveTo&&("grid"===this.style?this.gridMove?this.moveTo=!1:this.gridForwardTimeout=setTimeout((()=>{this.moveTo=!1}),this.gridSpeed/1.25):this.moveTo=!1)},movingReverse:function(){clearTimeout(this.gridReverseTimeout),this.moveBack||(this.moveBack=!0)},cancelReverse:function(){this.moveBack&&("grid"===this.style?this.gridMove?this.moveBack=!1:this.gridReverseTimeout=setTimeout((()=>{this.moveBack=!1}),this.gridSpeed/1.25):this.moveBack=!1)},movingLeft:function(){clearTimeout(this.gridLeftTimeout),this.moveLeft||(this.moveLeft=!0)},cancelLeft:function(){this.moveLeft&&("grid"===this.style?this.gridMove?this.moveLeft=!1:this.gridLeftTimeout=setTimeout((()=>{this.moveLeft=!1}),this.gridSpeed/1.25):this.moveLeft=!1)},movingRight:function(){clearTimeout(this.gridRightTimeout),this.moveRight||(this.moveRight=!0)},cancelRight:function(){this.moveRight&&("grid"===this.style?this.gridMove?this.moveRight=!1:this.gridRightTimeout=setTimeout((()=>{this.moveRight=!1}),this.gridSpeed/1.25):this.moveRight=!1)},movingUp:function(){clearTimeout(this.gridUpTimeout),this.moveUp||(this.moveUp=!0)},cancelUp:function(){this.moveUp&&("grid"===this.style?this.gridMove?this.moveUp=!1:this.gridUpTimeout=setTimeout((()=>{this.moveUp=!1}),this.gridSpeed/1.25):this.moveUp=!1)},movingDown:function(){clearTimeout(this.gridDownTimeout),this.moveDown||(this.moveDown=!0)},cancelDown:function(){this.moveDown&&("grid"===this.style?this.gridMove?this.moveDown=!1:this.gridDownTimeout=setTimeout((()=>{this.moveDown=!1}),this.gridSpeed/1.25):this.moveDown=!1)},clearMovement:function(){this.cancelForward(),this.cancelReverse(),this.cancelLeft(),this.cancelRight(),this.cancelUp(),this.cancelDown()},clearGridMovement:function(){this.moveTo=!1,this.moveBack=!1,this.moveLeft=!1,this.moveRight=!1,clearTimeout(this.gridForwardTimeout),clearTimeout(this.gridReverseTimeout),clearTimeout(this.gridLeftTimeout),clearTimeout(this.gridRightTimeout)},toggleSpeed:function(){this.brakeReady&&(this.brakeToggle?(this.brakeToggle=!1,this.brakeReady=!1,this.moveBrake=!0,this.gridSpeed=400,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)):(this.brakeToggle=!0,this.brakeReady=!1,this.moveBrake=!1,this.gridSpeed=200,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)),this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),250))},brakeReadBufferLong:function(){this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),2250)},hoverLocomotion:function(e){this.brakeReady&&(this.brakeToggle?(this.brakeToggle=!1,this.brakeReady=!1,this.moveBrake=!0,this.directionBrake1.setAttribute("material",{color:"red"}),this.directionBrake2.setAttribute("material",{color:"red"}),this.directionBrake3.setAttribute("material",{color:"red"}),this.directionBrake4.setAttribute("material",{color:"red"}),this.directionForward.emit("brakeOn",{}),this.directionReverse.emit("brakeOn",{}),this.directionBrake1.emit("brakeOn",{}),this.directionBrake2.emit("brakeOn",{}),this.directionBrake3.emit("brakeOn",{}),this.directionBrake4.emit("brakeOn",{})):(this.brakeToggle=!0,this.brakeReady=!1,this.moveBrake=!1,this.directionBrake1.setAttribute("material",{color:"black"}),this.directionBrake2.setAttribute("material",{color:"black"}),this.directionBrake3.setAttribute("material",{color:"black"}),this.directionBrake4.setAttribute("material",{color:"black"}),this.directionForward.emit("brakeOff",{}),this.directionReverse.emit("brakeOff",{}),this.directionBrake1.emit("brakeOff",{}),this.directionBrake2.emit("brakeOff",{}),this.directionBrake3.emit("brakeOff",{}),this.directionBrake4.emit("brakeOff",{})))},update:function(){this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault=this.data.speedFast,this.moveSpeedSlow=this.data.speedSlow,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridMove=!1,this.gridSpeed=500,this.mouseCursor=document.getElementById(this.data.courserid),this.data.uiid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,this.pov=this.data.pov,this.style=this.data.style,this.axis=this.data.axis,setTimeout((()=>{this.mouseController=document.getElementById("mouseController"),"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere"),"angleXY"===this.axis&&(this.avatar.object3D.position.copy(new THREE.Vector3(0,0,-10)),this.player.object3D.position.copy(new THREE.Vector3(0,1.6,2)))}),500))}),1e3),"desktop"===this.movetype||"mobile"===this.movetype?this.directionObject=this.camera:"vr"===this.movetype?"camera"===this.auxl.directionType?this.directionObject=this.camera:"bothRight"===this.auxl.vrHand||"bothLeftLoco"===this.auxl.vrHand?this.directionObject=document.getElementById("vrController1"):"bothLeft"===this.auxl.vrHand||"bothRightLoco"===this.auxl.vrHand?this.directionObject=document.getElementById("vrController2"):this.directionObject=document.getElementById("vrController1"):"vrHover"===this.movetype&&("camera"===this.auxl.directionType?this.directionObject=this.camera:this.directionObject=document.getElementById("vrController1"),this.directionForward=document.getElementById("locomotionForwardUI"),this.directionReverse=document.getElementById("locomotionReverseUI"),this.directionBrake1=document.getElementById("locomotionBrake1UI"),this.directionBrake2=document.getElementById("locomotionBrake2UI"),this.directionBrake3=document.getElementById("locomotionBrake3UI"),this.directionBrake4=document.getElementById("locomotionBrake4UI"),this.directionForward.addEventListener("mouseenter",this.movingForward),this.directionForward.addEventListener("mouseleave",this.cancelForward),this.directionReverse.addEventListener("mouseenter",this.movingReverse),this.directionReverse.addEventListener("mouseleave",this.cancelReverse),this.hoverLocomotionEvent=e=>{this.hoverLocomotion(e)},document.querySelectorAll(".directionBrake").forEach((e=>{e.addEventListener("mouseenter",(e=>this.hoverLocomotionEvent))})),document.querySelectorAll(".directionBrake").forEach((e=>{e.addEventListener("mouseleave",(e=>this.brakeReadBufferLong))}))),this.directionObject=this.camera},remove:function(){"desktop"===this.movetype||"mobile"===this.movetype||"vr"===this.movetype||"vrHover"===this.movetype&&(this.directionForward.removeEventListener("mouseenter",this.movingForward),this.directionForward.removeEventListener("mouseleave",this.cancelForward),this.directionReverse.removeEventListener("mouseenter",this.movingReverse),this.directionReverse.removeEventListener("mouseleave",this.cancelReverse),document.querySelectorAll(".directionBrake").forEach((e=>{e.removeEventListener("mouseenter",(e=>this.hoverLocomotionEvent))})),document.querySelectorAll(".directionBrake").forEach((e=>{e.removeEventListener("mouseleave",(e=>this.brakeReadBufferLong))})))},tick:function(e,t){this.auxl.player.layer.move&&("free"===this.style?this.freeStepThrottled():"grid"===this.style&&this.gridStepThrottled(),"vrHover"===this.movetype&&this.uiSync())},freeStep:function(e,t){this.moveBrake?this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedSlow):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedSlow):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedSlow):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedSlow):this.moveTo?this.move("forward",this.moveSpeedSlow):this.moveBack?this.move("reverse",this.moveSpeedSlow):this.moveRight?this.move("right",this.moveSpeedSlow):this.moveLeft&&this.move("left",this.moveSpeedSlow):this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedDefault):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedDefault):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedDefault):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedDefault):this.moveTo?this.move("forward",this.moveSpeedDefault):this.moveBack?this.move("reverse",this.moveSpeedDefault):this.moveRight?this.move("right",this.moveSpeedDefault):this.moveLeft&&this.move("left",this.moveSpeedDefault)},freeStepPlus:function(e,t){this.movement="",this.moveUp&&this.moveDown||(this.moveUp?this.movement+="Up":this.moveDown&&(this.movement+="Down")),this.moveTo&&this.moveBack||(this.moveTo?this.movement+="Forward":this.moveBack&&(this.movement+="Reverse")),this.moveRight&&this.moveLeft||(this.moveRight?this.movement+="Right":this.moveLeft&&(this.movement+="Left")),this.moveBrake?this.move(this.movement,this.moveSpeedSlow):this.move(this.movement,this.moveSpeedDefault)},gridStep:function(e,t){this.moveTo||this.moveBack||this.moveRight||this.moveLeft?this.gridMove||(this.gridMove=!0):this.gridMove=!1,this.moveTo&&this.moveRight?this.move("forwardRight",.5):this.moveTo&&this.moveLeft?this.move("forwardLeft",.5):this.moveBack&&this.moveRight?this.move("reverseRight",.5):this.moveBack&&this.moveLeft?this.move("reverseLeft",.5):this.moveTo?this.move("forward",.5):this.moveBack?this.move("reverse",.5):this.moveRight?this.move("right",.5):this.moveLeft&&this.move("left",.5)},distance:function(e,t,i,o){return Math.sqrt(Math.pow(i-e,2)+1*Math.pow(o-t,2))},uiSync:function(){this.elPosVec3New.copy(this.el.object3D.position),this.ui.object3D.position.copy(this.elPosVec3New)},move:function(e,t){"1st"===this.pov?"posXZ"===this.axis?this.directionXZ(e,t):"posXZY"===this.axis?this.directionXZY(e,t):"posXY"===this.axis?this.directionXY(e,t):"posXYZ"===this.axis?this.directionXYZ(e,t):"posXYZWall"===this.axis?this.directionXYZWall(e,t):"angleXY"===this.axis?this.directionAXY(e,t):"angleXYZ"===this.axis&&this.directionAXYZ(e,t):"3rd"===this.pov&&("posXZ"===this.axis?this.rigXZ(e,t):"posXZY"===this.axis?this.rigXZY(e,t):"posXY"===this.axis?this.rigXY(e,t):"posXYZ"===this.axis?this.rigXYZ(e,t):"posXYZWall"===this.axis?this.rigXYZWall(e,t):"angleXY"===this.axis?this.rigAXY(e,t):"angleXYZ"===this.axis&&this.rigAXYZ(e,t))},togglePOV:function(){"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere")}),500))},rayDirection:function(e,t,i){let o=new THREE.Vector3;e.object3D.getWorldDirection(o);const a=Math.PI/4,n=Math.PI/2,s=3*Math.PI/4,r=Math.PI,l=5*Math.PI/4,c=3*Math.PI/2,h=7*Math.PI/4,d=(e,t)=>{let i=new THREE.Matrix4,o=0;switch(t){case 0:o=0;break;case 30:o=Math.PI/6;break;case 45:o=Math.PI/4;break;case 60:o=Math.PI/3;break;case 90:o=Math.PI/2;break;case 120:o=2*Math.PI/3;break;case 135:o=3*Math.PI/4;break;case 150:o=5*Math.PI/6;break;case 180:default:o=Math.PI;break;case 210:o=7*Math.PI/6;break;case 225:o=5*Math.PI/4;break;case 240:o=4*Math.PI/3;break;case 270:o=3*Math.PI/2;break;case 300:o=5*Math.PI/3;break;case 315:o=7*Math.PI/4;break;case 330:o=11*Math.PI/6;break;case 360:o=2*Math.PI}return"x"===e?i.makeRotationX(o):"y"===e?i.makeRotationY(o):"z"===e&&i.makeRotationZ(o),i};let p=new THREE.Matrix4;"forwardRight"===t?p=d("y",s):"forwardLeft"===t?p=d("y",l):"reverseRight"===t?p=d("y",a):"reverseLeft"===t?p=d("y",h):"forward"===t?p=d("y",r):"reverse"===t?p=d("y",0):"right"===t?p=d("y",n):"left"===t&&(p=d("y",c));let u=(new THREE.Vector3).copy(o).applyMatrix4(p);o.copy(u);let m=new THREE.Vector3;return m.copy(this.rayBody.object3D.position).add(new THREE.Vector3(o.x,o.y,o.z).normalize().multiplyScalar(i)),m},movement:function(){if(this.auxl.player.layer.move)if(this.auxl.player.layer.playerPhysics)this.auxl.player.layer.physMove?this.positionNew.equals(this.positionPlayer)||(this.moveForce.copy(this.positionNew),this.moveForce.sub(this.positionPlayer),this.player.body.applyLocalImpulse(this.moveForce,new THREE.Vector3(0,0,0))):this.player.body.position.copy(this.positionNew),this.player.body.computeAABB();else if(this.auxl.collision){if(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.round(this.positionNew.y),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.round(this.positionPlayer.y),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.auxl.player.layer.bodyCrouch?this.allow=!0:(this.newPosStandRound.copy(this.newPosRound),this.newPosStandRound.y+=1,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosStandRound,this.posRound)?this.allow=!0:this.allow=!1)),this.allow||(this.newPosTemp.copy(this.newPosRound),this.newPosRound.x=this.posRound.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.x=this.positionPlayer.x,this.allow=!0):(this.newPosRound.z=this.posRound.z,this.newPosRound.x=this.newPosTemp.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.positionNew.z=this.positionPlayer.z,this.allow=!0))),this.allow){this.player.object3D.position.copy(this.positionNew),this.auxl.player.layer.gridPos.copy(this.newPosRound);let e="";this.newPosRound.z<this.posRound.z?e+="forward":this.newPosRound.z>this.posRound.z&&(e+="reverse"),this.newPosRound.x>this.posRound.x?e+="right":this.newPosRound.x<this.posRound.x&&(e+="left"),this.auxl.player.layer.gridDirection=e,this.newPosRound.x===this.posRound.x&&this.newPosRound.z===this.posRound.z||(this.auxl.map.CheckMapTriggers(this.newPosRound)&&this.auxl.map.TriggerEnterHit(this.newPosRound),this.auxl.map.CheckActiveTriggers(this.newPosRound),this.auxl.map.WaitingToSpawn())}}else this.player.object3D.position.copy(this.positionNew)},plane2D:function(e,t,i){return this.allow=!1,this.velocity=i,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.moveForce=new THREE.Vector3,this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"forwardLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverseRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"reverseLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"forward"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverse"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity):"right"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z):"left"===t&&("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z)),this.positionNew.y=this.positionPlayer.y,this.positionNew},directionXZ:function(e,t){if(this.allow=!1,this.velocity=t,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.moveForce=new THREE.Vector3(t,t,t),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"forwardLeft"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverseRight"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"reverseLeft"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"forward"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverse"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity):"right"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z):"left"===e&&("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z)),this.positionNew.y=this.positionPlayer.y,this.auxl.player.layer.move)if(this.auxl.player.layer.playerPhysics)this.auxl.player.layer.physMove?(this.moveForce.copy(this.positionNew),this.moveForce.sub(this.positionPlayer),this.positionNew.equals(this.positionPlayer)||this.player.body.applyLocalImpulse(this.moveForce,new THREE.Vector3(0,0,0))):this.player.body.position.copy(this.positionNew),this.player.body.computeAABB();else if(this.auxl.collision){if(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.round(this.positionNew.y),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.round(this.positionPlayer.y),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.auxl.player.layer.bodyCrouch?this.allow=!0:(this.newPosStandRound.copy(this.newPosRound),this.newPosStandRound.y+=1,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosStandRound,this.posRound)?this.allow=!0:this.allow=!1)),this.allow||(this.newPosTemp.copy(this.newPosRound),this.newPosRound.x=this.posRound.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.x=this.positionPlayer.x,this.allow=!0):(this.newPosRound.z=this.posRound.z,this.newPosRound.x=this.newPosTemp.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.positionNew.z=this.positionPlayer.z,this.allow=!0))),this.allow){this.player.object3D.position.copy(this.positionNew),this.auxl.player.layer.gridPos.copy(this.newPosRound);let e="";this.newPosRound.z<this.posRound.z?e+="forward":this.newPosRound.z>this.posRound.z&&(e+="reverse"),this.newPosRound.x>this.posRound.x?e+="right":this.newPosRound.x<this.posRound.x&&(e+="left"),this.auxl.player.layer.gridDirection=e,this.newPosRound.x===this.posRound.x&&this.newPosRound.z===this.posRound.z||(this.auxl.map.CheckMapTriggers(this.newPosRound)&&this.auxl.map.TriggerEnterHit(this.newPosRound),this.auxl.map.CheckActiveTriggers(this.newPosRound),this.auxl.map.WaitingToSpawn())}}else this.player.object3D.position.copy(this.positionNew)},directionXZY:function(e,t){this.velocity=t,this.directionVector=new THREE.Vector3,this.directionStep=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","UpForwardRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForwardRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ForwardRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpForwardLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForwardLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ForwardLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverseRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverseRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ReverseRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverseLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverseLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ReverseLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpForward"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForward"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"Forward"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverse"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverse"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"Reverse"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownRight"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y-this.velocity):"Right"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y):"UpLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownLeft"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y-this.velocity):"Left"===e?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y):"Up"===e?(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y+this.velocity):"Down"===e?(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y-this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y),this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.player.object3D.position.copy(this.positionNew)):this.auxl.player.layer.playerPhysics?this.player.body.position.copy(this.positionNew):this.player.object3D.position.copy(this.positionNew)},directionXY:function(e,t){this.velocity=t,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2||this.angle<0&&this.angle>-Math.PI/2?this.face="front":this.angle>Math.PI/2&&this.angle<Math.PI||this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="back":this.face="front","forwardRight"===e?("front"===this.face?this.positionNew.x=this.positionPlayer.x+this.velocity:this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y+this.velocity):"forwardLeft"===e?("front"===this.face?this.positionNew.x=this.positionPlayer.x-this.velocity:this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y+this.velocity):"reverseRight"===e?("front"===this.face?this.positionNew.x=this.positionPlayer.x+this.velocity:this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y-this.velocity):"reverseLeft"===e?("front"===this.face?this.positionNew.x=this.positionPlayer.x-this.velocity:this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y-this.velocity):"forward"===e?(this.positionNew.x=this.positionPlayer.x,this.positionNew.y=this.positionPlayer.y+this.velocity):"reverse"===e?(this.positionNew.x=this.positionPlayer.x,this.positionNew.y=this.positionPlayer.y-this.velocity):"right"===e?(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y):"left"===e&&(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y),this.positionNew.z=this.positionPlayer.z,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.roundHalf(this.positionNew.y),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.roundHalf(this.positionPlayer.y),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.player.object3D.position.copy(this.positionNew)):this.player.object3D.position.copy(this.positionNew)},directionXYZ:function(e,t){this.allow=!1,this.yDeadZone=.1,this.velocity=t,this.directionVector=new THREE.Vector3,this.cameraVector=new THREE.Vector3,this.camera.object3D.getWorldDirection(this.cameraVector),this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"forwardLeft"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverseRight"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"reverseLeft"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"forward"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverse"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity):"right"===e?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z):"left"===e&&("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z)),this.cameraVector.y<this.yDeadZone?this.positionNew.y=this.positionPlayer.y+-1*this.cameraVector.y*this.velocity:this.cameraVector.y>-1*this.yDeadZone?this.positionNew.y=this.positionPlayer.y-this.cameraVector.y*this.velocity:this.positionNew.y=this.positionPlayer.y,this.auxl.player.layer.move&&(this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.round(this.positionNew.y),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.round(this.positionPlayer.y),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?this.auxl.player.layer.bodyCrouch?this.allow=!0:(this.newPosStandRound.copy(this.newPosRound),this.newPosStandRound.y+=1,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosStandRound,this.posRound)?this.allow=!0:this.allow=!1):this.allow=!1,this.allow||(this.newPosTemp.copy(this.newPosRound),this.newPosRound.y=this.posRound.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.y=this.positionPlayer.y,this.allow=!0):(this.newPosRound.x=this.posRound.x,this.newPosRound.y=this.newPosTemp.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.x=this.positionPlayer.x,this.allow=!0):(this.newPosRound.z=this.posRound.z,this.newPosRound.x=this.newPosTemp.x,this.newPosRound.y=this.newPosTemp.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.positionNew.z=this.positionPlayer.z,this.allow=!0)))),this.allow&&(this.player.object3D.position.copy(this.positionNew),this.auxl.player.layer.gridPos.copy(this.newPosRound),this.newPosRound.x===this.posRound.x&&this.newPosRound.z===this.posRound.z||(this.auxl.map.CheckMapTriggers(this.newPosRound)&&this.auxl.map.TriggerEnterHit(this.newPosRound),this.auxl.map.CheckActiveTriggers(this.newPosRound),this.auxl.map.WaitingToSpawn()))):this.player.object3D.position.copy(this.positionNew))},directionXYZWall:function(e,t){},directionAXY:function(e,t){},directionAXYZ:function(e,t){},rigXZ:function(e,t){this.velocity=t,this.positionNew=new THREE.Vector3,this.positionAvatar.copy(this.avatar.object3D.position),"forwardRight"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z-this.velocity):"forwardLeft"===e?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z-this.velocity):"reverseRight"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z+this.velocity):"reverseLeft"===e?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z+this.velocity):"forward"===e?(this.positionNew.x=this.positionAvatar.x,this.positionNew.z=this.positionAvatar.z-this.velocity):"reverse"===e?(this.positionNew.x=this.positionAvatar.x,this.positionNew.z=this.positionAvatar.z+this.velocity):"right"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z):"left"===e&&(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z),this.positionNew.y=this.positionAvatar.y,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionAvatar.x),this.posRound.z=this.roundHalf(this.positionAvatar.z),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.avatar.object3D.position.copy(this.positionNew)):this.avatar.object3D.position.copy(this.positionNew)},rigXZY:function(e,t){},rigXY:function(e,t){this.velocity=t,this.positionNew=new THREE.Vector3,this.positionAvatar.copy(this.avatar.object3D.position),"forwardRight"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y+this.velocity):"forwardLeft"===e?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y+this.velocity):"reverseRight"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y-this.velocity):"reverseLeft"===e?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y-this.velocity):"forward"===e?(this.positionNew.x=this.positionAvatar.x,this.positionNew.y=this.positionAvatar.y+this.velocity):"reverse"===e?(this.positionNew.x=this.positionAvatar.x,this.positionNew.y=this.positionAvatar.y-this.velocity):"right"===e?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y):"left"===e&&(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y),this.positionNew.z=this.positionAvatar.z,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.roundHalf(this.positionNew.y),this.posRound.x=this.roundHalf(this.positionAvatar.x),this.posRound.y=this.roundHalf(this.positionAvatar.y),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.avatar.object3D.position.copy(this.positionNew)):this.avatar.object3D.position.copy(this.positionNew)},rigXYZ:function(e,t){},rigXYZWall:function(e,t){},rigAXY:function(e,t){this.velocity=t/10,this.rotationNew=new THREE.Euler(0,0,0,"YXZ"),this.rotationAvatar.copy(this.avatarSphere.object3D.rotation),"forwardRight"===e?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"forwardLeft"===e?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y+this.velocity):"reverseRight"===e?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"reverseLeft"===e?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y+this.velocity):"forward"===e?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y):"reverse"===e?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y):"right"===e?(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"left"===e&&(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.y=this.rotationAvatar.y+this.velocity),this.rotationNew.z=this.rotationAvatar.z,this.avatarSphere.object3D.rotation.copy(this.rotationNew)},rigAXYZ:function(e,t){},userDirection:function(){if(this.userPos=this.player.getAttribute("position"),this.userRot=this.camera.getAttribute("rotation"),this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z<0?this.userTravel="northWest":this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southWest":this.userPreviousPos.x+this.userPos.x>0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southEast":(this.userPreviousPos.x+this.userPos.x>0&&(this.userPreviousPos.z,this.userPos.z),this.userTravel="northEast"),this.userPreviousPos=this.userPos,this.userRot.y>360){let e=this.userRot.y/360;this.userPov=360*Math.floor(e)-this.userRot.y,this.userPov*=-1}else if(this.userRot.y<-360){let e=this.userRot.y/360;this.userPov=360*Math.floor(e)-this.userRot.y,this.userPov*=-1}else this.userPov=this.userRot.y;this.userPov>0&&this.userPov<15||this.userPov>345&&this.userPov<360?this.userView="north":this.userPov>255&&this.userPov>285?this.userView="east":this.userPov>75&&this.userPov<105?this.userView="west":this.userPov>165&&this.userPov<195?this.userView="south":this.userPov<0&&this.userPov>-15||this.userPov<-345&&this.userPov>-360?this.userView="north":this.userPov<-255&&this.userPov>-285?this.userView="west":this.userPov<-75&&this.userPov>-105?this.userView="east":this.userPov<-165&&this.userPov>-195?this.userView="south":this.userPov>15&&this.userPov<75?this.userView="northWest":this.userPov>105&&this.userPov<165?this.userView="southWest":this.userPov>195&&this.userPov<255?this.userView="southEast":this.userPov>285&&this.userPov<345||this.userPov<-15&&this.userPov>-75?this.userView="northEast":this.userPov<-105&&this.userPov>-165?this.userView="southEast":this.userPov<-195&&this.userPov>-255?this.userView="southWest":this.userPov<-285&&this.userPov>-345?this.userView="northWest":this.userView="north","northWest"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=-1*(this.velocity+this.positionPlayer.z),this.positionTemp.z+=this.positionPlayer.z):"southWest"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=this.velocity+this.positionPlayer.z):"southEast"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=this.velocity+this.positionPlayer.z):"northEast"===this.userView||"north"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=-1*(this.velocity+this.positionPlayer.z)):"west"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=this.velocity+this.positionPlayer.z):"east"===this.userView||"south"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=this.velocity+this.positionPlayer.z):(this.positionTemp.x=0,this.positionTemp.z=0),this.positionNew=new THREE.Vector3(this.positionTemp.x,0,this.positionTemp.z)}}),AFRAME.registerComponent("teleportation",{dependencies:["auxl"],init:function(){this.el.classList.contains("teleport")?this.el.parentNode.setAttribute("active","false"):this.el.classList.contains("cancel")&&(this.el.classList.toggle("clickable",!1),this.el.parentNode.setAttribute("active","false"))},resetTeleCircles:function(){this.allTeleportors=document.querySelectorAll(".teleporter");for(let e=0;e<this.allTeleportors.length;e++)"true"===this.allTeleportors[e].parentNode.getAttribute("active")&&(this.allTeleportors[e].emit("resetInstant",{}),this.allTeleportors[e].nextSibling.emit("resetInstant",{}))},resetInstantEvent:function(){this.classList.contains("teleport")?this.parentNode.setAttribute("active","false"):this.classList.contains("cancel")&&(this.classList.toggle("clickable",!1),this.parentNode.setAttribute("active","false"))},resetEvent:function(){this.classList.contains("teleport")?this.parentNode.setAttribute("active","false"):this.classList.contains("cancel")&&(this.classList.toggle("clickable",!1),this.parentNode.setAttribute("active","false"))},clickToTeleport:function(){let e,t=this,i=document.getElementById("playerRig"),o=document.getElementById("camera"),a=document.querySelector("a-scene").systems.auxl,n=i.getAttribute("position"),s=a.player.layer.transition.teleport,r=new THREE.Vector3,l=this.parentNode.getAttribute("position"),c=document.querySelectorAll(".teleporter");function h(e,t,i){e.emit("reset",{}),e.nextSibling.emit("reset",{}),t.copy(i),t.y=0}function d(){for(let e=0;e<c.length;e++)"true"===c[e].parentNode.getAttribute("active")&&(c[e].emit("resetInstant",{}),c[e].nextSibling.emit("resetInstant",{}))}if("false"===t.parentNode.getAttribute("active"))t.nextSibling.classList.toggle("clickable",!0),t.nextSibling.emit("click1",{}),t.userPov=o.getAttribute("rotation"),t.rotationParams={property:"object3D.rotation.y",to:t.userPov.y,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"},t.parentNode.setAttribute("animation__rotateToUser",t.rotationParams),t.parentNode.setAttribute("active","true");else if(t.classList.contains("teleport"))if("instant"===s)d(),h(t,r,l),e=setTimeout((function(){i.object3D.position.copy(r),clearTimeout(e)}),250);else if("fade"===s)a.player.PlayerTeleportAnim(),h(t,r,l),e=setTimeout((function(){d(),i.object3D.position.copy(r),clearTimeout(e)}),600);else if("locomotion"===s){let e={property:"position",from:{x:n.x,y:0,z:n.z},to:{x:l.x,y:0,z:l.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",e),t.nextSibling.emit("reset",{}),d()}else("sphere"===s||"blink"===s)&&(a.player.PlayerTeleportAnim(),h(t,r,l),e=setTimeout((function(){d(),i.object3D.position.copy(r),clearTimeout(e)}),600));else t.classList.contains("cancel")&&t.emit("reset",{})},update:function(){this.el.addEventListener("reset",this.resetEvent),this.el.addEventListener("resetInstant",this.resetInstantEvent),this.el.addEventListener("click",this.clickToTeleport)},remove:function(){this.el.removeEventListener("reset",this.resetEvent),this.el.removeEventListener("resetInstant",this.resetInstantEvent),this.el.removeEventListener("click",this.clickToTeleport)}}),AFRAME.registerComponent("raycast-teleportation-select",{dependencies:["auxl"],init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.hoverSelectData={data:"hoverSelectData",id:"hoverSelect",text:{value:"Teleport Here",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.5,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#3eb58c",opacity:1,metalness:.6,roughness:.4,emissive:"#3eb58c",emissiveIntensity:.2,side:"front"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{stare:{twist:!0}}},this.hoverSelect=this.auxl.Core(this.hoverSelectData),this.spawned=!1},spawnSelect:function(e){let t=e.detail.intersection.point;this.spawned&&(this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore()),this.hoverSelect.core.position.x=t.x,this.hoverSelect.core.position.y=1,this.hoverSelect.core.position.z=t.z,this.hoverSelect.SpawnCore(),this.clickToTeleportEvent=e=>{this.clickToTeleport(e)},this.hoverSelect.GetEl().addEventListener("click",this.clickToTeleportEvent),this.spawned=!0},clickToTeleport:function(e){let t,i=document.getElementById("playerRig"),o=(document.getElementById("camera"),document.querySelector("a-scene").systems.auxl),a=i.getAttribute("position"),n=o.player.layer.transition.teleport,s=new THREE.Vector3,r=e.detail.intersection.point;function l(e,t){e.copy(t),e.y=0}if(document.querySelectorAll(".teleporter"),this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore(),this.spawned=!1,"instant"===n)l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),250);else if("fade"===n)o.player.PlayerTeleportAnim(),l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),600);else if("locomotion"===n){let e={property:"position",from:{x:a.x,y:0,z:a.z},to:{x:r.x,y:0,z:r.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",e)}else("sphere"===n||"blink"===n)&&(o.player.PlayerTeleportAnim(),l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),600))},update:function(){this.spawnSelectEvent=e=>{this.spawnSelect(e)},this.el.addEventListener("click",this.spawnSelectEvent)},remove:function(){this.spawned&&(this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore()),this.el.removeEventListener("click",this.spawnSelectEvent)}}),AFRAME.registerComponent("raycast-teleportation",{dependencies:["auxl"],init:function(){},clickToTeleport:function(e){let t,i=document.getElementById("playerRig"),o=(document.getElementById("camera"),document.querySelector("a-scene").systems.auxl),a=i.getAttribute("position"),n=o.player.layer.transition.teleport,s=new THREE.Vector3,r=e.detail.intersection.point;function l(e,t){e.copy(t),e.y=0}if(document.querySelectorAll(".teleporter"),"instant"===n)l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),250);else if("fade"===n)o.player.PlayerTeleportAnim(),l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),600);else if("locomotion"===n){let e={property:"position",from:{x:a.x,y:0,z:a.z},to:{x:r.x,y:0,z:r.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",e)}else("sphere"===n||"blink"===n)&&(o.player.PlayerTeleportAnim(),l(s,r),t=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(t)}),600))},update:function(){this.raycastTeleport=e=>{this.clickToTeleport(e)},this.el.addEventListener("click",this.raycastTeleport)},remove:function(){this.el.removeEventListener("click",this.raycastTeleport)}}),AFRAME.registerComponent("teleportation-to",{dependencies:["auxl"],schema:{x:{type:"number",default:0},y:{type:"number",default:0},z:{type:"number",default:0},twistTo:{type:"boolean",default:!1},twist:{type:"number",default:0},event:{type:"string",default:"click"}},init:function(){},eventToTeleport:function(e){let t,i=document.getElementById("playerRig"),o=(document.getElementById("camera"),document.querySelector("a-scene").systems.auxl),a=i.getAttribute("position"),n=o.player.layer.transition.teleport,s=new THREE.Vector3,r=new THREE.Vector3(this.data.x,this.data.y,this.data.z),l=(document.querySelectorAll(".teleporter"),this.data.twistTo),c=this.data.twist;function h(e,t){e.copy(t)}function d(e){o.player.layer.playerPhysics?(i.body.position.copy(e),i.body.computeAABB()):i.object3D.position.copy(s),l&&o.player.TwistTo(c)}if("instant"===n)h(s,r),t=setTimeout((function(){d(s),clearTimeout(t)}),250);else if("fade"===n)o.player.PlayerQuickAnim(),h(s,r),t=setTimeout((function(){d(s),clearTimeout(t)}),225);else if("locomotion"===n)if(o.player.layer.playerPhysics)console.log("Configure Physics Locomotion Teleportation");else{let e={property:"position",from:{x:a.x,y:0,z:a.z},to:{x:r.x,y:0,z:r.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",e)}else("sphere"===n||"blink"===n)&&(o.player.PlayerQuickAnim(),h(s,r),t=setTimeout((function(){d(s),clearTimeout(t)}),225))},update:function(){this.raycastTeleport=e=>{this.eventToTeleport(e)},this.el.addEventListener(this.data.event,this.raycastTeleport)},remove:function(){this.el.removeEventListener(this.data.event,this.raycastTeleport)}}),AFRAME.registerComponent("clickfunc",{dependencies:["auxl"],schema:{clickObj:{type:"string",default:"auxlObj"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(e){this.auxl[this.data.clickObj].Click(e.target)}}}),AFRAME.registerComponent("clickrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"},delay:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},run:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))},events:{click:function(e){this.timeout=setTimeout((()=>{this.run(e),clearTimeout(this.timeout)}),this.data.delay)}}}),AFRAME.registerComponent("clickrunfunc",{dependencies:["auxl"],multiple:!0,schema:{method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(e){"null"===this.data.params?this.auxl[this.data.method]():"target"===this.data.params?this.auxl[this.data.method](e.target):this.auxl[this.data.method](this.data.params)}}}),AFRAME.registerComponent("fusingrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{fusing:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mousedownrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mousedown:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseenterrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseenter:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseleaverun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseleave:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseuprun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseup:function(e){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("menurun",{dependencies:["auxl"],schema:{cursorObj:{type:"string",default:"auxlObj"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(e){this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params))}}}),AFRAME.registerComponent("hoverrun",{dependencies:["auxl"],schema:{attached:{type:"string",default:"none"},menu:{type:"string",default:"menuName"},action:{type:"string",default:"actionName"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.attached=this.data.attached,this.menu=this.data.menu,this.action=this.data.action},events:{mouseenter:function(e){"none"!==this.attached?this.auxl[this.attached][this.menu].hoverMenu.active=this.action:this.auxl[this.menu].hoverMenu.active=this.action},mouseleave:function(e){"none"!==this.attached?this.auxl[this.attached][this.menu].hoverMenu.active=!1:this.auxl[this.menu].hoverMenu.active=!1}}}),AFRAME.registerComponent("onspawnrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():this.domEnt.components[this.data.component][this.data.method](this.data.params))}}),AFRAME.registerComponent("onspawnfunc",{dependencies:["auxl"],multiple:!0,schema:{auxlFunc:{type:"string",default:"auxlFunc"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,"null"===this.data.params?this.auxl[this.data.auxlFunc]():this.auxl[this.data.auxlFunc](this.data.params)}}),AFRAME.registerComponent("ondespawnrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},remove:function(){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():this.domEnt.components[this.data.component][this.data.method](this.data.params))}}),AFRAME.registerComponent("oneventrun",{dependencies:["auxl"],multiple:!0,schema:{event:{type:"string",default:"eventName"},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"},once:{type:"boolean",default:!1}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.event=this.data.event,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.once=this.data.once,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.el.addEventListener(this.event,this.run,{once:this.once})},remove:function(){this.el.removeEventListener(this.event,this.run)}}),AFRAME.registerComponent("ondelayrun",{dependencies:["auxl"],multiple:!0,schema:{delay:{type:"number",default:1e3},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.delay=this.data.delay,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.timeout=setTimeout((()=>{this.run(),clearTimeout(this.timeout)}),this.delay)},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("onintervalrun",{dependencies:["auxl"],multiple:!0,schema:{interval:{type:"number",default:1e3},loop:{type:"number",default:0},end:{type:"string",default:"null"},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.interval=this.data.interval,this.loop=this.data.loop,0===this.loop&&(this.loop=!1),this.end=this.data.end,this.checkEnd=!1,"null"===this.end||(this.checkEnd=!0),this.running=!0,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.repeat=setInterval((()=>{this.checkEnd&&!0===this.auxl[this.cursorObj].GetFlag(this.end)&&(this.running=!1,clearInterval(this.repeat)),this.running&&this.run(),this.loop&&(this.loop--,this.loop<=0&&(this.running=!1,clearInterval(this.repeat)))}),this.interval)},remove:function(){clearInterval(this.repeat)}}),AFRAME.registerComponent("sync-pos",{dependencies:["auxl"],schema:{idname:{type:"string",default:"ui"},position:{type:"vec3"}},init:function(){this.attachee=document.getElementById(this.data.idname),this.offset=new THREE.Vector3,this.data.position?this.offset.copy(this.data.position):this.offset.copy(this.attachee.object3D.position),this.newPosVec3=new THREE.Vector3},attached:function(){this.newPosVec3.copy(this.el.object3D.position),this.newPosVec3.x+=this.offset.x,this.newPosVec3.y+=this.offset.y,this.newPosVec3.z+=this.offset.z,this.attachee.object3D.position.copy(this.newPosVec3)},tick:function(e,t){this.attached()}}),AFRAME.registerComponent("sync-rot",{dependencies:["auxl"],schema:{idname:{type:"string",default:"ui"},rotation:{type:"vec4"}},init:function(){this.attachee=document.getElementById(this.data.idname),this.offset=new THREE.Euler,this.data.rotation?this.offset.copy(this.data.rotation):this.offset.copy(this.attachee.object3D.rotation),this.newRotEuler=new THREE.Euler},attached:function(){this.newRotEuler.copy(this.el.object3D.rotation),this.newRotEuler.x+=this.offset.x,this.newRotEuler.y+=this.offset.y,this.newRotEuler.z+=this.offset.z,this.newRotEuler.w+=this.offset.w,this.attachee.object3D.rotation.copy(this.newRotEuler)},tick:function(e,t){this.attached()}}),AFRAME.registerComponent("look-at-xyz",{dependencies:["auxl"],schema:{buffer:{type:"number",default:0},drag:{type:"number",default:0},max:{type:"number",default:360},match:{type:"string",default:"camera"},x:{type:"boolean",default:!1},y:{type:"boolean",default:!1},z:{type:"boolean",default:!1}},init:function(){},update:function(){this.startRotation=new THREE.Euler,this.rotation=new THREE.Euler,this.rotation.copy(this.el.object3D.rotation),this.startRotation.copy(this.el.object3D.rotation),this.matchView=document.getElementById(this.data.match),this.maxView=this.data.max,this.matchRotation=new THREE.Euler,this.lookAtXYZThrottled=AFRAME.utils.throttle(this.lookAtXYZ,30,this)},lookAtXYZ:function(){this.matchRotation.copy(this.matchView.object3D.rotation),this.data.x&&Math.abs(this.matchRotation.x-this.rotation.x)>=this.data.buffer&&(this.rotation.x=this.matchRotation.x),this.data.y&&Math.abs(this.matchRotation.y-this.rotation.y)>=this.data.buffer&&(this.data.drag>0?this.matchRotation.y>this.rotation.y?this.rotation.y+=this.data.drag:this.rotation.y-=this.data.drag:this.rotation.y=this.matchRotation.y),this.data.z&&Math.abs(this.matchRotation.z-this.rotation.z)>=this.data.buffer&&(this.rotation.z=this.matchRotation.z),this.el.object3D.rotation.copy(this.rotation)},tick:function(e,t){this.lookAtXYZThrottled()}}),AFRAME.registerComponent("stare",{dependencies:["auxl"],schema:{id:{type:"string",default:"playerRig"},twist:{type:"boolean",default:!1}},init:function(){},update:function(){this.idView=document.getElementById(this.data.id),this.idPosition=new THREE.Vector3,this.stareThrottled=AFRAME.utils.throttle(this.stare,30,this)},stare:function(){this.idPosition.copy(this.idView.object3D.position),"playerRig"===this.data.id&&(this.idPosition.y+=document.getElementById("camera").object3D.position.y+document.getElementById("playerBody").object3D.position.y),this.data.twist&&(this.idPosition.y=this.el.object3D.position.y),this.el.object3D.lookAt(this.idPosition)},tick:function(e,t){this.stareThrottled()}}),AFRAME.registerComponent("camera-forward",{dependencies:["auxl"],schema:{distance:{type:"number",default:1}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},forward:function(){this.rayDir=this.auxl.player.RayDir(this.auxl.camera.GetEl(),this.data.distance),this.el.object3D.position.copy(this.rayDir.position),this.el.object3D.lookAt(this.auxl.playerRig.GetEl().object3D.position)}}),AFRAME.registerComponent("hovertext",{dependencies:["auxl"],schema:{value:{type:"string",default:"TEXT"},hover:{type:"string",default:"front"},offset:{type:"number",default:1},altOffset:{type:"number",default:0},twist:{type:"bool",default:!0},size:{type:"number",default:20}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.value=this.data.value,this.hover=this.data.hover,this.offset=this.data.offset,this.altOffset=this.data.altOffset,this.twist=this.data.twist,this.size=this.data.size,this.hoverSpawned=!1,this.position=new THREE.Vector3(0,0,0),"top"===this.hover?this.position=new THREE.Vector3(0,this.offset,this.altOffset):"front"===this.hover&&(this.position=new THREE.Vector3(0,this.altOffset,this.offset)),this.hoverTextParentData={data:"hoverTextParentData",id:"hoverTextParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:{stare:{id:"playerRig",twist:this.twist}}},this.hoverTextParent=this.auxl.Core(this.hoverTextParentData),this.hoverTextData={data:"hoverTextData",id:"hoverText",text:{value:this.value,wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",width:2},position:this.position,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},this.hoverText=this.auxl.Core(this.hoverTextData),this.hoverTextAllData={parent:{core:this.hoverTextParent},child0:{core:this.hoverText}},this.hoverTextAll=this.auxl.Layer("hoverTextAll",this.hoverTextAllData)},events:{mouseenter:function(e){this.hoverSpawned||(this.hoverSpawned=!0,this.hoverTextAll.SpawnLayer(this.el))},mouseleave:function(e){this.hoverSpawned&&(this.hoverTextAll.DespawnLayer(),this.hoverSpawned=!1)}},update:function(){},remove:function(){this.hoverSpawned||(this.hoverTextAll.DespawnLayer(),this.hoverSpawned=!1)}}),AFRAME.registerComponent("gltfmat",{dependencies:["auxl"],schema:{colors:{type:"array",default:[!1]},emissives:{type:"array",default:[!1]},opacities:{type:"array",default:[!1]},textures:{type:"array",default:[!1]},repeats:{type:"array",default:[!1]},random:{type:"boolean",default:!1}},update:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.meshName=!1,this.current=0,this.materials=[],this.data.colors.forEach((e=>{e?(this.materials[this.current]="random"===e?new THREE.MeshStandardMaterial({color:this.auxl.colorTheoryGen().base}):new THREE.MeshStandardMaterial({color:e}),this.data.emissives[this.current]&&(this.materials[this.current].emissive=this.materials[this.current].color,this.materials[this.current].emissiveIntensity=this.data.emissives[this.current]),this.data.opacities[this.current]&&this.data.opacities[this.current]<1&&(this.materials[this.current].transparent=!0,this.materials[this.current].opacity=this.data.opacities[this.current]),this.data.textures[this.current]&&(this.materials[this.current].map=(new THREE.TextureLoader).load(this.data.textures[this.current]),this.materials[this.current].map.center.set(.5,.5),this.materials[this.current].map.rotation=THREE.MathUtils.degToRad(180),this.materials[this.current].map.wrapS=THREE.RepeatWrapping,this.materials[this.current].map.wrapT=THREE.RepeatWrapping,this.materials[this.current].map.repeat.set(-1,1),this.data.repeats[this.current]&&"false"!==this.data.repeats[this.current]&&(this.materials[this.current].map.wrapS=THREE.RepeatWrapping,this.materials[this.current].map.wrapT=THREE.RepeatWrapping,this.materials[this.current].map.repeat.set(this.data.repeats[this.current])))):this.materials[this.current]=!1,this.current++})),this.current=-2,this.el.getObject3D("mesh")?this.apply():this.el.addEventListener("model-loaded",(()=>{this.apply()}))},apply:function(){this.current=-2,this.el.getObject3D("mesh").traverse((e=>{this.current<0||(this.data.random?e.material=new THREE.MeshStandardMaterial({color:this.auxl.colorTheoryGen().base}):this.materials[this.current]&&(e.material=this.materials[this.current])),this.current++}))}}),AFRAME.registerComponent("modify-materials",{dependencies:["auxl"],init:function(){document.querySelector("a-scene").systems.auxl,this.el.addEventListener("model-loaded",(()=>{const e=this.el.getObject3D("mesh"),t=(new THREE.MeshBasicMaterial({color:16777215}),(new THREE.TextureLoader).load("./assets/img/gradient/threeTone.jpg"));t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter;const i=(new THREE.TextureLoader).load("./assets/img/gradient/fourTone.jpg");i.minFilter=THREE.NearestFilter,i.magFilter=THREE.NearestFilter;const o=(new THREE.TextureLoader).load("./assets/img/gradient/fiveTone.jpg");o.minFilter=THREE.NearestFilter,o.magFilter=THREE.NearestFilter,new THREE.DataTexture(2,1,2,3).needsUpdate=!0;const a=new THREE.MeshToonMaterial({color:"blue",gradientMap:o});e.traverse((e=>{-1!==e.name.indexOf("Mesh_crop_melon")&&(e.material=a)}))}))}}),AFRAME.registerComponent("scroll",{dependencies:["auxl","raycaster"],schema:{type:{type:"string",default:"plane"},axis:{type:"string",default:"horizontal"},parent:{type:"string",default:"auxlObj"},length:{type:"number",default:1},options:{type:"number",default:5},elements:{type:"array",default:[]}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.scrollee=document.getElementById(this.data.parent),this.domEnt,this.elements=[],this.data.elements.forEach((e=>this.elements.push(document.getElementById(e)))),this.scrollMap=new Map,this.scrollMap.set(4,this.elements[7]),this.scrollMap.set(3,this.elements[6]),this.scrollMap.set(2,this.elements[5]),this.scrollMap.set(1,this.elements[4]),this.scrollMap.set(0,this.elements[3]),this.scrollMap.set(-1,this.elements[2]),this.scrollMap.set(-2,this.elements[1]),this.scrollMap.set(-3,this.elements[0]),this.scrollThrottled=AFRAME.utils.throttle(this.scroll,50,this),this.mouse=document.querySelector("#mouseController"),this.mouseRay=this.mouse.components.raycaster,this.intersection,this.previous=new THREE.Vector3(0,0,0),this.hold=!1,this.distance=0,this.compass=!1,this.direction=!1,this.location=0,this.prevPos=0,this.pos=0,this.size=this.data.length/this.data.options,this.opacInit=!0,this.opacityPlus=0,this.plusFadeEl=!1,this.opacityMinus=0,this.minusFadeEl=!1,this.extraEl=!1,this.el.addEventListener("mousedown",(()=>{this.hold=!0,this.previous.copy(this.mouseRay.getIntersection(this.el).point)})),this.el.addEventListener("mouseup",(()=>{this.hold=!1,this.opacInit=!0})),this.el.addEventListener("mouseleave",(()=>{this.hold=!1,this.opacInit=!0})),this.el.addEventListener("raycaster-intersected",(function(e){}))},axisDirection:function(e,t){let i,o=[];return"vertical"===this.data.axis?(i="y",o=["down","up"]):"horizontal"===this.data.axis&&(i="x",o=["left","right"]),e[i]<t[i]?{axis:i,dir:o[0]}:{axis:i,dir:o[1]}},twoDecimal:function(e){return Math.round(100*e)/100},distanceTo:function(e,t){return Math.abs(Math.abs(e)-Math.abs(t))},getMapEl:function(e,t){for(;i=t,void 0===e.get(i);)t>0?t-=this.elements.length:t<0&&(t+=this.elements.length);var i;return e.get(t)},scroll:function(){if(this.hold)if(this.intersection=this.mouseRay.getIntersection(this.el),null===this.intersection||void 0===this.intersection);else if(this.intersection.point.equals(this.previous));else{if(this.compass=this.axisDirection(this.previous,this.intersection.point),this.distance=this.distanceTo(this.previous[this.compass.axis],this.intersection.point[this.compass.axis]),this.pos=this.scrollee.object3D.position[this.compass.axis],"plane"===this.data.type){let e,t;"left"===this.compass.dir||"down"===this.compass.dir?this.scrollee.object3D.position[this.compass.axis]+=this.distance:"right"!==this.compass.dir&&"up"!==this.compass.dir||(this.scrollee.object3D.position[this.compass.axis]-=this.distance),this.pos=this.twoDecimal(this.pos),this.location>0?(e=-1*(this.location*this.size+this.size),t=e+this.size):this.location<0?(t=-1*(this.location*this.size-this.size),e=t-this.size):(e=this.location*this.size-this.size,t=this.location*this.size+this.size),e=this.twoDecimal(e),t=this.twoDecimal(t),this.pos>t?(this.location--,this.opacityPlus=1,this.opacityMinus=0,this.direction="plus",this.opacInit=!1,this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+2),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-3),this.extraEl=this.getMapEl(this.scrollMap,this.location+4),this.extraEl.object3D.position[this.compass.axis]=(this.location-this.elements.length/2)*this.size,console.log("Shift Plus"),console.log(this.pos),console.log(this.location)):this.pos<e&&(this.location++,this.opacityPlus=0,this.opacityMinus=1,this.direction="minus",this.opacInit=!1,this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+3),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-2),this.extraEl=this.getMapEl(this.scrollMap,this.location-4),this.extraEl.object3D.position[this.compass.axis]=(this.location+this.elements.length/2)*this.size,console.log("Shift Minus"),console.log(this.pos),console.log(this.location));let i=0;this.pos>this.prevPos?(this.opacInit&&("minus"!==this.direction&&this.direction||(this.opacityPlus=1,this.opacityMinus=0,this.direction="plus",this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+2),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-3),this.extraEl=this.getMapEl(this.scrollMap,this.location+4),this.extraEl.object3D.position[this.compass.axis]=(this.location-this.elements.length/2)*this.size,console.log("swap"))),i=this.twoDecimal((this.pos-this.prevPos)*this.data.options),this.opacityPlus=this.twoDecimal(this.opacityPlus-i),this.opacityMinus=this.twoDecimal(this.opacityMinus+i),console.log("Plus")):this.pos<this.prevPos&&(this.opacInit&&("plus"!==this.direction&&this.direction||(this.opacityPlus=0,this.opacityMinus=1,this.direction="minus",this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+3),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-2),this.extraEl=this.getMapEl(this.scrollMap,this.location-4),this.extraEl.object3D.position[this.compass.axis]=(this.location+this.elements.length/2)*this.size,console.log("swap"))),i=this.twoDecimal((this.prevPos-this.pos)*this.data.options),this.opacityPlus=this.twoDecimal(this.opacityPlus+i),this.opacityMinus=this.twoDecimal(this.opacityMinus-i),console.log("Minus")),this.prevPos=this.pos,this.plusFadeEl&&this.minusFadeEl&&(this.plusFadeEl.setAttribute("material",{opacity:this.opacityPlus}),this.minusFadeEl.setAttribute("material",{opacity:this.opacityMinus})),console.log({previous:e,next:t,location:this.location,plusFadeEl:this.plusFadeEl,minusFadeEl:this.minusFadeEl,extraEl:this.extraEl})}else"cylinder"===this.data.type&&("left"===this.compass?this.scrollee.object3D.rotation.y+=this.distance:"right"===this.compass?this.scrollee.object3D.rotation.y-=this.distance:"up"===this.compass?this.scrollee.object3D.rotation.x+=this.distance:"down"===this.compass&&(this.scrollee.object3D.rotation.x-=this.distance));this.previous.copy(this.intersection.point)}},tick:function(e,t){this.scrollThrottled()}}),AFRAME.registerComponent("doorway",{dependencies:["auxl"],schema:{zone:{type:"string",default:"zone0"},to:{type:"string",default:"connect0"},posTo:{type:"boolean",default:!1},pos:{type:"vec3"},twistTo:{type:"boolean",default:!1},twist:{type:"number",default:0},delay:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.zone=this.data.zone,this.to=this.data.to,this.delay=this.data.delay,this.pos=new THREE.Vector3(0,0,0),this.data.pos.x&&(this.pos.x=this.data.pos.x),this.data.pos.y&&(this.pos.y=this.data.pos.y),this.data.pos.z&&(this.pos.z=this.data.pos.z),this.twist=this.data.twist},posTwist:function(){this.moveTimeout=setTimeout((()=>{this.data.posTo&&this.auxl.player.UpdatePlayerPosition(this.pos),this.data.twistTo&&this.auxl.player.TwistTo(this.twist),clearTimeout(this.moveTimeout)}),450)},swap:function(){this.timeout=setTimeout((()=>{this.auxl[this.zone].Move(this.to),this.posTwist(),clearTimeout(this.timeout)}),this.delay)},events:{click:function(e){this.swap()}},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("doorway-trigger",{dependencies:["auxl"],schema:{zone:{type:"string",default:"zone0"},to:{type:"string",default:"connect0"},delay:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.zone=this.data.zone,this.to=this.data.to,this.delay=this.data.delay},swap:function(){this.timeout=setTimeout((()=>{this.auxl[this.zone].Move(this.to),clearTimeout(this.timeout)}),this.delay)},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("clickaddinventory",{dependencies:["auxl"],multiple:!0,schema:{item:{type:"string",default:"itemName"},once:{type:"boolean",default:!0},delay:{type:"number",default:0},despawn:{type:"boolean",default:!0},auxlObj:{type:"string",default:"auxlObj"},despawnMethod:{type:"string",default:"DespawnCore"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,this.item=this.data.item,this.once=this.data.once,this.delay=this.data.delay,this.give=!0,this.despawn=this.data.despawn,this.auxlObj=this.data.auxlObj,this.despawnMethod=this.data.despawnMethod},events:{click:function(){this.give&&(this.timeout=setTimeout((()=>{this.auxl.comp.AddToInventory({item:this.auxl[this.item]}),this.once&&(this.give=!1),this.despawn&&this.auxl[this.auxlObj][this.despawnMethod](),clearTimeout(this.timeout)}),this.delay))}}}),AFRAME.registerComponent("acceptobject",{dependencies:["auxl"],multiple:!0,schema:{item:{type:"string",default:"itemName"},uses:{type:"number",default:1},delay:{type:"number",default:0},despawn:{type:"boolean",default:!0},auxlObj:{type:"string",default:"auxlObj"},despawnMethod:{type:"string",default:"DespawnCore"},methodObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,this.item=this.data.item,this.uses=this.data.uses,this.delay=this.data.delay,this.inUse=!1,this.despawn=this.data.despawn,this.auxlObj=this.data.auxlObj,this.despawnMethod=this.data.despawnMethod,this.methodObj=this.data.methodObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params},run:function(){this.timeout=setTimeout((()=>{"null"===this.component?this.auxl[this.methodObj][this.method]&&("null"===this.params?this.auxl[this.methodObj][this.method]():this.auxl[this.methodObj][this.method](this.params)):document.getElementById(this.methodObj)&&(this.domEnt=document.getElementById(this.methodObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params)),"limited"===this.auxl[this.item].persist&&(this.auxl[this.item].amount--,this.auxl.comp.UpdateInventoryMenu(),this.auxl.player.Unequip()),this.uses--,this.uses<=0&&this.despawn&&this.auxl[this.auxlObj][this.despawnMethod](),this.inUse=!1,clearTimeout(this.timeout)}),this.delay)},events:{click:function(){this.auxl.player.layer.equipped&&this.auxl.player.layer.equippedObject===this.item&&(this.inUse||(this.inUse=!0,this.run()))}}}),AFRAME.registerComponent("linkcable",{dependencies:["auxl"],schema:{type:{type:"string",default:"to",oneOf:["to","grab","hit","launch","fling","flying"]}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{mouseenter:function(e){console.log({event:"mouseenter",data:e}),this.auxl[this.el.id].Enter(e)},mousedown:function(e){console.log({event:"mousedown",data:e}),this.Measure(),this.auxl[this.el.id].LinkStart(e)},mouseup:function(e){console.log({event:"mouseup",data:e}),this.auxl[this.el.id].LinkEnd(e),this.Measure(!0)},mouseleave:function(e){console.log({event:"mouseleave",data:e}),this.auxl[this.el.id].Exit(e)},collide:function(e){this.auxl[this.el.id].Collide(e)},click:function(e){console.log({event:"click",data:e}),this.auxl[this.el.id].Click(e)},altclick:function(e){console.log({event:"altclick",data:e}),this.auxl[this.el.id].AltClick(e)}},tick:function(e,t){this.measure?this.power>1?(this.power--,console.log(this.power)):(this.power=0,this.Measure(!0)):this.power=1,this.auxl[this.el.id].Tick(this.power)},Measure:function(e){this.measure=!e}}),AFRAME.registerComponent("camerasync",{dependencies:["auxl"],init:function(){},tick:function(e,t){this.el.body.quaternion.copy(this.el.object3D.getWorldQuaternion(new THREE.Quaternion))}}),AFRAME.registerComponent("staticsync",{dependencies:["auxl"],schema:{type:{type:"string",default:"self",oneOf:["self","other",,]},auxlObj:{type:"string",default:"auxlObj"},offset:{type:"vec3"},posSync:{type:"vec3"},sync:{type:"bool",default:!0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.offset=this.data.offset||new THREE.Vector3(0,0,0),this.posSync=new THREE.Vector3(0,0,0)},update:function(){this.posSync.copy(this.data.posSync)},tick:function(e,t){this.data.sync&&this.el.body&&this.el.body.position&&("self"===this.data.type?this.el.object3D.position&&this.posSync.copy(this.el.object3D.position):"other"===this.data.type&&this.posSync.copy(this.auxl[this.data.auxlObj].GetEl().object3D.position),this.posSync.add(this.offset),this.el.body.position.copy(this.posSync),this.el.object3D.position.copy(this.posSync))}}),AFRAME.registerComponent("collision",{dependencies:["auxl"],init:function(){playerRig.addEventListener("collide",(function(e){}))}}),AFRAME.registerComponent("trigger",{dependencies:["auxl"],multiple:!0,schema:{collide:{type:"array",default:[!1]},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,this.checkTriggerThrottled=AFRAME.utils.throttle(this.checkTrigger,1e3,this),this.playerEl=document.querySelector("#playerRig"),this.el.body.collisionResponse=!1},run:function(e){console.log(this),"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](e.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](e.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))},events:{collide:function(e){this.run(e)}},checkTrigger:function(){this.el.body.aabb.overlaps(this.playerEl.body.aabb),this.el.body.aabb.contains(this.playerEl.body.aabb)}}),AFRAME.registerComponent("bodymaterial",{dependencies:["auxl"],schema:{friction:{type:"number",default:0},restitution:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl;let e=new CANNON.Material({friction:this.data.friction,restitution:this.data.restitution});this.auxl.physWorld.addMaterial(e),this.el.body.material=e}}),AFRAME.registerComponent("auxconstraint",{dependencies:["auxl"],multiple:!0,schema:{connectTo:{type:"string",default:"auxlObj"},type:{type:"string",default:"lock",oneOf:["coneTwist","distance","hinge","lock","pointToPoint"]},pivotA:{type:"vec3"},axisA:{type:"vec3"},pivotB:{type:"vec3"},axisB:{type:"vec3"},collideConnected:{type:"boolean",default:!0},distance:{type:"number",default:0,min:0},maxForce:{type:"number",default:1e6},always:{type:"boolean",default:!0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.connected=!1,this.connectBody=!1,this.listenersEnabled=!1},link:function(e){return e&&(this.connectBody=!1),this.connectBody||(this.auxl[this.data.connect]?this.auxl[this.data.connect].core&&this.auxl[this.data.connect].core.inScene?this.connectBody=this.auxl[this.data.connect].GetEl().body:this.auxl[this.data.connect].layer&&this.auxl[this.data.connect].layer.inScene&&(this.connectBody=this.auxl[this.data.connect].GetElParent().body):document.getElementById(this.data.connectTo)&&(this.connectBody=document.getElementById(this.data.connectTo).body)),this.connectBody},pivots:function(){this.pivotA=new THREE.Vector3(0,0,0),this.pivotB=new THREE.Vector3(0,0,0),this.data.pivotA&&this.pivotA.copy(this.data.pivotA),this.data.pivotB&&this.pivotB.copy(this.data.pivotB)},axis:function(){this.axisA=new CANNON.Vec3(0,0,0),this.axisB=new CANNON.Vec3(0,0,0),this.data.axisA&&this.axisA.copy(this.data.axisA),this.data.axisB&&this.axisB.copy(this.data.axisB)},Retry:function(e){let t=setTimeout((()=>{this.Reconnect(e),clearTimeout(t)}),500)},Connect:function(e){if(void 0!==this.el.body){if(!this.connected&&this.link(e)){switch(this.data.type){case"lock":this.constraint=new CANNON.LockConstraint(this.el.body,this.connectBody,{maxForce:this.data.maxForce});break;case"distance":this.constraint=new CANNON.DistanceConstraint(this.el.body,this.connectBody,this.data.distance,this.data.maxForce);break;case"pointToPoint":this.pivots(),this.constraint=new CANNON.PointToPointConstraint(this.el.body,this.pivotA,this.connectBody,this.pivotB,this.data.maxForce);break;case"hinge":this.pivots(),this.axis(),this.constraint=new CANNON.HingeConstraint(this.el.body,this.connectBody,{pivotA:this.pivotA,axisA:this.axisA,pivotB:this.pivotB,axisB:this.axisB,maxForce:this.data.maxForce});break;case"coneTwist":this.pivots(),this.axis(),this.constraint=new CANNON.ConeTwistConstraint(this.el.body,this.connectBody,{pivotA:this.pivotA,pivotB:this.pivotB,axisA:this.axisA,axisB:this.axisB,maxForce:this.data.maxForce});break;default:throw new Error("[constraint] Unexpected type: "+data.type)}this.constraint.collideConnected=this.data.collideConnected,this.auxl.physWorld.addConstraint(this.constraint),this.connected=!0}}else this.Retry(e)},Disconnect:function(){this.auxl.physWorld.removeConstraint(this.constraint),this.connected=!1},Reconnect:function(e){this.connected&&this.Disconnect(),this.Connect(e)},addListeners:function(e){this.auxl.el.addEventListener(e+"spawned",this.Connect.bind(this)),this.auxl.el.addEventListener(e+"despawned",this.Disconnect.bind(this)),this.listenersEnabled=!0},removeListeners:function(e){this.auxl.el.addEventListener(e+"spawned",this.Connect.bind(this)),this.auxl.el.addEventListener(e+"despawned",this.Disconnect.bind(this)),this.listenersEnabled=!1},update:function(e){let t=!1;e.connectTo!==this.data.connectTo&&(t=!0),this.Reconnect(t),t&&this.listenersEnabled&&this.removeListeners(e.connectTo),this.data.always&&!this.listenersEnabled&&this.addListeners(this.data.connectTo)},remove:function(){this.listenersEnabled&&this.removeListeners(this.data.connectTo)}}),AFRAME.registerComponent("auxspring",{dependencies:["auxl"],multiple:!0,schema:{connectTo:{type:"string",default:"auxlObj"},name:{type:"string",default:"auxlConstraint"},localAnchorA:{type:"vec3"},localAnchorB:{type:"vec3"},restLength:{type:"number",default:1,min:0},stiffness:{type:"number",default:100,min:0},damping:{type:"number",default:1,min:0},collideConnected:{type:"boolean",default:!0},always:{type:"boolean",default:!0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.connected=!1,this.connectBody=!1,this.listenersEnabled=!1,this.active=!1},link:function(e){return e&&(this.connectBody=!1),this.connectBody||(this.auxl[this.data.connect]?this.auxl[this.data.connect].core&&this.auxl[this.data.connect].core.inScene?this.connectBody=this.auxl[this.data.connect].GetEl().body:this.auxl[this.data.connect].layer&&this.auxl[this.data.connect].layer.inScene&&(this.connectBody=this.auxl[this.data.connect].GetElParent().body):document.getElementById(this.data.connectTo)&&(this.connectBody=document.getElementById(this.data.connectTo).body)),this.connectBody},localAnchors:function(){this.localAnchorA=new THREE.Vector3(0,0,0),this.localAnchorB=new THREE.Vector3(0,0,0),this.data.localAnchorA&&this.localAnchorA.copy(this.data.localAnchorA),this.data.localAnchorB&&this.localAnchorB.copy(this.data.localAnchorB)},Retry:function(e){let t=setTimeout((()=>{this.Reconnect(e),clearTimeout(t)}),500)},Connect:function(e){void 0!==this.el.body?!this.connected&&this.link(e)&&(this.localAnchors(),this.spring=new CANNON.Spring(this.el.body,this.connectBody,{restLength:this.data.restLength,stiffness:this.data.stiffness,damping:this.data.damping,localAnchorA:this.localAnchorA,localAnchorB:this.localAnchorB,collideConnected:this.collideConnected}),this.connected=!0):this.Retry(e)},Disconnect:function(){delete this.spring,this.spring=null,this.connected=!1},Reconnect:function(e){this.connected&&this.Disconnect(),this.Connect(e)},addListeners:function(e){this.auxl.el.addEventListener(e+"spawned",this.Connect.bind(this)),this.auxl.el.addEventListener(e+"despawned",this.Disconnect.bind(this)),this.listenersEnabled=!0},removeListeners:function(e){this.auxl.el.addEventListener(e+"spawned",this.Connect.bind(this)),this.auxl.el.addEventListener(e+"despawned",this.Disconnect.bind(this)),this.listenersEnabled=!1},update:function(e){let t=!1;e.connectTo!==this.data.connectTo&&(t=!0),t&&(this.Reconnect(t),t&&this.listenersEnabled&&this.removeListeners(e.connectTo),this.data.always&&!this.listenersEnabled&&this.addListeners(this.data.connectTo))},remove:function(){this.listenersEnabled&&this.removeListeners(this.data.connectTo)},tick:function(e,t){return this.connected&&this.active?this.spring.applyForce():void 0},play:function(){this.active=!0},pause:function(){this.active=!1}}),AFRAME.registerComponent("gravitycontrol",{dependencies:["auxl"],schema:{type:{type:"string",default:"float",oneOf:["float","earth","moon","jupiter","io","mars","Uranus","Neptune","Sun","Pluto","Saturn","Custom"]},axis:{type:"vec3",default:new THREE.Vector3(0,0,0)},velocityExpo:{type:"number",default:1e3},chuteOpen:{type:"boolean",default:!1},gravityObject:{type:"string",default:"none"},customGravity:{type:"number",default:9.80665,min:1e-6}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.worldGravity=new THREE.Vector3,this.worldGravityOffset=new THREE.Vector3,this.velocityTick=0,this.playerPosition=new THREE.Vector3,this.playerPositionOld=new THREE.Vector3,this.type=this.data.type,this.gravityAmount=0,this.axis=new THREE.Vector3(0,0,0),this.axis.x=this.data.axis.x,this.axis.y=this.data.axis.y,this.axis.z=this.data.axis.z,this.rotation=new THREE.Quaternion(0,0,0,1),this.centerOfGravity=new THREE.Vector3(0,.314,0),this.gravityDirAdjust=new THREE.Vector3(0,0,0),this.gravityQuat=new THREE.Quaternion(0,0,0,1),this.gravityObject=!1,this.allGravityDirection=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,-1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(-1,0,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,0,1)],this.allGravityRotation=[new THREE.Quaternion(0,0,0,1),new THREE.Quaternion(0,0,0,1),new THREE.Quaternion(.7071067811865475,0,.7071067811865476,0),new THREE.Quaternion(.5,.5,.5,-.5),new THREE.Quaternion(.5,-.5,-.5,-.5),new THREE.Quaternion(.5,.5,.5,.5),new THREE.Quaternion(-.5,-.5,.5,.5)],this.allGravityTypes={float:0,earth:9.80665,moon:1.6268,jupiter:24.7912112,io:1.79461695,mars:3.71672035,uranus:8.6886919,neptune:11.15016105,sun:274.782333,pluto:.61781895,saturn:10.44408225,mercury:3.726527,venus:8.8652116,custom:this.data.customGravity},this.velocityNew=new THREE.Vector3(0,0,0),this.velocityAdjust=0,this.massAdjust=0,this.axisCycleCount=0,this.axisDir=0,this.typeCycleCount=0,this.worldAxis=new THREE.Vector3(0,0,0),this.worldType="float",this.worldAxisCycleCount=0,this.worldTypeCycleCount=0,this.localAxisChange=!1,this.worldAxisChange=!1,this.worldAxisSet=0,this.axisSet=0},update:function(e){this.chuteOpen=this.data.chuteOpen,this.data.gravityObject&&"none"!==this.data.gravityObject?(this.gravityObject=this.data.gravityObject,document.getElementById(this.gravityObject)&&this.centerOfGravity.copy(document.getElementById(this.gravityObject).getAttribute("position"))):(this.gravityObject=!1,this.clearForces())},setAxis:function(e){this.localAxisChange||(this.localAxisChange=!0,this.axisSet=e,this.axisCycleCount=e,this.axis.copy(this.allGravityDirection[e]),this.axisTimeout1=setTimeout((()=>{this.el.body.sleep(),this.newPosition=new THREE.Vector3,this.newPosition.copy(this.axis).add(this.el.body.position),this.el.object3D.position.copy(this.newPosition),this.el.body.position.copy(this.newPosition),this.axisDir=e,this.el.body.quaternion.copy(this.allGravityRotation[this.axisDir]),this.el.object3D.quaternion.copy(this.allGravityRotation[this.axisDir]),this.axisTimeout2=setTimeout((()=>{this.el.body.wakeUp(),this.localAxisChange=!1,clearTimeout(this.axisTimeout1),clearTimeout(this.axisTimeout2)}),275)}),225),this.auxl.player.PlayerQuickAnim(),this.auxl.player.Notification({message:"Local Axis Update",time:2750}))},cycleAxis:function(){this.localAxisChange||(this.localAxisChange=!0,this.axisCycleCount++,this.axisCycleCount>=this.allGravityDirection.length&&(this.axisCycleCount=0),this.axis.copy(this.allGravityDirection[this.axisCycleCount]),this.axisTimeout1=setTimeout((()=>{this.el.body.sleep(),this.newPosition=new THREE.Vector3,this.newPosition.copy(this.axis).add(this.el.body.position),this.el.object3D.position.copy(this.newPosition),this.el.body.position.copy(this.newPosition),this.axisDir=this.axisCycleCount,this.el.body.quaternion.copy(this.allGravityRotation[this.axisDir]),this.el.object3D.quaternion.copy(this.allGravityRotation[this.axisDir]),this.axisTimeout2=setTimeout((()=>{this.el.body.wakeUp(),this.localAxisChange=!1,clearTimeout(this.axisTimeout1),clearTimeout(this.axisTimeout2)}),275)}),225),this.auxl.player.PlayerQuickAnim(),this.auxl.player.Notification({message:"Local Axis Update",time:2750}))},randomAxis:function(){this.axisCycleCount=Math.floor(Math.random()*this.allGravityDirection.length),this.axis.copy(this.allGravityDirection[this.axisCycleCount]),this.axisTimeout1=setTimeout((()=>{this.el.body.sleep(),this.newPosition=new THREE.Vector3,this.newPosition.copy(this.axis).add(this.el.body.position),this.el.object3D.position.copy(this.newPosition),this.el.body.position.copy(this.newPosition),this.axisDir=this.axisCycleCount,this.el.body.quaternion.copy(this.allGravityRotation[this.axisDir]),this.el.object3D.quaternion.copy(this.allGravityRotation[this.axisDir]),this.axisTimeout2=setTimeout((()=>{this.el.body.wakeUp(),this.localAxisChange=!1,clearTimeout(this.axisTimeout1),clearTimeout(this.axisTimeout2)}),275)}),225),this.auxl.player.PlayerQuickAnim(),this.auxl.player.Notification({message:"Local Axis Update",time:2750})},gravityObjectAxis:function(){.314===this.gravityObject.y&&document.getElementById(this.gravityObject)&&this.centerOfGravity.copy(document.getElementById(this.gravityObject).getAttribute("position")),this.gravityDirAdjust.copy(this.centerOfGravity),this.gravityDirAdjust.sub(this.playerPosition),this.gravityDirAdjust.normalize(),this.gravityQuat=new THREE.Quaternion,this.gravityQuat.setFromUnitVectors(new THREE.Vector3(0,-1,0),this.gravityDirAdjust),this.axis.copy(this.gravityDirAdjust),this.el.body.quaternion.copy(this.gravityQuat),this.el.object3D.quaternion.copy(this.gravityQuat)},setWorldAxis:function(e){this.worldAxisSet=e,this.worldAxisCycleCount=e,this.worldAxis.copy(this.allGravityDirection[e]),this.worldAxis.multiplyScalar(this.allGravityTypes[this.worldType]),this.el.body.world.gravity.copy(this.worldAxis),this.auxl.player.Notification({message:"World Axis Update",time:2750})},cycleWorldAxis:function(){this.worldAxisCycleCount++,this.worldAxisCycleCount>=this.allGravityDirection.length&&(this.worldAxisCycleCount=0),this.worldAxisSet=this.worldAxisCycleCount,this.worldAxis.copy(this.allGravityDirection[this.worldAxisCycleCount]),this.worldAxis.multiplyScalar(this.allGravityTypes[this.worldType]),this.el.body.world.gravity.copy(this.worldAxis),this.auxl.player.Notification({message:"World Axis Update",time:2750})},setTypes:function(e){this.typeCycleCount=e,this.type=Object.keys(this.allGravityTypes)[e],this.auxl.player.Notification({message:"Local Gravity : "+this.type,time:2e3})},cycleTypes:function(){this.typeCycleCount++,this.typeCycleCount>=Object.keys(this.allGravityTypes).length&&(this.typeCycleCount=0),this.type=Object.keys(this.allGravityTypes)[this.typeCycleCount],this.auxl.player.Notification({message:"Local Gravity : "+this.type,time:2e3})},randomTypes:function(){this.typeCycleCount=Math.floor(Math.random()*Object.keys(this.allGravityTypes).length),this.type=Object.keys(this.allGravityTypes)[this.typeCycleCount],this.auxl.player.Notification({message:"Local Gravity : "+this.type,time:2e3}),console.log(this.type)},setWorldTypes:function(e){this.worldTypeCycleCount=e,this.worldType=Object.keys(this.allGravityTypes)[e],this.worldAxis.copy(this.allGravityDirection[this.worldAxisSet]),this.worldAxis.multiplyScalar(this.allGravityTypes[this.worldType]),this.el.body.world.gravity.copy(this.worldAxis),this.auxl.player.Notification({message:"World Gravity : "+this.worldType,time:2e3})},cycleWorldTypes:function(){this.worldTypeCycleCount++,this.worldTypeCycleCount>=Object.keys(this.allGravityTypes).length&&(this.worldTypeCycleCount=0),this.worldType=Object.keys(this.allGravityTypes)[this.worldTypeCycleCount],this.worldAxis.copy(this.allGravityDirection[this.worldAxisSet]),this.worldAxis.multiplyScalar(this.allGravityTypes[this.worldType]),this.el.body.world.gravity.copy(this.worldAxis),this.auxl.player.Notification({message:"World Gravity : "+this.worldType,time:2e3})},clearForces:function(){null!==this.el.body&&null!==this.el.body.world&&this.el.body.world.clearForces()},gravityVelocity:function(){if(this.auxl.playerRig.GetEl()&&this.auxl.playerRig.GetEl().body){this.playerPosition.copy(this.auxl.playerRig.GetEl().body.position);let e=!1;if(this.gravityObject){this.playerPosition.dot(this.gravityDirAdjust)>this.playerPositionOld.dot(this.gravityDirAdjust)&&(e=!0)}else 0!==this.axis.x?this.axis.x<0?this.playerPosition.x<this.playerPositionOld.x&&(e=!0):this.playerPosition.x>this.playerPositionOld.x&&(e=!0):0!==this.axis.y?this.axis.y<0?this.playerPosition.y<this.playerPositionOld.y&&(e=!0):this.playerPosition.y>this.playerPositionOld.y&&(e=!0):0!==this.axis.z&&(this.axis.z<0?this.playerPosition.z<this.playerPositionOld.z&&(e=!0):this.playerPosition.z>this.playerPositionOld.z&&(e=!0));this.playerPositionOld.copy(this.playerPosition),this.massAdjust=this.el.body.mass,"float"===this.type?this.gravityAmount=0:"earth"===this.type?this.gravityAmount=9.80665:"moon"===this.type?(this.gravityAmount=1.6268,this.massAdjust*=.1657):"jupiter"===this.type?(this.gravityAmount=24.7912112,this.massAdjust*=2.528):"io"===this.data.type?(this.gravityAmount=1.79461695,this.massAdjust*=.183):"mars"===this.type?(this.gravityAmount=3.71672035,this.massAdjust*=.379):"uranus"===this.type?(this.gravityAmount=8.6886919,this.massAdjust*=.886):"neptune"===this.type?(this.gravityAmount=11.15016105,this.massAdjust*=1.137):"sun"===this.type?(this.gravityAmount=274.782333,this.massAdjust*=28.02):"pluto"===this.type?(this.gravityAmount=.61781895,this.massAdjust*=.063):"saturn"===this.type?(this.gravityAmount=10.44408225,this.massAdjust*=1.065):"mercury"===this.type?this.gravityAmount=3.726527:"venus"===this.type?this.gravityAmount=8.8652116:"custom"===this.type&&(this.gravityAmount=this.data.customGravity),(this.axis.equals(new THREE.Vector3(0,0,0))||"float"===this.type||this.data.chuteOpen)&&(e=!1),e?(this.velocityTick++,this.velocityAdjust=this.data.velocityExpo,this.velocityAdjust/=this.massAdjust,this.velocityNew=new THREE.Vector3(this.velocityTick/this.velocityAdjust,this.velocityTick/this.velocityAdjust,this.velocityTick/this.velocityAdjust),this.velocityNew.multiply(this.axis),this.el.body.velocity.x+=this.velocityNew.x,this.el.body.velocity.y+=this.velocityNew.y,this.el.body.velocity.z+=this.velocityNew.z):(this.auxl.player.layer.velocity=new THREE.Vector3(0,0,0),this.velocityTick=0),this.planetGravity=new THREE.Vector3(0,0,0),this.planetGravity=new THREE.Vector3(this.gravityAmount,this.gravityAmount,this.gravityAmount),this.planetGravity.multiply(this.axis),this.el.body.applyForce(this.planetGravity,new THREE.Vector3(0,0,0))}},offsetWorldGravity:function(){this.worldGravityOffset=new THREE.Vector3,this.worldGravity.copy(this.auxl.physWorld.gravity),this.worldGravityOffset.copy(this.worldGravity),this.worldGravityOffset.equals(new THREE.Vector3)||(this.worldGravityOffset.multiplyScalar(-1*this.el.body.mass),this.el.body.applyForce(this.worldGravityOffset,this.el.body.position))},tick:function(e,t){this.gravityObject&&this.gravityObjectAxis(),this.offsetWorldGravity(),this.gravityVelocity()}}),AFRAME.registerComponent("rain",{schema:{density:{type:"number",default:30}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.auxl.audioEnabled&&(this.playerAudio=document.querySelector("#playerAudio"),this.playerAudio.emit("thunderstorm",{bubbles:!1}));let e=document.querySelector("a-scene"),t=document.createElement("a-entity");this.parentId="rain",t.setAttribute("id",this.parentId),t.classList.add("weather"),e.appendChild(t);let i=this.data.density;for(let e=0;e<i;e++){let i,o,a,n=document.createElement("a-entity"),s=document.createElement("a-entity");t.classList.add("weatherElGroup"),t.appendChild(s),i=new THREE.Vector3(-.04,-.55,0),o=new THREE.Vector3(.04,-.55,0),a=new THREE.Vector3(0,0,0),n.setAttribute("geometry",{primitive:"triangle",vertexA:i,vertexB:o,vertexC:a}),n.setAttribute("material",{color:"#55a5be",opacity:.75,metalness:0,roughness:1,side:"double"});let r=40*Math.random()-20,l=40,c=40*Math.random()-20;n.setAttribute("position",{x:r,y:l,z:c}),n.setAttribute("scale",{x:1*Math.random()+.5,y:1*Math.random()+.5,z:1*Math.random()+.5}),n.classList.add("weatherEl"),n.setAttribute("raindrop",{});let h=!1,d=!1;if(0!==e&&e%2==0){d=document.createElement("a-entity");let e=new THREE.Vector3(-.1,-.1,0),t=new THREE.Vector3(.1,-.1,0),i=new THREE.Vector3(0,0,0);d.setAttribute("geometry",{primitive:"triangle",vertexA:e,vertexB:t,vertexC:i}),d.setAttribute("material",{color:"#327186",opacity:.75,metalness:0,roughness:1,side:"double"}),d.setAttribute("rotation","-90 0 0"),d.setAttribute("visible",!1),d.setAttribute("position",{x:r,y:"0.05",z:c}),d.classList.add("weatherElSplash"),h=!0}s.appendChild(n),h&&s.appendChild(d)}},remove:function(){let e=document.querySelector("a-scene"),t=document.getElementById(this.parentId);e.removeChild(t),this.auxl.audioEnabled&&this.playerAudio.components.sound__thunderstorm&&this.playerAudio.components.sound__thunderstorm.stopSound()}}),AFRAME.registerComponent("raindrop",{init:function(){let e=this.el,t=document.getElementById("playerRig"),i=Math.floor(2e3*Math.random()),o=Math.floor(1e3*Math.random()+1e3),a={property:"object3D.position.y",to:-2,dur:o,delay:i,loop:"true",dir:"normal",easing:"linear",elasticity:400,autoplay:"true",enabled:"true"};e.setAttribute("animation__drop",a);let n=!1,s=e.nextSibling;function r(){s.setAttribute("visible",!0),setTimeout((function(){s.setAttribute("visible",!1);let t=e.getAttribute("position");s.setAttribute("position",{x:t.x,z:t.z})}),500)}function l(){let i=t.getAttribute("position"),o=40*Math.random()-20+i.x,a=40*Math.random()-20+i.z;e.setAttribute("position",{x:o,z:a})}s&&(n=!0),this.splashTimeout=setTimeout((function(){setInterval(l,o),n&&setInterval(r,o)}),i+o)},remove:function(){clearTimeout(this.splashTimeout)}}),AFRAME.registerComponent("lightningbolt",{init:function(){this.auxl=document.querySelector("a-scene").systems.auxl;let e=document.querySelector("a-scene"),t=document.querySelector("#playerRig"),i=Math.floor(5e3*Math.random()+15e3),o=document.createElement("a-entity");o.setAttribute("position",{x:"0",y:"0",z:"0"}),o.setAttribute("scale","1 1 1"),o.setAttribute("id","lightningbolt"),o.setAttribute("visible",!1),o.classList.add("bolt"),o.setAttribute("animation__visibility",{property:"visible",from:!1,to:!0,dur:250,delay:0,loop:"true",dir:"normal",easing:"linear",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),e.appendChild(o);let a=document.createElement("a-entity");a.setAttribute("position",{x:"0",y:"7.5",z:"-3"}),a.setAttribute("scale","10 10 0"),a.classList.add("lightningbolt"),o.appendChild(a);let n=new THREE.Vector3(-.05,-.5,0),s=new THREE.Vector3(.05,-.5,0),r=new THREE.Vector3(0,0,0),l=document.createElement("a-entity");l.setAttribute("geometry",{primitive:"triangle",vertexA:n,vertexB:s,vertexC:r}),l.setAttribute("position",{x:"-0.15",y:"-0.7",z:"0"}),l.setAttribute("scale","0.25 0.25 0.25"),l.setAttribute("rotation","0 0 215"),l.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),l.classList.add("lightningboltleftsplash"),l.setAttribute("animation__scale",{property:"scale",from:"0.1 0.1 0.1",to:"1 1 1",dur:1e3,delay:0,loop:"true",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),l.setAttribute("animation__rotation",{property:"rotation",from:"0 0 215",to:"0 0 250",dur:1e3,delay:0,loop:"true",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),a.appendChild(l);let c=document.createElement("a-entity");c.setAttribute("rotation","0 0 -5"),c.classList.add("midBoltWrapper"),a.appendChild(c);let h=document.createElement("a-entity");h.setAttribute("rotation","0 0 0"),h.setAttribute("scale","0.25 1 1"),h.classList.add("boltTopWrapper"),c.appendChild(h);let d=document.createElement("a-entity");d.setAttribute("geometry",{primitive:"plane",width:1,height:1}),d.setAttribute("position",{x:"1.6",y:"4",z:"0"}),d.setAttribute("rotation","0 0 45"),d.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),d.classList.add("topBolt"),h.appendChild(d);let p=document.createElement("a-entity");p.setAttribute("rotation","0 0 0"),p.setAttribute("scale","0.25 1 1"),p.classList.add("boltTopMidWrapper"),c.appendChild(p);let u=document.createElement("a-entity");u.setAttribute("geometry",{primitive:"plane",width:1,height:1}),u.setAttribute("position",{x:"1.2",y:"3",z:"0"}),u.setAttribute("rotation","0 0 45"),u.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),u.classList.add("topMidBolt"),p.appendChild(u);let m=document.createElement("a-entity");m.setAttribute("rotation","0 0 0"),m.setAttribute("scale","0.25 1 1"),m.classList.add("boltMidWrapper"),c.appendChild(m);let y=document.createElement("a-entity");y.setAttribute("geometry",{primitive:"plane",width:1,height:1}),y.setAttribute("position",{x:"0.8",y:"2",z:"0"}),y.setAttribute("rotation","0 0 45"),y.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),y.classList.add("midBolt"),m.appendChild(y);let g=document.createElement("a-entity");g.setAttribute("rotation","0 0 0"),g.setAttribute("scale","0.25 1 1"),g.classList.add("boltBottomMidWrapper"),c.appendChild(g);let v=document.createElement("a-entity");v.setAttribute("geometry",{primitive:"plane",width:1,height:1}),v.setAttribute("position",{x:"0.4",y:"1",z:"0"}),v.setAttribute("rotation","0 0 45"),v.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),v.classList.add("bottomMidBolt"),g.appendChild(v);let b=document.createElement("a-entity");b.setAttribute("rotation","0 0 0"),b.setAttribute("scale","0.25 1 1"),b.classList.add("boltBottomWrapper"),c.appendChild(b);let f=document.createElement("a-entity");f.setAttribute("geometry",{primitive:"plane",width:1,height:1}),f.setAttribute("position",{x:"0",y:"0",z:"0"}),f.setAttribute("rotation","0 0 45"),f.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),f.classList.add("bottomBolt"),b.appendChild(f);let E=document.createElement("a-entity");E.setAttribute("geometry",{primitive:"triangle",vertexA:n,vertexB:s,vertexC:r}),E.setAttribute("position",{x:"0.05",y:"-0.7",z:"0"}),E.setAttribute("scale","0.25 0.25 0.25"),E.setAttribute("rotation","0 0 -215"),E.setAttribute("material",{color:"#f09e1b",opacity:.75,shader:"flat",side:"double"}),E.classList.add("lightningboltrightsplash"),E.setAttribute("animation__scale",{property:"scale",from:"0.1 0.1 0.1",to:"1 1 1",dur:1e3,delay:0,loop:"true",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),E.setAttribute("animation__rotation",{property:"rotation",from:"0 0 -215",to:"0 0 -250",dur:1e3,delay:0,loop:"true",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),a.appendChild(E);let w=document.createElement("a-entity");w.setAttribute("geometry",{primitive:"circle",radius:4,segments:16}),w.setAttribute("position",{x:"-0.5",y:"0.2",z:"-3"}),w.setAttribute("rotation","-90 0 0"),w.setAttribute("material",{color:"#dba54f",opacity:.75,shader:"flat",side:"double"}),w.classList.add("boltfloor"),o.appendChild(w);let x,T=document.createElement("a-entity");T.setAttribute("gltf-model",this.auxl.cloud0),T.setAttribute("position",{x:"6",y:"50",z:"-2"}),T.setAttribute("rotation","0 0 180"),T.classList.add("boltCloud"),o.appendChild(T),document.querySelector("#ambientLight")?(x=document.querySelector("#ambientLight"),x.setAttribute("light",{type:"ambient",color:"#716a9a",intensity:.5})):(x=document.createElement("a-entity"),x.setAttribute("light",{type:"ambient",color:"#716a9a",intensity:.5}),x.setAttribute("id","#ambientLight"),e.appendChild(x)),x.setAttribute("animation__lightningbolt1",{property:"light.intensity",from:"0.5",to:"4.5",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeOutCirc",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),x.setAttribute("animation__lightningbolt2",{property:"light.intensity",from:"4.5",to:"0",dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),x.setAttribute("animation__lightningbolt3",{property:"light.intensity",from:"0",to:"2.5",dur:1,delay:500,loop:"false",dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),x.setAttribute("animation__lightningbolt4",{property:"light.intensity",from:"3.5",to:"0",dur:200,delay:500,loop:"false",dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),x.setAttribute("animation__lightningbolt5",{property:"light.intensity",from:"0",to:"3.5",dur:1,delay:700,loop:"false",dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"}),x.setAttribute("animation__lightningbolt6",{property:"light.intensity",from:"2.5",to:"0.5",dur:50,delay:1e3,loop:"false",dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:"false",enabled:"true",startEvents:"boltHit",pauseEvents:"boltStop"});let R=document.querySelector(".bolt"),k=document.querySelector(".lightningboltleftsplash"),D=document.querySelector(".lightningboltrightsplash"),C=document.querySelector("#playerAudio");function M(){let e=t.getAttribute("position"),i=80*Math.random()-40+e.x,o=80*Math.random()-40+e.z;R.setAttribute("position",{x:i,y:.15,z:o})}M(),this.boltInterval=setInterval((()=>{this.auxl.audioEnabled&&C.emit("boltHit"),setTimeout((()=>{R.setAttribute("visible",!0),x.emit("boltHit"),setTimeout((()=>{R.emit("boltHit"),k.emit("boltHit"),D.emit("boltHit"),setTimeout((()=>{R.setAttribute("visible",!1),o.emit("boltStop"),x.emit("boltStop"),k.emit("boltStop"),k.setAttribute("scale","0.25 0.25 0.25"),k.setAttribute("rotation","0 0 215"),D.emit("boltStop"),D.setAttribute("scale","0.25 0.25 0.25"),D.setAttribute("rotation","0 0 -215"),M()}),800)}),250)}),1500)}),i)},remove:function(){clearInterval(this.boltInterval);let e=document.querySelector("a-scene"),t=document.getElementById("lightningbolt");e.removeChild(t)}}),AFRAME.registerComponent("auxsound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var e=this;this.listener=null,this.audioLoader=new THREE.AudioLoader,this.pool=new THREE.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){e.playSound()}},update:function(e){var t,i,o=this.data,a=o.src!==e.src;if(a){if(!o.src)return;this.setupSound()}for(t=0;t<this.pool.children.length;t++)i=this.pool.children[t],o.positional&&(i.setDistanceModel(o.distanceModel),i.setMaxDistance(o.maxDistance),i.setRefDistance(o.refDistance),i.setRolloffFactor(o.rolloffFactor)),i.setLoop(o.loop),i.setLoopStart(o.loopStart),0!==o.loopStart&&0===o.loopEnd?i.setLoopEnd(i.buffer.duration):i.setLoopEnd(o.loopEnd),i.setVolume(o.volume),i.isPaused=!1;if(o.on!==e.on&&this.updateEventListener(e.on),a){var n=this;this.loaded=!1,this.audioLoader.load(o.src,(function(e){for(t=0;t<n.pool.children.length;t++)(i=n.pool.children[t]).setBuffer(e);n.loaded=!0,THREE.Cache.remove(o.src),(n.data.autoplay||n.mustPlay)&&n.playSound(n.processSound),n.el.emit("sound-loaded",n.evtDetail,!1)}))}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var e;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(e=0;e<this.pool.children.length;e++)this.pool.children[e].disconnect()}catch(e){}},updateEventListener:function(e){var t=this.el;e&&t.removeEventListener(e,this.playSoundBound),t.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var e,t,i=this.el,o=i.sceneEl,a=this;this.pool.children.length>0&&(this.stopSound(),i.removeObject3D("sound"));var n=this.listener=o.audioListener||new THREE.AudioListener;for(o.audioListener=n,o.camera&&o.camera.add(n),o.addEventListener("camera-set-active",(function(e){e.detail.cameraEl.getObject3D("camera").add(n)})),this.pool=new THREE.Group,e=0;e<this.data.poolSize;e++)t=this.data.positional?new THREE.PositionalAudio(n):new THREE.Audio(n),this.pool.add(t);for(i.setObject3D(this.attrName,this.pool),e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).onEnded=function(){this.isPlaying=!1,a.el.emit("sound-ended",a.evtDetail,!1)}},pauseSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).source&&t.source.buffer&&t.isPlaying&&!t.isPaused&&(t.isPaused=!0,t.pause())},playSound:function(e){var t,i,o;if(!this.loaded)return this.mustPlay=!0,void(this.processSound=e);for(t=!1,this.isPlaying=!0,i=0;i<this.pool.children.length;i++)(o=this.pool.children[i]).isPlaying||!o.buffer||t||(e&&e(o),o.play(),o.isPaused=!1,t=!0);t&&(this.mustPlay=!1,this.processSound=void 0)},stopSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++){if(!(t=this.pool.children[e]).source||!t.source.buffer)return;t.stop()}}}),AFRAME.registerComponent("auxl-third-party",{dependencies:["auxl"],init:function(){const e=document.querySelector("a-scene").systems.auxl;e.TestObj=t=>{let i={};return i.id=t,i.testData={data:"testData",id:"test",sources:!1,text:!1,geometry:{primitive:"box",depth:.5,width:.5,height:.5},material:{shader:"standard",src:e.pattern10,repeat:"1 1",color:"#52a539",emissive:"#52a539",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(-1.5,2.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{doorway:{zone:"zone0",to:"connect0"}}},i.test=e.Core(i.testData),{testObj:i,SpawnTest:()=>{i.test.SpawnCore()},DespawnTest:()=>{i.test.DespawnCore()},TestMethod:e=>{console.log(e)}}},e.AddObjGenToTracker("testObj","SpawnTest","DespawnTest"),e.test=e.TestObj("test"),e.buildExtra=()=>{e.test=e.TestObj("test")},e.toBeRebuilt("buildExtra")}}),AFRAME.registerShader("threeColorGradientShader",{schema:{topColor:{type:"color",default:"1 0 0",is:"uniform"},middleColor:{type:"color",default:"0 1 0",is:"uniform"},bottomColor:{type:"color",default:"0 0 1",is:"uniform"}},vertexShader:["varying vec3 vWorldPosition;","void main() {"," vec4 worldPosition = modelMatrix * vec4( position, 1.0 );"," vWorldPosition = worldPosition.xyz;"," gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 bottomColor;","uniform vec3 middleColor;","uniform vec3 topColor;","uniform float offset;","varying vec3 vWorldPosition;","void main() {"," float h = normalize( vWorldPosition ).y;"," if (h>0.0) {","   gl_FragColor = vec4( mix( middleColor, topColor, max( pow( max(h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," } else {","   gl_FragColor = vec4( mix( middleColor, bottomColor, max( pow( max(-h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," }","}"].join("\n")}),AFRAME.registerComponent("library",{dependencies:["auxl"],init:function(){const e=document.querySelector("a-scene").systems.auxl;e.mintyGreen="#3EB489",e.mintyPink="#C14B76",e.vaporPink="#ff71ce",e.vaporBlue="#01cdfe",e.vaporGreen="#05ffa1",e.vaporPurple="#b967ff",e.vaporYellow="#fffb96",e.grassMaterial={shader:"standard",color:"#55be71",opacity:1,metalness:.1,roughness:.9,emissive:"#397e4b",emissiveIntensity:.2},e.waterMaterial={shader:"standard",color:"#55a5be",opacity:1,metalness:.1,roughness:.9,emissive:"#65c3e0",emissiveIntensity:.2},e.nullParentData={data:"nullParent",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:!1},e.menuBaseData={data:"menu part",id:"menuBaseTemp",sources:!1,text:{value:"Hmmm...",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"box",depth:.04,width:.4,height:.15},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"},click2:{property:"material.emissiveIntensity",from:"0.6",to:"0.8",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:{stare:{id:"playerRig"}}},e.menuCylinderData={data:"menuCylinderData",id:"menuCylinder",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.4,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{hoveron:{property:"components.material.material.emissiveIntensity",from:.4,to:.6,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"components.material.material.emissiveIntensity",from:.6,to:.4,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.menuHoverData={data:"menuHoverData",id:"menuHover",sources:!1,text:{value:"Menu",wrapCount:40,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(0,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.buildCoreData={data:"buildCoreData",id:"buildCore",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.4,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{hoveron:{property:"components.material.material.emissiveIntensity",from:.4,to:.6,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"components.material.material.emissiveIntensity",from:.6,to:.4,dur:125,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.buildHoverData={data:"buildHoverData",id:"buildHover",sources:!1,text:{value:"Menu",wrapCount:40,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(0,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.playerRigData={data:"playerRigData",id:"playerRig",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{auxcontroller:null,locomotion:{uiid:!1,courserid:"mouseController",movetype:"desktop"},light:{type:"point",intensity:.075,distance:5,decay:.75}}},e.playerRig=e.Core(e.playerRigData),e.playerBodyData={data:"playerBodyData",id:"playerBody",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,1,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:!1},e.playerBody=e.Core(e.playerBodyData),e.avatarHeadData={data:"Avatar Head",id:"avatarHead",sources:!1,text:!1,geometry:!1,material:!1,geometry:{primitive:"box",depth:.25,width:.25,height:.25},material:{shader:"standard",color:"#4bc166",opacity:1,metalness:.2,roughness:.8,emissive:"#4bc166",emissiveIntensity:.6},position:new THREE.Vector3(0,1.6,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"look-controls":{enabled:!0,reverseMouseDrag:!1,reverseTouchDrag:!1,touchEnabled:!0,mouseEnabled:!0,pointerLockEnabled:!0,magicWindowTrackingEnabled:!0}}},e.avatarHead=e.Core(e.avatarHeadData),e.playerHeadData={data:"Player Head",id:"playerHead",sources:!1,text:!1,geometry:!1,material:!1,geometry:{primitive:"box",depth:.25,width:.25,height:.25},material:{shader:"standard",color:"#4bc166",opacity:1,metalness:.2,roughness:.8,emissive:"#4bc166",emissiveIntensity:.6},position:new THREE.Vector3(0,1.6,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"look-controls":{enabled:!0,reverseMouseDrag:!1,reverseTouchDrag:!1,touchEnabled:!0,mouseEnabled:!0,pointerLockEnabled:!0,magicWindowTrackingEnabled:!0},"wasd-controls":{enabled:!1}}},e.playerHead=e.Core(e.playerHeadData),e.playerCamRoamData={data:"playerCamRoamData",id:"playerCamRoam",sources:!1,text:!1,geometry:!1,material:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,1.6,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:!1},e.playerCamRoam=e.Core(e.playerCamRoamData),e.roamCameraData={data:"roamCameraData",id:"roamCamera",position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"look-controls":{enabled:!0,reverseMouseDrag:!1,reverseTouchDrag:!1,touchEnabled:!0,mouseEnabled:!0,pointerLockEnabled:!0,magicWindowTrackingEnabled:!0},"wasd-controls":{enabled:!1},camera:{active:!1}}},e.roamCamera=e.Core(e.roamCameraData),e.headRigData={data:"headRigData",id:"headRig",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:!1},e.headRig=e.Core(e.headRigData),e.cameraData={data:"Camera Entity",id:"camera",entity:"preAdded",position:new THREE.Vector3(0,1.6,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"look-controls":{enabled:!0,reverseMouseDrag:!1,reverseTouchDrag:!1,touchEnabled:!0,mouseEnabled:!0,pointerLockEnabled:!0,magicWindowTrackingEnabled:!0},"wasd-controls":{enabled:!1}}},e.camera=e.Core(e.cameraData),e.cameraUIData={data:"Camera UI",id:"cameraUI",sources:!1,text:{value:"Message",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold",side:"double",opacity:0},geometry:{primitive:"plane",width:.3,height:.15},material:{shader:"flat",color:"#ac2d2d",opacity:.69,side:"both"},position:new THREE.Vector3(0,.05,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{opacinbk:{property:"components.material.material.opacity",from:0,to:.82,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacoutbk:{property:"components.material.material.opacity",from:.82,to:0,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsgFadeOut",pauseEvents:"cameraMsg"},opacintxt:{property:"text.opacity",from:0,to:.82,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacouttxt:{property:"text.opacity",from:.82,to:0,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsgFadeOut",pauseEvents:"cameraMsg"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},e.cameraUI=e.Core(e.cameraUIData),e.mouseControllerData={data:"Mouse Controller",id:"mouseController",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.005,radiusOuter:.01},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.75,.75,.75),animations:{click:{property:"scale",from:"0.75 0.75 0.75",to:"0.4 0.4 0.4",dur:100,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mousedown"},clickreset:{property:"scale",from:"0.4 0.4 0.4",to:"0.75 0.75 0.75",dur:300,delay:0,loop:"false",dir:"normal",easing:"easeOutCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseup"},hoverenter:{property:"material.color",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"material.color",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["clickable","a-ent","player"],components:!1},e.mouseController=e.Core(e.mouseControllerData),e.vrController1Data={data:"vrController1Data",id:"vrController1",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{camera:{active:!1},visible:"false"}},e.vrController1=e.Core(e.vrController1Data),e.vrController1UIData={data:"vrController1UIData",id:"vrController1UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},e.vrController1UI=e.Core(e.vrController1UIData),e.vrController2Data={data:"vrController2Data",id:"vrController2",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{camera:{active:!1},visible:"false"}},e.vrController2=e.Core(e.vrController2Data),e.vrController2UIData={data:"vrController2UIData",id:"vrController2UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},e.vrController2UI=e.Core(e.vrController2UIData),e.playerBeltUIData={data:"playerBeltUIData",id:"playerBeltUI",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"look-at-xyz":{match:"camera",x:!1,y:!0,z:!1}}},e.playerBeltUI=e.Core(e.playerBeltUIData),e.playerBeltTextData={data:"playerBeltTextData",id:"playerBeltText",sources:!1,text:{value:"Hello World!",color:"#FFFFFF",align:"left",font:"exo2bold",width:.9,zOffset:.03,side:"front",wrapCount:45,baseline:"center"},geometry:{primitive:"box",depth:.025,width:1,height:.25},material:{shader:"standard",color:"#4bb8c1",opacity:.75,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable"],components:{visible:!1}},e.playerBeltText=e.Core(e.playerBeltTextData),e.playerBeltTitleTextData={data:"playerBeltTitleTextData",id:"playerBeltTitleText",sources:!1,text:{value:"Read",color:"#FFFFFF",align:"left",font:"exo2bold",width:.225,zOffset:.03,side:"front",wrapCount:16,baseline:"center"},geometry:{primitive:"box",depth:.05,width:.25,height:.05},material:{shader:"standard",color:"#4bb8c1",opacity:.75,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(-.35,.15,.1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable"],components:{visible:!1}},e.playerBeltTitleText=e.Core(e.playerBeltTitleTextData),e.playerFloorData={data:"Player Floor",id:"playerFloor",sources:!1,text:{value:"N\nW     E\nS",width:7,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.26,side:"double"},geometry:{primitive:"circle",radius:1,segments:32,thetaStart:0,thetaLength:360},material:{shader:"flat",repeat:"1 1",color:"#3EB489",opacity:.42,side:"both"},position:new THREE.Vector3(0,.05,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player","clickable"],components:{visible:!1}},e.playerFloor=e.Core(e.playerFloorData),e.playerAudioData={data:"playerAudioData",id:"playerAudio",position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:!1},e.playerAudio=e.Core(e.playerAudioData),e.fadeScreenData={data:"Fade Screen",id:"fadeScreen",sources:!1,text:!1,geometry:{primitive:"plane",width:1,height:.5},material:{shader:"flat",color:"#000000",opacity:0},position:new THREE.Vector3(0,0,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{fadein:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeinquick:{property:"components.material.material.opacity",from:0,to:1,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadequick"},fadeoutquick:{property:"components.material.material.opacity",from:1,to:0,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadequick"},fadeinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene1"},fadeoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene2"},fadein:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadein"},fadeout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeout"}},mixins:!1,classes:["a-ent","player","clickable"],components:{visible:!1}},e.fadeScreen=e.Core(e.fadeScreenData),e.sphereScreenData={data:"Sphere Screen",id:"sphereScreen",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.125,segmentsWidth:36,segmentsHeight:18,phiLength:360,phiStart:0,thetaLength:0,thetaStart:90},material:{shader:"flat",color:"#000000",opacity:1,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{spherein1:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein2:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout1:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout2:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein1quick:{property:"geometry.thetaLength",from:0,to:180,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"spherequick"},spherein2quick:{property:"geometry.thetaStart",from:90,to:0,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"spherequick"},sphereout1quick:{property:"geometry.thetaLength",from:180,to:0,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"spherequick"},sphereout2quick:{property:"geometry.thetaStart",from:0,to:90,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"spherequick"},spherein1scene:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},spherein2scene:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},sphereout1scene:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"},sphereout2scene:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},e.sphereScreen=e.Core(e.sphereScreenData),e.blink1ScreenData={data:"Blink 1 Screen",id:"blink1Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinquick:{property:"object3D.position.y",from:2.5,to:1,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkopacinquick:{property:"components.material.material.opacity",from:0,to:1,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkoutquick:{property:"object3D.position.y",from:1,to:2.5,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkopacoutquick:{property:"components.material.material.opacity",from:1,to:0,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkinscene:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},e.blink1Screen=e.Core(e.blink1ScreenData),e.blink2ScreenData={data:"Blink 2 Screen",id:"blink2Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,-2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinquick:{property:"object3D.position.y",from:-2.5,to:-1,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkopacinquick:{property:"components.material.material.opacity",from:0,to:1,dur:200,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkoutquick:{property:"object3D.position.y",from:-1,to:-2.5,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkopacoutquick:{property:"components.material.material.opacity",from:1,to:0,dur:200,delay:300,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkquick"},blinkinscene:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},e.blink2Screen=e.Core(e.blink2ScreenData),e.playerAll={parent:{core:e.playerRig},child0:{parent:{core:e.playerBody},child0:{parent:{core:e.playerHead},child0:{parent:{core:e.headRig},child0:{parent:{core:e.camera},child0:{core:e.mouseController},child1:{core:e.cameraUI},child2:{core:e.fadeScreen},child3:{core:e.sphereScreen},child4:{core:e.blink1Screen},child5:{core:e.blink2Screen}},child1:{core:e.playerAudio},child2:{parent:{core:e.playerBeltUI},child0:{parent:{core:e.playerBeltText},child0:{core:e.playerBeltTitleText}}}}},child1:{parent:{core:e.vrController1},child0:{core:e.vrController1UI}},child2:{parent:{core:e.vrController2},child0:{core:e.vrController2UI}},child3:{core:e.playerFloor},child4:{parent:{core:e.playerCamRoam},child0:{core:e.roamCamera}}}},e.playerLayer=e.Layer("playerLayer",e.playerAll),e.player=e.Player("player",e.playerLayer),e.avatarSphereData={data:"avatarSphereData",id:"avatarSphere",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarSphere=e.Core(e.avatarSphereData),e.avatarRigData={data:"avatarRigData",id:"avatarRig",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,1,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:{light:{type:"point",intensity:.075,distance:5,decay:.75}}},e.avatarRig=e.Core(e.avatarRigData),e.avatarBodyData={data:"avatarBodyData",id:"avatarBody",sources:!1,text:!1,geometry:{primitive:"box",depth:.25,width:.25,height:1.3},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,.75,.125),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarBody=e.Core(e.avatarBodyData),e.avatarFaceData={data:"avatarFaceData",id:"avatarFace",sources:!1,text:!1,geometry:{primitive:"triangle",vertexA:new THREE.Vector3(0,.5,0),vertexB:new THREE.Vector3(-.5,-.5,0),vertexC:new THREE.Vector3(.5,-.5,0)},material:{shader:"standard",color:"#1fceac",opacity:1,metalness:.2,roughness:.8,emissive:"#1fceac",emissiveIntensity:.6},position:new THREE.Vector3(0,.655,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.25,.25,.25),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarFace=e.Core(e.avatarFaceData),e.avatarHoverData={data:"avatarHoverData",id:"avatarHover",sources:!1,text:{value:"Avatar",width:3,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:2,height:2},material:{shader:"standard",color:"#c1664b",opacity:.5,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,3,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarHover=e.Core(e.avatarHoverData),e.avatarHand1Data={data:"avatarHand1Data",id:"avatarHand1",sources:!1,text:!1,geometry:{primitive:"box",depth:.2,width:.2,height:.2},material:{shader:"standard",color:"#c14b6b",opacity:1,metalness:.2,roughness:.8,emissive:"#c14b6b",emissiveIntensity:.6},position:new THREE.Vector3(-.33,.2,-.22),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarHand1=e.Core(e.avatarHand1Data),e.avatarHand2Data={data:"avatarHand2Data",id:"avatarHand2",sources:!1,text:!1,geometry:{primitive:"box",depth:.2,width:.2,height:.2},material:{shader:"standard",color:"#4b7dc1",opacity:1,metalness:.2,roughness:.8,emissive:"#4b7dc1",emissiveIntensity:.6},position:new THREE.Vector3(.33,.2,-.22),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},e.avatarHand2=e.Core(e.avatarHand2Data),e.avatarData={parent:{core:e.avatarSphere},child0:{parent:{core:e.avatarRig},child0:{parent:{core:e.avatarBody},child0:{core:e.avatarFace},child1:{core:e.avatarHover},child2:{core:e.avatarHand1},child3:{core:e.avatarHand2}}}},e.avatar=e.Layer("avatar",e.avatarData),e.avatar.SpawnLayer("playerBody"),e.beltUIParentData={data:"beltUIParentData",id:"beltUIParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:!1},e.beltUIParent=e.Core(e.beltUIParentData),e.locomotionForwardUIData={data:"locomotionForwardUIData",id:"locomotionForwardUI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.4,radiusBottom:1.5,radiusTop:2,segmentsHeight:6,segmentsRadial:24,thetaStart:0,thetaLength:360},material:{shader:"flat",color:"#5c174b",opacity:.3,side:"double"},position:new THREE.Vector3(0,.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:1,to:.25,dur:1250,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.25,to:1,dur:700,delay:100,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.locomotionForwardUI=e.Core(e.locomotionForwardUIData),e.locomotionReverseUIData={data:"locomotionReverseUIData",id:"locomotionReverseUI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.001,radiusBottom:1.25,radiusTop:1.5,segmentsHeight:1,segmentsRadial:24,thetaStart:0,thetaLength:360},material:{shader:"flat",color:"#46113a",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.75,to:.1,dur:1150,delay:350,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.75,dur:700,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.locomotionReverseUI=e.Core(e.locomotionReverseUIData),e.locomotionBrake1UIData={data:"locomotionBrake1UIData",id:"locomotionBrake1UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:0,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},e.locomotionBrake1UI=e.Core(e.locomotionBrake1UIData),e.locomotionBrake2UIData={data:"locomotionBrake2UIData",id:"locomotionBrake2UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:90,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},e.locomotionBrake2UI=e.Core(e.locomotionBrake2UIData),e.locomotionBrake3UIData={data:"locomotionBrake3UIData",id:"locomotionBrake3UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:180,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},e.locomotionBrake3UI=e.Core(e.locomotionBrake3UIData),e.locomotionBrake4UIData={data:"locomotionBrake4UIData",id:"locomotionBrake4UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:270,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},e.locomotionBrake4UI=e.Core(e.locomotionBrake4UIData),e.locomotionUIAllData={parent:{core:e.beltUIParent},child0:{core:e.locomotionForwardUI},child1:{core:e.locomotionReverseUI},child2:{core:e.locomotionBrake1UI},child3:{core:e.locomotionBrake2UI},child4:{core:e.locomotionBrake3UI},child5:{core:e.locomotionBrake4UI}},e.locomotionUILayer=e.Layer("locomotionUILayer",e.locomotionUIAllData),e.ghostParentData={data:"ghostParentData",id:"ghostParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"look-at-xyz":{buffer:.05,drag:.05,max:360,match:"camera",x:!0,y:!0,z:!0}}},e.ghostParent=e.Core(e.ghostParentData),e.ghostAllData={data:"ghostAllData",id:"ghostAll",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.ghostAll=e.Core(e.ghostAllData),e.eye1SocketData={data:"eye1SocketData",id:"eye1Socket",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.175,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#fcfafd",emissive:"#fcfafd",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.15,.1,.4),rotation:new THREE.Vector3(90,0,0),scale:new THREE.Vector3(.75,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},e.eye1Socket=e.Core(e.eye1SocketData),e.eye2SocketData=e.coreDataFromTemplate(e.eye1SocketData,{id:"eye2Socket",position:new THREE.Vector3(.15,.1,.4)},!0),e.eye2Socket=e.Core(e.eye2SocketData),e.eye1PupilData={data:"eye1PupilData",id:"eye1Pupil",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.1,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#1500fa",emissive:"#1500fa",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.01,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.25,1,1),animations:{lookdown:{property:"position",to:new THREE.Vector3(0,.01,.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookDown"},lookup:{property:"position",to:new THREE.Vector3(0,.01,-.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookUp"},lookright:{property:"position",to:new THREE.Vector3(.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookRight"},lookleft:{property:"position",to:new THREE.Vector3(-.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookLeft"},lookloop0:{property:"position",to:new THREE.Vector3(0,.01,0),dur:0,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!0,enabled:!0},lookloop1:{property:"position",to:new THREE.Vector3(0,.01,.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop0, animationcomplete__lookloop8"},lookloop2:{property:"position",to:new THREE.Vector3(0,.01,-.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop1"},lookloop3:{property:"position",to:new THREE.Vector3(-.05,.01,.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop2"},lookloop4:{property:"position",to:new THREE.Vector3(.05,.01,.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop3"},lookloop5:{property:"position",to:new THREE.Vector3(-.05,.01,-.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop4"},lookloop6:{property:"position",to:new THREE.Vector3(.05,.01,-.07),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop5"},lookloop7:{property:"position",to:new THREE.Vector3(0,.01,0),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop6"},lookloop8:{property:"position",to:new THREE.Vector3(0,.01,0),dur:1500,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"animationcomplete__lookloop7"},powerup1:{property:"material.color",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},e.eye1Pupil=e.Core(e.eye1PupilData),e.eye2PupilData=e.coreDataFromTemplate(e.eye1PupilData,{id:"eye2Pupil"},!0),e.eye2Pupil=e.Core(e.eye2PupilData),e.mouthData={data:"mouthData",id:"mouth",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup:{property:"visible",to:!0,dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown:{property:"visible",to:!1,dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:{visible:!1,line:{start:new THREE.Vector3(-.3,-.2,.41),end:new THREE.Vector3(-.2,-.15,.41),color:"white"},line__2:{start:new THREE.Vector3(-.2,-.15,.41),end:new THREE.Vector3(-.1,-.2,.41),color:"white"},line__3:{start:new THREE.Vector3(-.1,-.2,.41),end:new THREE.Vector3(0,-.15,.41),color:"white"},line__4:{start:new THREE.Vector3(0,-.15,.41),end:new THREE.Vector3(.1,-.2,.41),color:"white"},line__5:{start:new THREE.Vector3(.1,-.2,.41),end:new THREE.Vector3(.2,-.15,.41),color:"white"},line__6:{start:new THREE.Vector3(.2,-.15,.41),end:new THREE.Vector3(.3,-.2,.41),color:"white"}}},e.mouth=e.Core(e.mouthData),e.spinData={data:"spinData",id:"spin",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,-.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{rotate:{property:"object3D.rotation.y",from:0,to:360,dur:1500,delay:0,loop:!0,dir:"normal",easing:"linear",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},e.spin=e.Core(e.spinData),e.headData={data:"headData",id:"head",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.4,phiStart:0,phiLength:180,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:180},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.15,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.head=e.Core(e.headData),e.bodyData={data:"bodyData",id:"body",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.4,height:.3,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.body=e.Core(e.bodyData),e.legData={data:"legData",id:"leg",sources:!1,text:!1,geometry:{primitive:"cone",radiusBottom:0,radiusTop:.15,height:.2,openEnded:!1,segmentsHeight:4,segmentsRadial:8,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.25,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},e.leg1Data=e.coreDataFromTemplate(e.legData,{id:"leg1"},!0),e.leg1=e.Core(e.leg1Data),e.leg2Data=e.coreDataFromTemplate(e.legData,{id:"leg2",position:new THREE.Vector3(.25,-.25,0)},!0),e.leg2=e.Core(e.leg2Data),e.leg3Data=e.coreDataFromTemplate(e.legData,{id:"leg3",position:new THREE.Vector3(0,-.25,-.25)},!0),e.leg3=e.Core(e.leg3Data),e.leg4Data=e.coreDataFromTemplate(e.legData,{id:"leg4",position:new THREE.Vector3(0,-.25,.25)},!0),e.leg4=e.Core(e.leg4Data),e.ghostLayerData={parent:{core:e.ghostParent},child0:{parent:{core:e.ghostAll},child0:{parent:{core:e.eye1Socket},child0:{core:e.eye1Pupil}},child1:{parent:{core:e.eye2Socket},child0:{core:e.eye2Pupil}},child2:{core:e.mouth},child3:{parent:{core:e.spin},child0:{core:e.head},child1:{core:e.body},child2:{core:e.leg1},child3:{core:e.leg2},child4:{core:e.leg3},child5:{core:e.leg4}}}},e.ghost=e.Layer("ghost",e.ghostLayerData),e.compCubeParentData={data:"compCubeParentData",id:"compCubeParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},e.compCubeParent=e.Core(e.compCubeParentData),e.compCubeData={data:"compCubeData",id:"compCube",sources:!1,text:{value:"Menu",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.135,side:"double"},geometry:{primitive:"box",depth:.25,width:.25,height:.25},material:{shader:"flat",color:"#C14B76",opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.compCube=e.Core(e.compCubeData),e.cubeLayerData={parent:{core:e.compCubeParent},child0:{core:e.compCube}},e.compCubeLayer=e.Layer("compCubeLayer",e.cubeLayerData),e.compSphereParentData={data:"compSphereParentData",id:"compSphereParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},e.compSphereParent=e.Core(e.compSphereParentData),e.compSphereData={data:"compSphereData",id:"compSphere",sources:!1,text:{value:"Menu",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.26,side:"double"},geometry:{primitive:"sphere",radius:.25},material:{shader:"flat",color:"#C14B76",opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.compSphere=e.Core(e.compSphereData),e.compSphereLayerData={parent:{core:e.compSphereParent},child0:{core:e.compSphere}},e.compSphereLayer=e.Layer("compSphereLayer",e.compSphereLayerData),e.compBubbleParentData={data:"compBubbleParentData",id:"compBubbleParent",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:.75,zOffset:.025,side:"front",wrapCount:35,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.8,height:.15},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.42,.42),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.compBubbleParent=e.Core(e.compBubbleParentData),e.compBubbleCloseData={data:"compBubbleCloseData",id:"compBubbleClose",sources:!1,text:{value:"X",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.025,side:"front",wrapCount:2,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.08,height:.08},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.5,.06,-.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"},hoveron:{property:"text.color",to:"#000000",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"text.color",to:"#ffffff",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click:{property:"scale",from:"1 1 1",to:"1.25 1.25 1.25",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.compBubbleClose=e.Core(e.compBubbleCloseData),e.compBubbleResetData={data:"compBubbleResetData",id:"compBubbleReset",sources:!1,text:{value:"@",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.025,side:"front",wrapCount:2,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.08,height:.08},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.5,-.04,-.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"},hoveron:{property:"text.color",to:"#000000",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"text.color",to:"#ffffff",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click:{property:"scale",from:"1 1 1",to:"1.25 1.25 1.25",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.compBubbleReset=e.Core(e.compBubbleResetData),e.compBubbleLayerData={parent:{core:e.compBubbleParent},child0:{core:e.compBubbleClose},child1:{core:e.compBubbleReset}},e.compBubbleLayer=e.Layer("compBubbleLayer",e.compBubbleLayerData),e.compPage0Data={info:{id:"compPage0",description:"Companion page 0.",tags:"comp",nextPage:null,prevPage:null,timeline:"linear"},timeline0:{self:{Speak:{speech:"Hey there!"}}},timeline1:{self:{Speak:{speech:"Having fun?"}}},timeline2:{self:{Speak:{speech:"Lets look around."}}},timeline3:{self:{Speak:{speech:"Whats over there?"}}},timeline4:{self:{Speak:{speech:"Now... where was that cookie I was eating?"}}},timeline5:{self:{Speak:{speech:"Found it!"}}},timeline6:{self:{NewPage:!0}}},e.compPage1Data={info:{id:"compPage1",description:"Companion page 1.",tags:"comp",nextPage:null,prevPage:null,timeline:"linear"},timeline0:{self:{Speak:{speech:"2 Hey there!"}}},timeline1:{self:{Speak:{speech:"2 Having fun?"}}},timeline2:{self:{Speak:{speech:"2 Lets look around."}}},timeline3:{self:{Speak:{speech:"2 Whats over there?"}}},timeline4:{self:{Speak:{speech:"2 Now... where was that cookie I was eating?"}}},timeline5:{self:{Speak:{speech:"2 Found it!"}}},timeline6:{self:{ResetBook:!0}}},e.compIdleData={info:{id:"compIdleData",description:"Companion idle page.",tags:"comp",nextPage:null,prevPage:null,timeline:"random"},timeline0:{self:{Speak:{speech:"Yo ho ho ho and a bottle of rum for me..."}}},timeline1:{self:{Speak:{speech:"Ooh a piece of candy!"}}},timeline2:{self:{Speak:{speech:"Nom nom nom nom..."}}},timeline3:{self:{Speak:{speech:"Yada yada yada..."}}},timeline4:{self:{Speak:{speech:"Whistle whistle whistle..."}}},timeline5:{self:{Speak:{speech:"16 16 16..."}}},timeline6:{self:{Speak:{speech:"Twinkle twinkle little star..."}}},timeline7:{self:{IdleReset:!0}}},e.compBookData={info:{id:"compBook",name:"Comp",description:"Companion book.",tags:"comp",timeline:"other",idleDelay:5e3,idleInterval:7e3},pages:{page0:e.compPage0Data,page1:e.compPage1Data},idle:{page0:e.compIdleData}},e.comp=e.Companion("comp",e.ghost),e.configurationViewData={data:"configurationViewData",id:"configurationView",sources:!1,text:{value:"Controls",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:1},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,1.5,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{clickrun:{cursorObj:"comp",method:"ToggleControlView"}}},e.configurationView=e.Core(e.configurationViewData),e.sceneTextData={data:"Scene display text.",id:"sceneText",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:.8,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.4),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.textBubbleSideData={data:"text bubble to the side of user/character",id:"textBubbleSide",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:.45,zOffset:.025,side:"front",wrapCount:45,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.5,height:.15},material:{shader:"standard",color:"#4bb8c1",opacity:.8,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.375,1.7,-.65),rotation:new THREE.Vector3(5,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.textBubbleSide=e.Core(e.textBubbleSideData),e.textBubbleBottomData={data:"text bubble on bottom",id:"textBubbleBottom",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:.8,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.textBubbleBottom=e.Core(e.textBubbleBottomData),e.textBubbleTopData={data:"text bubble on top",id:"textBubbleTop",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:.8,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,2.05,-1.25),rotation:new THREE.Vector3(15,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},e.textBubbleTop=e.Core(e.textBubbleTopData),e.detailMainData={data:"detailMainData",id:"detailMain",sources:!1,text:{value:"Details...",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.065,side:"double"},geometry:{primitive:"box",depth:.1,width:1,height:1},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,1.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(0,0,0),animations:{opening:{property:"scale",from:"0.001 0.001 0.001",to:"1 1 1",dur:500,delay:50,loop:"false",dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"open"},close:{property:"scale",from:"1 1 1",to:"0.001 0.001 0.001",dur:500,delay:50,loop:!1,dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"}},mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},e.detailCloseData={data:"detailCloseData",id:"detailClose",sources:!1,text:{value:"X",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.065,side:"double"},geometry:{primitive:"box",depth:.1,width:.25,height:.25},material:{shader:"standard",color:"#c14b4b",opacity:1,metalness:.2,roughness:.8,emissive:"#c14b4b",emissiveIntensity:.6},position:new THREE.Vector3(.5,.5,.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(0,0,0),animations:{opening:{property:"scale",from:"0.001 0.001 0.001",to:"1 1 1",dur:500,delay:50,loop:"false",dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"open"},close:{property:"scale",from:"1 1 1",to:"0.001 0.001 0.001",dur:500,delay:50,loop:!1,dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"}},mixins:!1,classes:["clickable","a-ent"],components:!1},e.teleportParentData={data:"teleportParentData",id:"teleportParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,.025,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1pos:{property:"object3D.position.y",from:.025,to:.75,dur:2e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1rot:{property:"object3D.rotation.x",from:-90,to:720,dur:2e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},posreset:{property:"object3D.position.y",from:.75,to:.025,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},rotreset:{property:"object3D.rotation.x",from:720,to:-90,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},posresetinstant:{property:"object3D.position.y",from:.75,to:.025,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"},rotresetinstant:{property:"object3D.rotation.x",from:720,to:-90,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"}},mixins:!1,classes:["a-ent"],components:!1},e.teleportConfirmData={data:"teleportConfirmData",id:"teleportConfirm",sources:!1,text:{value:"Teleport Here",wrapCount:45,width:5,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",opacity:.75},geometry:{primitive:"circle",radius:.75,segments:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#838282",opacity:.75,metalness:.6,roughness:.4,emissive:"#838282",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable","teleporter","teleport"],components:{teleportation:null}},e.teleportCancelData={data:"teleportCancelData",id:"teleportCancel",sources:!1,text:{value:"Cancel",wrapCount:45,width:5,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",opacity:0},geometry:{primitive:"circle",radius:.75,segments:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#838282",opacity:0,metalness:.6,roughness:.4,emissive:"#838282",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(0,1.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:{click1opac:{property:"material.opacity",from:0,to:.75,dur:1e3,delay:1800,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1textopac:{property:"text.opacity",from:0,to:1,dur:1e3,delay:1800,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1opacreset:{property:"material.opacity",from:.75,to:0,dur:500,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},click1textopacreset:{property:"text.opacity",from:1,to:0,dur:500,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},click1opacresetinstant:{property:"material.opacity",from:.75,to:0,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"},click1textopacresetinstant:{property:"text.opacity",from:1,to:0,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"}},mixins:!1,classes:["a-ent","clickable","teleporter","cancel"],components:{teleportation:null}};let t=[new THREE.Vector3(0,.025,0),new THREE.Vector3(-5,.025,-5),new THREE.Vector3(0,.025,-10),new THREE.Vector3(-5,.025,5),new THREE.Vector3(-10,.025,0),new THREE.Vector3(5,.025,-5),new THREE.Vector3(10,.025,0),new THREE.Vector3(5,.025,5),new THREE.Vector3(0,.025,10)];e.teleport=e.Teleport("teleport",t);let i=[new THREE.Vector3(0,.025,0),new THREE.Vector3(-5,.025,-5),new THREE.Vector3(-5,.025,5),new THREE.Vector3(5,.025,-5),new THREE.Vector3(5,.025,5)];e.teleport0=e.Teleport("teleport0",i),e.teleportPortalData={data:"teleportPortalData",id:"teleportPortal",sources:!1,text:!1,geometry:{primitive:"plane",width:2,height:10},material:{shader:"standard",color:"#beef1a",opacity:.25,metalness:.6,roughness:.4,emissive:"#beef1a",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(10,5,-10),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable"],components:{stare:{id:"playerRig",twist:!0},"raycast-teleportation":null}},e.teleportPortal1Data=e.coreDataFromTemplate(e.teleportPortalData,{id:"teleportPortal1"},!0),e.teleportPortal1=e.Core(e.teleportPortal1Data),e.teleportPortal2Data=e.coreDataFromTemplate(e.teleportPortalData,{id:"teleportPortal2",position:new THREE.Vector3(0,5,3)},!0),e.teleportPortal2=e.Core(e.teleportPortal2Data),e.directionalLightData={data:"directionalLight",id:"directionalLight",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(-1,1,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.1,to:1,dur:e.timeInDay/4,delay:0,loop:"true",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(-1,1,-1),to:new THREE.Vector3(1,1,1),dur:e.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:1,castShadow:!1}}},e.directionalLight=e.Core(e.directionalLightData),e.ambientLightData={data:"ambientLight",id:"ambientLight",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.5,to:.25,dur:e.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daycolor:{property:"light.color",from:"#99154E",to:"#fffb96",dur:e.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"ambient",intensity:1,color:"#716a9a"}}},e.ambientLight=e.Core(e.ambientLightData),e.directionalLight2Data={data:"directionalLight2",id:"directionalLight2",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(1,1,1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{nightlight:{property:"light.intensity",from:.2,to:.1,dur:e.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(-1,1,-1),dur:e.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:.1,castShadow:!1}}},e.directionalLight2=e.Core(e.directionalLight2Data),e.directionalLight3Data={data:"directionalLight3",id:"directionalLight3",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(1,1,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.05,to:.1,dur:e.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(1,1,-1),to:new THREE.Vector3(-1,1,-1),dur:e.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!1,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:.05,castShadow:!1}}},e.directionalLight3=e.Core(e.directionalLight3Data),e.sunOuterData={data:"sunOuter",id:"sunOuter",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(-5,45,0),scale:new THREE.Vector3(1,1,1),animations:{daynight:{property:"object3D.rotation.x",from:-5,to:355,dur:e.timeInDay,delay:0,loop:"1",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:!1},e.sunData={data:"sun",id:"sun",sources:!1,text:!1,geometry:{primitive:"sphere",radius:325},material:{shader:"flat",color:"#F0A500",opacity:1,side:"front",fog:!1},position:new THREE.Vector3(0,0,-3400),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.sunOuter=e.Core(e.sunOuterData),e.sun=e.Core(e.sunData),e.sunLayerData={parent:{core:e.sunOuter},child0:{core:e.sun}},e.sunLayer=e.Layer("sunLayer",e.sunLayerData),e.moonOuterData={data:"moonOuter",id:"moonOuter",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(175,45,0),scale:new THREE.Vector3(1,1,1),animations:{daynight:{property:"object3D.rotation.x",from:175,to:535,dur:e.timeInDay,delay:0,loop:"1",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:!1},e.moonData={data:"moonData",id:"moon",sources:!1,text:!1,geometry:{primitive:"sphere",radius:325},material:{shader:"flat",color:"#5c2196",opacity:1,side:"front",fog:!1},position:new THREE.Vector3(0,0,-3400),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.moonOuter=e.Core(e.moonOuterData),e.moon=e.Core(e.moonData),e.moonLayerData={parent:{core:e.moonOuter},child0:{core:e.moon}},e.moonLayer=e.Layer("moonLayer",e.moonLayerData),e.skyGradData={data:"sky gradient",id:"skyGrad",entity:"a-sky",sources:!1,text:!1,geometry:!1,material:{shader:"threeColorGradientShader",topColor:"#613381",middleColor:"#99154E",bottomColor:"#b967ff"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(8.046,8.046,8.046),animations:{sunrisetop:{property:"material.topColor",from:"#613381",to:"#01cdfe",dur:e.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunrisemid:{property:"material.middleColor",from:"#99154E",to:"#fffb96",dur:e.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunsettop:{property:"material.topColor",from:"#01cdfe",to:"#613381",dur:e.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunset",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunsetmid:{property:"material.middleColor",from:"#fffb96",to:"#99154E",dur:e.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunset",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{"hide-on-enter-ar":null}},e.skyGrad=e.Core(e.skyGradData),e.skyBox0Data={data:"skyBox0Data",id:"skyBox0",sources:!1,lights:[e.directionalLight,e.directionalLight2,e.directionalLight3,e.ambientLight],sky:[e.skyGrad],space:[e.sunLayer,e.moonLayer]},e.skyBox0=e.SkyBox(e.skyBox0Data),e.mapEdgeBasicData={data:"mapEdgeBasicData",id:"mapEdgeBasic",sources:!1,text:!1,geometry:{primitive:"box",depth:.25,width:.25,height:.5},material:{shader:"standard",color:"#6c4646",opacity:1},position:new THREE.Vector3(0,1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.mapEdgeBasic=e.Core(e.mapEdgeBasicData),e.buildLibrary=()=>{e.ghostParent=e.Core(e.ghostParentData),e.ghostAll=e.Core(e.ghostAllData),e.eye1Socket=e.Core(e.eye1SocketData),e.eye2Socket=e.Core(e.eye2SocketData),e.eye1Pupil=e.Core(e.eye1PupilData),e.eye2Pupil=e.Core(e.eye2PupilData),e.mouth=e.Core(e.mouthData),e.spin=e.Core(e.spinData),e.head=e.Core(e.headData),e.body=e.Core(e.bodyData),e.leg1=e.Core(e.leg1Data),e.leg2=e.Core(e.leg2Data),e.leg3=e.Core(e.leg3Data),e.leg4=e.Core(e.leg4Data),e.ghost=e.Layer("ghost",e.ghostLayerData),e.compCubeParent=e.Core(e.compCubeParentData),e.compCube=e.Core(e.compCubeData),e.compCubeLayer=e.Layer("compCubeLayer",e.cubeLayerData),e.compSphereParent=e.Core(e.compSphereParentData),e.compSphere=e.Core(e.compSphereData),e.compSphereLayer=e.Layer("compSphereLayer",e.compSphereLayerData),e.compBubbleParent=e.Core(e.compBubbleParentData),e.compBubbleClose=e.Core(e.compBubbleCloseData),e.compBubbleReset=e.Core(e.compBubbleResetData),e.compBubbleLayer=e.Layer("compBubbleLayer",e.compBubbleLayerData),e.comp=e.Companion("comp",e.ghost),e.configurationView=e.Core(e.configurationViewData),e.textBubbleSide=e.Core(e.textBubbleSideData),e.textBubbleBottom=e.Core(e.textBubbleBottomData),e.textBubbleTop=e.Core(e.textBubbleTopData),e.teleport=e.Teleport("teleport",t),e.teleport0=e.Teleport("teleport0",i),e.teleportPortal1=e.Core(e.teleportPortal1Data),e.teleportPortal2=e.Core(e.teleportPortal2Data),e.directionalLight=e.Core(e.directionalLightData),e.ambientLight=e.Core(e.ambientLightData),e.directionalLight2=e.Core(e.directionalLight2Data),e.directionalLight3=e.Core(e.directionalLight3Data),e.sunOuter=e.Core(e.sunOuterData),e.sun=e.Core(e.sunData),e.sunLayer=e.Layer("sunLayer",e.sunLayerData),e.moonOuter=e.Core(e.moonOuterData),e.moon=e.Core(e.moonData),e.moonLayer=e.Layer("moonLayer",e.moonLayerData),e.skyGrad=e.Core(e.skyGradData),e.skyBox0=e.SkyBox(e.skyBox0Data),e.mapEdgeBasic=e.Core(e.mapEdgeBasicData)},e.toBeRebuilt("buildLibrary")}});var u=i(379),m=i.n(u),y=i(795),g=i.n(y),v=i(569),b=i.n(v),f=i(565),E=i.n(f),w=i(216),x=i.n(w),T=i(655),R=i.n(T),k=i(537),D={};D.styleTagTransform=R(),D.setAttributes=E(),D.insert=b().bind(null,"head"),D.domAPI=g(),D.insertStyleElement=x(),m()(k.Z,D),k.Z&&k.Z.locals&&k.Z.locals;var C=i(524),M={};M.styleTagTransform=R(),M.setAttributes=E(),M.insert=b().bind(null,"head"),M.domAPI=g(),M.insertStyleElement=x(),m()(C.Z,M),C.Z&&C.Z.locals&&C.Z.locals})()})();