(()=>{var t={72:t=>{function e(t){return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}e.keys=()=>[],e.resolve=e,e.id=72,t.exports=e}},e={};function i(o){var a=e[o];if(void 0!==a)return a.exports;var n=e[o]={exports:{}};return t[o](n,n.exports,i),n.exports}i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=(t,e)=>{let o=JSON.parse(JSON.stringify(e));o.inScene=!1,o.el={},o.dom=!1,o.domTimeout,o.events={},o.parent=!1,o.gridSpawned=!1,o.gridPath=[],o.pathSpeed=1e3,o.pathWait=1e3,o.pathRoute="any",o.pathLoop="infinite",o.pathType="jump",o.currentPath=-1,o.gridPathInterval,o.gridPathTimeout;let a=!1,n=!1,s=!1,r=!1;async function l(t){const e=await fetch(t);return await i(72)(e.url),!0}function c(){t.loadingObjects.set(o.id,!0),t.loadingScene||(t.loadingScene=!0)}function h(){t.loadingObjects.delete(o.id)}const p=()=>{if(o.el={},o.sources){let a=Object.keys(o.sources),r=Object.values(o.sources);for(let c in a)if(t.jsLoaded.hasOwnProperty(a[c]))!1===t.jsLoaded[a[c]]&&(console.log(o.id),console.log("JS is not yet loaded"),t.spawnedWaitingForJS[a[c]].push({id:o.id,properties:o.components[a[c]]}));else{function h(){console.log(a[c]),console.log("Done"),t.jsLoaded[a[c]]=!0,g({property:a[c],value:o.components[a[c]]}),console.log(t.spawnedWaitingForJS);for(let e in t.spawnedWaitingForJS[a[c]]){let i=t.spawnedWaitingForJS[a[c]][e].id,o=t.spawnedWaitingForJS[a[c]][e].properties;console.log(i),console.log(o),document.getElementById(i).setAttribute(a[c],o)}delete t.spawnedWaitingForJS[a[c]],console.log(t.spawnedWaitingForJS)}t.spawnedWaitingForJS[a[c]]=[],console.log(a[c]),console.log(r[c]),t.jsLoaded[a[c]]=!1,l(r[c]).then(h)}}if("preAdded"===o.entity?document.getElementById(o.id)?o.el=document.getElementById(o.id):o.el=document.createElement("a-entity"):o.entity?o.el=document.createElement(o.entity):o.el=document.createElement("a-entity"),t.audioEnabled){let p={};if(o.sound&&(p=JSON.parse(JSON.stringify(o.sound)),p.volume||(p.volume=1),p.volume*=t.volume,o.el.setAttribute("sound",p)),o.sounds)for(let d in o.sounds)p=JSON.parse(JSON.stringify(o.sounds[d])),p.volume||(p.volume=1),p.volume*=t.volume,o.el.setAttribute("sound__"+d,p)}o.text&&o.el.setAttribute("text",o.text),o.el.setAttribute("id",o.id),o.geometry&&o.el.setAttribute("geometry",o.geometry),o.material&&(o.material.src&&(s=!0),o.el.setAttribute("material",o.material)),o.position&&o.el.setAttribute("position",o.position),o.rotation&&o.el.setAttribute("rotation",o.rotation),o.scale&&o.el.setAttribute("scale",o.scale),o.mixins&&o.el.setAttribute("mixins",o.mixins);for(let u in o.classes)o.el.classList.add(o.classes[u]);let e=Object.keys(o.animations),i=Object.values(o.animations);for(let m in e)0===m||o.el.setAttribute("animation__"+e[m],i[m]);if((o.components["gltf-model"]||o.components["obj-model"])&&(n=!0),o.components){let y=Object.keys(o.components),v=Object.values(o.components);for(let f in y)if(0===f);else if(t.jsAll.hasOwnProperty(y[f]))if(t.jsLoaded.hasOwnProperty(y[f]))!1===t.jsLoaded[y[f]]?t.spawnedWaitingForJS[y[f]].push({id:o.id,properties:o.components[y[f]]}):o.el.setAttribute(y[f],v[f]);else{function b(){t.jsLoaded[y[f]]=!0,g({property:y[f],value:o.components[y[f]]});for(let e in t.spawnedWaitingForJS[y[f]]){let i=t.spawnedWaitingForJS[y[f]][e].id,o=t.spawnedWaitingForJS[y[f]][e].properties;document.getElementById(i).setAttribute(y[f],o)}delete t.spawnedWaitingForJS[y[f]]}t.spawnedWaitingForJS[y[f]]=[],t.jsLoaded[y[f]]=!1,l(t.jsAll[y[f]]).then(b)}else o.el.setAttribute(y[f],v[f])}return o.el},d=e=>{o.parent=e||!1;let i=!1;o.inScene||(p(),(n||s)&&c(),"preAdded"===o.entity&&document.getElementById(o.id)&&(i=!0),i||(o.parent?(o.parent.core?o.parent.core.inScene?o.parent=o.parent.GetEl():o.parent=!1:o.parent.layer?e.layer.inScene?o.parent=o.parent.GetParentEl():o.parent=!1:o.parent.id||"string"==typeof o.parent&&(document.getElementById(o.parent)?o.parent=document.getElementById(o.parent):o.parent=!1),o.parent?o.parent.appendChild(o.el):(console.log(id),console.log(o.parent),console.log(document.getElementById(o.parent)),console.log("Parent is not in scene!"))):t.sceneEl.appendChild(o.el)),n&&o.el.addEventListener("model-loaded",h),s&&o.el.addEventListener("loaded",h),o.domTimeout=setTimeout((()=>{o.dom=document.getElementById(o.id),clearTimeout(o.domTimeout)}),100),o.inScene=!0)},u=()=>{if(o.inScene){clearTimeout(o.domTimeout),clearTimeout(o.gridPathTimeout),clearInterval(o.gridPathInterval),n&&o.el.removeEventListener("model-loaded",h),(s||r)&&o.el.removeEventListener("loaded",h);let e=Object.keys(o.components);for(let t in e)0===t||b().removeAttribute(e[t]);o.gridSpawned&&(o.grid.collide?t.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,!1):o.grid.trigger&&t.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,!1),o.gridSpawned=!1),o.parent?o.parent.removeChild(o.el):t.sceneEl.removeChild(o.el),t.ExistsInTracker(o.id)&&t.RemoveFromTracker(o.id),o.dom=!1,o.inScene=!1}};function m(t){let e=new THREE.Vector3(0,0,0);if(t.start.x===t.end.x&&t.start.z===t.end.z)e.x=t.start.x,e.z=t.start.z;else{let i=-1*(t.start.x-t.end.x),o=-1*(t.start.z-t.end.z);i/=2,o/=2,e.x=t.start.x+i,e.z=t.start.z+o}return e.y=t.start.y,e}const y=(e,i)=>{let a={start:{},end:{}};a.start.x=o.grid.start.x,a.start.y=o.grid.start.y,a.start.z=o.grid.start.z,a.end.x=o.grid.end.x,a.end.y=o.grid.end.y,a.end.z=o.grid.end.z,e.x&&(a.start.x+=e.x,a.end.x+=e.x),e.y&&(a.start.y+=e.y,a.end.y+=e.y),e.z&&(a.start.z+=e.z,a.end.z+=e.z);let n=m(a);return o.grid.collide?!!t.map.CheckMapAreaSansArea(o.grid,a,o.grid.height)&&(t.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,!1),t.map.UpdateMapArea(o.id,a.start,a.end,!0),"anim"===o.pathType?e.x?w("animstartx"+n.x):e.y?w("animstarty"+n.y):e.z&&w("animstartz"+n.z):"jump"===o.pathType&&g({property:"position",value:n}),o.grid.start.x=a.start.x,o.grid.start.y=a.start.y,o.grid.start.z=a.start.z,o.grid.end.x=a.end.x,o.grid.end.y=a.end.y,o.grid.end.z=a.end.z,!0):o.grid.trigger?(t.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,!1),t.map.UpdateMapAreaTrigger(o.id,a.start,a.end,!0),"anim"===o.pathType?e.x?w("animstartx"+n.x):e.y?w("animstarty"+n.y):e.z&&w("animstartz"+n.z):"jump"===o.pathType&&(e.pos.y,o.grid.yOffset,g({property:"position",value:n})),o.grid.start.x=a.start.x,o.grid.start.y=a.start.y,o.grid.start.z=a.start.z,o.grid.end.x=a.end.x,o.grid.end.y=a.end.y,o.grid.end.z=a.end.z,!0):void 0},g=e=>{if(Array.isArray(e))for(let i in e)e[i].value&&e[i].value.src&&t.loadingScene&&(r||(r=!0,c(),o.el.addEventListener("loaded",h))),b().setAttribute(e[i].property,e[i].value);else e.value&&e.value.src&&t.loadingScene&&(r||(r=!0,c(),o.el.addEventListener("loaded",h))),b().setAttribute(e.property,e.value)};function v(t){let e="animation__"+t.name||0,i=t.property,o=t.from||!1,a=t.to||!1,n=t.dur||!1,s=t.delay||!1,r=t.loop||!1,l=t.dir||!1,c=t.easing||!1,h=t.elasticity||!1,p=t.autoplay||!1,d=t.enabled||!1,u=t.startEvents||!1,m=t.pauseEvents||!1,y=t.resumeEvents||!1,g={property:"object3D.rotation.y",to:360,dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};return i&&(g.property=i),o&&(g.from=o),a&&(g.to=a),n&&(g.dur=n),s&&(g.delay=s),r&&(g.loop=r),l&&(g.dir=l),c&&(g.easing=c),h&&(g.elasticity=h),p&&(g.autoplay=p),d&&(g.enabled=d),u&&(g.startEvents=u),m&&(g.pauseEvents=m),y&&(g.resumeEvents=y),{name:e,anim:g}}const f=t=>{if(Array.isArray(t))for(let e in t){let i=v(t[e]);b().setAttribute(i.name,i.anim)}else{let e=v(t);b().setAttribute(e.name,e.anim)}},b=t=>(t?o.dom=document.getElementById(o.id):o.dom||(o.dom=document.getElementById(o.id)),o.dom),w=t=>{if(Array.isArray(t))for(let e in t)b().emit(t[e],{bubbles:!1});else b().emit(t,{bubbles:!1})};function E(){o.detailMain.core.el.emit("close",{}),o.detailClose.core.el.emit("close",{});let t=setTimeout((function(){o.detailAll.DespawnLayer(),o.isOpen=!1,clearTimeout(t)}),550)}function x(){function t(){o.detailClose.core.el.removeEventListener("click",t),o.isOpen=E()}o.isOpen?(o.isOpen=E(),o.detailClose.core.el.removeEventListener("click",t)):(o.detailAll.SpawnLayer(),o.isOpen=function(){let t=setTimeout((function(){o.detailMain.core.el.emit("open",{}),o.detailClose.core.el.emit("open",{}),o.isOpen=!0,clearTimeout(t)}),25)}(),o.detailClose.core.el.addEventListener("click",t))}return{core:o,Generate:p,SpawnCore:d,DespawnCore:u,ToggleSpawn:(e,i)=>{let a=e||!1;a&&(o.parent=a),o.inScene?u():(d(o.parent),i&&t.spawnTracker(o.id,i))},SpawnCoreOnGrid:e=>{if(o.inScene);else{e&&(o.grid=e),o.grid.start.y||(o.grid.start.y=0),o.grid.end.y||(o.grid.end.y=0),o.grid.yOffset||(o.grid.yOffset=0),o.grid.height=Math.abs(o.grid.start.y)+Math.abs(o.grid.end.y)+1;let i=t.player.GetPlayerInfo().grid;if(o.grid.start.x<=i.x&&o.grid.end.x>=i.x&&o.grid.start.y<=i.y&&o.grid.end.y>=i.y&&o.grid.start.z<=i.z&&o.grid.end.z>=i.z)t.map.WaitToSpawn({name:o.id,func:"SpawnCoreOnGrid"});else{let e=m(o.grid);o.position.x=e.x,o.position.y=o.grid.yOffset+e.y,o.position.z=e.z,d(),o.grid.collide?t.map.UpdateMapArea(o.id,o.grid.start,o.grid.end,o.grid.collide):o.grid.trigger&&t.map.UpdateMapAreaTrigger(o.id,o.grid.start,o.grid.end,o.grid.trigger),o.gridSpawned=!0}}},ToggleCoreGridSpawn:t=>{o.inScene?DespawnFromGrid():SpawnOnGrid(t)},RemoveComponent:t=>{if(Array.isArray(t))for(let e in t)b().removeAttribute(t[e]);else b().removeAttribute(t)},GridMove:y,GridPath:t=>{o.pathSpeed=t.speed||1e3,o.pathWait=t.wait||1e3,o.pathPatience=t.patience||3,o.pathRoute=t.route||"any",o.pathLoop=t.loop||"infinite",o.pathType=t.type||"jump";let e=m(o.grid);o.position.x=e.x,e.y&&(o.position.y=e.y),o.position.z=e.z;let i,a,n=.5;for(let e in t.path){let i=1;for(let a in t.path[e]){"y"===a?(n=t.path[e][a]>0?1:-1,i=Math.abs(t.path[e][a])):(n=t.path[e][a]>0?.5:-.5,i=Math.abs(t.path[e][a]/.5));for(let t=0;t<i;t++)o.gridPath.push({[a]:n})}}let s=o.position.x,r=o.position.y,l=o.position.z;if("anim"===o.pathType)for(let t in o.gridPath){let e={name:"animmove",property:"object3D.position.x",to:0,dur:o.pathSpeed,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"moveXStart",pauseEvents:"moveXStop"};i=Object.keys(o.gridPath[t])[0],a=o.gridPath[t][i],e.property="object3D.position."+i,"x"===i?(e.to=s+=a,e.name="animmove"+i+s,e.startEvents="animstart"+i+s,e.pauseEvents="animstop"+i+s):"y"===i?(e.to=(r+=a)+o.grid.yOffset,e.name="animmove"+i+r,e.startEvents="animstart"+i+r,e.pauseEvents="animstop"+i+r):"z"===i&&(e.to=l+=a,e.name="animmove"+i+l,e.startEvents="animstart"+i+l,e.pauseEvents="animstop"+i+l),o.inScene?f(e):(0===Object.keys(o.animations).length&&(o.animations={}),delete e.name,o.animations["move"+t]=e)}},WalkPath:()=>{let t=!0,e=!1,i=!0,a=!1,n=!0,s=!1,r=0,l=!1,c=0;function h(){l=!l}function p(){o.currentPath=0}function d(){o.currentPath=o.gridPath.length-1}"any"===o.pathRoute&&100*Math.random()>50&&(l=!0),o.gridPathInterval=setInterval((()=>{t&&i&&n&&(("circuit"===o.pathRoute||"alternate"===o.pathRoute||"any"===o.pathRoute)&&(l?(o.currentPath--,o.currentPath<0&&("infinite"===o.pathLoop||(r>=o.pathLoop?clearInterval(o.gridPathInterval):r++),"circuit"===o.pathRoute?l&&(p(),h()):"alternate"===o.pathRoute?(p(),h()):"any"===o.pathRoute&&(100*Math.random()>50?(p(),h()):d()))):(o.currentPath++,o.currentPath>=o.gridPath.length&&("infinite"===o.pathLoop||(r>=o.pathLoop?clearInterval(o.gridPathInterval):r++),"circuit"===o.pathRoute?p():"alternate"===o.pathRoute?(d(),h()):"any"===o.pathRoute&&(100*Math.random()>50?p():(d(),h()))))),t=!1,i=!1,n=!1,e=!!o.gridPath[o.currentPath].x,a=!!o.gridPath[o.currentPath].y,s=!!o.gridPath[o.currentPath].z),e?(t=y(l?{x:-1*o.gridPath[o.currentPath].x}:{x:o.gridPath[o.currentPath].x}),t?(e=!1,c=0,a||(i=!0),s||(n=!0)):(c++,c>=o.pathPatience&&(t=!0,i=!0,n=!0,h()))):a?(i=y(l?{y:-1*o.gridPath[o.currentPath].y}:{y:o.gridPath[o.currentPath].y}),i?(a=!1,c=0,e||(t=!0),s||(n=!0)):(c++,c>=o.pathPatience&&(t=!0,i=!0,n=!0,h()))):s&&(n=y(l?{z:-1*o.gridPath[o.currentPath].z}:{z:o.gridPath[o.currentPath].z}),n?(s=!1,c=0,e||(t=!0),a||(i=!0)):(c++,c>=o.pathPatience&&(t=!0,i=!0,n=!0,h())))}),o.pathSpeed+o.pathWait)},ChangeSelf:g,ChangeCore:t=>{Array.isArray(t)?o.el[t[each].property]=t[each].value:o.el[t.property]=t.value,o.inScene&&g(t)},PhysPos:t=>{"object"==typeof o.el.getAttribute("static-body")||"object"==typeof o.el.getAttribute("dynamic-body")?o.inScene&&o.el.body.position.copy(t):console.log("No physics body attached!")},UpdatePhys:t=>{"object"==typeof o.el.getAttribute("static-body")||"object"==typeof o.el.getAttribute("dynamic-body")?o.inScene&&console.log(t):console.log("No physics body attached!")},Animate:f,GetEl:b,EmitEvent:w,SetFlag:e=>{if(Array.isArray(e))for(let i in e)o[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:o.id,type:"core",sub:!1,name:e[i].flag,data:e[i].value});else o[e.flag]=e.value,t.saveToProfile({auxlObject:o.id,type:"core",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(o(t[i]));return e}return o[t]},EnableDetail:e=>{var i,n,s,r,l,c;a||(i=e.text,n=e.position,s=e.textColor,r=e.windowColor,l=e.windowWidth,c=e.windowHeight,o.isOpen=!1,o.detailMain=t.Core(t.detailMainData),o.detailClose=t.Core(t.detailCloseData),n?(o.detailMain.core.position.x=n.x,o.detailMain.core.position.y=n.y,o.detailMain.core.position.z=n.z):(o.detailMain.core.position.x=o.position.x+.1,o.detailMain.core.position.y=o.position.y+.75,o.detailMain.core.position.z=o.position.z+.25),r&&(o.detailMain.core.material.color=r),i?o.detailMain.core.text.value=i:o.detail&&(o.detailMain.core.text.value=o.detail),s&&(o.detailMain.core.text.color=s),l&&(o.detailMain.core.geometry.width=l,o.detailClose.core.position.x=c/2),c&&(o.detailMain.core.geometry.height=c,o.detailClose.core.position.y=c/2),o.detailLayer={parent:{core:o.detailMain},child0:{core:o.detailClose}},o.detailAll=t.Layer("detailAll",o.detailLayer),a=!0),b().addEventListener("click",x)},DisableDetail:()=>{b().removeEventListener("click",x)}}},e=(t,e,i)=>{let o,a,n,s;i.id=e,i.vrUI=!1,i.transition={},i.transition.id="000000",i.transition.scene="fade",i.transition.teleport="fade",i.teleporting=!1,i.move=!1,i.moveType={pov:"1st",axis:"posXYZ",style:"free"},i.stand=!0,i.standing=!0,i.animating=!1,i.snapRotating=!1;let r={name:"anim45",property:"object3D.rotation.y",from:"0",to:"45",dur:250,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0},l={name:"anim90",property:"object3D.rotation.y",from:"0",to:"90",dur:250,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0};i.beltDisplay=!0,i.beltDefaultText="Hello World!",i.beltText="Hello World!",i.flashlight=!1,i.infoText="Player :\n",i.gridPos=new THREE.Vector3(0,0,0),i.gridDirection="still",i.equipped=!1,i.equippedObject="none",i.menuToggle=!0,i.SpawnLayer(),i.gridPos.copy(t.playerRig.GetEl().getAttribute("position"));const c=e=>{e&&(i.beltText=e),i.beltDisplay&&t.playerBeltText.ChangeSelf({property:"text",value:{value:i.beltText}})},h=t=>{let e=t||1e3;p();let i=setTimeout((function(){d(),clearTimeout(i)}),e)},p=()=>{"Desktop"===t.controls?t.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}}):"VR"===t.controls?"bothRight"===t.vrHand?t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"bothLeft"===t.vrHand?t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"both"===t.vrHand?(t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}),t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}})):"right"===t.vrHand?t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"left"===t.vrHand&&t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"Mobile"===t.controls&&t.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".disabled",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}})},d=()=>{"Desktop"===t.controls?t.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}}):"VR"===t.controls?"bothRight"===t.vrHand?t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"bothLeft"===t.vrHand?t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"both"===t.vrHand?(t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}),t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}})):"right"===t.vrHand?t.vrController2.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"left"===t.vrHand&&t.vrController1.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}}):"Mobile"===t.controls&&t.mouseController.ChangeSelf({property:"raycaster",value:{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}})},u=()=>{document.getElementById("beltUIParent")&&t.locomotionUILayer.DespawnLayer()},m=()=>{i.equipped=!1,i.equippedObject="none",c(t.systemText)};return{layer:i,Reset:()=>{i.transition={},i.transition.id="000000",i.transition.scene="fade",i.transition.teleport="fade",i.teleporting=!1,i.stand=!0,i.standing=!0,i.animating=!1,i.snapRotating=!1,i.beltDisplay=!0,i.beltDefaultText="Hello World!",i.beltText="Hello World!",i.flashlight=!1,i.infoText="Player :\n"},PlayerSceneAnim:()=>{let e=setTimeout((function(){t.loadingScene||(t.loadingScene=!0),clearTimeout(e)}),800);i.teleporting||(i.teleporting=!0,"blink"===i.transition.scene?(p(),i.GetChild("blink1Screen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("blink2Screen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("blink1Screen").EmitEvent("blinkScene1"),i.GetChild("blink2Screen").EmitEvent("blinkScene1")):"fade"===i.transition.scene?(p(),i.GetChild("fadeScreen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("fadeScreen").EmitEvent("fadeScene1")):"sphere"===i.transition.scene?(p(),i.GetChild("sphereScreen").ChangeSelf({property:"visible",value:"true"}),i.GetChild("sphereScreen").EmitEvent("sphereScene1")):"instant"===i.transition.scene&&p())},UpdateSceneTransitionStyle:t=>{i.transition.scene=t},PlayerTeleportAnim:()=>{let e;t.player.layer.teleporting||(t.player.layer.teleporting=!0,"blink"===t.player.layer.transition.teleport?(t.player.TempDisableClick(),t.blink1Screen.ChangeSelf({property:"visible",value:"true"}),t.blink2Screen.ChangeSelf({property:"visible",value:"true"}),t.blink1Screen.EmitEvent("blink"),t.blink2Screen.EmitEvent("blink"),e=setTimeout((function(){t.blink1Screen.ChangeSelf({property:"visible",value:"false"}),t.blink2Screen.ChangeSelf({property:"visible",value:"false"}),t.player.layer.teleporting=!1,clearTimeout(e)}),1200)):"fade"===t.player.layer.transition.teleport?(t.player.TempDisableClick(),t.fadeScreen.ChangeSelf({property:"visible",value:"true"}),t.fadeScreen.EmitEvent("fade"),e=setTimeout((function(){t.fadeScreen.ChangeSelf({property:"visible",value:"false"}),t.player.layer.teleporting=!1,clearTimeout(e)}),1200)):"sphere"===t.player.layer.transition.teleport?(t.player.TempDisableClick(),t.sphereScreen.ChangeSelf({property:"visible",value:"true"}),t.sphereScreen.EmitEvent("sphere"),e=setTimeout((function(){t.sphereScreen.ChangeSelf({property:"visible",value:"false"}),t.player.layer.teleporting=!1,clearTimeout(e)}),1200)):("instant"===t.player.layer.transition.teleport||"locomotion"===t.player.layer.transition.teleport)&&(e=setTimeout((function(){t.player.layer.teleporting=!1,clearTimeout(e)}),500)))},UpdateTeleportTransitionStyle:t=>{i.transition.teleport=t},UpdateTransitionColor:e=>{t.fadeScreen.ChangeSelf({property:"material",value:{color:e}}),t.sphereScreen.ChangeSelf({property:"material",value:{color:e}}),t.blink1Screen.ChangeSelf({property:"material",value:{color:e}}),t.blink2Screen.ChangeSelf({property:"material",value:{color:e}})},ToggleVRText:()=>{i.vrUI=!i.vrUI,"VR"===t.controls&&("bothRight"===t.vrHand?t.vrController2.ChangeSelf({property:"visible",value:i.vrUI}):"bothLeft"===t.vrHand?t.vrController1.ChangeSelf({property:"visible",value:i.vrUI}):"both"===t.vrHand?(t.vrController1.ChangeSelf({property:"visible",value:i.vrUI}),t.vrController2.ChangeSelf({property:"visible",value:i.vrUI})):"right"===t.vrHand?t.vrController2.ChangeSelf({property:"visible",value:i.vrUI}):"left"===t.vrHand&&t.vrController1.ChangeSelf({property:"visible",value:i.vrUI}))},UpdateUIText:e=>{UpdateSystemText(e),"VR"===t.controls&&i.vrUI&&("bothRight"===t.vrHand?t.vrController2.ChangeSelf({property:"text",value:e}):"bothLeft"===t.vrHand?t.vrController1.ChangeSelf({property:"text",value:e}):"both"===t.vrHand?(t.vrController1.ChangeSelf({property:"text",value:e}),t.vrController2.ChangeSelf({property:"text",value:e})):"right"===t.vrHand?t.vrController2.ChangeSelf({property:"text",value:e}):"left"===t.vrHand&&t.vrController1.ChangeSelf({property:"text",value:e}))},ToggleBeltText:()=>{i.beltDisplay?(t.playerBeltText.ChangeSelf({property:"visible",value:!1}),i.beltDisplay=!1):(t.playerBeltText.ChangeSelf({property:"visible",value:!0}),c(),i.beltDisplay=!0)},UpdateBeltText:c,Notification:e=>{a=e.time||2750,h(a),t.cameraUI.ChangeSelf({property:"text",value:{value:e.message,width:.5,color:"#FFFFFF",align:"center",font:"exo2bold",side:"double",opacity:0}}),t.cameraUI.ChangeSelf({property:"visible",value:"true"}),t.cameraUI.EmitEvent("cameraMsg"),o=setTimeout((function(){t.cameraUI.ChangeSelf({property:"visible",value:"false"}),clearTimeout(o)}),a)},TempDisableClick:h,DisableClick:p,EnableClick:d,UnlockLocomotion:()=>{i.move=!0},LockLocomotion:()=>{i.move=!1},EnableVRLocomotion:()=>{u(),t.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"vr"})},EnableVRHoverLocomotion:e=>{t.locomotionUILayer.GetParentEl()||t.locomotionUILayer.SpawnLayer(),t.playerRig.GetEl().setAttribute("locomotion",{uiid:"beltUIParent",courserid:"mouseController",movetype:"vrHover"})},EnableDesktopLocomotion:()=>{u(),t.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"desktop"})},EnableMobileLocomotion:()=>{u(),t.playerRig.GetEl().setAttribute("locomotion",{uiid:!1,courserid:"mouseController",movetype:"mobile"})},ChangeLocomotionType:e=>{e.pov&&(i.moveType.pov=e.pov),e.axis&&(i.moveType.axis=e.axis),e.style&&(i.moveType.style=e.style),t.playerRig.GetEl().setAttribute("locomotion",{pov:i.moveType.pov,axis:i.moveType.axis,style:i.moveType.style})},RemoveBelt:u,ToggleSittingMode:()=>{i.animating||(i.animating=!0,i.stand?(t.playerBody.EmitEvent("sit"),i.stand=!1):(t.playerBody.EmitEvent("stand"),i.stand=!0),n=setTimeout((function(){i.animating=!1,clearTimeout(n)}),775))},ToggleCrouch:()=>{if(i.stand)if(i.animating);else{if(i.animating=!0,i.standing)t.playerBody.EmitEvent("crouchDownStanding"),i.standing=!1;else{let e=new THREE.Vector3(0,0,0);e.copy(i.gridPos),e.y+=1,t.map.CheckMapObstaclesDiagonal(e,i.gridPos)&&(t.playerBody.EmitEvent("crouchUpStanding"),i.standing=!0)}n=setTimeout((function(){i.animating=!1,clearTimeout(n)}),775)}else if(i.animating);else{if(i.animating=!0,i.standing)t.playerBody.EmitEvent("crouchDownSitting"),i.standing=!1;else{let e=new THREE.Vector3(0,0,0);e.copy(i.gridPos),e.y+=1,t.map.CheckMapObstaclesDiagonal(e,i.gridPos)&&(t.playerBody.EmitEvent("crouchUpSitting"),i.standing=!0)}n=setTimeout((function(){i.animating=!1,clearTimeout(n)}),775)}},SnapRight45:()=>{if(i.snapRotating);else{i.snapRotating=!0;let e=t.playerBody.GetEl().getAttribute("rotation").y;r.from=e,r.to=e-45,t.playerBody.Animate(r),s=setTimeout((()=>{i.snapRotating=!1,clearTimeout(s)}),r.dur+10)}},SnapLeft45:()=>{if(i.snapRotating);else{i.snapRotating=!0;let e=t.playerBody.GetEl().getAttribute("rotation").y;r.from=e,r.to=e+45,t.playerBody.Animate(r),s=setTimeout((()=>{i.snapRotating=!1,clearTimeout(s)}),r.dur+10)}},SnapRight90:()=>{if(i.snapRotating);else{i.snapRotating=!0;let e=t.playerBody.GetEl().getAttribute("rotation").y;l.from=e,l.to=e-90,t.playerBody.Animate(l),s=setTimeout((()=>{i.snapRotating=!1,clearTimeout(s)}),l.dur+10)}},SnapLeft90:()=>{if(i.snapRotating);else{i.snapRotating=!0;let e=t.playerBody.GetEl().getAttribute("rotation").y;l.from=e,l.to=e+90,t.playerBody.Animate(l),s=setTimeout((()=>{i.snapRotating=!1,clearTimeout(s)}),l.dur+10)}},ToggleFlashlight:()=>{i.flashlight?("Desktop"===t.controls||"Mobile"===t.controls?t.camera.RemoveComponent("light"):"VR"===t.controls&&("bothRight"===t.vrHand||"bothRightLoco"===t.vrHand||"right"===t.vrHand?t.vrController2.RemoveComponent("light"):t.vrController1.RemoveComponent("light")),i.flashlight=!1):("Desktop"===t.controls||"Mobile"===t.controls?t.camera.ChangeSelf({property:"light",value:{type:"spot",intensity:.5,distance:15,decay:.3,penumbra:.15,angle:25}}):"VR"===t.controls&&("bothRight"===t.vrHand||"bothRightLoco"===t.vrHand||"right"===t.vrHand?t.vrController2.ChangeSelf({property:"light",value:{type:"spot",intensity:.5,distance:15,decay:.3,penumbra:.15,angle:25}}):t.vrController1.ChangeSelf({property:"light",value:{type:"spot",intensity:.5,distance:15,decay:.3,penumbra:.15,angle:25}})),i.flashlight=!0)},ResetUserPosRot:()=>{t.playerRig.ChangeSelf({property:"position",value:new THREE.Vector3(0,0,1)}),i.gridPos.copy(t.playerRig.GetEl().getAttribute("position"));let e=t.camera.GetEl().getAttribute("rotation").y;e>0?e<360&&(e%=360):e<0&&e<-360&&(e%=360),t.playerBody.ChangeSelf({property:"rotation",value:new THREE.Vector3(0,-1*e+1,0)})},GetPlayerInfo:()=>({layer:i,id:i.layer.all.parent.core.core.id,pos:t.playerRig.GetEl().getAttribute("position"),bodyRot:t.playerBody.GetEl().getAttribute("rotation"),headRot:t.camera.GetEl().getAttribute("rotation"),grid:i.gridPos}),AttachToPlayer:(t,e)=>{let o=new THREE.Vector3(0,0,0);e&&(o.x+=e.x,o.y+=e.y,o.z+=e.z),t.setAttribute("sync-pos",{idname:i.id,position:o})},Equip:e=>{let o=!1;if(i.equipped&&e===i.equippedObject?m():o=!0,o){i.equipped=!0,i.equippedObject=e;let o="Equipped : "+t[e].name;c(o)}},Unequip:m,MainMenuAction:()=>{if(i.menuToggle){i.menuToggle=!1;let e=setTimeout((()=>{i.menuToggle=!0,clearTimeout(e)}),350);t.comp.comp.inScene?t.mainMenu.multiMenu.menuOpen?t.mainMenu.ToggleMenu():t.comp.DespawnComp():t.comp.SpawnComp()}},DetachFromPlayer:t=>{t.removeAttribute("sync-pos")},UpdatePlayerPosition:e=>{let o=new THREE.Vector3(0,0,0);o.x=e.x||0,o.y=e.y||0,o.z=e.z||0,t.playerRig.ChangeSelf({property:"position",value:o}),i.gridPos.copy(o)},TwistTo:e=>{let i=t.camera.GetEl().getAttribute("rotation").y;i>0?i<360&&(i%=360):i<0&&i<-360&&(i%=360);let o=new THREE.Vector3(0,-1*i+1+e,0);t.playerBody.ChangeSelf({property:"rotation",value:o})},ToggleBackgroundAudio:()=>{t.backgroundAudio=!t.backgroundAudio,t.backgroundAudio?t.playerAudio.SpawnCore(t.playerRig):t.playerAudio.DespawnCore()},TestFunc:t=>{console.log(t)}}},o=(t,e)=>{let i,o=Object.assign({},e),a=t.Core(t.sceneTextData),n=t.SpeechSystem(a);const s=(e,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(t[i].GetFlag)if(t[i].GetFlag(o))for(let t in a)for(let e in a[t])h(t,e,a[t][e]);else for(let t in n)for(let e in n[t])h(t,e,n[t][e]);else if(t[i].GetFlagParent)if(t[i].GetFlagParent(o))for(let t in a)for(let e in a[t])h(t,e,a[t][e]);else for(let t in n)for(let e in n[t])h(t,e,n[t][e])},r=(e,i,o)=>{let a=[];for(let t in o)"default"===t||a.push(t);if(t[i].GetFlag){let e=t[i].GetFlag(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])h(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])h(t,e,o.default[t][e])}else if(t[i].GetFlagParent){let e=t[i].GetFlagParent(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])h(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])h(t,e,o.default[t][e])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},l=({name:e,type:i,id:o,method:a,params:n,event:s})=>{let r=e+o;"timeout"===i||"interval"===i?t.running[r]={type:i,name:e,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(t.running[r]={type:i,name:e,id:o,nameId:r,method:a,params:n,event:s})},c=e=>{delete t.running[e]},h=(e,i,o)=>{for(let o in t.objGenTracking)i!==t.objGenTracking[o].spawn&&i!==t.objGenTracking[o].altSpawn||t.spawnTracker(e,"node");t[e][i](o)};function p(e){if("controls"!==e){"info"===e&&(o[e].fog?t.sceneEl.setAttribute("fog",o[e].fog):t.sceneEl.setAttribute("fog",{type:"linear",near:999,far:1e3,color:"#FFF"}));for(let i in o[e])if("delay"===e)for(let a in o[e][i])for(let n in o[e][i][a])if("IfElse"===n)for(let r in o[e][i][a][n])l({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){s(0,r,o[e][i][a][n][r]),clearTimeout(t.timeouts[i+a])}),i);else if("Switch"===n)for(let s in o[e][i][a][n])l({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){r(0,s,o[e][i][a][n][s]),clearTimeout(t.timeouts[i+a])}),i);else l({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){h(a,n,o[e][i][a][n]),clearTimeout(t.timeouts[i+a])}),i);else if("interval"===e)for(let a in o[e][i]){let n,p=0,d=o[e][i].loop;if(o[e][i].end&&(n=o[e][i].end),"run"===a)for(let u in o[e][i][a])for(let m in o[e][i][a][u])if("IfElse"===m)for(let r in o[e][i][a][u][m])l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),c(i+u)),s(0,r,o[e][i][a][u][m][r]),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i);else if("Switch"===m)for(let s in o[e][i][a][u][m])l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),c(i+u)),r(0,s,o[e][i][a][u][m][s]),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i);else{let s=m,r=o[e][i][a][u][m];l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),c(i+u)),h(u,s,r),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i)}}else if("interaction"===e)for(let a in o[e][i])for(let n in o[e][i][a]){let c,p,d,u;if("IfElse"===n)for(let r in o[e][i][a][n])c=a,d=o[e][i][a][n][r],l({name:c,type:"interaction",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){s(0,r,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){s(0,r,d)}));else if("Switch"===n)for(let s in o[e][i][a][n])c=a,d=o[e][i][a][n][s],l({name:c,type:"interaction",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){r(0,s,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){r(0,s,d)}));else if("relay"===n)for(let s in o[e][i][a][n])for(let r in o[e][i][a][n][s])c=a,u=s,p=r,d=o[e][i][a][n][s][r],l({name:c,type:"interaction",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){h(u,p,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){h(u,p,d)}));else c=a,p=n,d=o[e][i][a][n],l({name:c,type:"interaction",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){h(c,p,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){h(c,p,d)}))}else if("event"===e)for(let a in o[e][i])for(let n in o[e][i][a]){let c,p,d,u;if("IfElse"===n)for(let r in o[e][i][a][n])c=a,d=o[e][i][a][n][r],l({name:c,type:"event",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){s(0,r,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){s(0,r,d)}));else if("Switch"===n)for(let s in o[e][i][a][n])c=a,d=o[e][i][a][n][s],l({name:c,type:"event",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){r(0,s,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){r(0,s,d)}));else if("relay"===n)for(let s in o[e][i][a][n])for(let r in o[e][i][a][n][s])c=a,u=s,p=r,d=o[e][i][a][n][s][r],l({name:c,type:"event",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){h(u,p,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){h(u,p,d)}));else c=a,p=n,d=o[e][i][a][n],l({name:c,type:"event",id:a,method:p,params:d,event:i}),t[c].GetEl?t[c].GetEl().addEventListener(i,(function(){h(c,p,d)})):t[c].GetParentEl&&t[c].GetParentEl().addEventListener(i,(function(){h(c,p,d)}))}else if("info"===e);else for(let t in o[e][i])if("start"===e)if("IfElse"===t)for(let a in o[e][i][t])s(0,a,o[e][i][t][a]);else if("Switch"===t)for(let a in o[e][i][t])r(0,a,o[e][i][t][a]);else h(i,t,o[e][i][t]);else if("exit"===e)if("IfElse"===t)for(let a in o[e][i][t])s(0,a,o[e][i][t][a]);else if("Switch"===t)for(let a in o[e][i][t])r(0,a,o[e][i][t][a]);else h(i,t,o[e][i][t]);else console.log(e),console.log(i),console.log(t),console.log("Hit Other Timeline, Please Investigate")}else t.universalControls.updateAction(o[e])}const d=()=>{t.map.grid.edgeSpawned&&t.map.DespawnEdges(),t.map.ClearWaiting(),t.map.ClearTriggers()},u=()=>{"other"===o.info.spawnPos||(o.info.spawnPos?t.player.UpdatePlayerPosition(o.info.spawnPos):t.player.UpdatePlayerPosition(new THREE.Vector3(0,0,0)))};return{core:o,ClearScene:()=>{p("exit"),t.universalControls.disableAction(o.controls),d(),o.info.sceneText&&n.KillStop(),(()=>{for(let e in t.running)"timeout"===t.running[e].type?(clearTimeout(t.timeouts[t.running[e].nameId]),delete t.timeouts[t.running[e].nameId]):"interval"===t.running[e].type?(clearInterval(t.intervals[t.running[e].nameId]),delete t.intervals[t.running[e].nameId]):"interaction"!==t.running[e].type&&"event"!==t.running[e].type||(t[t.running[e].name].GetEl?t[t.running[e].name].GetEl().removeEventListener(t.running[e].event,(function(){h(t.running[e].object,t.running[e].method,t.running[e].params)})):t[t.running[e].name].GetParentEl&&t[t.running[e].name].GetParentEl().removeEventListener(t.running[e].event,(function(){h(t.running[e].object,t.running[e].method,t.running[e].params)}))),c(e)})(),t.clearSpawned(t.nodeSpawned)},StartScene:()=>{t.sceneReading=!0,t.SceneLoadTimeout(),u(),p("info"),o.info.map&&(t.map.BuildMap(o.info.map.size,o.info.map.height),t.mapEdge=o.info.map.edge||!1,t.mapEdge&&o.info.map.spawnEdge&&t.map.SpawnEdges(o.info.map.edgeUpdate)),p("start"),p("delay"),p("interval"),p("event"),p("interaction"),p("controls"),t.UpdateControlText(),(()=>{if(o.info.sceneText){n.Start(),n.DisplaySpeech({role:o.info.name,speech:"... ... ..."});let t=setTimeout((()=>{n.DisplaySpeech({role:o.info.name,speech:o.info.description}),clearTimeout(t)}),1250)}})(),i=setTimeout((()=>{t.sceneReading=!1,clearTimeout(i)}),400),t.local.location.scene=o.info.id,t.saveToProfile(),t.local.location.load&&(t.local.location.load=!1)},ScenePlayerPosition:u}},a=(t,e)=>{let i,o,a=Object.assign({},e);a.mapMenuData=!1,a.mapMainMenuData=!1,a.mapMenu,a.nodes={},a.currentNode,a.zoneLoaded=!1,a.displayBasicTravelMenu=a.info.travelMenu||!1;const n=(e,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(t[i].GetFlag)if(t[i].GetFlag(o))for(let t in a)for(let e in a[t])r(t,e,a[t][e]);else for(let t in n)for(let e in n[t])r(t,e,n[t][e]);else if(t[i].GetFlagParent)if(t[i].GetFlagParent(o))for(let t in a)for(let e in a[t])r(t,e,a[t][e]);else for(let t in n)for(let e in n[t])r(t,e,n[t][e])},s=(e,i,o)=>{let a=[];for(let t in o)"default"===t||a.push(t);if(t[i].GetFlag){let e=t[i].GetFlag(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])r(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])r(t,e,o.default[t][e])}else if(t[i].GetFlagParent){let e=t[i].GetFlagParent(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])r(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])r(t,e,o.default[t][e])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},r=(e,i,o)=>{for(let o in t.objGenTracking)i!==t.objGenTracking[o].spawn&&i!==t.objGenTracking[o].altSpawn||t.spawnTracker(e,"zone");t[e][i](o)},l=({name:e,type:i,id:o,method:a,params:n,event:s})=>{let r=e+o;"timeout"===i||"interval"===i?t.zoneRunning[r]={type:i,name:e,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(t.zoneRunning[r]={type:i,name:e,id:o,nameId:r,method:a,params:n,event:s})},c=e=>{delete t.zoneRunning[e]};function h(e){if("controls"!==e)for(let i in a[e])if("delay"===e)for(let o in a[e][i])for(let c in a[e][i][o])if("IfElse"===c)for(let s in a[e][i][o][c])l({name:i,type:"timeout",id:o}),t.timeouts[i+o]=setTimeout((function(){n(0,s,a[e][i][o][c][s]),clearTimeout(t.timeouts[i+o])}),i);else if("Switch"===c)for(let n in a[e][i][o][c])l({name:i,type:"timeout",id:o}),t.timeouts[i+o]=setTimeout((function(){s(0,n,a[e][i][o][c][n]),clearTimeout(t.timeouts[i+o])}),i);else l({name:i,type:"timeout",id:o}),t.timeouts[i+o]=setTimeout((function(){r(o,c,a[e][i][o][c]),clearTimeout(t.timeouts[i+o])}),i);else if("interval"===e)for(let o in a[e][i]){let h,p=0,d=a[e][i].loop;if(a[e][i].end&&(h=a[e][i].end),"run"===o)for(let u in a[e][i][o])for(let m in a[e][i][o][u])if("IfElse"===m)for(let s in a[e][i][o][u][m])l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(h)&&(clearInterval(t.intervals[i+u]),c(i+u)),n(0,s,a[e][i][o][u][m][s]),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i);else if("Switch"===m)for(let n in a[e][i][o][u][m])l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(h)&&(clearInterval(t.intervals[i+u]),c(i+u)),s(0,n,a[e][i][o][u][m][n]),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i);else{let n=m,s=a[e][i][o][u][m];l({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(h)&&(clearInterval(t.intervals[i+u]),c(i+u)),r(u,n,s),"infinite"===d||(p++,p>=d&&(clearInterval(t.intervals[i+u]),c(i+u)))}),i)}}else if("interaction"===e)for(let o in a[e][i])for(let c in a[e][i][o]){let h,p,d;if("IfElse"===c)for(let s in a[e][i][o][c])h=o,d=a[e][i][o][c][s],l({name:h,type:"interaction",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){n(0,s,d)}));else if("Switch"===c)for(let n in a[e][i][o][c])h=o,d=a[e][i][o][c][n],l({name:h,type:"interaction",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){s(0,n,d)}));else h=o,p=c,d=a[e][i][o][c],l({name:h,type:"interaction",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){r(h,p,d)}))}else if("event"===e)for(let o in a[e][i])for(let c in a[e][i][o]){let h,p,d;if("IfElse"===c)for(let s in a[e][i][o][c])h=o,d=a[e][i][o][c][s],l({name:h,type:"event",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){n(0,s,d)}));else if("Switch"===c)for(let n in a[e][i][o][c])h=o,d=a[e][i][o][c][n],l({name:h,type:"event",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){s(0,n,d)}));else h=o,p=c,d=a[e][i][o][c],l({name:h,type:"event",id:o,method:p,params:d,event:i}),t[h].GetEl().addEventListener(i,(function(){r(h,p,d)}))}else if("info"===e);else for(let t in a[e][i])if("start"===e)if("IfElse"===t)for(let o in a[e][i][t])n(0,o,a[e][i][t][o]);else if("Switch"===t)for(let o in a[e][i][t])s(0,o,a[e][i][t][o]);else r(i,t,a[e][i][t]);else if("exit"===e)if("IfElse"===t)for(let o in a[e][i][t])n(0,o,a[e][i][t][o]);else if("Switch"===t)for(let o in a[e][i][t])s(0,o,a[e][i][t][o]);else r(i,t,a[e][i][t]);else console.log("Hit Other Timeline, Please Investigate");else t.universalControls.updateAction(a[e])}const p=()=>{t.universalControls.disableAction(a.controls)},d=e=>{t.local.location.load?a.currentNode=t.local.location.scene:a.currentNode=e||a.info.start,a.currentZone=a.info.id,t.currentZone=a.info.id,a.zoneLoaded||(h("start"),h("delay"),h("interval"),h("event"),h("interaction"),h("controls"),t.local.location.zone=a.info.id,a.zoneLoaded=!0),t[a.currentNode].StartScene(),y(),a.displayBasicTravelMenu&&m(),t.player.UnlockLocomotion()},u=()=>{t[a.currentNode].ClearScene()},m=()=>{a.mapMenuData={id:"moveMenu",prompt:"Move to...",options:{option0:"0"},actions:{action0:"0"},data:t.menuBaseData,cursorObj:a.currentZone,method:"MenuMoveClick",pos:new THREE.Vector3(-1.5,1.5,-1)};let e,i=0;for(let o in a.map[a.currentNode])e=a.nodes[a.map[a.currentNode][o].node]?a.nodes[a.map[a.currentNode][o].node]:t[a.map[a.currentNode][o].node],a.map[a.currentNode][o].locked&&!t.comp.CheckForKey(a.map[a.currentNode][o].keyId)?a.mapMenuData.options["option"+i]=e.core.info.name+" [Locked]":a.map[a.currentNode][o].locked&&t.comp.CheckForKey(a.map[a.currentNode][o].keyId)?a.mapMenuData.options["option"+i]=e.core.info.name+" [Unlocked]":a.mapMenuData.options["option"+i]=e.core.info.name,a.mapMenuData.actions["action"+i]=o,i++;a.mapMenu=t.Menu(a.mapMenuData),a.mapMenu.SpawnMenu()},y=()=>{a.mapMainMenuData={};let e,i,o={},n={},s=1,r=1,l=Object.keys(a.map[a.currentNode]).length,c=Math.ceil(l/7),h="travel"+r;t.local.location.load||""===t.local.location.scenario||t[t.local.location.scenario].UpdateZoneMap();for(let p in a.map[a.currentNode])e=a.nodes[a.map[a.currentNode][p].node]?a.nodes[a.map[a.currentNode][p].node]:t[a.map[a.currentNode][p].node],i=a.map[a.currentNode][p].locked&&!t.comp.CheckForKey(a.map[a.currentNode][p].keyId)?e.core.info.name+" [Locked]":a.map[a.currentNode][p].locked&&t.comp.CheckForKey(a.map[a.currentNode][p].keyId)?e.core.info.name+" [Unlocked]":e.core.info.name,o={id:"action"+s,style:!1,title:i,description:"Travel to "+i,subMenu:!1,action:{auxlObj:a.currentZone,component:!1,method:"Move",params:p,menu:"close"}},n={id:"action"+s,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},a.mapMainMenuData["button"+s]=o,s===l?t.mainMenu.UpdateSubMenu(h,a.mapMainMenuData):s++,c>1&&s%7==0&&(r++,n.id="action"+s,n.subMenu="travel"+r,a.mapMainMenuData["button"+s]=n,t.mainMenu.UpdateSubMenu(h,a.mapMainMenuData),a.mapMainMenuData={},h="travel"+r)},g=e=>{t.player.LockLocomotion(),o=a.map[a.currentNode][e],o.locked&&!t.comp.CheckForKey(o.keyId)?(clearTimeout(void 0),t.player.Notification({message:"Requires : "+o.keyName})):(o.locked&&t.comp.CheckForKey(o.keyId)&&!o.keepKey&&t.comp.RemoveFromInventory(o.keyId),i=setTimeout((()=>{a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu(),u(),a.nodes[o.node]?d(o.node):(v(),a.zoneLoaded=!1,t[o.inZone].StartScene(o.node)),clearTimeout(i)}),425),t.player.PlayerSceneAnim())},v=()=>{h("exit"),p(),a.zoneLoaded=!1,(()=>{for(let e in t.zoneRunning)"timeout"===t.zoneRunning[e].type?(clearTimeout(t.timeouts[t.zoneRunning[e].nameId]),delete t.timeouts[t.zoneRunning[e].nameId]):"interval"===t.zoneRunning[e].type?(clearInterval(t.intervals[t.zoneRunning[e].nameId]),delete t.intervals[t.zoneRunning[e].nameId]):"interaction"!==t.zoneRunning[e].type&&"event"!==t.zoneRunning[e].type||t[t.zoneRunning[e].name].GetEl().removeEventListener(t.zoneRunning[e].event,(function(){r(t.zoneRunning[e].object,t.zoneRunning[e].method,t.zoneRunning[e].params)})),c(e)})(),p(),t.clearSpawned(t.zoneSpawned),a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu()};return{core:a,UpdateMap:e=>{a.nodes={},a.map=e;for(let i in e)a.nodes[i]=t[i]},StartScene:d,MoveSpawnMenu:m,MenuMoveClick:t=>{let e=t.getAttribute("result");g(e)},Move:g,Change:(e,o)=>{i=setTimeout((()=>{a.displayBasicTravelMenu&&a.mapMenu.DespawnMenu(),u(),a.id===e?d(o):(v(),a.zoneLoaded=!1,t[e].StartScene(o)),clearTimeout(i)}),425),t.player.PlayerSceneAnim()},ClearZone:v}},n=(t,e)=>{let i,o=Object.assign({},e);o.scenarioLoaded=!1;let a=o.info.startZone,n=o.info.name,s=o.info.instructions;const r=(e,i,{cond:o,ifTrue:a,ifFalse:n})=>{if(t[i].GetFlag)if(t[i].GetFlag(o))for(let t in a)for(let e in a[t])c(t,e,a[t][e]);else for(let t in n)for(let e in n[t])c(t,e,n[t][e]);else if(t[i].GetFlagParent)if(t[i].GetFlagParent(o))for(let t in a)for(let e in a[t])c(t,e,a[t][e]);else for(let t in n)for(let e in n[t])c(t,e,n[t][e])},l=(e,i,o)=>{let a=[];for(let t in o)"default"===t||a.push(t);if(t[i].GetFlag){let e=t[i].GetFlag(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])c(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])c(t,e,o.default[t][e])}else if(t[i].GetFlagParent){let e=t[i].GetFlagParent(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])c(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])c(t,e,o.default[t][e])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},c=(e,i,o)=>{for(let o in t.objGenTracking)i!==t.objGenTracking[o].spawn&&i!==t.objGenTracking[o].altSpawn||t.spawnTracker(e,"scenario");t[e][i](o)},h=({name:e,type:i,id:o,method:a,params:n,event:s})=>{let r=e+o;"timeout"===i||"interval"===i?t.scenarioRunning[r]={type:i,name:e,id:o,nameId:r}:"interaction"!==i&&"event"!==i||(t.scenarioRunning[r]={type:i,name:e,id:o,nameId:r,method:a,params:n,event:s})},p=e=>{delete t.scenarioRunning[e]};function d(e){if("controls"!==e)for(let i in o[e])if("delay"===e)for(let a in o[e][i])for(let n in o[e][i][a])if("IfElse"===n)for(let s in o[e][i][a][n])h({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){r(0,s,o[e][i][a][n][s]),clearTimeout(t.timeouts[i+a])}),i);else if("Switch"===n)for(let s in o[e][i][a][n])h({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){l(0,s,o[e][i][a][n][s]),clearTimeout(t.timeouts[i+a])}),i);else h({name:i,type:"timeout",id:a}),t.timeouts[i+a]=setTimeout((function(){c(a,n,o[e][i][a][n]),clearTimeout(t.timeouts[i+a])}),i);else if("interval"===e)for(let a in o[e][i]){let n,s=0,d=o[e][i].loop;if(o[e][i].end&&(n=o[e][i].end),"run"===a)for(let u in o[e][i][a])for(let m in o[e][i][a][u])if("IfElse"===m)for(let l in o[e][i][a][u][m])h({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),p(i+u)),r(0,l,o[e][i][a][u][m][l]),"infinite"===d||(s++,s>=d&&(clearInterval(t.intervals[i+u]),p(i+u)))}),i);else if("Switch"===m)for(let r in o[e][i][a][u][m])h({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),p(i+u)),l(0,r,o[e][i][a][u][m][r]),"infinite"===d||(s++,s>=d&&(clearInterval(t.intervals[i+u]),p(i+u)))}),i);else{let r=m,l=o[e][i][a][u][m];h({name:i,type:"interval",id:u}),t.intervals[i+u]=setInterval((function(){!0===t[u].GetFlag(n)&&(clearInterval(t.intervals[i+u]),p(i+u)),c(u,r,l),"infinite"===d||(s++,s>=d&&(clearInterval(t.intervals[i+u]),p(i+u)))}),i)}}else if("interaction"===e)for(let a in o[e][i])for(let n in o[e][i][a]){let s,p,d;if("IfElse"===n)for(let l in o[e][i][a][n])s=a,d=o[e][i][a][n][l],h({name:s,type:"interaction",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){r(0,l,d)}));else if("Switch"===n)for(let r in o[e][i][a][n])s=a,d=o[e][i][a][n][r],h({name:s,type:"interaction",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){l(0,r,d)}));else s=a,p=n,d=o[e][i][a][n],h({name:s,type:"interaction",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){c(s,p,d)}))}else if("event"===e)for(let a in o[e][i])for(let n in o[e][i][a]){let s,p,d;if("IfElse"===n)for(let l in o[e][i][a][n])s=a,d=o[e][i][a][n][l],h({name:s,type:"event",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){r(0,l,d)}));else if("Switch"===n)for(let r in o[e][i][a][n])s=a,d=o[e][i][a][n][r],h({name:s,type:"event",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){l(0,r,d)}));else s=a,p=n,d=o[e][i][a][n],h({name:s,type:"event",id:a,method:p,params:d,event:i}),t[s].GetEl().addEventListener(i,(function(){c(s,p,d)}))}else if("info"===e);else for(let t in o[e][i])if("start"===e)if("IfElse"===t)for(let a in o[e][i][t])r(0,a,o[e][i][t][a]);else if("Switch"===t)for(let a in o[e][i][t])l(0,a,o[e][i][t][a]);else c(i,t,o[e][i][t]);else if("exit"===e)if("IfElse"===t)for(let a in o[e][i][t])r(0,a,o[e][i][t][a]);else if("Switch"===t)for(let a in o[e][i][t])l(0,a,o[e][i][t][a]);else c(i,t,o[e][i][t]);else console.log("Hit Other Timeline, Please Investigate");else t.universalControls.updateAction(o[e])}const u=()=>{t.universalControls.disableAction(o.controls)},m=()=>{for(let e in o.map)t[e].UpdateMap(o.map[e])};return{core:o,StartScenario:()=>{o.scenarioLoaded||(t.player.PlayerSceneAnim(),m(),scenarioHeaderTitle.innerHTML=n,scenarioMenuTitle.innerHTML=n,instructions.innerHTML=s,t.universalControls=document.getElementById("playerRig").components["universal-controls"],i=setTimeout((()=>{d("start"),d("delay"),d("interval"),d("event"),d("interaction"),d("controls"),a=t.local.location.load?t.local.location.zone:o.info.startZone,t[a].StartScene(),o.scenarioLoaded=!0,t.local.location.scenario=o.info.id,clearTimeout(i)}),425))},ClearScenario:()=>{t[t[t.currentZone].core.currentNode].ClearScene(),t[t.currentZone].ClearZone(),d("exit"),u(),(()=>{for(let e in t.scenarioRunning)"timeout"===t.scenarioRunning[e].type?(clearTimeout(t.timeouts[t.scenarioRunning[e].nameId]),delete t.timeouts[t.scenarioRunning[e].nameId]):"interval"===t.scenarioRunning[e].type?(clearInterval(t.intervals[t.scenarioRunning[e].nameId]),delete t.intervals[t.scenarioRunning[e].nameId]):"interaction"!==t.scenarioRunning[e].type&&"event"!==t.scenarioRunning[e].type||t[t.scenarioRunning[e].name].GetEl().removeEventListener(t.scenarioRunning[e].event,(function(){c(t.scenarioRunning[e].object,t.scenarioRunning[e].method,t.scenarioRunning[e].params)})),p(e)})(),u(),t.clearSpawned(t.scenarioSpawned),o.scenarioLoaded=!1},UpdateZoneMap:m}},s=(t,e)=>{let i={};i.data=Object.assign({},e),i.inScene=!1,i.menuOpen=!1,i.active=!1,i.descriptionOpen=!1,i.buttonHover="",i.currentMenu="menu",i.menuPath=["menu"],i.switching=!1,i.switchingTimeout,i.id=e.info.id||"hoverMenu",i.name=e.info.name||"Quick Menu",i.layout=e.info.layout||"circleUp",i.posOffset=e.info.posOffset||new THREE.Vector3(0,0,0),i.offset=e.info.offset||-1,i.parent=i.data.info.parent||!1,i.spawnPos=new THREE.Vector3(0,0,0),i.attached=i.data.info.attached||!1;let o=-45,a=0;i.buttonData=JSON.parse(JSON.stringify(i.data.info.buttonData)),i.hoverData=JSON.parse(JSON.stringify(i.data.info.hoverData)),i.nullParentData={data:"nullParentData",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:i.posOffset,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},i.cores={},i.cores.hover={},i.nullParentData.id=i.id,i.data.info.position&&(i.nullParentData.position=i.data.info.position),i.cores.parent=t.Core(i.nullParentData),i.nullParentData.position=new THREE.Vector3(0,0,0),i.nullParentData.components={},i.buttonData.id=i.data.info.id+"menu","circleUp"!==i.layout&&"circleDown"!==i.layout||(i.buttonData.position.x=i.offset),i.buttonData.text.value=i.name,i.cores.main=t.Core(i.buttonData);for(let e in i.data)if("info"===e);else{i.cores[e]=[],i.cores.hover[e]=[];let n=0;for(let a in i.data[e])n++,i.buttonData.id=i.data[e][a].id,i.buttonData.text.value=i.data[e][a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*n*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*n:"vertical"===i.layout?i.buttonData.position.y=n*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=n*i.offset),i.buttonData.components={},i.buttonData.components.hoverrun={},i.buttonData.components.hoverrun.menu=i.id,i.buttonData.components.hoverrun.action=a,i.attached&&(i.buttonData.components.hoverrun.attached=i.attached),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=i.data[e][a].id+"hover",i.hoverData.text.value=i.data[e][a].description,i.cores.hover[e][a]=t.Core(i.hoverData),i.cores[e][a]=t.Core(i.buttonData);n>a&&(a=n)}i.cores.nulls=[];for(let e=0;e<=8;e++)i.nullParentData.id=i.id+"null"+e,"circleUp"===i.layout?i.nullParentData.rotation.z=o*e:"circleDown"===i.layout&&(i.nullParentData.rotation.z=o*e*-1),i.cores.nulls.push(t.Core(i.nullParentData));i.menuLayerData={parent:{core:i.cores.parent},child0:{parent:{core:i.cores.nulls[0]},child0:{core:i.cores.main}}};for(let t=1;t<i.cores.nulls.length;t++)i.menuLayerData["child"+t]={},i.menuLayerData["child"+t].core=i.cores.nulls[t];i.menuLayer=t.Layer(i.id,i.menuLayerData);const n=t=>{let e;if(e=t?0:50,i.switching);else if(i.menuOpen){let o=setTimeout((()=>{(t=>{i.menuOpen=!1,i.switching=!0;let e,o=i.currentMenu,a=1,n={};e=t?25:50,i.descriptionOpen&&s(i.buttonHover);let r=setTimeout((()=>{for(let t in i.cores[o])n[t]=i.menuLayer.GetChildEl(i.id+"null"+a),i.cores[o][t].DespawnCore(),a++;clearTimeout(r)}),e);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),2*e)})(t),clearTimeout(o)}),e)}},s=t=>{i.descriptionOpen&&(i.cores[i.currentMenu][t].GetEl(),i.cores.hover[i.currentMenu][t].DespawnCore(),i.buttonHover="",i.descriptionOpen=!1)};return{hoverMenu:i,SpawnHoverMenu:()=>{i.inScene||(i.active=!1,i.menuLayer.layer.all.parent.core.core.position=function(){let e=new THREE.Vector3;t.camera.GetEl().object3D.getWorldDirection(e);let o=new THREE.Vector3;return o.copy(t.camera.GetEl().object3D.position).add(new THREE.Vector3(e.x,e.y,e.z).normalize().multiplyScalar(i.posOffset.z)),o}(),i.menuLayer.SpawnLayer(i.parent),(()=>{i.menuOpen=!0,i.switching=!0;let t,e=i.currentMenu,o=1,a=setTimeout((()=>{for(let a in i.cores[e])t=i.menuLayer.GetChildEl(i.id+"null"+o),i.cores[e][a].SpawnCore(t),o++;clearTimeout(a)}),50);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),100)})(),i.inScene=!0)},DespawnHoverMenu:()=>{if(i.inScene){console.log(i.active),i.active&&function(e){if(e.component&&"null"!==e.component){if(document.getElementById(e.auxlObj)){let t=document.getElementById(e.auxlObj);e.params&&"null"!==e.params?t.components[e.component][e.method](e.params):t.components[e.component][e.method]()}}else t[e.auxlObj][e.method]&&(e.params&&"null"!==e.params?t[e.auxlObj][e.method](e.params):t[e.auxlObj][e.method]())}(i.data.menu[i.active].action),n(!0);let e=setTimeout((()=>{i.menuLayer.DespawnLayer(),i.inScene=!1,clearTimeout(e)}),50)}},UpdateParent:t=>{let e=t||!1;i.inScene||(i.parent=e)},UpdateSubMenu:(e,n)=>{if(i.currentMenu===e);else{i.cores[e]=[],i.cores.hover[e]=[];let s=0;for(let a in n)s++,i.buttonData.id=n[a].id,i.buttonData.text.value=n[a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*s*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*s:"vertical"===i.layout?i.buttonData.position.y=s*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=s*i.offset),i.buttonData.components={},n[a].action&&(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=n[a].action.auxlObj,i.buttonData.components.clickrun.method=n[a].action.method,n[a].action.component&&(i.buttonData.components.clickrun.component=n[a].action.component),n[a].action.params&&(i.buttonData.components.clickrun.params=n[a].action.params)),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=n[a].id+"hover",i.hoverData.text.value=n[a].description,i.cores.hover[e][a]=t.Core(i.hoverData),i.cores[e][a]=t.Core(i.buttonData);s>a&&(a=s)}},ResetMenu:n,SpawnDescription:t=>{if(i.descriptionOpen);else{i.buttonHover=t;let e=i.cores[i.currentMenu][t].GetEl();i.cores.hover[i.currentMenu][t].SpawnCore(e),i.descriptionOpen=!0}},DespawnDescription:s}},r=(t,e,i,o,a,n)=>{let s={};s.id=e;let r=s.id+"layer",l=s.id+"combo0",c=s.id+"combo1",h=s.id+"combo2",p=s.id+"combo3",d=s.id+"combo4";if(s.sequence=o,s.run=a,s.current=0,s.locked=!0,s.correctSoFar=!0,s.lockedTimeout,s.unlockedTimeout,s.position=n||new THREE.Vector3(0,0,0),s.texts=[],i)for(let t in i)s.texts[t]={value:i[t],color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.051,side:"front",wrapCount:2,baseline:"center"};else s.texts[0]=!1,s.texts[1]=!1,s.texts[2]=!1,s.texts[3]=!1,s.texts[4]=!1;s.comboParentData={data:"comboParentData",id:"comboParent",sources:!1,text:!1,geometry:!1,material:!1,position:s.position,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},s.comboParent=t.Core(s.comboParentData),s.combo0Data={data:"combo0Data",id:l,sources:!1,text:s.texts[0],geometry:{primitive:"box",depth:.1,width:.2,height:.3},material:{shader:"standard",color:"#e02574",emissive:"#e02574",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(-.4,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"},locked:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:250,delay:0,loop:!1,dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"locked"},locked2:{property:"material.emissiveIntensity",from:"1",to:"0.25",dur:250,delay:1750,loop:!1,dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"locked"},unlocked:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:250,delay:0,loop:"8",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"unlocked"}},mixins:!1,classes:["clickable","a-ent"],components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"0"}}},s[l]=t.Core(s.combo0Data),s.combo1Data=t.coreDataFromTemplate(s.combo0Data,{id:c,text:s.texts[1],position:new THREE.Vector3(-.2,0,0),material:{shader:"standard",color:"#66e025",emissive:"#66e025",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"1"}}},!0),s[c]=t.Core(s.combo1Data),s.combo2Data=t.coreDataFromTemplate(s.combo0Data,{id:h,text:s.texts[2],position:new THREE.Vector3(0,0,0),material:{shader:"standard",color:"#256de0",emissive:"#256de0",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"2"}}},!0),s[h]=t.Core(s.combo2Data),s.combo3Data=t.coreDataFromTemplate(s.combo0Data,{id:p,text:s.texts[3],position:new THREE.Vector3(.2,0,0),material:{shader:"standard",color:"#e0e025",emissive:"#e0e025",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"3"}}},!0),s[p]=t.Core(s.combo3Data),s.combo4Data=t.coreDataFromTemplate(s.combo0Data,{id:d,text:s.texts[4],position:new THREE.Vector3(.4,0,0),material:{shader:"standard",color:"#e09825",emissive:"#e09825",emissiveIntensity:.25,opacity:1},components:{clickrun:{cursorObj:s.id,component:"null",method:"KeyClick",params:"4"}}},!0),s[d]=t.Core(s.combo4Data),s.comboAll={parent:{core:s.comboParent},child0:{core:s[l]},child1:{core:s[c]},child2:{core:s[h]},child3:{core:s[p]},child4:{core:s[d]}},s[r]=t.Layer(r,s.comboAll);const u=()=>{s.locked=!1,m(),g(),s.unlockedTimeout=setTimeout((()=>{s.run.component&&"null"!==s.run.component?document.getElementById(s.run.cursorObj).components[s.run.component][s.run.method](s.run.params):t[s.run.cursorObj][s.run.method](s.run.params),g(),f(),clearTimeout(s.lockedTimeout)}),2250)},m=()=>{s[r].EmitEventAll("unlocked")},y=()=>{s[r].EmitEventAll("locked")},g=()=>{s[r].GetAllChildEl().forEach((t=>t.classList.toggle("clickable")))},v=()=>{s.current=0,s.correctSoFar=!0,s.locked=!0},f=()=>{clearTimeout(s.lockedTimeout),clearTimeout(s.unlockedTimeout),s[r].DespawnLayer()};return{comboLock:s,SpawnComboLock:()=>{s.locked=!0,s[r].SpawnLayer()},DespawnComboLock:f,KeyClick:t=>{s.locked&&(t=>{s.correctSoFar&&(t===s.sequence[s.current]?s.correctSoFar=!0:s.correctSoFar=!1),s.current++,s.current>=s.sequence.length&&(s.correctSoFar?u():(v(),y(),g(),s.unlockedTimeout=setTimeout((()=>{g(),clearTimeout(s.unlockedTimeout)}),2e3)))})(t)},NewSequence:t=>{clearTimeout(s.lockedTimeout),clearTimeout(s.unlockedTimeout),s.sequence=t,v()}}},l=(t,e,i,o)=>{let a,n;e.on=!1,e.speaking=!1,e.blinking=!1,e.blinkNextText="",e.blinkText0="",e.blinkText1="",e.textDisplayInterval;let s="speech";e.type="core",e.core?(e.type="core",s=e.core.id):(e.type="layer",s=e.layer.id);let r=!1;i&&(r=i.avatar.core?"core":"layer");const l=()=>{"core"===e.type?e.GetEl().emit("skip",{}):e.GetParentEl().emit("skip",{})},c=()=>{e.speaking=!1,clearInterval(t.intervals[s]),delete t.intervals[s]},h=()=>{e.blinking=!1,clearInterval(t.intervals[s+"blink"]),delete t.intervals[s+"blink"]},p=()=>{d({name:"blinkDisplayInterval",type:"interval",id:s}),t.intervals[s+"blink"]=setInterval((()=>{e.blinking?("core"===e.type?e.GetEl().setAttribute("text",{value:e.blinkText1}):e.GetParentEl().setAttribute("text",{value:e.blinkText1}),e.blinking=!1):("core"===e.type?e.GetEl().setAttribute("text",{value:e.blinkText0}):e.GetParentEl().setAttribute("text",{value:e.blinkText0}),e.blinking=!0)}),1e3)},d=({name:e,type:i,id:o,method:a,params:n})=>{let s=e+o;"timeout"===i||"interval"===i?t.running[s]={type:i,name:e,id:o,nameId:s}:"interaction"!==i&&"event"!==i||(t.running[s]={type:i,name:e,id:o,nameId:s,method:a,params:n,event})};return{core:e,Start:()=>{let o=!1;"core"===r?o=i.avatar.GetEl():"layer"===r&&(o=i.avatar.GetParentEl()),"core"===e.type?(e.SpawnCore(o),e.GetEl().addEventListener("mouseenter",l),n=setTimeout((()=>{e.EmitEvent("loadin"),clearTimeout(a)}),25)):(e.SpawnLayer(o),e.GetParentEl().addEventListener("mouseenter",l),e.layer.all.child0.core.GetEl().addEventListener("click",t[i.id].ResetSpeech),e.layer.all.child1.core.GetEl().addEventListener("click",t[i.id].ForceResetBook),n=setTimeout((()=>{e.EmitEventAll("loadin"),clearTimeout(a)}),25)),e.on=!0},Skip:l,KillStop:()=>{c(),h(),e.on&&("core"===e.type?(e.GetEl().removeEventListener("mouseenter",l),e.EmitEvent("loadout"),a=setTimeout((()=>{e.DespawnCore(),e.on=!1,clearTimeout(a)}),1e3)):(e.GetParentEl().removeEventListener("mouseenter",l),e.EmitEventAll("loadout"),e.layer.all.child0.core.GetEl().removeEventListener("click",i.ResetSpeech),e.layer.all.child1.core.GetEl().removeEventListener("click",i.ForceResetBook),a=setTimeout((()=>{e.DespawnLayer(),e.on=!1,clearTimeout(a)}),1e3)))},ChangeCore:t=>{if("core"===e.type)if(Array.isArray(t))for(let i in t)e.ChangeSelf(t[i]);else e.ChangeSelf(t);else if(Array.isArray(t))for(let i in t)e.ChangeParent(t[i]);else e.ChangeParent(t)},DisplaySpeech:({role:o,speech:a})=>{h();let n=o+" : ",r=n,l=0;function u(){"core"===e.type?e.GetEl().setAttribute("text",{value:n+a}):e.GetParentEl().setAttribute("text",{value:n+a}),e.speaking=!1,c(),e.blink&&(e.blinkText0=n+a,e.blinkText1=n+a,i.bookEnd?e.blinkNextText=" X":e.blinkNextText=" ->",e.blinkText1+=e.blinkNextText,p()),"core"===e.type?e.GetEl().removeEventListener("skip",u):e.GetParentEl().removeEventListener("skip",u)}"core"===e.type?e.GetEl(!0).setAttribute("text",{value:r}):e.GetParentEl().setAttribute("text",{value:r}),e.speaking=!0,"core"===e.type?e.GetEl().addEventListener("skip",u):e.GetParentEl().addEventListener("skip",u),d({name:"textDisplayInterval",type:"interval",id:s}),t.intervals[s]=setInterval((()=>{l<a.length&&(r+=a[l],l++),l>=a.length&&(e.speaking=!1,"core"===e.type?e.GetEl().removeEventListener("skip",u):e.GetParentEl().removeEventListener("skip",u),c(),e.blink&&(e.blinkText0=r,e.blinkText1=r,i.bookEnd?e.blinkNextText=" X":e.blinkNextText=" ->",e.blinkText1+=e.blinkNextText,p())),e.on&&("core"===e.type?e.GetEl().setAttribute("text",{value:r}):e.GetParentEl().setAttribute("text",{value:r}))}),20)}}},c=t=>{let e={size:0,topHeight:0,bottomHeight:0,collide:{},trigger:{},triggersActive:!1,edgeSpawned:!1,edges:{}};e.edge=t.mapEdgeBasic,e.waiting=!1,e.spawnWaiting={},e.waitingMove=!1,e.moveWaiting={};const i=()=>{t.collision=!0};i();const o=()=>{if(e.collide={},t.collisionMap[0]=[],t.collisionMap[1]=[],e.topHeight>0)for(let i=0;i<e.topHeight;i++)a(t.collisionMap[0],i);if(e.bottomHeight>0)for(let i=0;i<e.bottomHeight;i++)a(t.collisionMap[1],i)},a=(t,i)=>{let o=[[],[],[],[]];o[0]=[],o[0]=Array(e.size/2).fill(0,0);for(let t in o[0])o[0][t]=Array(e.size/2).fill(0,0);o[1]=[],o[1]=Array(e.size/2).fill(0,0);for(let t in o[1])o[1][t]=Array(e.size/2).fill(0,0);o[2]=[],o[2]=Array(e.size/2).fill(0,0);for(let t in o[2])o[2][t]=Array(e.size/2).fill(0,0);o[3]=[],o[3]=Array(e.size/2).fill(0,0);for(let t in o[3])o[3][t]=Array(e.size/2).fill(0,0);t.push(o)},n=t=>{for(let i in e.collide)if(i===t.name);else for(let o in e.collide[i])if(e.collide[i][o].pos.x===t.pos.x&&e.collide[i][o].pos.y===t.pos.y&&e.collide[i][o].pos.z===t.pos.z)return!1;return!0},s=(e,i)=>{let o,a=2*e.x,n=e.y,s=2*e.z;o=n>=0?0:1,a<0&&s<0?t.collisionMap[o][n][0][-1*s][-1*a]=i:e.x>=0&&s<0?t.collisionMap[o][n][1][-1*s][a]=i:a<0&&s>=0?t.collisionMap[o][n][2][s][-1*a]=i:a>=0&&s>=0?t.collisionMap[o][n][3][s][a]=i:console.log("Update out of bounds")},r=e=>{let i=t.player.GetPlayerInfo().grid;return!(e.start.x<=i.x&&e.end.x>=i.x&&e.start.y<=i.y&&e.end.y>=i.y&&e.start.z<=i.z&&e.end.z>=i.z||t.player.layer.standing&&(i.y+=1,e.start.x<=i.x&&e.end.x>=i.x&&e.start.y<=i.y&&e.end.y>=i.y&&e.start.z<=i.z&&e.end.z>=i.z))},l=e=>{let i,o={};if(o.x=2*e.x,o.y=e.y||0,o.z=2*e.z,i=o.y>=0?0:1,o.y>=0){if(t.collisionMap[i].length<=o.y)return console.log("height out of bounds"),!t.mapEdge}else if(t.collisionMap[i].length>=-1*o.y)return console.log("height out of bounds"),!t.mapEdge;return o.x<0&&o.z<0?t.collisionMap[i][o.y][0].length>-1*o.z&&t.collisionMap[i][o.y][0][-1*o.z].length>-1*o.x?0===t.collisionMap[i][o.y][0][-1*o.z][-1*o.x]:!t.mapEdge:o.x>=0&&o.z<0?t.collisionMap[i][o.y][1].length>-1*o.z&&t.collisionMap[i][o.y][1][-1*o.z].length>o.x?0===t.collisionMap[i][o.y][1][-1*o.z][o.x]:!t.mapEdge:o.x<0&&o.z>=0?t.collisionMap[i][o.y][2].length>o.z&&t.collisionMap[i][o.y][2][o.z].length>-1*o.x?0===t.collisionMap[i][o.y][2][o.z][-1*o.x]:!t.mapEdge:o.x>=0&&o.z>=0&&(t.collisionMap[i][o.y][3].length>o.z&&t.collisionMap[i][o.y][3][o.z].length>o.x?0===t.collisionMap[i][o.y][3][o.z][o.x]:!t.mapEdge)},c=()=>{if(e.triggers={},t.triggerMap[0]=[],t.triggerMap[1]=[],e.topHeight>0)for(let i=0;i<e.topHeight;i++)a(t.triggerMap[0],i);if(e.bottomHeight>0)for(let i=0;i<e.bottomHeight;i++)a(t.triggerMap[1],i)},h=t=>{e.trigger[t.name]||(e.trigger[t.name]={}),e.trigger[t.name]["space"+t.spaces]={},e.trigger[t.name]["space"+t.spaces].pos=t.pos},p=t=>{delete e.trigger[t]},d=t=>{for(let i in e.trigger)if(i===t.name);else for(let o in e.trigger[i])if(e.trigger[i][o].pos.x===t.pos.x&&e.trigger[i][o].pos.y===t.pos.y&&e.trigger[i][o].pos.z===t.pos.z)return!1;return!0},u=(e,i)=>{let o,a=2*e.x,n=e.y,s=2*e.z;o=e.y>=0?0:1,a<0&&s<0?t.triggerMap[o][n][0][-1*s][-1*a]=i:e.x>=0&&s<0?t.triggerMap[o][n][1][-1*s][a]=i:a<0&&s>=0?t.triggerMap[o][n][2][s][-1*a]=i:a>=0&&s>=0?t.triggerMap[o][n][3][s][a]=i:console.log("Update out of bounds")},m=(i,o)=>{t[i.name]?o?e.trigger[i.name].active||(t[i.name].EmitEvent?t[i.name].EmitEvent("triggerEnter"):t[i.name].EmitEventParent&&t[i.name].EmitEventParent("triggerEnter"),e.trigger[i.name].active=!0):e.trigger[i.name].active&&(t[i.name].EmitEvent?t[i.name].EmitEvent("triggerExit"):t[i.name].EmitEventParent&&t[i.name].EmitEventParent("triggerExit"),e.trigger[i.name].active=!1):(console.log(i.name),console.log("Trigger is not an AUXL object"))};return{grid:e,BuildMap:(t,i)=>{e.size=t,e.topHeight=i.top||2,e.bottomHeight=i.bottom||0,o(),c()},BlankMap:o,UpdateMap:s,UpdateMapArea:(t,i,o,a)=>{let r,l,c,h,p,d,u,m={x:i.x,y:i.y,z:i.z},y=0;u=a?1:0,i.y===o.y?c=1:(c=Math.abs(i.y)+Math.abs(o.y),c+=1),m.y=i.y,h=c;for(let a=0;a<c;a++){i.z===o.z?p=1:(p=i.z-o.z,p*=2,p<0&&(p*=-1),p+=1),m.z=i.z,d=p;for(let a=0;a<p;a++){i.x===o.x?r=1:(r=i.x-o.x,r*=2,r<0&&(r*=-1),r+=1),m.x=i.x,l=r;for(let i=0;i<r;i++)0===u?(n({name:t,pos:{x:m.x,y:m.y,z:m.z}})&&s(m,u),y++):1===u&&(s(m,u),y++,g={name:t,spaces:y,pos:{x:m.x,y:m.y,z:m.z}},e.collide[g.name]||(e.collide[g.name]={}),e.collide[g.name]["space"+g.spaces]={},e.collide[g.name]["space"+g.spaces].pos=g.pos),l--,l>0&&(m.x+=.5);d--,d>0&&(m.z+=.5)}h--,h>0&&(m.y+=1)}var g;0===u&&(t=>{delete e.collide[t]})(t)},EnableCollision:i,DisableCollision:()=>{t.collision=!1},CheckMapObstacles:l,CheckMapObstaclesDiagonal:(e,i)=>{let o,a={};a.x=i.x,a.y=i.y,a.z=i.z,a.x*=2,a.z*=2,o=a.y>=0?0:1;let n,s,r,l={};if(l.x=e.x,l.y=e.y,l.z=e.z,l.x*=2,l.z*=2,n=l.y>=0?0:1,l.x===a.x&&l.z===a.z?s="same":l.x===a.x||l.z===a.z?l.x===a.x?s="z":l.z===a.z&&(s="x"):s=l.x>a.x?l.z>a.z?"reverseRight":"forwardRight":l.z>a.z?"reverseLeft":"forwardLeft",r=l.y===a.y?"same":l.y>a.y?"up":"down",l.y>=0){if(t.collisionMap[o].length<=l.y)return console.log("height out of bounds"),!t.mapEdge}else if(t.collisionMap[o].length>=-1*l.y)return console.log("height out of bounds"),!t.mapEdge;function c(e,i,o,a,n){if(void 0===t.collisionMap[e][a])0===e?a<0&&("undefined"===t.collisionMap[1]||c(1,i,o,-1*a,n)):1===e&&a<0&&("undefined"===t.collisionMap[0]||c(0,i,o,-1*a,n));else if(void 0===t.collisionMap[e][a][i][n])0===i?n<0&&c(e,2,o,a,-1*n):1===i?n<0&&c(e,3,o,a,-1*n):2===i?n<0&&c(e,0,o,a,-1*n):3===i&&n<0&&c(e,1,o,a,-1*n);else{if(void 0!==t.collisionMap[e][a][i][n][o])return t.collisionMap[e][a][i][n][o];0===i?o<0&&c(e,1,-1*o,a,n):1===i?o<0&&c(e,0,-1*o,a,n):2===i?o<0&&c(e,3,-1*o,a,n):3===i&&o<0&&c(e,2,-1*o,a,n)}}return l.x<0&&l.z<0?t.collisionMap[n][l.y][0].length>-1*l.z&&t.collisionMap[n][l.y][0][-1*l.z].length>-1*l.x?0===c(n,0,-1*l.x,l.y,-1*l.z)&&("forwardRight"===s?0===c(n,0,-1*l.x,l.y,-1*l.z+1)||0===c(n,0,-1*l.x-1,l.y,-1*l.z):"forwardLeft"===s?0===c(n,0,-1*l.x,l.y,-1*l.z+1)||0===c(n,0,-1*l.x+1,l.y,-1*l.z):"reverseRight"===s?0===c(n,0,-1*l.x,l.y,-1*l.z-1)||0===c(n,0,-1*l.x-1,l.y,-1*l.z):"reverseLeft"!==s||0===c(n,0,-1*l.x,l.y,-1*l.z-1)||0===c(n,0,-1*l.x+1,l.y,-1*l.z)):!t.mapEdge:l.x>=0&&l.z<0?t.collisionMap[n][l.y][1].length>-1*l.z&&t.collisionMap[n][l.y][1][-1*l.z].length>l.x?0===c(n,1,l.x,l.y,-1*l.z)&&("forwardRight"===s?0===c(n,1,l.x,l.y,-1*l.z+1)||0===c(n,1,l.x-1,l.y,-1*l.z):"forwardLeft"===s?0===c(n,1,l.x,l.y,-1*l.z+1)||0===c(n,1,l.x+1,l.y,-1*l.z):"reverseRight"===s?0===c(n,1,l.x,l.y,-1*l.z-1)||0===c(n,1,l.x-1,l.y,-1*l.z):"reverseLeft"!==s||0===c(n,1,l.x,l.y,-1*l.z-1)||0===c(n,1,l.x+1,l.y,-1*l.z)):!t.mapEdge:l.x<0&&l.z>=0?t.collisionMap[n][l.y][2].length>l.z&&t.collisionMap[n][l.y][2][l.z].length>-1*l.x?0===c(n,2,-1*l.x,l.y,l.z)&&("forwardRight"===s?0===c(n,2,-1*l.x,l.y,l.z+1)||0===c(n,2,-1*l.x-1,l.y,l.z):"forwardLeft"===s?0===c(n,2,-1*l.x,l.y,l.z+1)||0===c(n,2,-1*l.x+1,l.y,l.z):"reverseRight"===s?0===c(n,2,-1*l.x,l.y,l.z-1)||0===c(n,2,-1*l.x-1,l.y,l.z):"reverseLeft"!==s||0===c(n,2,-1*l.x,l.y,l.z-1)||0===c(n,2,-1*l.x+1,l.y,l.z)):!t.mapEdge:l.x>=0&&l.z>=0&&(t.collisionMap[n][l.y][3].length>l.z&&t.collisionMap[n][l.y][3][l.z].length>l.x?0===c(n,3,l.x,l.y,l.z)&&("forwardRight"===s?0===c(n,3,l.x,l.y,l.z+1)||0===c(n,3,l.x-1,l.y,l.z):"forwardLeft"===s?0===c(n,3,l.x,l.y,l.z+1)||0===c(n,3,l.x+1,l.y,l.z):"reverseRight"===s?0===c(n,3,l.x,l.y,l.z-1)||0===c(n,3,l.x-1,l.y,l.z):"reverseLeft"!==s||0===c(n,3,l.x,l.y,l.z-1)||0===c(n,3,l.x+1,l.y,l.z)):!t.mapEdge)},CheckMapObstaclesArea:(t,e)=>{let i,o,a,n,s={x:t.x,z:t.z};if(t.z===e.z?a=1:(a=t.z-e.z,a*=2,a<0&&(a*=-1),a+=1),s.z=t.z,n=a,!r({start:t,end:e}))return console.log("Hit Player"),!1;for(let r=0;r<a;r++){t.x===e.x?i=1:(i=t.x-e.x,i*=2,i<0&&(i*=-1),i+=1),s.x=t.x,o=i;for(let t=0;t<i;t++){if(!l(s))return console.log("Hit Object"),console.log(s),!1;o--,o>0&&(s.x+=.5)}n--,n>0&&(s.z+=.5)}return!0},CheckMapAreaSansArea:(t,e,i)=>{let o,a,n,s,c,h,p=((t,e,i)=>{let o,a,n,s,r,l,c={x:t.x,y:t.y,z:t.z},h=[],p=Math.abs(t.y)+Math.abs(e.y)+i;for(let t=0;t<p+1;t++)h.push(new Array);t.y===e.y?n=1:(n=Math.abs(t.y)+Math.abs(e.y),n+=1),c.y=t.y,s=n;for(let i=0;i<n;i++){t.z===e.z?r=1:(r=t.z-e.z,r*=2,r<0&&(r*=-1),r+=1),c.z=t.z,l=r;for(let i=0;i<r;i++){t.x===e.x?o=1:(o=t.x-e.x,o*=2,o<0&&(o*=-1),o+=1),c.x=t.x,a=o;for(let t=0;t<o;t++)h[c.y].push({x:c.x,z:c.z}),a--,a>0&&(c.x+=.5);l--,l>0&&(c.z+=.5)}s--,s>0&&(c.y+=1)}return h})(t.start,t.end,i),d=!1,u={x:e.start.x,y:e.start.y,z:e.start.z};if(!r(e))return!1;e.start.y===e.end.y?n=1:(n=Math.abs(e.start.y)+Math.abs(e.end.y),n+=1),u.y=e.start.y,s=n;for(let t=0;t<n;t++){e.start.z===e.end.z?c=1:(c=e.start.z-e.end.z,c*=2,c<0&&(c*=-1),c+=1),u.z=e.start.z,h=c;for(let t=0;t<c;t++){e.start.x===e.end.x?o=1:(o=e.start.x-e.end.x,o*=2,o<0&&(o*=-1),o+=1),u.x=e.start.x,a=o;for(let t=0;t<o;t++){for(let t in p[u.y])if(u.x===p[u.y][t].x&&u.z===p[u.y][t].z){d=!0;break}if(d);else if(!l(u))return!1;d=!1,a--,a>0&&(u.x+=.5)}h--,h>0&&(u.z+=.5)}s--,s>0&&(u.y+=1)}return!0},SpawnEdges:i=>{var o;i&&(o=i,e.edge.core.material=o);let a=e.size/4+1,n=e.size/2+2.5;e.edges.northEdge=t.coreFromTemplate(e.edge,{id:"northEdge",geometry:{primitive:"box",depth:.5,width:n,height:.5},position:new THREE.Vector3(0,.25,-1*a)},!0),e.edges.northEdge.SpawnCore(),e.edges.southEdge=t.coreFromTemplate(e.edge,{id:"southEdge",geometry:{primitive:"box",depth:.5,width:n,height:.5},position:new THREE.Vector3(0,.25,a)},!0),e.edges.southEdge.SpawnCore(),e.edges.westEdge=t.coreFromTemplate(e.edge,{id:"westEdge",geometry:{primitive:"box",depth:n,width:.5,height:.5},position:new THREE.Vector3(-1*a,.25,0)},!0),e.edges.westEdge.SpawnCore(),e.edges.eastEdge=t.coreFromTemplate(e.edge,{id:"eastEdge",geometry:{primitive:"box",depth:n,width:.5,height:.5},position:new THREE.Vector3(a,.25,0)},!0),e.edges.eastEdge.SpawnCore(),e.edgeSpawned=!0},DespawnEdges:t=>{e.edges.northEdge.DespawnCore(),delete e.edges.northEdge,e.edges.southEdge.DespawnCore(),delete e.edges.southEdge,e.edges.westEdge.DespawnCore(),delete e.edges.westEdge,e.edges.eastEdge.DespawnCore(),delete e.edges.eastEdge,e.edgeSpawned=!1},UpdateEdge:t=>{e.edge=t},BlankMapTrigger:c,OnMapTrigger:h,OffMapTrigger:p,CheckMapOverlapTrigger:d,UpdateMapAreaTrigger:(t,e,i,o)=>{let a,n,s,r,l,c,m,y={x:e.x,y:e.y,z:e.z},g=0;m=o?1:0,e.y===i.y?s=1:(s=Math.abs(e.y)+Math.abs(i.y),s+=1),y.y=e.y,r=s;for(let o=0;o<s;o++){e.z===i.z?l=1:(l=e.z-i.z,l*=2,l<0&&(l*=-1),l+=1),y.z=e.z,c=l;for(let o=0;o<l;o++){e.x===i.x?a=1:(a=e.x-i.x,a*=2,a<0&&(a*=-1),a+=1),y.x=e.x,n=a;for(let e=0;e<a;e++)0===m?(d({name:t,pos:{x:y.x,y:y.y,z:y.z}})&&u(y,m),g++):1===m&&(u(y,m),g++,h({name:t,spaces:g,pos:{x:y.x,y:y.y,z:y.z}})),n--,n>0&&(y.x+=.5);c--,c>0&&(y.z+=.5)}r--,r>0&&(y.y+=1)}0===m&&p(t)},UpdateMapTrigger:u,CheckMapTriggers:e=>{let i,o={};if(o.x=2*e.x,o.y=e.y,o.z=2*e.z,i=o.y>=0?0:1,o.x<0&&o.z<0){if(t.triggerMap[i][o.y][0].length>-1*o.z&&t.triggerMap[i][o.y][0][-1*o.z].length>-1*o.x)return 1===t.triggerMap[i][o.y][0][-1*o.z][-1*o.x]}else if(o.x>=0&&o.z<0){if(t.triggerMap[i][o.y][1].length>-1*o.z&&t.triggerMap[i][o.y][1][-1*o.z].length>o.x)return 1===t.triggerMap[i][o.y][1][-1*o.z][o.x]}else if(o.x<0&&o.z>=0){if(t.triggerMap[i][o.y][2].length>o.z&&t.triggerMap[i][o.y][2][o.z].length>-1*o.x)return 1===t.triggerMap[i][o.y][2][o.z][-1*o.x]}else{if(!(o.x>=0&&o.z>=0))return!1;if(t.triggerMap[i][o.y][3].length>o.z&&t.triggerMap[i][o.y][3][o.z].length>o.x)return 1===t.triggerMap[i][o.y][3][o.z][o.x]}},TriggerEnterHit:t=>{let i=[];for(let o in e.trigger)for(let a in e.trigger[o])"active"===a||e.trigger[o][a].pos.x===t.x&&e.trigger[o][a].pos.z===t.z&&i.push({name:o,pos:e.trigger[o][a]});if(i.length>0){e.triggersActive=!0;for(let t in i)m(i[t],!0)}},CheckActiveTriggers:t=>{if(e.triggersActive){let i=!1,o=!1;for(let i in e.trigger)if(o=!1,e.trigger[i].active){for(let a in e.trigger[i])e.trigger[i][a].pos&&e.trigger[i][a].pos.x===t.x&&e.trigger[i][a].pos.z===t.z&&(o=!0);o||m({name:i},!1)}i&&(e.triggersActive=!1)}},ClearTriggers:()=>{for(let t in e.trigger)for(let i in e.trigger[t])"active"===i&&(e.trigger[t][i]=!1);e.triggersActive=!1},WaitToSpawn:t=>{e.waiting||(e.waiting=!0),e.spawnWaiting[t.name]=t},WaitingToSpawn:()=>{if(e.waiting)for(let o in e.spawnWaiting)t[o][e.spawnWaiting[o].func](),t[o].inScene&&(i=o,delete e.spawnWaiting[i],0===Object.keys(e.spawnWaiting).length&&(e.waiting=!1));var i},ClearWaiting:()=>{e.waiting=!1,e.spawnWaiting={}},MoveToGrid:(e,i)=>{console.log(e),console.log(i),console.log(t[i.id])},PathOnGrid:t=>{}}};AFRAME.registerSystem("auxl",{schema:{id:{type:"string",default:"#FFFFFF"},color:{type:"string",default:"#FFFFFF"},shortname:{type:"string",default:"#FFFFFF"},longname:{type:"string",default:"#FFFFFF"},server:{type:"string",default:"localhost"},onlineKey:{type:"string",default:"FFFFFF"}},init:function(){const i=this;this.expStarted=!1,this.defaultWorld,this.currentWorld,this.currentZone,this.worldLoaded=!1,this.local={},this.local.profile={},this.rebuildObjects=[],this.volume=1,this.backgroundAudio=!1,this.checkSceneLoadThrottled=AFRAME.utils.throttle(this.checkSceneLoad,30,this),this.sceneReading=!1,this.loadingScene=!1,this.loadingObjects=new Map,this.maxLoadTime=5e3,this.jsLoaded={},this.jsAll={"look-at":"https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js","gltf-morph":"https://rawcdn.githack.com/elbobo/aframe-gltf-morph-component/07e9b80bd382cc1c19223468d35c453e7c76e9a2/dist/aframe-gltf-morph-component.js"},document.querySelector("a-scene"),document.querySelector("head");const h=document.querySelector("body"),p=document.getElementById("stickyMenu"),d=document.getElementById("stickyTitle"),u=document.getElementById("systemText"),m=document.getElementById("beginDiv"),y=document.getElementById("startButton"),g=document.getElementById("menuModeButton"),v=document.getElementById("audioButton"),f=document.getElementById("audioVolume"),b=document.getElementById("volDownButton"),w=document.getElementById("volume"),E=document.getElementById("volUpButton"),x=document.getElementById("viewInfo"),D=document.getElementById("viewData"),T=document.getElementById("expInfo"),R=document.getElementById("infoClose"),M=document.getElementById("instructions"),P=document.getElementById("dataInfo"),k=document.getElementById("dataClose"),S=document.getElementById("manageData"),C=document.getElementById("resetData"),L=document.getElementById("scenarioHeaderTitle"),z=document.getElementById("scenarioMenuTitle"),N=document.getElementById("controllerBlock"),I=document.getElementById("vrHandButton"),H=document.getElementById("vrLocomotionType"),F=document.getElementById("upLeft"),O=document.getElementById("up"),A=document.getElementById("upRight"),j=document.getElementById("left"),V=document.getElementById("center"),B=document.getElementById("right"),U=document.getElementById("downLeft"),G=document.getElementById("down"),q=document.getElementById("downRight"),W=document.getElementById("select"),_=document.getElementById("start"),J=document.getElementById("a"),K=document.getElementById("b"),X=document.getElementById("c"),Z=document.getElementById("d"),Y=document.getElementById("e"),Q=document.getElementById("f"),$=document.getElementById("l"),tt=document.getElementById("r");let et=[h,m,y,g,v,x,D,T,R,M,z,P,k,S,C,N,I,H],it=[p,d,L,N,F,O,A,j,V,B,U,G,q,W,_,J,K,X,Z,Y,Q,$,tt];this.systemLoaded=t=>{pt(t),i.player.infoText="Player : "+i.local.profile.shortname+"\n",ot(),at()};const ot=()=>{i.map=i.Collision()},at=()=>{nt(),st(),rt(this.local.profile.systemText)},nt=()=>{for(let t in et)et[t].style.setProperty("background-color",this.local.profile.colorScheme.base),et[t].style.setProperty("color-text",this.local.profile.colorScheme.compl);for(let t in it)it[t].style.setProperty("background-color","transparent"),it[t].style.setProperty("color-text",this.local.profile.colorScheme.compl),it[t].style.setProperty("border-color",this.local.profile.colorScheme.compl);i.cameraUI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.cameraUI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.playerFloor.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.playerFloor.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.vrController1UI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.vrController1UI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}}),i.vrController2UI.ChangeSelf({property:"material",value:{color:this.local.profile.colorScheme.base}}),i.vrController2UI.ChangeSelf({property:"text",value:{color:this.local.profile.colorScheme.compl}})},st=()=>{u.innerHTML=this.systemText,i.player.UpdateBeltText(this.systemText),i.cameraUI.ChangeSelf({property:"text",value:{value:this.systemText}}),i.vrController1UI.ChangeSelf({property:"text",value:{value:this.systemText}}),i.vrController2UI.ChangeSelf({property:"text",value:{value:this.systemText}})},rt=t=>{this.systemText=t,st()};this.toBeRebuilt=t=>{i.rebuildObjects.push(t)},this.SceneLoadTimeout=()=>{i.sceneLoadTimeout=setTimeout((()=>{i.loadingObjects=new Map,clearTimeout(i.sceneLoadTimeout)}),i.maxLoadTime)},this.save="auxl"+window.location.pathname;const lt=()=>{this.local={},this.local.profile={},this.local.profile.domain=window.location.hostname,this.local.profile.page=window.location.pathname,this.local.profile.controls=this.controls,this.local.profile.vrHand=this.vrHand,this.local.profile.volume=this.volume,this.local.profile.time={},this.local.profile.time.creation=ut(),this.local.profile.time.lastVisit=ut(),this.local.profile.colorScheme=i.colorTheoryGen(),this.local.profile.id=this.local.profile.colorScheme.base,this.local.profile.color=this.local.profile.colorScheme.base,this.local.profile.shortname=this.local.profile.colorScheme.base,this.local.profile.longname=this.data.longname,this.local.profile.server=this.data.server,this.local.profile.onlineKey=this.data.onlineKey,this.local.profile.systemText="Welcome "+this.local.profile.shortname,this.systemText=this.local.profile.systemText,this.local.location={},this.local.location.load=!1,this.local.location.world="",this.local.location.scenario="",this.local.location.zone="",this.local.location.scene=""},ct=()=>{console.log("New here. Loading default data."),window.localStorage.clear(),lt(),(()=>{clearTimeout(i.sceneLoadTimeout),i.comp.ClearInventoryNotifications(),i.player.Reset();for(let t in i.rebuildObjects)i[i.rebuildObjects[t]]()})(),window.localStorage.setItem(this.save,JSON.stringify(i.local)),at(),vt(this.local.profile.vrHand),gt(this.local.profile.controls),ft()},ht=()=>{console.log("Loading previous data."),this.local=JSON.parse(window.localStorage.getItem(this.save)),at(),this.local.profile.time.return=ut(),this.local.profile.time.span=function(t,e){let i={},o={},a=36e5,n=864e5,s=26298e5;function r(t){let e={};return e.ms=t,e.seconds=Math.floor(e.ms/1e3),e.minutes=Math.floor(e.seconds/60),e.hours=Math.floor(e.minutes/60),e.days=Math.floor(e.hours/24),e.months=Math.floor(e.days/(365/12)),e.years=Math.floor(e.months/12),e}o.total=e.ms-t.ms;let l=e.ms-t.ms;return i=r(l),l-=315576e5*i.years,o.years=i.years,i=r(l),l-=i.months*s,o.months=i.months,i=r(l),l-=i.days*n,o.days=i.days,i=r(l),l-=i.hours*a,o.hours=i.hours,i=r(l),l-=6e4*i.minutes,o.minutes=i.minutes,i=r(l),l-=1e3*i.seconds,o.seconds=i.seconds,i=r(l),l-=1*i.ms,o.ms=i.ms,i=r(l),o}(this.local.profile.time.lastVisit,this.local.profile.time.return),console.log("Time since last visit :"),console.log(this.local.profile.time.span),this.local.profile.time.lastVisit=this.local.profile.time.return,""===this.local.location.world||""===this.local.location.scenario||""===this.local.location.zone||""===this.local.location.scene?this.local.location.load=!1:this.local.location.load=!0,i.saveToProfile(),dt(),vt(this.local.profile.vrHand),gt(this.local.profile.controls),ft(),this.volume=this.local.profile.volume},pt=t=>{t?ct():localStorage.getItem(this.save)?ht():ct()};this.saveToProfile=t=>{t&&(i.local[t.auxlObject]?t.sub?(i.local[t.auxlObject][t.type][t.sub]||(i.local[t.auxlObject][t.type][t.sub]={}),i.local[t.auxlObject][t.type][t.sub][t.name]=t.data):i.local[t.auxlObject][t.type][t.name]=t.data:(i.local[t.auxlObject]={},i.local[t.auxlObject][t.type]={},t.sub?(i.local[t.auxlObject][t.type][t.sub]={},i.local[t.auxlObject][t.type][t.sub][t.name]=t.data):i.local[t.auxlObject][t.type][t.name]=t.data)),window.localStorage.setItem(this.save,JSON.stringify(i.local))};const dt=()=>{console.log(i.local);for(let t in i.local)if("profile"===t||"location"===t);else for(let e in i.local[t])for(let o in i.local[t][e])i[t]&&(i[t][e][o]=i.local[t][e][o])};function ut(){let t={};return t.time=new Date,t.year=t.time.getFullYear(),t.month=t.time.getMonth(),t.date=t.time.getDate(),t.day=t.time.getDay(),t.hour=t.time.getHours(),t.minute=t.time.getMinutes(),t.second=t.time.getSeconds(),t.ms=t.time.getTime(),t}function mt(){i.menuOpen?(m.style.display="none",i.menuOpen=!1,i.infoOpen&&bt(),i.backgroundAudio&&!i.playerAudio.core.inScene&&i.playerAudio.SpawnCore(i.playerRig)):(m.style.display="flex",i.menuOpen=!0)}function yt(){i.vrController1.GetEl().setAttribute("visible",!1),i.vrController2.GetEl().setAttribute("visible",!1),i.vrController1UI.GetEl().setAttribute("visible",!1),i.vrController2UI.GetEl().setAttribute("visible",!1),i.vrController1.GetEl().removeAttribute("cursor"),i.vrController2.GetEl().removeAttribute("cursor"),i.vrController1.GetEl().removeAttribute("laser-controls"),i.vrController2.GetEl().removeAttribute("laser-controls")}function gt(t){"Desktop"===i.controls?yt():"Mobile"===i.controls?(i.mouseController.GetEl().setAttribute("visible",!1),i.mouseController.GetEl().removeAttribute("raycaster"),i.mouseController.GetEl().removeAttribute("cursor"),N.style.display="none"):"VR"===i.controls&&(I.style.display="none",H.style.display="none",yt()),"Desktop"===t?(g.innerHTML="Mode : Desktop",i.mouseController.GetEl().setAttribute("visible",!0),i.mouseController.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),i.mouseController.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"mouseController",mouseCursorStylesEnabled:"true"}),i.playerRig.GetEl().setAttribute("universal-controls",{update:0}),i.player.EnableDesktopLocomotion(),i.locomotionText="WASD Keys"):"Mobile"===t?(g.innerHTML="Mode : Mobile",i.mouseController.GetEl().setAttribute("visible",!0),i.mouseController.GetEl().setAttribute("raycaster",{enabled:"true",autoRefresh:"true",objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"}),i.mouseController.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"mouseController",mouseCursorStylesEnabled:"true"}),N.style.display="flex",i.playerRig.GetEl().setAttribute("universal-controls",{update:6}),i.player.EnableMobileLocomotion(),i.locomotionText="Arrow Buttons"):"VR"===t&&(g.innerHTML="Mode : VR",I.style.display="flex",H.style.display="flex","bothRight"===i.vrHand?(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("universal-controls",{update:1}),i.player.EnableVRLocomotion(),i.locomotionText="Left Controller Joystick"):"bothLeft"===i.vrHand?(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!1,autoRefresh:!1,objects:".disabled",far:0,near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!1,useWorldCoordinates:!1}),i.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("universal-controls",{update:2}),i.player.EnableVRLocomotion(),i.locomotionText="Right Controller Joystick"):"bothRightLoco"===i.vrHand||"bothLeftLoco"===i.vrHand?(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:"false"}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),vrController1.setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),i.vrController2.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("universal-controls",{update:3}),i.player.EnableVRLocomotion(),"bothLeftLoco"===i.vrHand?i.locomotionText="Left Controller Joystick":"bothRightLoco"===i.vrHand&&(i.locomotionText="Right Controller Joystick")):"right"===i.vrHand?(i.vrController2.GetEl().setAttribute("visible",!0),i.vrController2.GetEl().setAttribute("laser-controls",{hand:"right"}),i.vrController2.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController2.GetEl().setAttribute("cursor",{fuse:"false",rayOrigin:"vrController2",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("universal-controls",{update:4}),i.player.EnableVRHoverLocomotion("vrController2"),i.locomotionText="Hover on Forward/Backward Belt."):"left"===i.vrHand&&(i.vrController1.GetEl().setAttribute("visible",!0),i.vrController1.GetEl().setAttribute("laser-controls",{hand:"left"}),i.vrController1.GetEl().setAttribute("raycaster",{enabled:!0,autoRefresh:!0,objects:".clickable",far:"Infinity",near:0,interval:0,lineColor:"#228da7",lineOpacity:.5,showLine:!0,useWorldCoordinates:!1}),i.vrController1.GetEl().setAttribute("cursor",{fuse:!1,rayOrigin:"vrController1",mouseCursorStylesEnabled:!0}),i.playerRig.GetEl().setAttribute("universal-controls",{update:5}),i.player.EnableVRHoverLocomotion("vrController1"),i.locomotionText="Hover on Forward/Backward Belt.")),i.controls=t,ft()}function vt(t){"bothRight"===t?I.innerHTML="2 Hands : Right Ray | Left Move":"bothLeft"===t?I.innerHTML="2 Hands : Left Ray | Right Move":"bothLeftLoco"===t?I.innerHTML="2 Hands : Dual Ray | Left Move":"bothRightLoco"===t?I.innerHTML="2 Hands : Dual Ray | Right Move":"right"===t?I.innerHTML="1 Hand : Right Ray | Belt Move":"left"===t&&(I.innerHTML="1 Hand : Left Ray | Belt Move"),i.vrHand=t}function ft(){i.UpdateControlText(),i.local.profile.controls=i.controls,i.local.profile.vrHand=i.vrHand,i.saveToProfile()}function bt(){i.infoOpen?(T.style.display="none",i.infoOpen=!1):(T.style.display="flex",i.infoOpen=!0)}function wt(){i.dataOpen?(P.style.display="none",i.dataOpen=!1):(P.style.display="flex",i.dataOpen=!0)}this.universalControls,this.controls="Desktop",this.vrHand="bothRight",this.directionType="camera",this.locomotionText="WASD Keys",this.joystickLoco=8,this.joystickRot=8,this.controlsInfo={},this.controlsText="",this.menuOpen=!0,this.infoOpen=!1,this.dataOpen=!1,this.audioEnabled=!1,this.mobilePermissionGranted=!1,this.spawned={},this.scenarioSpawned={},this.zoneSpawned={},this.nodeSpawned={},this.bookSpawned={},this.spawnedWaitingForJS={},this.objGenTracking={core:{type:"core",spawn:"SpawnCore",despawn:"DespawnCore",altSpawn:"SpawnCoreOnGrid"},layer:{type:"layer",spawn:"SpawnLayer",despawn:"DespawnLayer",altSpawn:"SpawnLayerOnGrid"},menu:{type:"menu",spawn:"SpawnMenu",despawn:"DespawnMenu"},multiMenu:{type:"multiMenu",spawn:"SpawnMultiMenu",despawn:"DespawnMultiMenu"},singleGen:{type:"singleGen",spawn:"SpawnObjRing",despawn:"DespawnObjRing"},multiGen:{type:"multiGen",spawn:"SpawnMultiAsset",despawn:"DespawnMultiAsset"},comp:{type:"comp",spawn:"SpawnComp",despawn:"DespawnComp"},teleport:{type:"teleport",spawn:"SpawnTeleport",despawn:"DespawnTeleport"},npc:{type:"npc",spawn:"SpawnNPC",despawn:"DespawnNPC"},speechSystem:{type:"speechSystem",spawn:"SpawnSpeech",despawn:"DespawnSpeech"},book:{type:"book",spawn:"SpawnBook",despawn:"DespawnBook"},horizon:{type:"horizon",spawn:"SpawnHorizon",despawn:"DespawnHorizon"},skyBox:{type:"skyBox",spawn:"SpawnSkyBox",despawn:"DespawnSkyBox"},gridLayout:{type:"gridLayout",spawn:"SpawnGridLayout",despawn:"DespawnGridLayout"},gate:{type:"gate",spawn:"SpawnGate",despawn:"DespawnGate"},imageSwapper:{type:"imageSwapper",spawn:"SpawnImgSwap",despawn:"DespawnImgSwap"},imageCarousel:{type:"imageCarousel",spawn:"SpawnImgCarousel",despawn:"DespawnImgCarousel"},comboLock:{type:"comboLock",spawn:"SpawnComboLock",despawn:"DespawnComboLock"},highScoreBoard:{type:"highScoreBoard",spawn:"SpawnBoard",despawn:"DespawnBoard"},memory:{type:"memory",spawn:"SpawnMemGame",despawn:"DespawnMemGame"},swipeLaunch:{type:"swipeLaunch",spawn:"SpawnSLGame",despawn:"DespawnSLGame"},guessHit:{type:"guessHit",spawn:"SpawnGHGame",despawn:"DespawnGHGame"},dragDiffuse:{type:"dragDiffuse",spawn:"SpawnDDGame",despawn:"DespawnDDGame"},sharpShooter:{type:"sharpShooter",spawn:"SpawnSSGame",despawn:"DespawnSSGame"},perfectScale:{type:"perfectScale",spawn:"SpawnPSGame",despawn:"DespawnPSGame"},reflex7:{type:"reflex7",spawn:"SpawnR7Game",despawn:"DespawnR7Game"},tapIt:{type:"tapIt",spawn:"SpawnTIGame",despawn:"DespawnTIGame"},popPop:{type:"popPop",spawn:"SpawnPPGame",despawn:"DespawnPPGame"},hordeHalt:{type:"hordeHalt",spawn:"SpawnHHGame",despawn:"DespawnHHGame"}},this.AddObjGenToTracker=(t,e,o,a)=>{i.objGenTracking[t]={},i.objGenTracking[t].type=t,i.objGenTracking[t].spawn=e,i.objGenTracking[t].altSpawn=e,i.objGenTracking[t].despawn=o},this.spawnTracker=(t,e,o)=>{let a,n,s;if(a="scenario"===e?"scenarioSpawned":"zone"===e?"zoneSpawned":"node"===e?"nodeSpawned":"book"===e?"bookSpawned":"nodeSpawned",i[t]){for(let e in i.objGenTracking)if(i[t][i.objGenTracking[e].spawn]||i[t][i.objGenTracking[e].altSpawn]){n=i.objGenTracking[e].type,s=i[t][n].id;break}n||console.log("Tracker type error")}"book"===e?(i[a][o]||(i[a][o]={}),i[a][o][s]={type:n,obj:t}):i[a][s]={type:n,obj:t}},this.clearSpawned=t=>{for(let e in t)i[e]?i[e][i.objGenTracking[t[e].type].despawn]():t[e].parent?t[e].parent[e][i.objGenTracking[t[e].type].despawn]():i[e].obj[i.objGenTracking[t[e].type].despawn](),delete t[e]},this.RemoveFromTracker=(t,e)=>{i.scenarioSpawned[t]?delete i.scenarioSpawned[t]:i.zoneSpawned[t]?delete i.zoneSpawned[t]:i.nodeSpawned[t]?delete i.nodeSpawned[t]:i.bookSpawned[t]&&delete i.bookSpawned[bookName][t]},this.ExistsInTracker=(t,e)=>{let o=e||!1;return!!i.scenarioSpawned[t]||!!i.zoneSpawned[t]||!!i.nodeSpawned[t]||!!o&&!!i.bookSpawned[o][t]&&void delete i.bookSpawned[o][t]},this.running={},this.zoneRunning={},this.scenarioRunning={},this.timeouts={},this.intervals={},this.interactions={},this.events={},this.timeInDay=36e4,this.physics=!1,this.collisionMap=[[],[]],this.triggerMap=[[],[]],this.mapEdge=!1,p.addEventListener("click",mt),y.addEventListener("click",(function(){i.worldLoaded||(""===i.local.location.world?i.defaultWorld.StartWorld():i[i.local.location.world].StartWorld(),y.innerHTML="Resume",ft(),i.worldLoaded=!0),mt()})),this.UpdateControlText=()=>{i.controlsText="Control Configuration : "+i.controls+" mode\n",i.controlsText+="Movement | "+i.locomotionText+"\n";let t="";for(let e in i.controlsInfo)"altDown"===e?"Desktop"===i.controls?t="Mouse Right Click":"Mobile"===i.controls?t="Middle Directional Button":"VR"===i.controls&&(t="Grip"):"altUp"===e||("action1Down"===e?"Desktop"===i.controls?t=i.controlConfig.action1Keys[1]+" Key":"Mobile"===i.controls?t="A Button":"VR"===i.controls&&(t="X Button"):"action1Up"===e||("action2Down"===e?"Desktop"===i.controls?t=i.controlConfig.action2Keys[1]+" Key":"Mobile"===i.controls?t="B Button":"VR"===i.controls&&(t="Y Button"):"action2Up"===e||("action3Down"===e?"Desktop"===i.controls?t=i.controlConfig.action3Keys[1]+" Key":"Mobile"===i.controls?t="C Button":"VR"===i.controls&&(t="A Button"):"action3Up"===e||("action4Down"===e?"Desktop"===i.controls?t=i.controlConfig.action4Keys[1]+" Key":"Mobile"===i.controls?t="D Button":"VR"===i.controls&&(t="B Button"):"action4Up"===e||("action5Down"===e?"Desktop"===i.controls?t=i.controlConfig.action5Keys[1]+" Key":"Mobile"===i.controls?t="E Button":"VR"===i.controls&&(t="Alt Joystick Down"):"action5Up"===e||("action6Down"===e?"Desktop"===i.controls?t=i.controlConfig.action6Keys[1]+" Key":"Mobile"===i.controls?t="F Button":"VR"===i.controls&&(t="Alt Joystick Up"):"action6Up"===e||("action7Down"===e?"Desktop"===i.controls?t=i.controlConfig.action7Keys[1]+" Key":"Mobile"===i.controls?t="<- Button":"VR"===i.controls&&(t="Alt Joystick Left"):"action7Up"===e||("action8Down"===e?"Desktop"===i.controls?t=i.controlConfig.action8Keys[1]+" Key":"Mobile"===i.controls?t="-> Button":"VR"===i.controls&&(t="Alt Joystick Right"):"action8Up"===e||console.log("Failed to identify action"))))))))),i.controlsText+=t+" | "+i.controlsInfo[e].name+" : "+i.controlsInfo[e].info+"\n";i.controlsText+="Click to Close Window"},g.addEventListener("click",(function(){"Desktop"===i.controls?gt("VR"):"VR"===i.controls?gt("Mobile"):"Mobile"===i.controls&&gt("Desktop"),ft()})),I.addEventListener("click",(function(){"bothRight"===i.vrHand?vt("bothLeft"):"bothLeft"===i.vrHand?vt("bothLeftLoco"):"bothLeftLoco"===i.vrHand?vt("bothRightLoco"):"bothRightLoco"===i.vrHand?vt("right"):"right"===i.vrHand?vt("left"):(i.vrHand="left")&&vt("bothRight"),ft()})),H.addEventListener("click",(function(){"camera"===i.directionType?(i.directionType="controller",H.innerHTML="Direction : Controller"):(i.directionType="camera",H.innerHTML="Direction : Camera"),ft()})),v.addEventListener("click",(function(){i.audioEnabled?(i.audioEnabled=!1,f.style.display="none",v.innerHTML="Sound : Disabled"):(i.audioEnabled=!0,v.innerHTML="Sound : Enabled",f.style.display="flex",w.innerHTML=i.volume.toFixed(1))})),E.addEventListener("click",(function(){i.volume+=.1,i.volume>2&&(i.volume=2),w.innerHTML=i.volume.toFixed(1),i.local.profile.volume=i.volume,i.saveToProfile(),i.playerAudio.core.inScene&&i.playerAudio.DespawnCore()})),b.addEventListener("click",(function(){i.volume-=.1,i.volume<0&&(i.volume=0),w.innerHTML=i.volume.toFixed(1),i.local.profile.volume=i.volume,i.saveToProfile(),i.playerAudio.core.inScene&&i.playerAudio.DespawnCore()})),this.ToggleBackgroundAudio=()=>{i.backgroundAudio=!i.backgroundAudio,i.backgroundAudio?i.playerAudio.SpawnCore(i.playerRig):i.playerAudio.DespawnCore()},x.addEventListener("click",bt),R.addEventListener("click",bt),D.addEventListener("click",wt),k.addEventListener("click",wt),C.addEventListener("click",(function(){i.comp.inScene&&i.comp.DespawnComp();let t=setTimeout((function(){i.worldLoaded&&(i.currentWorld.StopWorld(),y.innerHTML="Restart",i.worldLoaded=!1),i.systemLoaded(!0),wt(),clearTimeout(t)}),750)})),this.ToggleHTML=(t,e)=>{document.getElementById(t).style.display=e?"l"===t||"r"===t?"block":"flex":"none"},this.findInScene=t=>{let e=t;return e.core?e=!!e.core.inScene&&e.GetEl():e.layer?e=!!e.layer.inScene&&e.GetParentEl():e.id||"string"==typeof e&&(e=!!document.getElementById(e)&&document.getElementById(e)),e},this.attach=(t,e)=>{let o=i.findInScene(t),a=i.findInScene(e);o&&a?a.appendChild(o):console.log("Failed to find Child or Parent")},this.detach=t=>{let e=i.findInScene(t);e?i.sceneEl.appendChild(e):console.log("Failed to find Child")},this.colorTheoryGen=(t,e)=>{let i,o,a,n,s,r,l,c,h=!1;const p=["red","orange","yellow","lime","blue","cyan","magenta","maroon","olive","green","purple","teal","navy","silver","grey","black","white"];function d(t,e,i){let o=(1-Math.abs(2*i-1))*e,a=o*(1-Math.abs(t/60%2-1)),n=i-o/2,s=0,r=0,l=0;return 0<=t&&t<60?(s=o,r=a,l=0):60<=t&&t<120?(s=a,r=o,l=0):120<=t&&t<180?(s=0,r=o,l=a):180<=t&&t<240?(s=0,r=a,l=o):240<=t&&t<300?(s=a,r=0,l=o):300<=t&&t<360&&(s=o,r=0,l=a),s=Math.round(255*(s+n)),r=Math.round(255*(r+n)),l=Math.round(255*(l+n)),{r:s,g:r,b:l}}function u(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),"#"+t+e+i}function m(){return p[Math.floor(Math.random()*(p.length-4))]}if(t&&("#"===t[0]&&4===t.length||"#"===t[0]&&7===t.length||(t=!1)),e){for(let t in p)if(e===p[t]){h=!0;break}h||(e=m())}t?(l=t,c=function(t){let e=0,i=0,o=0;return 4==t.length?(e="0x"+t[1]+t[1],i="0x"+t[2]+t[2],o="0x"+t[3]+t[3]):7==t.length&&(e="0x"+t[1]+t[2],i="0x"+t[3]+t[4],o="0x"+t[5]+t[6]),{r:e,g:i,b:o}}(l),i=c.r,o=i/255,a=c.g,n=a/255,s=c.b,r=s/255):(e||(e=m()),"red"===e?(i=Math.floor(55*Math.random())+200,a=s=0):"orange"===e?(i=Math.floor(105*Math.random())+150,a=Math.floor(.65*i),s=0):"yellow"===e?(i=a=Math.floor(55*Math.random())+200,s=0):"lime"===e?(a=Math.floor(55*Math.random())+200,i=s=0):"blue"===e?(s=Math.floor(55*Math.random())+200,i=a=0):"cyan"===e?(a=s=Math.floor(55*Math.random())+200,i=0):"magenta"===e?(i=s=Math.floor(55*Math.random())+200,a=0):"maroon"===e?(i=Math.floor(28*Math.random())+100,s=a=0):"olive"===e?(i=a=Math.floor(28*Math.random())+100,s=0):"green"===e?(a=Math.floor(28*Math.random())+100,i=s=0):"purple"===e?(i=s=Math.floor(28*Math.random())+100,a=0):"teal"===e?(a=s=Math.floor(28*Math.random())+100,i=0):"navy"===e?(s=Math.floor(28*Math.random())+100,i=a=0):"black"===e?i=a=s=Math.floor(42*Math.random()):"white"===e?i=a=s=Math.floor(35*Math.random())+220:"silver"===e?i=a=s=Math.floor(42*Math.random())+170:"grey"===e&&(i=a=s=Math.floor(28*Math.random())+100),o=i/255,n=a/255,r=s/255,l=u(i,a,s));let y,g,v=Math.max(o,n,r),f=Math.min(o,n,r),b=.5*(v+f);v===o?y=f===n?6*(r-n)/(o-n)*60:(n-r)/(o-r)*60:v===n?y=f===r?60*(2-(o-r)/(n-r)):60*(2+(r-o)/(n-o)):v===r&&(y=f===o?60*(4-(n-o)/(r-o)):60*(4+(o-n)/(r-n))),g=1===b?0:(v-f)/(1-(2*b-1));let w=d(Math.abs(y+180-360),g,b),E=u(w.r,w.g,w.b),x=[d(Math.abs(y+150-360),g,b),d(Math.abs(y+210-360),g,b)],D=[u(x[0].r,x[0].g,x[0].b),u(x[1].r,x[1].g,x[1].b)],T=[d(Math.abs(y+120-360),g,b),d(Math.abs(y+240-360),g,b)],R=[u(T[0].r,T[0].g,T[0].b),u(T[1].r,T[1].g,T[1].b)],M=[d(Math.abs(y+90-360),g,b),d(Math.abs(y+180-360),g,b),d(Math.abs(y+270-360),g,b)],P=[u(M[0].r,M[0].g,M[0].b),u(M[1].r,M[1].g,M[1].b),u(M[2].r,M[2].g,M[2].b)],k=[d(Math.abs(y+30-360),g,b),d(Math.abs(y+60-360),g,b),d(Math.abs(y+90-360),g,b)],S=[u(k[0].r,k[0].g,k[0].b),u(k[1].r,k[1].g,k[1].b),u(k[2].r,k[2].g,k[2].b)],C=[];const L=.42;let z=u(1.42*i,1.42*a,1.42*s);C.push(z);let N=u(i*(1-L),a*(1-L),s*(1-L));return C.push(N),{base:l,light:z,dark:N,compl:E,splitCompl:D,triadic:R,tetradic:P,analog:S}},this.checkDupeName=t=>{let e=t,o=-1;for(;;){if(!i[e])return t===e||console.log(t+" changed to "+e),e;o++,e=t+"Copy"+o}},this.ranNameGen=()=>{let t="",e=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],i=Math.floor(12*Math.random())+4;for(let o=0;o<i;o++)t+=e[Math.floor(Math.random()*e.length)];return t},this.pronoun=t=>{let e={};"male"===t?(e.sex="male",e.sexe="man",e.sexes="men"):"female"===t?(e.sex="female",e.sexe="woman",e.sexes="women"):"other"===t&&(e.sex="person",e.sexe="person",e.sexes="people")},this.Core=e=>t(i,e),this.coreDataFromTemplate=(t,e,o)=>((t,e,i,o)=>{let a=function(t,e,i){const{[t]:o,[e]:a,...n}=i;return n}("el","parent",e);if(a=JSON.parse(JSON.stringify(a)),i)for(let t in i)a[t]=i[t];if(o||(i.id||(a.id=t.ranNameGen()),a.id=t.checkDupeName(a.id)),o)return a;t[a.id]=a})(i,t,e,o),this.coreFromTemplate=(t,e,o)=>((t,e,i,o)=>{o||(i?i.id||(i.id=t.ranNameGen()):(i={}).id=t.ranNameGen(),i.id=t.checkDupeName(i.id));let a=t.coreDataFromTemplate(e.core,i,!0);if(o)return t.Core(a);t[a.id]=t.Core(a)})(i,t,e,o),this.Layer=(t,e,o)=>((t,e,i,o)=>{let a={id:e,all:i,inScene:!1,allNames:[],children:{},tempParents:[],parent:!1,gridSpawned:!1,gridPath:[],pathSpeed:1e3,pathWait:1e3,pathRoute:"any",pathLoop:"infinite",pathType:"jump",currentPath:-1};if(a.gridPathInterval,a.gridPathTimeout,o)for(let t in o)a[t]=o[t];let n=[];const s=t=>{if(a.parent=t||!1,t&&(t.core?t.core.inScene?a.parent=t.GetEl():a.parent=!1:t.layer?t.layer.inScene?a.parent=t.GetParentEl():a.parent=!1:t.id?a.parent=t:"string"==typeof t&&(document.getElementById(t)?a.parent=document.getElementById(t):a.parent=!1),a.parent||(console.log(e),console.log(t),console.log(document.getElementById(t)),console.log("Parent is not in scene!"))),a.inScene);else{let i=a.parent;function o(t,e,s){i=t||!1,e.parent&&(a.tempParents[s]=e.parent.core.core.id);for(let t in e)e.hasOwnProperty(t)&&("core"===t?(n.length===s&&n.push([]),n[s].push(e[t]),a.allNames.push(e[t].core.id),e[t].core.id===a.all.parent.core.core.id||e[t].core.id===i||e[t].core.id===a.tempParents[s]||e[t].core.id===a.tempParents[s-1]||(a.children[e[t].core.id]={obj:e[t],parent:i},e[t].SpawnCore(i))):"parent"===t&&e[t].hasOwnProperty("core")?(n.length===s&&n.push([]),n[s].push(e[t].core),i=e[t].core.core.id===a.all.parent.core.core.id?a.parent:e[t].core.core.id===i||e[t].core.core.id===a.tempParents[s]?a.tempParents[s-1]:a.tempParents[s],a.children[e[t].core.id]={obj:e[t],parent:i},e[t].core.SpawnCore(i),o(i,e[t],s+1)):"object"==typeof e[t]&&(i=e[t].parent?e[t].parent:a.tempParents[s],o(i,e[t],s+1)))}o(a.parent,a.all,0),a.inScene=!0}},r=()=>{if(a.inScene){clearTimeout(a.gridPathTimeout),clearInterval(a.gridPathInterval),a.gridSpawned&&(a.grid.collide?t.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,!1):a.grid.trigger&&t.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,!1));let e,i=[...n];i.reverse();for(let t of i){e=[...t],e.reverse();for(let t of e)t.DespawnCore()}t.ExistsInTracker(a.id)&&t.RemoveFromTracker(a.id),a.inScene=!1}};function l(t){let e=new THREE.Vector3(0,0,0);if(t.start.x===t.end.x&&t.start.z===t.end.z)e.x=t.start.x,e.z=t.start.z;else{let i=-1*(t.start.x-t.end.x),o=-1*(t.start.z-t.end.z);i/=2,o/=2,e.x=t.start.x+i,e.z=t.start.z+o}return e.y=t.start.y,e}const c=(e,i)=>{let o={start:{},end:{}};o.start.x=a.grid.start.x,o.start.y=a.grid.start.y,o.start.z=a.grid.start.z,o.end.x=a.grid.end.x,o.end.y=a.grid.end.y,o.end.z=a.grid.end.z,e.x&&(o.start.x+=e.x,o.end.x+=e.x),e.y&&(o.start.y+=e.y,o.end.y+=e.y),e.z&&(o.start.z+=e.z,o.end.z+=e.z);let n=l(o);return n.y=a.all.parent.core.core.position.y+n.y,a.grid.collide?!!t.map.CheckMapAreaSansArea(a.grid,o,a.grid.height)&&(t.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,!1),t.map.UpdateMapArea(a.id,o.start,o.end,!0),"anim"===a.pathType?e.x?p("animstartx"+n.x):e.y?p("animstarty"+n.y):e.z&&p("animstartz"+n.z):"jump"===a.pathType&&d({property:"position",value:n}),a.grid.start.x=o.start.x,a.grid.start.y=o.start.y,a.grid.start.z=o.start.z,a.grid.end.x=o.end.x,a.grid.end.y=o.end.y,a.grid.end.z=o.end.z,!0):a.grid.trigger?(t.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,!1),t.map.UpdateMapAreaTrigger(a.id,o.start,o.end,!0),"anim"===a.pathType?e.x?p("animstartx"+n.x):e.y?p("animstarty"+n.y):e.z&&p("animstartz"+n.z):"jump"===a.pathType&&d({property:"position",value:n}),a.grid.start.x=o.start.x,a.grid.start.y=o.start.y,a.grid.start.z=o.start.z,a.grid.end.x=o.end.x,a.grid.end.y=o.end.y,a.grid.end.z=o.end.z,!0):void 0},h=(t,e)=>{let i=m(t);if(i)return i.GetEl(e)},p=t=>{if(Array.isArray(t))for(let e in t)i.parent.core.EmitEvent(t[e]);else i.parent.core.EmitEvent(t)},d=t=>{if(Array.isArray(t))for(let e in t)i.parent.core.ChangeSelf(t[e]);else i.parent.core.ChangeSelf(t)},u=t=>{if(Array.isArray(t))for(let e in t)i.parent.core.Animate(t[e]);else i.parent.core.Animate(t)},m=t=>{let e=[];return function i(o,a){for(let n in o)if(o.hasOwnProperty(n))if("core"===n){if(o[n].core.id===t)return void e.push(o[n])}else if("parent"===n&&o[n].hasOwnProperty("core")){if(o[n].core.core.id===t)return void e.push(o[n].core)}else"object"==typeof o[n]&&i(o[n],a+1)}(a.all,0),e[0]?e[0]:(console.log("Unable to find child"),console.log(t),!1)};return{layer:a,SpawnLayer:s,DespawnLayer:r,ToggleSpawn:t=>{let e=t||!1;e&&(a.parent=e),a.inScene?r():s(a.parent)},SpawnLayerOnGrid:e=>{if(a.inScene);else{e&&(a.grid=e),a.grid.start.y||(a.grid.start.y=0),a.grid.end.y||(a.grid.end.y=0),a.grid.yOffset||(a.grid.yOffset=0),a.grid.height=Math.abs(a.grid.start.y)+Math.abs(a.grid.end.y)+1;let i=t.player.GetPlayerInfo().grid;if(a.grid.start.x<=i.x&&a.grid.end.x>=i.x&&a.grid.start.y<=i.y&&a.grid.end.y>=i.y&&a.grid.start.z<=i.z&&a.grid.end.z>=i.z)t.map.WaitToSpawn({name:a.id,func:"SpawnLayerOnGrid"});else{let e=l(a.grid);a.all.parent.core.core.position.x=e.x,a.all.parent.core.core.position.y=a.grid.yOffset+e.y,a.all.parent.core.core.position.z=e.z,s(),a.grid.collide?t.map.UpdateMapArea(a.id,a.grid.start,a.grid.end,a.grid.collide):a.grid.trigger&&t.map.UpdateMapAreaTrigger(a.id,a.grid.start,a.grid.end,a.grid.trigger),a.gridSpawned=!0}}},ToggleLayerGridSpawn:t=>{a.inScene?DespawnFromGrid():SpawnOnGrid(t)},GridMove:c,GridPath:t=>{a.pathSpeed=t.speed||1e3,a.pathWait=t.wait||1e3,a.pathPatience=t.patience||3,a.pathRoute=t.route||"any",a.pathLoop=t.loop||"infinite",a.pathType=t.type||"jump";let e=l(a.grid);a.all.parent.core.core.position.x=e.x,e.y&&(a.all.parent.core.core.position.y=a.all.parent.core.core.position.y+e.y),a.all.parent.core.core.position.z=e.z;let i,o,n=.5;for(let e in t.path){let i=1;for(let o in t.path[e]){n=t.path[e][o]>0?.5:-.5,i="y"===o?Math.abs(t.path[e][o]):Math.abs(t.path[e][o])/.5;for(let t=0;t<i;t++)a.gridPath.push({[o]:n})}}let s=a.all.parent.core.core.position.x,r=a.all.parent.core.core.position.y,c=a.all.parent.core.core.position.z;if("anim"===a.pathType)for(let t in a.gridPath){let e={name:"animmove",property:"object3D.position.x",to:0,dur:a.pathSpeed,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"moveXStart",pauseEvents:"moveXStop"};i=Object.keys(a.gridPath[t])[0],o=a.gridPath[t][i],e.property="object3D.position."+i,"x"===i?(e.to=s+=o,e.name="animmove"+i+s,e.startEvents="animstart"+i+s,e.pauseEvents="animstop"+i+s):"y"===i?(e.to=r+=o,e.name="animmove"+i+r,e.startEvents="animstart"+i+r,e.pauseEvents="animstop"+i+r):"z"===i&&(e.to=c+=o,e.name="animmove"+i+c,e.startEvents="animstart"+i+c,e.pauseEvents="animstop"+i+c),a.inScene?u(e):(0===Object.keys(a.all.parent.core.core.animations).length&&(a.all.parent.core.core.animations={}),delete e.name,a.all.parent.core.core.animations["move"+t]=e)}},WalkPath:()=>{let t=!0,e=!1,i=!0,o=!1,n=!0,s=!1,r=0,l=!1,h=0;function p(){l=!l}function d(){a.currentPath=0}function u(){a.currentPath=a.gridPath.length-1}"any"===a.pathRoute&&100*Math.random()>50&&(l=!0),a.gridPathInterval=setInterval((()=>{t&&i&&n&&(("circuit"===a.pathRoute||"alternate"===a.pathRoute||"any"===a.pathRoute)&&(l?(a.currentPath--,a.currentPath<0&&("infinite"===a.pathLoop||(r>=a.pathLoop?clearInterval(a.gridPathInterval):r++),"circuit"===a.pathRoute?l&&(d(),p()):"alternate"===a.pathRoute?(d(),p()):"any"===a.pathRoute&&(100*Math.random()>50?(d(),p()):u()))):(a.currentPath++,a.currentPath>=a.gridPath.length&&("infinite"===a.pathLoop||(r>=a.pathLoop?clearInterval(a.gridPathInterval):r++),"circuit"===a.pathRoute?d():"alternate"===a.pathRoute?(u(),p()):"any"===a.pathRoute&&(100*Math.random()>50?d():(u(),p()))))),t=!1,i=!1,n=!1,e=!!a.gridPath[a.currentPath].x,o=!!a.gridPath[a.currentPath].y,s=!!a.gridPath[a.currentPath].z),e?(t=c(l?{x:-1*a.gridPath[a.currentPath].x}:{x:a.gridPath[a.currentPath].x}),t?(e=!1,h=0,o||(i=!0),s||(n=!0)):(h++,h>=a.pathPatience&&(t=!0,i=!0,n=!0,p()))):o?(i=c(l?{y:-1*a.gridPath[a.currentPath].y}:{y:a.gridPath[a.currentPath].y}),i?(o=!1,h=0,e||(t=!0),s||(n=!0)):(h++,h>=a.pathPatience&&(t=!0,i=!0,n=!0,p()))):s&&(n=c(l?{z:-1*a.gridPath[a.currentPath].z}:{z:a.gridPath[a.currentPath].z}),n?(s=!1,h=0,e||(t=!0),o||(i=!0)):(h++,h>=a.pathPatience&&(t=!0,i=!0,n=!0,p())))}),a.pathSpeed+a.pathWait)},GetParentEl:t=>a.all.parent.core.GetEl(t),GetChildEl:h,GetAllChildEl:t=>{let e=[];for(let i in a.allNames)a.allNames[i]===a.all.parent.core.core.id||e.push(h(a.allNames[i],t));return e},GetAllEl:t=>{let e=[];for(let i in a.allNames)e.push(h(a.allNames[i],t));return e},EmitEventParent:p,EmitEventChild:(t,e)=>{let i=m(t);if(Array.isArray(e))for(let t in e)i.EmitEvent(e[t]);else i.EmitEvent(e)},EmitEventAll:t=>{if(Array.isArray(t))for(let e in t)for(let i of n)for(let o of i)o.EmitEvent(t[e]);else for(let e of n)for(let i of e)i.EmitEvent(t)},ChangeParent:d,ChangeChild:(t,e)=>{let i=m(t);if(Array.isArray(e))for(let t in e)i.ChangeSelf(e[t]);else i.ChangeSelf(e)},ChangeAll:t=>{if(Array.isArray(t))for(let e in t)for(let i of n)for(let o of i)o.ChangeSelf(t[e]);else for(let e of n)for(let i of e)i.ChangeSelf(t)},RemoveComponentParent:t=>{if(Array.isArray(t))for(let e in t)i.parent.core.RemoveComponent(t[e]);else i.parent.core.RemoveComponent(t)},RemoveComponentChild:(t,e)=>{let i=m(t);if(Array.isArray(e))for(let t in e)i.RemoveComponent(e[t]);else i.RemoveComponent(e)},RemoveComponentAll:t=>{if(Array.isArray(t))for(let e in t)for(let i of n)for(let o of i)o.RemoveComponent(t[e]);else for(let e of n)for(let i of e)i.RemoveComponent(t)},AnimateParent:u,AnimateChild:(t,e)=>{let i=m(t);if(Array.isArray(e))for(let t in e)i.Animate(e[t]);else i.Animate(e)},AnimateAll:t=>{if(Array.isArray(t))for(let e in t)for(let i of n)for(let o of i)o.Animate(t[e]);else for(let e of n)for(let i of e)i.Animate(t)},SetFlagParent:t=>{if(Array.isArray(t))for(let e in t)i.parent.core.SetFlag(t[e]);else i.parent.core.SetFlag(t)},SetFlagChild:(t,e)=>{let i=m(t);if(Array.isArray(e))for(let t in e)i.SetFlag(e[t]);else i.SetFlag(e)},SetFlagAll:t=>{if(Array.isArray(t))for(let e in t)for(let i of n)for(let o of i)o.SetFlag(t[e]);else for(let e of n)for(let i of e)i.SetFlag(t)},GetFlagParent:t=>{if(Array.isArray(t)){let e=[];for(let o in t)e.push(i.parent.core.GetFlag(t[o]));return e}return i.parent.core.GetFlag(t)},GetFlagChild:(t,e)=>{let i=m(t);if(Array.isArray(e)){let t=[];for(let o in e)t.push(i.GetFlag(e[o]));return t}return i.GetFlag(e)},GetFlagAll:t=>{let e=[];if(Array.isArray(t)){for(let i in t){let o=[];for(let e of n)for(let a of e)o.push(a.GetFlag(t[i]));e.push(o)}return e}for(let i of n)for(let o of i)e.push(o.GetFlag(t));return e},EnableDetailParent:t=>{i.parent.core.EnableDetail(t)},EnableDetailChild:(t,e)=>{m(t).EnableDetail(e)},EnableDetailAll:t=>{for(let e of n)for(let i of e)i.EnableDetail(t)},DisableDetailParent:()=>{i.parent.core.DisableDetail()},DisableDetailChild:t=>{m(t).DisableDetail()},DisableDetailAll:()=>{for(let t of n)for(let e of t)e.DisableDetail()},GetChild:m}})(i,t,e,o),this.layerDataFromTemplate=(t,e,o,a)=>((t,e,i,o,a)=>{let n=i||t.ranNameGen();n=t.checkDupeName(n);let s={},r=0;if(o?o.id||(o.id=n+r):(o={}).id=n+r,o.id=t.checkDupeName(o.id),function e(i,a){for(let s in i)i[s].core?(a[s]={},a[s].core=0===r?t.coreFromTemplate(i[s].core,o,!0):t.coreFromTemplate(i[s].core,{id:t.checkDupeName(n+r)},!0),r++):(a[s]={},e(i[s],a[s]))}(e,s),o)for(let t in o)s.parent.core.core[t]=o[t];if(a)return s;t[n]=s})(i,t,e,o,a),this.layerFromTemplate=(t,e,o,a,n)=>((t,e,i,o,a,n)=>{let s,r={},l=0;if(n||(i||(i=t.ranNameGen()),i=t.checkDupeName(i)),o?o.id||(o.id=i+l):(o={}).id=i+l,o.id=t.checkDupeName(o.id),s=e.layer?e.layer.all:e,function e(a,n){for(let s in a)a[s].core?(n[s]={},n[s].core=0===l?t.coreFromTemplate(a[s].core,o,!0):t.coreFromTemplate(a[s].core,{id:t.checkDupeName(i+l)},!0),l++):(n[s]={},e(a[s],n[s]))}(s,r),o)for(let t in o)r.parent.core.core[t]=o[t];if(n)return t.Layer(i,r,a);t[i]=t.Layer(i,r,a)})(i,t,e,o,a,n),this.Player=(t,o)=>e(i,t,o),this.Companion=(t,e,o)=>((t,e,i,o)=>{let a,n={};function s(){let t=new THREE.Vector3;camera.object3D.getWorldDirection(t);let e=new THREE.Vector3;return e.copy(camera.object3D.position).add(new THREE.Vector3(t.x,0,t.z).normalize().multiplyScalar(n.distance)),e.y=n.height,e}n.avatarType="",n.menuParentId,i.SpawnCore?(n.avatarType="core",n.menuParentId=i.core.id,a=i.core.id):i.SpawnLayer&&(n.avatarType="layer",n.menuParentId=i.layer.all.parent.core.core.id,a=i.layer.id),n.avatar=Object.assign({},i),n.shapes={default:a,Cube:"compCubeLayer",Sphere:"compSphereLayer"},n.id=e,n.inScene=!1,n.infoDisplay=!1,n.pos=t.playerRig.GetEl().getAttribute("position"),n.height=1.5,n.distance=-2,n.firstSpawn=!0,n.viewConfig=!1,n.bookData=t.compBookData,t.compNPC=t.NPC("compNPC",n.avatar,n.bookData,t.compBubbleLayer,!0),n.enableInventory=o||!1,n.inventoryTimeouts=[],n.items={},n.tools={},n.keys={},n.specials={},n.mainMenuData={info:{id:"mainMenu",buttonData:t.menuCylinderData,hoverData:t.menuHoverData,title:"Main Menu",description:"Main menu for travel, system and settings.",layout:"circleUp",offset:-1,parent:n.menuParentId,stare:!1},menu0:{button1:{id:"subMenu2",style:!1,title:"Travel to",description:"Select your next travel destination.",subMenu:"travel1",action:!1},button2:{id:"subMenu3",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu3",action:!1},button3:{id:"subMenu4",style:!1,title:"Controls",description:"View current control configuration.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"ToggleControlView",params:null,menu:"close"}}},travel1:{button0:{id:"subMenu4",style:!1,title:"Sub Menu 4 Test",description:"A test sub menu.",subMenu:"menu4",action:!1},button1:{id:"subMenu5",style:!1,title:"Sub Menu 5 Test",description:"A test sub menu.",subMenu:"menu5",action:!1}},menu2:{button0:{id:"action1",style:!1,title:"Toggle Flashlight",description:"Turn On/Off your flashlight.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleFlashlight",params:null,menu:"close"}}},menu3:{button0:{id:"action1",style:!1,title:"Sit/Stand Toggle",description:"Toggle between sitting or standing mode.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"ToggleSittingMode",params:null,menu:"stay"}},button1:{id:"subMenu1",style:!1,title:"Companion Avatar",description:"Change the companion avatar shape.",subMenu:"compShape1",action:!1},button2:{id:"subMenu2",style:!1,title:"Scene Transition Type",description:"Change the scene transition animation style.",subMenu:"menu4",action:!1},button3:{id:"subMenu3",style:!1,title:"Teleport Transition Type",description:"Change the teleport transition animation style.",subMenu:"menu5",action:!1},button4:{id:"subMenu4",style:!1,title:"Transition Color",description:"Change the transition animation color.",subMenu:"menu6",action:!1}},menu4:{button0:{id:"action1",style:!1,title:"Instant",description:"Disable animation.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"instant",menu:"back"}},button1:{id:"action2",style:!1,title:"Blink",description:"Blink in and out in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"blink",menu:"back"}},button2:{id:"action3",style:!1,title:"Fade",description:"Fade in and out in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"fade",menu:"back"}},button3:{id:"action4",style:!1,title:"Sphere",description:"Close and open a sphere in between scenes.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateSceneTransitionStyle",params:"sphere",menu:"back"}}},menu5:{button0:{id:"action1",style:!1,title:"Instant",description:"Disable animation.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"instant",menu:"back"}},button1:{id:"action2",style:!1,title:"Locomotion",description:"Slide to teleport position.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"locomotion",menu:"back"}},button2:{id:"action3",style:!1,title:"Blink",description:"Blink in and out in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"blink",menu:"back"}},button3:{id:"action4",style:!1,title:"Fade",description:"Fade in and out in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"fade",menu:"back"}},button4:{id:"action5",style:!1,title:"Sphere",description:"Close and open a sphere in between teleports.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTeleportTransitionStyle",params:"sphere",menu:"back"}}},menu6:{button0:{id:"action1",style:!1,title:"Black",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"black",menu:"back"}},button1:{id:"action2",style:!1,title:"Grey",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"grey",menu:"back"}},button2:{id:"action3",style:!1,title:"White",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"white",menu:"back"}},button3:{id:"action4",style:!1,title:"Red",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"red",menu:"back"}},button4:{id:"action5",style:!1,title:"Green",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"green",menu:"back"}},button5:{id:"action6",style:!1,title:"Blue",description:"Change transition color.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"UpdateTransitionColor",params:"blue",menu:"back"}}},compShape1:{},inventory:{button0:{id:"subMenu1",style:!1,title:"Items",description:"View your items.",subMenu:"items1",action:!1},button1:{id:"subMenu2",style:!1,title:"Tools",description:"View your tools.",subMenu:"tools1",action:!1},button2:{id:"subMenu3",style:!1,title:"Keys",description:"View your keys.",subMenu:"keys1",action:!1},button3:{id:"subMenu4",style:!1,title:"Special",description:"View your special objects.",subMenu:"specials1",action:!1}},items1:{},tools1:{},keys1:{},specials1:{}},n.enableInventory&&(n.mainMenuData.menu0.button0={id:"subMenu1",style:!1,title:"Inventory",description:"View your inventory.",subMenu:"inventory",action:!1},n.mainMenuData.menu0.button4={id:"subMenu5",style:!1,title:"Unequip",description:"Unequip your held object.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"Unequip",params:null,menu:"stay"}}),t.mainMenu=t.MultiMenu(n.mainMenuData);const r=()=>{n.shapeButtons={};let e={},i={},o=1,a=1,s=Object.keys(n.shapes).length,r=Math.ceil(s/8),l="compShape"+a;for(let c in n.shapes)e={id:"action"+o,style:!1,title:c,description:"Change to a "+c+" avatar.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"UpdateShape",params:n.shapes[c],menu:"close"}},i={id:"action"+o,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},n.shapeButtons["button"+o]=e,o===s?t.mainMenu.UpdateSubMenu(l,n.shapeButtons):o++,r>1&&o%7==0&&(a++,i.id="action"+o,i.subMenu="compShape"+a,n.shapeButtons["button"+o]=i,t.mainMenu.UpdateSubMenu(l,n.shapeButtons),n.shapeButtons={},l="compShape"+a)},l=()=>{t.playerFloor.GetEl().classList.toggle("clickable")};t.playerFloor.GetEl().addEventListener("click",(()=>{n.inScene?h():c()}));const c=()=>{if(n.inScene);else{l(),t.compNPC.SpawnNPC(t.playerRig.GetEl()),"core"===n.avatarType?n.firstSpawn?n.firstSpawn=!1:n.avatar.ChangeSelf({property:"position",value:s()}):n.firstSpawn?n.firstSpawn=!1:n.avatar.ChangeParent({property:"position",value:s()});let e=setTimeout((()=>{n.enableInventory&&u(),t.mainMenu.multiMenu.parent=n.menuParentId,t.mainMenu.SpawnMultiMenu(),l(),n.inScene=!0,clearTimeout(e)}),100)}},h=()=>{if(n.inScene){l(),t.mainMenu.DespawnMultiMenu();let e=setTimeout((()=>{t.compNPC.DespawnNPC(),t.RemoveFromTracker(n.id),n.inScene=!1,l(),clearTimeout(e)}),300)}},p=()=>{for(let t in n.inventoryTimeouts)clearTimeout(n.inventoryTimeouts[t]);n.inventoryTimeouts=[]},d=e=>{n.inventoryButtons={};let i={},o={},a=1,s=1,r=Object.keys(n[e]).length,l=Math.ceil(r/8),c=e+s,h="stay";for(let p in n[e]){let d;d="limited"===n[e][p].persist?n[e][p].name+" x"+n[e][p].amount:n[e][p].name,h=n[e][p].menu?n[e][p].menu:"stay",i={id:"action"+a,style:n[e][p].style,title:d,description:n[e][p].description,subMenu:!1,action:{auxlObj:n[e][p].auxlObj,component:n[e][p].component,method:n[e][p].method,params:n[e][p].params,menu:h}},n[e][p].action||(i.action=!1),o={id:"action"+a,style:!1,title:"More",description:"Next Page",subMenu:!1,action:!1},n.inventoryButtons["button"+a]=i,a===r?t.mainMenu.UpdateSubMenu(c,n.inventoryButtons):a++,l>1&&a%7==0&&(s++,o.id="action"+a,o.subMenu=e+s,n.inventoryButtons["button"+a]=o,t.mainMenu.UpdateSubMenu(c,n.inventoryButtons),n.inventoryButtons={},c=e+s)}},u=()=>{d("items"),d("tools"),d("keys"),d("specials")};return{comp:n,TestFunc:t=>{console.log(t)},AddAvatar:(t,e)=>{n.shapes[t]=e,r()},UpdateShape:e=>{let i=!1;n.inScene&&(i=!0,h());let o=setTimeout((()=>{t[e].SpawnCore?(n.avatarType="core",n.menuParentId=t[e].core.id):t[e].SpawnLayer?(n.avatarType="layer",n.menuParentId=t[e].layer.all.parent.core.core.id):(console.log(e),console.log("failed to detect type")),n.avatar=Object.assign({},t[e]),t.compNPC=t.NPC("compNPC",n.avatar,t.compBookData,t.compBubbleLayer,!0),i&&c(),clearTimeout(o)}),400)},UpdateBook:e=>{let i=!1;n.inScene&&(i=!0,h()),n.bookData=e;let o=setTimeout((()=>{t.compNPC=t.NPC("compNPC",n.avatar,n.bookData,t.compBubbleLayer,!0),i&&c(),clearTimeout(o)}),400)},SpawnComp:c,DespawnComp:h,SetFlag:e=>{if(Array.isArray(e))for(let i in e)n[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:n.id,type:"comp",sub:!1,name:e[i].flag,data:e[i].value});else n[e.flag]=e.value,t.saveToProfile({auxlObject:n.id,type:"comp",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(n(t[i]));return e}return n[t]},UpdatePosition:()=>{"core"===n.avatarType?n.avatar.ChangeSelf({property:"position",value:s()}):n.avatar.ChangeParent({property:"position",value:s()})},ToggleControlView:()=>{n.viewConfig?(t.configurationView.DespawnCore(),n.viewConfig=!1):(t.configurationView.SpawnCore(t.playerRig.GetEl()),t.configurationView.ChangeSelf({property:"text",value:{value:t.controlsText}}),n.viewConfig=!0)},UpdateMainMenu:e=>{let i=!1;t.mainMenu.inScene&&(t.mainMenu.DespawnMultiMenu(),i=!0),Object.keys(e).forEach((t=>{n.mainMenuData[t]?n.mainMenuData[t][e[t].id]=e[t]:n.mainMenuData[t]=e[t]})),t.mainMenu=t.MultiMenu(n.mainMenuData),u(),r(),i&&t.mainMenu.SpawnMultiMenu()},UpdateMainMenuStyle:e=>{let i=!1;t.mainMenu.inScene&&(t.mainMenu.DespawnMultiMenu(),i=!0),n.mainMenuData.info.buttonData=e,t.mainMenu=t.MultiMenu(n.mainMenuData),u(),r(),i&&t.mainMenu.SpawnMultiMenu()},EnableInventory:()=>{n.enableInventory=!0,n.mainMenuData.menu0={button0:{id:"subMenu1",style:!1,title:"Inventory",description:"View your inventory.",subMenu:"inventory",action:!1},button4:{id:"subMenu5",style:!1,title:"Unequip",description:"Unequip your held object.",subMenu:!1,action:{auxlObj:"player",component:!1,method:"Unequip",params:null,menu:"stay"}},button1:{id:"subMenu2",style:!1,title:"Travel to",description:"Select your next travel destination.",subMenu:"menu1",action:!1},button2:{id:"subMenu3",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu3",action:!1},button3:{id:"subMenu4",style:!1,title:"Controls",description:"View current control configuration.",subMenu:!1,action:{auxlObj:"comp",component:!1,method:"ToggleControlView",params:null,menu:"close"}}},t.mainMenu=t.MultiMenu(n.mainMenuData),u()},AddToInventory:({item:e,hide:i})=>{function o(e){n[e.category][e.name]?"limited"===n[e.category][e.name].persist&&(n[e.category][e.name].amount+=e.amount):n[e.category][e.name]=e,t.saveToProfile({auxlObject:n.id,type:"comp",sub:e.category,name:e.name,data:e})}if(Array.isArray(e))for(let t in e)o(e[t]);else o(e);if(u(),p(),i);else if(Array.isArray(e))for(let i in e){let o=3800;o*=i,n.inventoryTimeouts[i]=setTimeout((()=>{t.player.Notification({message:"Acquired : "+e[i].name}),clearTimeout(n.inventoryTimeouts[i])}),o)}else t.player.Notification({message:"Acquired : "+e.name})},ClearInventoryNotifications:p,RemoveFromInventory:e=>{function i(e){n[e.category][e.name]?"limited"===n[e.category][e.name].persist&&(n[e.category][e.name].amount--,n[e.category][e.name].amount<=0&&delete n[e.category][e.name]):delete n[e.category][e.name],t.saveToProfile({auxlObject:n.id,type:"comp",sub:e.category,name:e.name,data:e})}if(Array.isArray(e))for(let t in e)i(e[t]);else i(e);u()},CheckInventory:t=>{let e;function i(t){return!!n[t.category][t.name]}if(Array.isArray(t))for(let o in t)e.push(i(t[o]));else e=i(t);return e},CheckForKey:t=>{let e=!1;if(0===Object.keys(n.keys).length)e=!1;else for(let i in n.keys)if(n.keys[i].id===t){e=!0;break}return e},UpdateInventoryMenu:u}})(i,t,e,o),this.SceneNode=t=>o(i,t),this.MapZone=t=>a(i,t),this.Scenario=t=>n(i,t),this.World=t=>((t,e)=>{let i={};i.data=Object.assign({},e),i.id=i.data.info.id,i.name=i.data.info.name,i.scenarios=i.data.scenarios,i.current=0,i.loaded=!1,i.scenarioLoaded=!1;const o=t=>{i.current=t,i.scenarios[t].StartScenario(),i.scenarioLoaded=!0},a=t=>{i.scenarios[t].ClearScenario(),i.scenarioLoaded=!1};return{world:i,SetAsDefault:()=>{t.defaultWorld=t[i.id]},StartWorld:()=>{i.data.info.maxLoadtime?t.maxLoadTime=i.data.info.maxLoadtime:t.maxLoadTime=5e3,i.data.info.dayTime?t.timeInDay=i.data.info.dayTime:t.timeInDay=36e4,i.data.info.inventory?t.comp.EnableInventory():t.comp.enableInventory=!1,i.data.info.collision?t.collision=i.data.info.collision:t.collision=!1,i.data.info.physics?i.data.info.physics=t.physics:t.physics=!1,i.data.info.menuStyle&&t.comp.UpdateMainMenuStyle(i.data.info.menuStyle),i.data.info.menuOptions&&t.comp.UpdateMainMenu(i.data.info.menuOptions),i.data.info.backgroundAudio&&(t.playerAudio.core.sounds={},t.playerAudio.core.sounds.background={src:i.data.info.backgroundAudio,autoplay:!0,loop:!0,volume:1},t.playerAudio.SpawnCore(t.playerRig),t.backgroundAudio=!0),i.data.info.compBookUpdate&&t.comp.UpdateBook(i.data.info.compBookUpdate),o(i.current),t.currentWorld=t[i.id],t.worldLoaded=!0,t.local.location.world=i.id},StopWorld:()=>{a(i.current),t.worldLoaded=!1},StartScenario:o,ClearScenario:a,NextScenario:()=>{a(i.current),i.current++,o(i.current)},LoadScenario:t=>{a(i.current),i.current=t,o(i.current)}}})(i,t),this.Menu=t=>((t,e)=>{let i={inScene:!1};i.data=Object.assign({},e.data),i.id=e.id||"menu",i.prompt=e.prompt,i.options=e.options,i.actions=e.actions,i.layers={},i.layer={};let o={},a={},n=[],s=0,r=Object.keys(i.options).length;return i.clickrun={},i.clickrun.cursorObj=e.cursorObj||!1,i.clickrun.method=e.method||"Click",i.clickrun.params=e.params||"target",i.layout=e.layout,i.data.position=new THREE.Vector3(0,0,0),i.data.position.x=e.pos.x,i.data.position.y=e.pos.y,i.data.position.z=e.pos.z,{menu:i,SpawnMenu:()=>{if(i.inScene);else{s=0,n=[],a={},i.data.id=i.id,i.data.text.value=i.prompt,i.data.material.color,i.data.material.emissive=t.colorTheoryGen().base,o=t.Core(i.data),i.layers={parent:{core:o}},i.data.position.x=1.15*i.data.geometry.width,i.data.position.z=0,1===r||"horizontal"===i.layout?i.data.position.y=0:i.data.position.y=.75*i.data.geometry.height*r/2,i.data.sources={},i.data.components={},i.data.components.clickrun={},i.data.components.clickrun.cursorObj=i.clickrun.cursorObj,i.data.components.clickrun.method=i.clickrun.method,i.data.components.clickrun.params=i.clickrun.params;for(let e in i.options)1===r||0===s||("vertical"===i.layout?i.data.position.y-=1.15*i.data.geometry.height:"horizontal"===i.layout?i.data.position.x+=1.15*i.data.geometry.width:i.data.position.y-=1.15*i.data.geometry.height),i.data.material.color,i.data.material.emissive=t.colorTheoryGen().base,i.data.text.value=i.options[e],i.data.id=i.id+"option"+s,i.data.components.result=i.actions["action"+s],a=t.Core(i.data),n.push(a),i.layers["child"+s]={core:n[s]},s++;i.layer=t.Layer(i.id,i.layers),i.layer.SpawnLayer(),i.inScene=!0}},DespawnMenu:()=>{i.inScene&&(i.layer.DespawnLayer(),i.inScene=!1)},AddToParentSpawnTracker:(e,o)=>{t.scenarioSpawned[o.id]?t.scenarioSpawned[i.id]={type:"menu",obj:e,parent:o}:t.zoneSpawned[o.id]?t.zoneSpawned[i.id]={type:"menu",obj:e,parent:o}:t.nodeSpawned[o.id]?t.nodeSpawned[i.id]={type:"menu",obj:e,parent:o}:t.bookSpawned[o.id]&&(t.bookSpawned[i.id]={type:"menu",obj:e,parent:o})},RemoveMenuFromSceneTracker:()=>{t.scenarioSpawned[i.id]?delete t.scenarioSpawned[i.id]:t.zoneSpawned[i.id]?delete t.zoneSpawned[i.id]:t.nodeSpawned[i.id]?delete t.nodeSpawned[i.id]:t.bookSpawned[i.id]&&delete t.bookSpawned[i.id]}}})(i,t),this.MultiMenu=t=>((t,e)=>{let i={};i.data=Object.assign({},e),i.inScene=!1,i.menuOpen=!1,i.descriptionOpen=!1,i.buttonHover="",i.currentMenu="menu0",i.menuPath=["menu0"],i.switching=!1,i.switchingTimeout,i.id=e.info.id||"multiMenu",i.layout=e.info.layout||"circleUp",i.posOffset=e.info.posOffset||new THREE.Vector3(0,0,0),i.offset=e.info.offset||-1,i.parent=i.data.info.parent||!1,i.stare=i.data.info.stare||!1;let o=-45,a=0,n=250;i.buttonData=JSON.parse(JSON.stringify(i.data.info.buttonData)),i.hoverData=JSON.parse(JSON.stringify(i.data.info.hoverData)),i.nullParentData={data:"nullParentData",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:i.posOffset,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},i.stare&&(i.nullParentData.components.stare={id:i.stare.id,twist:i.stare.twist}),i.cores={},i.cores.hover={},i.nullParentData.id=i.id,i.data.info.position&&(i.nullParentData.position=i.data.info.position),i.cores.parent=t.Core(i.nullParentData),i.nullParentData.position=new THREE.Vector3(0,0,0),i.nullParentData.components={},i.buttonData.id=i.data.info.id+"menu","circleUp"!==i.layout&&"circleDown"!==i.layout||(i.buttonData.position.x=i.offset),i.cores.main=t.Core(i.buttonData);for(let e in i.data)if("info"===e);else{i.cores[e]=[],i.cores.hover[e]=[];let n=0;for(let a in i.data[e])n++,i.buttonData.id=i.data[e][a].id,i.buttonData.text.value=i.data[e][a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*n*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*n:"vertical"===i.layout?i.buttonData.position.y=n*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=n*i.offset),i.buttonData.components={},i.data[e][a].action?(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=i.data[e][a].action.auxlObj,i.buttonData.components.clickrun.method=i.data[e][a].action.method,i.data[e][a].action.component&&(i.buttonData.components.clickrun.component=i.data[e][a].action.component),i.data[e][a].action.params&&(i.buttonData.components.clickrun.params=i.data[e][a].action.params),i.data[e][a].action.menu?"stay"===i.data[e][a].action.menu||("back"===i.data[e][a].action.menu?(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ToggleMenu",i.buttonData.components.menurun.params=null):"close"===i.data[e][a].action.menu&&(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="SubMenu",i.buttonData.components.menurun.params=i.data[e][a].subMenu),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=i.data[e][a].id+"hover",i.hoverData.text.value=i.data[e][a].description,i.cores.hover[e][a]=t.Core(i.hoverData),i.cores[e][a]=t.Core(i.buttonData);n>a&&(a=n)}i.cores.nulls=[];for(let e=0;e<=8;e++)i.nullParentData.id=i.id+"null"+e,"circleUp"===i.layout?i.nullParentData.rotation.z=o*e:"circleDown"===i.layout&&(i.nullParentData.rotation.z=o*e*-1),i.cores.nulls.push(t.Core(i.nullParentData));i.menuLayerData={parent:{core:i.cores.parent},child0:{parent:{core:i.cores.nulls[0]},child0:{core:i.cores.main}}};for(let t=1;t<i.cores.nulls.length;t++)i.menuLayerData["child"+t]={},i.menuLayerData["child"+t].core=i.cores.nulls[t];i.menuLayer=t.Layer(i.id,i.menuLayerData);const s=()=>{i.menuPath.length>1?i.cores.main.ChangeSelf({property:"text",value:{value:"Back"}}):i.cores.main.ChangeSelf({property:"text",value:{value:"Close"}}),i.menuOpen=!0,i.switching=!0;let t,e=i.currentMenu,o=1,a=setTimeout((()=>{for(let a in i.cores[e])t=i.menuLayer.GetChildEl(i.id+"null"+o),i.cores[e][a].SpawnCore(t),o++;clearTimeout(a)}),n);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),500)},r=t=>{i.menuOpen=!1,i.switching=!0;let e,o=i.currentMenu,a=1,s={};e=t?25:n,i.descriptionOpen&&p(i.buttonHover);let r=setTimeout((()=>{for(let t in i.cores[o])s[t]=i.menuLayer.GetChildEl(i.id+"null"+a),i.cores[o][t].DespawnCore(),a++;clearTimeout(r)}),e);i.switchingTimeout=setTimeout((()=>{i.switching=!1,clearTimeout(i.switchingTimeout)}),2*e)},l=()=>{i.switching||(i.menuOpen?i.menuPath.length>1?h(i.menuPath[i.menuPath.length-2]):c():s())},c=t=>{let e;if(i.cores.main.ChangeSelf({property:"text",value:{value:"Open"}}),e=t?0:n,i.switching);else if(i.menuOpen){let o=setTimeout((()=>{r(t),i.currentMenu="menu0",i.menuPath=["menu0"],i.menuOpen=!1,clearTimeout(o)}),e)}},h=t=>{i.switching||(r(),i.currentMenu=t,i.menuPath.includes(i.currentMenu)?i.menuPath.pop():i.menuPath.push(i.currentMenu),s())},p=t=>{i.descriptionOpen&&(i.cores[i.currentMenu][t].GetEl(),i.cores.hover[i.currentMenu][t].DespawnCore(),i.buttonHover="",i.descriptionOpen=!1)};return{multiMenu:i,SpawnMultiMenu:t=>{i.inScene||(i.menuLayer.SpawnLayer(i.parent),i.menuLayer.GetChildEl(i.id+"null0").addEventListener("click",l),i.cores.main.ChangeSelf({property:"text",value:{value:"Open"}}),t&&l(),i.inScene=!0)},DespawnMultiMenu:()=>{if(i.inScene){c(!0);let e=setTimeout((()=>{i.menuLayer.GetChildEl(i.id+"null0").removeEventListener("click",l),i.menuLayer.DespawnLayer(),i.inScene=!1,t.RemoveFromTracker(i.id),clearTimeout(e)}),n)}},ToggleMenu:l,UpdateParent:t=>{let e=t||!1;i.inScene||(i.parent=e)},UpdateButtons:t=>{console.log(i.cores)},UpdateSubMenu:(e,n)=>{if(i.currentMenu===e);else{i.cores[e]=[],i.cores.hover[e]=[];let s=0;for(let a in n)s++,i.buttonData.id=n[a].id,i.buttonData.text.value=n[a].title,"circleUp"===i.layout?i.buttonData.rotation.z=o*s*-1:"circleDown"===i.layout?i.buttonData.rotation.z=o*s:"vertical"===i.layout?i.buttonData.position.y=s*i.offset:"horizontal"===i.layout&&(i.buttonData.position.x=s*i.offset),i.buttonData.components={},n[a].action?(i.buttonData.components.clickrun={},i.buttonData.components.clickrun.cursorObj=n[a].action.auxlObj,i.buttonData.components.clickrun.method=n[a].action.method,n[a].action.component&&(i.buttonData.components.clickrun.component=n[a].action.component),n[a].action.params&&(i.buttonData.components.clickrun.params=n[a].action.params),n[a].action.menu?"stay"===n[a].action.menu||("back"===n[a].action.menu?(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ToggleMenu",i.buttonData.components.menurun.params=null):"close"===n[a].action.menu&&(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="ResetMenu")):(i.buttonData.components.menurun={},i.buttonData.components.menurun.cursorObj=i.id,i.buttonData.components.menurun.method="SubMenu",i.buttonData.components.menurun.params=n[a].subMenu),i.buttonData.components.mouseenterrun={},i.buttonData.components.mouseenterrun.cursorObj=i.id,i.buttonData.components.mouseenterrun.method="SpawnDescription",i.buttonData.components.mouseenterrun.params=a,i.buttonData.components.mouseleaverun={},i.buttonData.components.mouseleaverun.cursorObj=i.id,i.buttonData.components.mouseleaverun.method="DespawnDescription",i.buttonData.components.mouseleaverun.params=a,i.hoverData.id=n[a].id+"hover",i.hoverData.text.value=n[a].description,i.cores.hover[e][a]=t.Core(i.hoverData),i.cores[e][a]=t.Core(i.buttonData);s>a&&(a=s)}},SubMenu:h,ResetMenu:c,SpawnDescription:t=>{if(i.descriptionOpen);else{i.buttonHover=t;let e=i.cores[i.currentMenu][t].GetEl();i.cores.hover[i.currentMenu][t].SpawnCore(e),i.descriptionOpen=!0}},DespawnDescription:p}})(i,t),this.HoverMenu=t=>s(i,t),this.ComboLock=(t,e,o,a,n)=>r(i,t,e,o,a,n),this.ScrollMenu=t=>((t,e)=>{let i={};return i.id=e,i.AllParentData={data:"AllParentData",id:"allParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,1.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},i.allParent=t.Core(i.AllParentData),i.scrollBkgdData={data:"scrollBkgdData",id:"scrollBkgd",sources:!1,text:!1,geometry:{primitive:"box",depth:.1,width:.5,height:1.4},material:{shader:"standard",color:"#e02574",emissive:"#e02574",emissiveIntensity:.25,opacity:.5},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{scroll:{type:"plane",axis:"vertical",parent:"scrollParent",length:1,options:5,elements:["scroll0","scroll1","scroll2","scroll3","scroll4","scroll5","scroll6","scroll7"]}}},i.scrollBkgd=t.Core(i.scrollBkgdData),i.scrollParentData={data:"scrollParentData",id:"scrollParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},i.scrollParent=t.Core(i.scrollParentData),i.scroll0Data={data:"scroll0Data",id:"scroll0",sources:!1,text:!1,geometry:{primitive:"box",depth:.025,width:.1,height:.1},material:{shader:"standard",color:"#e02574",emissive:"#e02574",opacity:0},position:new THREE.Vector3(0,-.6,.1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click:{property:"material.emissiveIntensity",from:"0.25",to:"1",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},i.scroll0=t.Core(i.scroll0Data),i.scroll1Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll1",position:new THREE.Vector3(0,-.4,.1),material:{shader:"standard",color:"#66e025",emissive:"#66e025",opacity:1}},!0),i.scroll1=t.Core(i.scroll1Data),i.scroll2Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll2",position:new THREE.Vector3(0,-.2,.1),material:{shader:"standard",color:"#256de0",emissive:"#256de0",opacity:1}},!0),i.scroll2=t.Core(i.scroll2Data),i.scroll3Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll3",position:new THREE.Vector3(0,0,.1),material:{shader:"standard",color:"#e0e025",emissive:"#e0e025",opacity:1}},!0),i.scroll3=t.Core(i.scroll3Data),i.scroll4Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll4",position:new THREE.Vector3(0,.2,.1),material:{shader:"standard",color:"#e09825",emissive:"#e09825",opacity:1}},!0),i.scroll4=t.Core(i.scroll4Data),i.scroll5Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll5",position:new THREE.Vector3(0,.4,.1),material:{shader:"standard",color:"#e02525",emissive:"#e02525",opacity:1}},!0),i.scroll5=t.Core(i.scroll5Data),i.scroll6Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll6",position:new THREE.Vector3(0,.6,.1),material:{shader:"standard",color:"#25e0d9",emissive:"#25e0d9",opacity:0}},!0),i.scroll6=t.Core(i.scroll6Data),i.scroll7Data=t.coreDataFromTemplate(i.scroll0Data,{id:"scroll7",position:new THREE.Vector3(0,.8,.1),material:{shader:"standard",color:"#ffffff",emissive:"#ffffff",opacity:0}},!0),i.scroll7=t.Core(i.scroll7Data),i.scrollAllData={parent:{core:i.allParent},child0:{core:i.scrollBkgd},child1:{parent:{core:i.scrollParent},child0:{core:i.scroll0},child1:{core:i.scroll1},child2:{core:i.scroll2},child3:{core:i.scroll3},child4:{core:i.scroll4},child5:{core:i.scroll5},child6:{core:i.scroll6},child7:{core:i.scroll7}}},i.scrollAll=t.Layer("scrollAll",i.scrollAllData),{scrollMenu:i,SpawnScrollMenu:()=>{i.scrollAll.SpawnLayer()},DespawnScrollMenu:()=>{i.scrollAll.DespawnLayer()}}})(i,t),this.SkyBox=t=>((t,e)=>{let i,o,a=Object.assign({},e);a.inScene=!1,a.time=5.5,a.day=!1;const n=()=>{a.inScene||((()=>{for(let t in a.lights)a.lights[t].SpawnCore?a.lights[t].SpawnCore():a.lights[t].SpawnLayer?a.lights[t].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.lights[t]))})(),(()=>{for(let t in a.sky)a.sky[t].SpawnCore?a.sky[t].SpawnCore():a.sky[t].SpawnLayer?a.sky[t].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.sky[t]))})(),(()=>{for(let t in a.space)a.space[t].SpawnCore?a.space[t].SpawnCore():a.space[t].SpawnLayer?a.space[t].SpawnLayer():(console.log("Failed to spawn object"),console.log(a.space[t]))})(),a.inScene=!0)},s=()=>{a.inScene&&(clearTimeout(i),clearInterval(o),(()=>{for(let t in a.lights)a.lights[t].DespawnCore?a.lights[t].DespawnCore():a.lights[t].DespawnLayer?a.lights[t].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.lights[t]))})(),(()=>{for(let t in a.sky)a.sky[t].DespawnCore?a.sky[t].DespawnCore():a.sky[t].DespawnLayer?a.sky[t].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.sky[t]))})(),(()=>{for(let t in a.space)a.space[t].DespawnCore?a.space[t].DespawnCore():a.space[t].DespawnLayer?a.space[t].DespawnLayer():(console.log("Failed to spawn object"),console.log(a.space[t]))})(),t.RemoveFromTracker(a.id),a.inScene=!1)},r=(t,e)=>{for(let i in t)t[i].SpawnCore?t[i].EmitEvent(e):t[i].SpawnLayer?t[i].EmitEventAll(e):(console.log("Failed to emit event to object"),console.log(t[i]))},l=()=>{a.day=!0,r(a.lights,"sunrise"),r(a.sky,"sunrise"),r(a.space,"sunrise")},c=()=>{a.day=!1,r(a.lights,"sunset"),r(a.sky,"sunset"),r(a.space,"sunset")},h=()=>{r(a.lights,"pauseDayNight"),r(a.sky,"pauseDayNight"),r(a.space,"pauseDayNight")},p=e=>{e&&"number"==typeof e&&e>=24e3&&(t.timeInDay=e),l(),i=setTimeout((()=>{c(),o=setInterval((()=>{a.day?c():l()}),t.timeInDay/2)}),t.timeInDay/2-t.timeInDay/24)};return{skyBox:a,SpawnSkyBox:n,DespawnSkyBox:s,ToggleSpawn:()=>{a.inScene?s():n()},SetFlag:e=>{if(Array.isArray(e))for(let i in e)a[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:a.id,type:"skyBox",sub:!1,name:e[i].flag,data:e[i].value});else a[e.flag]=e.value,t.saveToProfile({auxlObject:a.id,type:"skyBox",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(a(t[i]));return e}return a[t]},DayNightCycle:p,PauseDayNight:h,ResumeDayNight:()=>{r(a.lights,"resumeDayNight"),r(a.sky,"resumeDayNight"),r(a.space,"resumeDayNight")},RestartDayNight:t=>{h(),Despawn(),Spawn(),p(t)},SetTime:e=>{h(),a.day=e>=6&&e<=18,a.time=e;let i=15*a.time-90;t.sunLayer.layer.inScene&&t.sunLayer.GetChild("sunOuter").ChangeSelf({property:"rotation",value:new THREE.Vector3(i,45,0)});let o=15*a.time+90;t.moonLayer.layer.inScene&&t.moonLayer.GetChild("moonOuter").ChangeSelf({property:"rotation",value:new THREE.Vector3(o,45,0)})}}})(i,t),this.Horizon=t=>((t,e)=>{let i,o,a,n,s,r,l,c,h=Object.assign({},e);h.inScene=!1,"low"===h.density?s=5:"normal"===h.density?s=10:"high"===h.density&&(s=20),"low"===h.height?r=.5:"normal"===h.height?r=1:"high"===h.height&&(r=1.5),"low"===h.width?l=.5:"normal"===h.width?l=1:"high"===h.width&&(l=1.5);let p,d=new THREE.Vector3(0,0,-1*h.radius),u=new THREE.Vector3(1,1,1);"mountains"===h.type?(p=100*r,c={primitive:"cone",height:p,radiusBottom:50,radiusTop:0,openEnded:!0,segmentsHeight:1,segmentsRadial:9,thetaLength:180,thetaStart:90},u.x=1.5*l):"hills"===h.type?(p=50*r,c={primitive:"circle",radius:p,thetaStart:0,thetaLength:180},u.x=1.5*l):"buildings"===h.type?(p=100*r,c={primitive:"plane",width:40*l,height:p}):"cylinderWall"===h.type?(p=50*r,c={primitive:"cylinder",openEnded:!0,radius:h.radius,height:p,segmentsHeight:9,segmentsRadial:32,thetaStart:0,thetaLength:360},d.z=0,s=1):"squareWall"===h.type&&(p=40*r,c={primitive:"plane",width:2*h.radius,height:p},s=4);let m={data:"horizonAllData",id:"horizonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,-5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},y={parent:{core:t.Core(m)}},g={data:"horizonParentData",id:"horizonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},v="horizonParent",f=[],b={data:"horizonChildData",id:"horizonChild",sources:!1,text:!1,geometry:c,material:!1,position:d,rotation:new THREE.Vector3(0,0,0),scale:u,animations:!1,mixins:!1,classes:["a-ent"],components:!1},w="horizonChild",E=[];for(let e=0;e<s;e++){v="horizonParent"+e;let r,c,d,u=new THREE.Vector3(0,0,0);u.y=360/s*e,g.id=v,g.rotation=u,f[e]=t.Core(g),w="horizonChild"+e,b.id=w,"squareWall"===h.type||(b.scale.x=1.5*l+(.1*Math.random()-.2),b.scale.y=.2*Math.random()-.4+1),"mountains"===h.type||"buildings"===h.type||"cylinderWall"===h.type||"squareWall"===h.type?b.position.y=b.scale.y*p/2-1:"hills"===h.type&&(b.position.y=-1),h.texture?(n=h.baseColor?t.colorTheoryGen(h.baseColor):h.baseColorFamily?t.colorTheoryGen(!1,h.baseColorFamily):t.colorTheoryGen(),d=n.base,r={shader:"standard",side:"double",color:d},h.texture.src&&(c=Array.isArray(h.texture.src)?h.texture.src[Math.floor(Math.random()*h.texture.src.length)]:h.texture.src,r.src=c),h.texture.repeat&&(r.repeat=h.texture.repeat),h.texture.opacity&&(r.opacity=h.texture.opacity),h.texture.metalness&&(r.metalness=h.texture.metalness),h.texture.roughness&&(r.roughness=h.texture.roughness),h.texture.emissive&&(r.emissive=d),h.texture.emissiveIntensity&&(r.emissiveIntensity=h.texture.emissiveIntensity)):h.baseColor?(n=t.colorTheoryGen(h.baseColor),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}):h.baseColorFamily?(n=t.colorTheoryGen(!1,h.baseColorFamily),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}):(n=t.colorTheoryGen(),o=n.base,i=n.tetradic[0],a=n.tetradic[1],r={shader:"threeColorGradientShader",topColor:i,middleColor:o,bottomColor:a,side:"double"}),b.material=r,E[e]=t.Core(b),y["child"+e]={parent:{core:f[e]},child0:{core:E[e]}}}let x=t.Layer("horizonLayer",y);const D=()=>{h.inScene||(x.SpawnLayer(),h.inScene=!0)},T=()=>{h.inScene&&(x.DespawnLayer(),t.RemoveFromTracker(h.id),h.inScene=!1)};return{horizon:h,SpawnHorizon:D,DespawnHorizon:T,ToggleSpawn:()=>{h.inScene?T():D()},SetFlag:e=>{if(Array.isArray(e))for(let i in e)h[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:h.id,type:"horizon",sub:!1,name:e[i].flag,data:e[i].value});else h[e.flag]=e.value,t.saveToProfile({auxlObject:h.id,type:"horizon",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(h(t[i]));return e}return h[t]}}})(i,t),this.ObjsGenRing=t=>((t,e)=>{let i=Object.assign({},e);i.inScene=!1;let o,a,n,s,r,l,c,h,p,d,u,m=Object.assign({},e.objData),y=JSON.parse(JSON.stringify(e.objData));function g(t,e,i,o){return Math.sqrt(Math.pow(i-t,2)+1*Math.pow(o-e,2))}function v(t,e){return o=Math.random()*(2*t)-t,n=Math.random()*(2*t)-t,new THREE.Vector3(o,e,n)}i.all=[];const f=()=>{if(i.inScene);else{(()=>{for(let e=0;e<i.total;e++){y.id=m.id+e,i.ranColor&&(u=t.colorTheoryGen().base,y.material.color=u,y.material.emissive&&(y.material.emissive=u)),i.ranTexture&&(y.material.src=t.patterns[Math.floor(Math.random()*t.patterns.length)]),h=y.rotation.x,p=y.rotation.y,d=y.rotation.z,i.ranRotX&&(h+=360*Math.random()),i.ranRotY&&(p+=360*Math.random()),i.ranRotZ&&(d+=360*Math.random()),y.rotation=new THREE.Vector3(h,p,d),r=i.objData.scale.x,l=i.objData.scale.y,c=i.objData.scale.z,i.ranScaleX&&(r+=Math.random()*i.scaleFlex),i.ranScaleY&&(l+=Math.random()*i.scaleFlex),i.ranScaleZ&&(c+=Math.random()*i.scaleFlex),y.scale=new THREE.Vector3(r,l,c),a=i.objData.position.y,i.ranYPos&&(a+=Math.random()*i.yPosFlex),s=v(i.outerRingRadius,a),y.position=s;let o=42;t:for(;o>0;){if(0===e){if(g(s.x,s.z,0,0)<i.innerRingRadius){s=v(i.outerRingRadius,a),o--;continue t}y.position=s}for(let t=0;t<i.all.length;t++){if(g(s.x,s.z,i.all[t].core.position.x,i.all[t].core.position.z)<i.sameTypeRadius||g(s.x,s.z,0,0)<i.innerRingRadius){s=v(i.outerRingRadius,a),o--;continue t}y.position=s}break}i.all.push(t.Core(y))}})();for(let t=0;t<i.total;t++)i.all[t].SpawnCore();i.inScene=!0}},b=()=>{if(i.inScene){for(let t=0;t<i.total;t++)i.all[t].DespawnCore();t.RemoveFromTracker(i.id),i.inScene=!1}};return{singleGen:i,SpawnObjRing:f,DespawnObjRing:b,ToggleSpawn:()=>{i.inScene?b():f()},SetFlag:e=>{if(Array.isArray(e))for(let o in e)i[e[o].flag]=e[o].value,t.saveToProfile({auxlObject:i.id,type:"singleGen",sub:!1,name:e[o].flag,data:e[o].value});else i[e.flag]=e.value,t.saveToProfile({auxlObject:i.id,type:"singleGen",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let o in t)e.push(i(t[o]));return e}return i[t]}}})(i,t),this.MultiAssetGen=t=>((t,e)=>{let i=Object.assign({},e);i.inScene=!1,i.assets={},i.assets.tiny=[],i.assets.small=[],i.assets.med=[],i.assets.large=[],i.assets.huge=[];let o=["tiny","small","med","large","huge"];i.grid=[],i.ring0=[],i.ring1=[],i.ring2=[],i.ring3=[],i.ring4=[],i.ring5=[],i.ring={i0:.5,o0:4,i1:3,o1:25,i2:5,o2:60,i3:6,o3:80,i4:8,o4:100,i5:18,o5:150};let a=[],n=[],s=[],r=[],l=[],c=[],h=x("ring5",i.ring.o5,i.ring.i5),p=x("ring4",i.ring.o4,i.ring.i4,h),d=x("ring3",i.ring.o3,i.ring.i3,p),u=x("ring2",i.ring.o2,i.ring.i2,d),m=x("ring1",i.ring.o1,i.ring.i1,u),y=(x("ring0",i.ring.o0,i.ring.i0,m),0),g=0,v=0,f=0,b=0,w=0;for(let t in a)a[t][0]-=i.ring.o5/2,a[t][1]-=i.ring.o5/2,0===a[t][0]&&0===a[t][1]&&(a[t][0]=a[t][1]=i.ring.o5/2);for(let t in n)n[t][0]-=i.ring.o4/2,n[t][1]-=i.ring.o4/2,0===n[t][0]&&0===n[t][1]&&(n[t][0]=n[t][1]=i.ring.o4/2);for(let t in s)s[t][0]-=i.ring.o3/2,s[t][1]-=i.ring.o3/2,0===s[t][0]&&0===s[t][1]&&(s[t][0]=s[t][1]=i.ring.o3/2);for(let t in r)r[t][0]-=i.ring.o2/2,r[t][1]-=i.ring.o2/2,0===r[t][0]&&0===r[t][1]&&(r[t][0]=r[t][1]=i.ring.o2/2);for(let t in l)l[t][0]-=i.ring.o1/2,l[t][1]-=i.ring.o1/2,0===l[t][0]&&0===l[t][1]&&(l[t][0]=l[t][1]=i.ring.o1/2);for(let t in c)c[t][0]-=i.ring.o0/2,c[t][1]-=i.ring.o0/2,0===c[t][0]&&0===c[t][1]&&(c[t][0]=c[t][1]=i.ring.o0/2);function E(t){t.sort((()=>Math.random()-.5))}function x(t,e,i,o){let h,p;p=!!o&&o.center;let d=function*(p,d,u,m){const y=u*u,g=u*Math.SQRT1_2,v=Math.ceil(p/g),f=Math.ceil(d/g);let b=[];if(h=new Array(v*f),o)for(let t in o)h[t]=o[t],b[t]=o[t];m?yield{add:E(m,m)}:yield{add:E(p/2,d/2)};t:for(;b.length;){const t=Math.trunc(Math.random()*b.length),o=b[t],a=Math.random(),n=1e-7;for(let t=0;t<15;++t){const s=2*Math.PI*(a+1*t/15),r=u+n,l=o[0]+r*Math.cos(s),c=o[1]+r*Math.sin(s);if(i<=l&&l<e&&i<=c&&c<e&&w(l,c)){yield{add:E(l,c),parent:o};continue t}}const s=b.pop();t<b.length&&(b[t]=s),yield{remove:o}}function w(t,e){const i=Math.trunc(t/g),o=Math.trunc(e/g),a=Math.max(i-2,0),n=Math.max(o-2,0),s=Math.min(i+3,v),r=Math.min(o+3,f);for(let i=n;i<r;++i){const o=i*v;for(let i=a;i<s;++i){const a=h[o+i];if(a){const i=a[0]-t,o=a[1]-e;if(i*i+o*o<y)return!1}}}return!0}function E(e,i,o){const p=h[v*Math.trunc(i/g)+Math.trunc(e/g)]=[e,i];return b.push(p),"ring5"===t?a.push(p):"ring4"===t?n.push(p):"ring3"===t?s.push(p):"ring2"===t?r.push(p):"ring1"===t?l.push(p):"ring0"===t&&c.push(p),p}}(e,e,i,p);!function t(){d.done=d.next().done,d.done||t()}();let u=[];for(let t in h)h[t]&&u.push(h[t]);return u}E(a),E(n),E(s),E(r),E(l),E(c);const D=()=>{if(i.inScene);else{(()=>{for(let e in o){let h=Object.assign({},i[o[e]]);for(let p in h.objs){let d,u,m,E,x,D,T,R,M,P,k=Object.assign({},h.objs[p]),S=JSON.parse(JSON.stringify(h.objs[p]));for(let p=0;p<h.max/h.objs.length;p++)S.id=k.id+p,h.ranColor&&(P=t.colorTheoryGen().base,S.material.color=P,S.material.emissive&&(S.material.emissive=P)),h.ranTexture&&(S.material.src=t.patterns[Math.floor(Math.random()*t.patterns.length)]),T=k.rotation.x,R=k.rotation.y,M=k.rotation.z,h.ranRotX&&(T+=360*Math.random()),h.ranRotY&&(R+=360*Math.random()),h.ranRotZ&&(M+=360*Math.random()),S.rotation=new THREE.Vector3(T,R,M),E=k.scale.x,x=k.scale.y,D=k.scale.z,h.ranScaleX&&(E+=Math.random()*h.scaleFlex),h.ranScaleY&&(x+=Math.random()*h.scaleFlex),h.ranScaleZ&&(D+=Math.random()*h.scaleFlex),S.scale=new THREE.Vector3(E,x,D),u=k.position.y,h.ranYPos&&(u+=Math.random()*h.yPosFlex),0===h.rings?w<c.length?(d=c[w][0],m=c[w][1],w++):(d=Math.random()*(2*i.ring.o0)-i.ring.o0+i.ring.i0,m=Math.random()*(2*i.ring.o0)-i.ring.o0+i.ring.i0):1===h.rings?b<l.length?(d=l[b][0],m=l[b][1],b++):(d=Math.random()*(2*i.ring.o1)-i.ring.o1+i.ring.i1,m=Math.random()*(2*i.ring.o1)-i.ring.o1+i.ring.i1):2===h.rings?f<r.length?(d=r[f][0],m=r[f][1],f++):(d=Math.random()*(2*i.ring.o2)-i.ring.o2+i.ring.i2,m=Math.random()*(2*i.ring.o2)-i.ring.o2+i.ring.i2):3===h.rings?v<s.length?(d=s[v][0],m=s[v][1],v++):(d=Math.random()*(2*i.ring.o3)-i.ring.o3+i.ring.i3,m=Math.random()*(2*i.ring.o3)-i.ring.o3+i.ring.i3):4===h.rings?g<n.length?(d=n[g][0],m=n[g][1],g++):(d=Math.random()*(2*i.ring.o4)-i.ring.o4+i.ring.i4,m=Math.random()*(2*i.ring.o4)-i.ring.o4+i.ring.i4):5===h.rings&&(y<a.length?(d=a[y][0],m=a[y][1],y++):(d=Math.random()*(2*i.ring.o5)-i.ring.o5+i.ring.i5,m=Math.random()*(2*i.ring.o5)-i.ring.o5+i.ring.i5)),S.position=new THREE.Vector3(d,u,m),i.assets[o[e]].push(t.Core(S))}}})();for(let t in o){let e=i.assets[o[t]];for(let t in e)e[t].SpawnCore()}i.inScene=!0}},T=()=>{if(i.inScene){for(let t in o){let e=i.assets[o[t]];for(let t in e)e[t].DespawnCore()}t.RemoveFromTracker(i.id),i.inScene=!1}};return{multiGen:i,SpawnMultiAsset:D,DespawnMultiAsset:T,ToggleSpawn:()=>{i.inScene?T():D()},SetFlag:e=>{if(Array.isArray(e))for(let o in e)i[e[o].flag]=e[o].value,t.saveToProfile({auxlObject:i.id,type:"multiGen",sub:!1,name:e[o].flag,data:e[o].value});else i[e.flag]=e.value,t.saveToProfile({auxlObject:i.id,type:"multiGen",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let o in t)e.push(i(t[o]));return e}return i[t]}}})(i,t),this.Teleport=(t,e)=>((t,e,i)=>{let o,a,n={};n.id=e,n.inScene=!1,n.all=[];let s,r,l,c="",h="",p="";for(let e in i)l=t.colorTheoryGen().base,c="teleport"+e+"Parent",t.teleportParentData.id=c,t.teleportParentData.position=i[e],a=t.Core(t.teleportParentData),h="teleport"+e+"Confirm",t.teleportConfirmData.id=h,t.teleportConfirmData.material.color=l,t.teleportConfirmData.material.emissive=l,s=t.Core(t.teleportConfirmData),p="teleport"+e+"Cancel",t.teleportCancelData.id=p,t.teleportCancelData.material.color=l.compl,t.teleportCancelData.material.emissive=l.compl,r=t.Core(t.teleportCancelData),o={parent:{core:a},child0:{core:s},child1:{core:r}},n.all[e]=t.Layer("teleport"+e,o);const d=()=>{if(n.inScene);else{for(let t in n.all)n.all[t].SpawnLayer();n.inScene=!0}},u=()=>{if(n.inScene){for(let t in n.all)n.all[t].DespawnLayer();t.RemoveFromTracker(n.id),n.inScene=!1}};return{teleport:n,SpawnTeleport:d,DespawnTeleport:u,ToggleSpawn:()=>{n.inScene?u():d()},SetFlag:e=>{if(Array.isArray(e))for(let i in e)n[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:n.id,type:"teleport",sub:!1,name:e[i].flag,data:e[i].value});else n[e.flag]=e.value,t.saveToProfile({auxlObject:n.id,type:"teleport",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(n(t[i]));return e}return n[t]}}})(i,t,e),this.Book=(t,e)=>((t,e,i)=>{let o=0,a=0,n=0;for(let t in e.pages)n+=Object.keys(e.pages[t]).length-1;let s=e.pages["page"+a].info.timeline,r=e.idle.page0.info.timeline,l=Object.keys(e.pages.page0).length,c=Math.floor(Math.random()*l-1)+1,h=0,p=Object.keys(e.idle.page0).length,d=Math.floor(Math.random()*p-1)+1,u=0;const m=(e,o,a)=>{"self"===e&&(e=i.id);for(let a in t.objGenTracking)o!==t.objGenTracking[a].spawn&&o!==t.objGenTracking[a].altSpawn||t.spawnTracker(e,"book",i.id);t[e][o](a)};function*y(e,a){o++,i.bookEnd=o>=n;for(let e in a)if("id"===e||"description"===e||"tags"===e||"nextPage"===e||"prevPage"===e||"timeline"===e);else if("pureFunction"===e)t[e](a[e]);else for(let t in a[e])m(e,t,a[e][t]);yield}function*g(t,i){for(let o in i)t.currentTimeline=o,t.timelineQue.push([o,i[o]]),o===e.jumpTo&&(e.jumping=!1),e.jumping||(yield*y(0,i[o]))}let v=function*(t){t.currentTimeline=0,t.currentEntry=0,t.currentDialog=0,t.pageQue=[],t.timelineQue=[],t.entryQue=[],t.textBubbleQue=[],t.speaker="",t.speaking=!1,t.jumping=!1,t.jumpTo,t.selectJumpMenu,o=0,i.bookEnd=!1,yield*function*(t){for(let e in t.pages)t.currentPage=e,t.pageQue.push([e,t.pages[e]]),yield*g(t,t.pages[e])}(t)}(e);function*f(e,i){for(let e in i)if("id"===e||"description"===e||"tags"===e||"nextPage"===e||"prevPage"===e||"timeline"===e);else if("pureFunction"===e)t[e](i[e]);else for(let t in i[e])m(e,t,i[e][t]);yield}function*b(t,i){for(let o in i)t.currentTimeline=o,t.timelineQue.push([o,i[o]]),o===e.jumpTo&&(e.jumping=!1),e.jumping||(yield*f(0,i[o]))}let w=!1;e.idle&&(w=function*(t){t.currentPage=0,t.currentTimeline=0,t.currentEntry=0,t.currentDialog=0,t.pageQue=[],t.timelineQue=[],t.entryQue=[],t.textBubbleQue=[],t.speaker="",t.speaking=!1,t.jumping=!1,t.jumpTo,t.selectJumpMenu,yield*function*(t){for(let e in t.idle)t.currentPage=e,t.pageQue.push([e,t.idle[e]]),yield*b(t,t.idle[e])}(t)}(e));const E=t=>{"random"===s&&x(t),v.done=v.next().done;let e=setTimeout((function(){i.loadingTimeline=!1,clearTimeout(e)}),1e3)},x=e=>{if(e)c=e;else{for(c=Math.floor(Math.random()*l);c>=l-1||c===h;)c=Math.floor(Math.random()*l-1)+1;c<=h&&t[i.id].ResetBookRandom(!0)}R({timeline:"timeline"+c,page:"page"+a}),h=c},D=e=>{if(e)d=e;else{for(d=Math.floor(Math.random()*p)+1;d>=p-1||d===u;)d=Math.floor(Math.random()*p-1)+1;d<=u&&t[i.id].ResetIdleRandom(!0,d)}T({timeline:"timeline"+d,page:"page0"}),u=d},T=({timeline:t,page:i})=>{let o=i||e.currentPage;e.jumpTo=t,e.idle[o][e.jumpTo]&&(e.jumping=!0)},R=({timeline:t,page:i})=>{let o=i||e.currentPage;e.jumpTo=t,e.pages[o][e.jumpTo]&&(e.jumping=!0)};return{bookData:e,book:v,idleBook:w,Init:()=>{v.done=v.next().done,v.done=v.next().done,i.loadingTimeline=!1},Next:E,NewPage:({page:t,timeline:i})=>{let o;t?o=t:(a+=1,o="page"+a),R({timeline:i||"timeline0",page:o});let n=setTimeout((function(){E(),clearTimeout(n)}),250);s=e.pages["page"+a].info.timeline},Random:x,IdleInit:()=>{w.done=w.next().done,i.loadingTimeline=!1},IdleNext:t=>{"random"===r&&D(t),w.done=w.next().done;let e=setTimeout((function(){i.loadingTimeline=!1,clearTimeout(e)}),1e3)},RandomIdle:D,Jump:R,JumpIdle:T,SelectJump:e=>{let o={id:"selectJumpMenu",prompt:e[0],options:{},actions:{},data:t.menuBaseData,cursorObj:i.id,pos:new THREE.Vector3(1,1.5,-.5),method:"Click"};for(let t=1;t<e.length;t++)o.options["option"+(t-1)]=e[t][0],o.actions["action"+(t-1)]=e[t][1];if(i.selectJumpMenu=t.Menu(o),i.selectJumpMenu.SpawnMenu(),i.selectJumpMenu.AddToParentSpawnTracker(i.selectJumpMenu,i,"book"),"core"===i.bubble.type?i.bubble.GetEl().classList.toggle("clickable",!1):i.bubble.GetParentEl().classList.toggle("clickable",!1),"core"===i.avatarType)i.avatar.GetEl().classList.toggle("clickable",!1);else{let t=i.avatar.GetAllEl();for(let e in t)t[e].classList.toggle("clickable",!1)}},readTimeline:function({page:i,time:o}){for(let a in e.pages[i][o])if("pureFunction"===a)t[a](o[a]);else for(let n in e.pages[i][o][a])t[a][n](e.pages[i][o][a][n])}}})(i,t,e),this.SpeechSystem=(t,e,o)=>l(i,t,e),this.NPC=(t,e,o,a,n)=>((t,e,i,o,a,n)=>{let s,r={};r.avatar=Object.assign({},i),r.avatarType,r.parentId,i.SpawnCore?(r.avatarType="core",r.parentId=i.core.id):i.SpawnLayer&&(r.avatarType="layer",r.parentId=i.layer.all.parent.core.core.id),r.id=e,r.special=n||!0,r.inScene=!1,r.speaking=!1,r.bookEnd=!1,r.idle=!1,r.idleSpeech=!1,r.loadingTimeline=!1,o.info.name?r.name=o.info.name:r.name=r.id,r.bubble=Object.assign({},a),r.bubble.blink=!0;let l,c,h=t.SpeechSystem(r.bubble,r);o.idle&&(r.idleSpeech=!0);let p,d,u=o.info.idleDelay||7e3,m=o.info.idleInterval||1e4;const y=(t,e)=>{if("core"===r.avatarType)r.avatar.GetEl().addEventListener(t,e);else{let i=r.avatar.GetAllEl();for(let o in i)i[o].addEventListener(t,e)}},g=(t,e)=>{if("core"===r.avatarType)r.avatar.GetEl().removeEventListener(t,e);else{let i=r.avatar.GetAllEl();for(let o in i)i[o].removeEventListener(t,e)}},v=(t,e)=>{if("core"===r.avatarType)r.avatar.GetEl().addEventListener(t,e);else{let i=r.avatar.GetAllChildEl();for(let o in i)i[o].addEventListener(t,e)}},f=(t,e)=>{if("core"===r.avatarType)r.avatar.GetEl().removeEventListener(t,e);else{let i=r.avatar.GetAllChildEl();for(let o in i)i[o].removeEventListener(t,e)}},b=e=>{if(r.inScene);else{let i=e||!1;s=t.Book(o,r),"core"===r.avatarType?r.avatar.SpawnCore(i):r.avatar.SpawnLayer(i),l=setTimeout((()=>{r.special?v("mouseenter",x):y("mouseenter",x),clearTimeout(l)}),25),r.idleSpeech&&(c=setTimeout((()=>{R(),clearTimeout(c)}),u)),r.inScene=!0}},w=()=>{r.inScene&&(E(),clearTimeout(l),clearTimeout(c),D(),M(),r.speaking?r.special?f("mouseenter",T):g("mouseenter",T):r.special?f("mouseenter",x):g("mouseenter",x),"core"===r.avatarType?r.avatar.DespawnCore():r.avatar.DespawnLayer(),t.RemoveFromTracker(r.id),r.inScene=!1)},E=()=>{t.clearSpawned(t.bookSpawned[r.id]),delete t.bookSpawned[r.id]},x=()=>{r.idle&&M(),clearTimeout(c),r.speaking=!0,r.special?f("mouseenter",x):g("mouseenter",x),h.Start(),s.Init(),r.special?v("mouseenter",T):y("mouseenter",T)},D=()=>{h.KillStop(),r.special?f("mouseenter",T):g("mouseenter",T)},T=t=>{h.core.on?h.core.speaking||r.loadingTimeline||(r.loadingTimeline=!0,s.Next(t)):r.loadingTimeline||(r.loadingTimeline=!0,s.Next(t))},R=()=>{r.idle=!0,h.Start(),s.IdleInit(),P(),p=setInterval((()=>{P()}),m)},M=()=>{clearInterval(p),r.idle=!1},P=t=>{h.core.on?h.core.speaking||r.loadingTimeline||(r.loadingTimeline=!0,s.IdleNext(t)):r.loadingTimeline||(r.loadingTimeline=!0,s.IdleNext(t))},k=({timeline:t,page:e})=>{s.Jump({timeline:t,page:e})},S=(e,i,o)=>{"self"===e&&(e=r.id),t[e][i](o)};return{npc:r,GetAllNPCEl:()=>{let t;return t="core"===r.avatarType?r.avatar.GetEl():r.avatar.GetAllEl(),t},GetMainNPCEl:()=>{let t;return t="core"===r.avatarType?r.avatar.GetEl():r.avatar.GetParentEl(),t},AddNPCEventsAll:y,RemoveNPCEventsAll:g,SpawnNPC:b,DespawnNPC:w,ToggleSpawn:()=>{r.inScene?w():b()},EnableSpeech:x,DisableSpeech:D,EnableIdleSpeech:R,DisableIdleSpeech:M,Speak:({role:t,speech:e})=>{t?"self"===t&&(t=r.name):t=r.name,h.DisplaySpeech({role:t,speech:e})},NextTimeline:T,NewPage:({page:t,timeline:e})=>{s.NewPage({page:t,timeline:e})},ResetSpeech:e=>{D(),E(),s=t.Book(o,r),r.special?v("mouseenter",x):y("mouseenter",x)},ResetBook:e=>{(s.book.done||e)&&(E(),s=t.Book(o,r),s.Init())},ForceResetBook:()=>{E(),s=t.Book(o,r),s.Init()},ResetBookRandom:(e,i)=>{(s.book.done||e)&&(E(),s=t.Book(o,r),s.Init(),T(i))},IdleNextTimeline:P,IdleReset:e=>{(s.idleBook.done||e)&&(E(),s=t.Book(o,r),s.IdleInit())},ResetIdleRandom:(e,i)=>{(s.idleBook.done||e)&&(E(),s=t.Book(o,r),s.IdleInit(),P(i))},UpdateBook:()=>{console.log(o),console.log(o.pages),console.log(o.idle)},Click:t=>{h.Skip();let e=t.getAttribute("result");if(k({timeline:e}),s.Next(),"core"===r.bubble.type?r.bubble.GetEl().classList.toggle("clickable",!1):r.bubble.GetParentEl().classList.toggle("clickable",!1),"core"===r.avatarType)r.avatar.GetEl().classList.toggle("clickable",!0);else{let t=r.avatar.GetAllEl();for(let e in t)t[e].classList.toggle("clickable",!0)}d=setTimeout((function(){r.selectJumpMenu.DespawnMenu(),r.selectJumpMenu.RemoveMenuFromSceneTracker(),clearTimeout(d)}),250)},Jump:k,SelectJump:t=>{s.SelectJump(t)},auxlObjMethod:S,IfElse:e=>{let i=Object.keys(e)[0],o=e[i].cond,a=e[i].ifTrue,n=e[i].ifFalse;if("self"===i&&(i=r.id),t[i].GetFlag)if(t[i].GetFlag(o))for(let t in a)for(let e in a[t])S(t,e,a[t][e]);else for(let t in n)for(let e in n[t])S(t,e,n[t][e]);else if(t[i].GetFlagParent)if(t[i].GetFlagParent(o))for(let t in a)for(let e in a[t])S(t,e,a[t][e]);else for(let t in n)for(let e in n[t])S(t,e,n[t][e])},Switch:e=>{let i=Object.keys(e)[0],o=e[i];"self"===i&&(i=r.id);let a=[];for(let t in o)"cond"===t||"default"===t||a.push(t);if(t[i].GetFlag){let e=t[i].GetFlag(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])S(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])S(t,e,o.default[t][e])}else if(t[i].GetFlagParent){let e=t[i].GetFlagParent(o.cond);for(let t in a)if(e===a[t]){for(let e in o[a[t]])for(let i in o[a[t]][e])S(e,i,o[a[t]][e][i]);return}for(let t in o.default)for(let e in o.default[t])S(t,e,o.default[t][e])}else console.log(i),console.log("Unable to find value"),console.log(o.cond)},SetFlag:e=>{if(Array.isArray(e))for(let i in e)r[e[i].flag]=e[i].value,t.saveToProfile({auxlObject:r.id,type:"npc",sub:!1,name:e[i].flag,data:e[i].value});else r[e.flag]=e.value,t.saveToProfile({auxlObject:r.id,type:"npc",sub:!1,name:e.flag,data:e.value})},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(r(t[i]));return e}return r[t]}}})(i,t,e,o,a,n),this.InfoBubble=(t,e,o,a)=>((t,e,i,o,a)=>{let n={};n.id=e;let s=n.id+"bubble",r=n.id+"text";n.parent=i,i.SpawnCore?n.parentType="core":i.SpawnLayer&&(n.parentType="layer"),n.custom={},n.inScene=!1,n.position=new THREE.Vector3(0,.5,0),n.rotation=new THREE.Vector3(0,0,0),n.color=a||"#14d9a4",o&&(o.x?(n.position.x=o.x,n.position.y=o.y,n.position.z=o.z):n.position.y=o),n.infoBubbleData={data:"infoBubbleData",id:s,sources:!1,sounds:{maximize:{src:t.maximize6,autoplay:!0,loop:!1,volume:1},minimize:{src:t.minimize6,autoplay:!1,loop:!1,volume:1,on:"spawnOut"}},text:!1,geometry:{primitive:"circle",radius:.3,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:n.color,opacity:1,metalness:.2,roughness:.8,emissive:n.color,emissiveIntensity:.6,side:"double"},position:n.position,rotation:n.rotation,scale:new THREE.Vector3(.01,.01,.01),animations:{spawnin:{property:"scale",from:"0.01 0.01 0.01",to:"1 1 1",dur:1500,delay:500,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!0,enabled:!0},spawnout:{property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},n[s]=t.Core(n.infoBubbleData),n.emotiTextData={data:"emotiTextData",id:r,sources:!1,text:{value:"!",wrapCount:2,color:"#FFFFFF",font:"exo2bold",zOffset:0,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(.025,.1,.025),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},n[r]=t.Core(n.emotiTextData),n.emotiLayerData={parent:{core:n[s]},child0:{core:n[r]}},n[n.id]=t.Layer(n.id,n.emotiLayerData);const l=()=>{n.inScene||(n[n.id].layer.all.parent.core.core.animations.spawnout={property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:3e3,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0},n[n.id].SpawnLayer(n.parent),n.inScene=!0,n.soundTimeout=setTimeout((()=>{n[n.id].EmitEventParent("spawnOut"),clearTimeout(n.soundTimeout)}),3e3),n.timeout=setTimeout((()=>{c(),clearTimeout(n.timeout)}),4050))},c=()=>{n.inScene&&(n[n.id].DespawnLayer(),n.inScene=!1,t.RemoveFromTracker(n.id))},h=()=>{n.inScene||(n[n.id].layer.all.parent.core.core.animations.spawnout={property:"scale",from:"1 1 1",to:"0.01 0.01 0.01",dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"spawnOut"},n[n.id].SpawnLayer(n.parent),n.inScene=!0,u("mouseenter",p))},p=()=>{n.inScene&&(m("mouseenter",p),n[n.id].EmitEventParent("spawnOut"),n.timeout=setTimeout((()=>{c(),t.RemoveFromTracker(n.id),clearTimeout(n.timeout)}),1050))},d=(t,e,i)=>{n[r].core.text.value=t,n[r].core.text.wrapCount=t.length+2,i?(i.x?n[r].core.text.xOffset=i.x:n[r].core.text.xOffset=0,i.x?n[r].core.text.yOffset=i.y:n[r].core.text.yOffset=0):(n[r].core.text.xOffset=0,n[r].core.text.zOffset=0),n[r].core.rotation.z=e||0},u=(t,e)=>{"core"===n.parentType?n.parent.GetEl().addEventListener(t,e):n.parent.GetParentEl().addEventListener(t,e)},m=(t,e)=>{"core"===n.parentType?n.parent.GetEl().removeEventListener(t,e):n.parent.GetParentEl().removeEventListener(t,e)},y=t=>{for(let e in n.custom)if(t.type===e){n.custom[e].rotation?d(n.custom[e].text,n.custom[e].rotation,n.custom[e].offset):d(n.custom[e].text),n.custom[e].alert?h():l();break}},g=()=>{d("!"),l()},v=()=>{d("!"),h()},f=()=>{d("?"),l()},b=()=>{d("?"),h()},w=()=>{d(":)",-90),l()},E=()=>{d("^-^"),l()},x=()=>{d("@"),l()},D=()=>{d("^^"),l()},T=()=>{d('"'),l()},R=()=>{d("*"),l()},M=()=>{d("?"),l()},P=()=>{d("%"),l()},k=()=>{d("zzz"),l()},S=()=>{d("+"),l()},C=()=>{d("~"),l()},L=()=>{d("!"),l()},z=()=>{d("="),l()},N=()=>{d("$"),l()},I=()=>{d("<3\n",90,{x:-.1}),l()},H=()=>{d("#"),l()};return"core"===n.parentType?(0===Object.keys(n.parent.core.components).length&&(n.parent.core.components={}),n.parent.core.components.onspawnrun__emote={cursorObj:n.id,component:null,method:"AddEmotes",params:null},n.parent.core.components.ondespawnrun__emote={cursorObj:n.id,component:null,method:"RemoveEmotes",params:null}):(0===Object.keys(n.parent.layer.all.parent.core.core.components).length&&(n.parent.layer.all.parent.core.core.components={}),n.parent.layer.all.parent.core.core.components.onspawnrun__emote={cursorObj:n.id,component:null,method:"AddEmotes",params:null},n.parent.layer.all.parent.core.core.components.ondespawnrun__emote={cursorObj:n.id,component:null,method:"RemoveEmotes",params:null}),{infoBubble:n,AddEmotes:()=>{u("alert1",v),u("alert2",b),u("emote1",g),u("emote2",f),u("emote3",w),u("emote4",E),u("casual",x),u("happy",D),u("sad",T),u("angry",R),u("confused",M),u("tired",P),u("asleep",k),u("annoyed",S),u("smug",C),u("shocked",L),u("scared",z),u("confident",N),u("love",I),u("shy",H);for(let t in n.custom)u(t,y)},RemoveEmotes:()=>{n.inScene&&(clearTimeout(n.soundTimeout),clearTimeout(n.timeout),c()),m("alert1",v),m("alert2",b),m("emote1",g),m("emote2",f),m("emote3",w),m("emote4",E),m("casual",x),m("happy",D),m("sad",T),m("angry",R),m("confused",M),m("tired",P),m("asleep",k),m("annoyed",S),m("smug",C),m("shocked",L),m("scared",z),m("confident",N),m("love",I),m("shy",H);for(let t in n.custom)m(t,y)},NewBubble:t=>{n.custom[t.eventName]=t}}})(i,t,e,o,a),this.Creature=(t,e,o)=>((t,e,i,o)=>{let a={};a.id=e,a.auxlId=e+"layer",a.bubbleId=e+"bubble",a.parent=i||!1,a.inScene=!1;let n="parent"+a.id,s="head"+a.id,r="eye1Socket"+a.id,l="eyebrow1"+a.id,c="eye1Pupil"+a.id,h="eye1PupilAccent"+a.id,p="eye1Blink"+a.id,d="eye1LidOffset"+a.id,u="eye1Lid"+a.id,m="eye2Socket"+a.id,y="eyebrow2"+a.id,g="eye2Pupil"+a.id,v="eye2PupilAccent"+a.id,f="eye2Blink"+a.id,b="eye2LidOffset"+a.id,w="eye2Lid"+a.id,E="ear1Offset"+a.id,x="ear1"+a.id,D="ear2Offset"+a.id,T="ear2"+a.id,R="body"+a.id,M=(a.id,"leg1"+a.id),P="leg2"+a.id,k="leg3"+a.id,S="leg4"+a.id;a.id,a.custom=o||!1;let C=!1,L=["egg","circle","square","rectangle","triangle"],z=!1,N=["egg","circle","square","rectangle","triangle"],I=!1,H=["*","!","x","&","<3","z"],F=!1,O=["bun","bunny","mouse","ant","horn"];a.custom&&(a.custom.eye&&(C=a.custom.eye),a.custom.pupil&&(z=a.custom.pupil),a.custom.accent&&(I=a.custom.accent),a.custom.ear&&(F=a.custom.ear)),C||(C=L[Math.floor(Math.random()*L.length)]),z||(z=N[Math.floor(Math.random()*N.length)]),I||(I=H[Math.floor(Math.random()*H.length)]),F||(F=O[Math.floor(Math.random()*O.length)]),a.position=new THREE.Vector3(0,3,-3),a.rotation=new THREE.Vector3(0,0,0),a.scale=new THREE.Vector3(1,1,1),a.custom&&(o.offset&&(o.offset.x?(a.position.x=o.offset.x,a.position.y=o.offset.y,a.position.z=o.offset.z):a.position.z=o.offset),o.rotation&&(o.rotation.x?(a.rotation.x=o.rotation.x,a.rotation.y=o.rotation.y,a.rotation.z=o.rotation.z):a.rotation.y=o.rotation),o.scale&&(o.scale.x?(a.scale.x=o.scale.x,a.scale.y=o.scale.y,a.scale.z=o.scale.z):a.scale.y=o.scale)),a.color=t.colorTheoryGen(!1,!0),a.pupilColor=a.color.base,a.pupilMaterial={shader:"standard",color:a.pupilColor,emissive:a.pupilColor,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.skinColor0=a.color.splitCompl[1],a.skinMaterial={shader:"standard",color:a.skinColor0,emissive:a.skinColor0,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.skinColor1=t.colorTheoryGen(a.skinColor0).base,a.browMaterial={shader:"standard",color:a.skinColor1,emissive:a.skinColor1,emissiveIntensity:.5,opacity:1,side:"double",metalness:.2,roughness:.8},a.accentColor="white",a.accentText={value:I,wrapCount:3,color:a.accentColor,font:"exo2bold",side:"double",align:"center",baseline:"center",zOffset:.0175};let A=Math.random();a.custom&&("small"===o.browSize?A=0:"medium"===o.browSize?A=.5:"large"===o.browSize&&(A=1)),a.browThickness=.04*A+.01;let j=Math.random();a.custom&&("small"===o.eyeSize?j=0:"medium"===o.eyeSize?j=.5:"large"===o.eyeSize&&(j=1));let V=.08*j+.125,B={primitive:"cylinder",radius:V,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},U=new THREE.Vector3(.75,1,1),G={primitive:"cylinder",radius:V,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},q=new THREE.Vector3(0,0,V),W=new THREE.Vector3(0,0,-1*V),_={primitive:"cylinder",radius:V,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},J={primitive:"cylinder",radius:V/3,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},K=.0575*j+.1,X={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},Z=new THREE.Vector3(1,1,1),Y={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Q=new THREE.Vector3(0,0,K),$=new THREE.Vector3(0,0,-1*K),tt={primitive:"cylinder",radius:K,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},et={primitive:"cylinder",radius:K/3,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},it=.125*j+.175,ot={primitive:"box",depth:it,width:it,height:.015},at=new THREE.Vector3(1,1,1),nt={primitive:"box",depth:it,width:it,height:.015},st=new THREE.Vector3(0,0,it),rt=new THREE.Vector3(0,0,-1*it),lt={primitive:"box",depth:it,width:it,height:.015},ct={primitive:"box",depth:it/3,width:it/3,height:.015},ht=.25*j+.225,pt=.66*ht,dt={primitive:"box",depth:ht,width:pt,height:.015},ut=new THREE.Vector3(1,1,1),mt={primitive:"box",depth:ht,width:pt,height:.015},yt=new THREE.Vector3(0,0,pt),gt=new THREE.Vector3(0,0,-1*pt),vt={primitive:"box",depth:ht,width:pt,height:.015},ft={primitive:"box",depth:ht/3,width:pt/3,height:.015},bt=.15*j+.1,wt={primitive:"triangle",vertexA:new THREE.Vector3(0,0,bt),vertexB:new THREE.Vector3(-1*bt,0,-1*bt),vertexC:new THREE.Vector3(bt,0,-1*bt)},Et=new THREE.Vector3(1,1.5,1),xt={primitive:"triangle",vertexA:new THREE.Vector3(0,0,bt),vertexB:new THREE.Vector3(-1*bt,0,-1*bt),vertexC:new THREE.Vector3(bt,0,-1*bt)},Dt=new THREE.Vector3(0,.05,bt),Tt=new THREE.Vector3(0,0,-1*bt),Rt={primitive:"triangle",vertexA:new THREE.Vector3(0,0,bt),vertexB:new THREE.Vector3(-1*bt,0,-1*bt),vertexC:new THREE.Vector3(bt,0,-1*bt)},Mt={primitive:"triangle",vertexA:new THREE.Vector3(0,0,.33*bt),vertexB:new THREE.Vector3(-.33*bt,0,-.33*bt),vertexC:new THREE.Vector3(.33*bt,0,-.33*bt)},Pt=.05*j+.075;"egg"===z?a.pupilShape=J:"circle"===z?a.pupilShape=et:"square"===z?a.pupilShape=ct:"rectangle"===z?a.pupilShape=ft:"triangle"===z&&(a.pupilShape=Mt),"egg"===C?(a.socketShape=B,a.socketScale=U,a.lidShape=G,a.lidPosition=q,a.lidOffsetPosition=W,a.blinkShape=_,a.blinkAnim={property:"object3D.scale.z",from:.65,to:1.3,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"flux",pauseEvents:"stopFlux"},a.wideAnim={property:"object3D.scale.z",to:.5,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"wide"},a.normalAnim={property:"object3D.scale.z",to:.65,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"normal"},a.squintAnim={property:"object3D.scale.z",to:1.3,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"squint"},a.tiredAnim={property:"object3D.scale.z",to:1.1,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"tired"}):"circle"===C?(a.socketShape=X,a.socketScale=Z,a.lidShape=Y,a.lidPosition=Q,a.lidOffsetPosition=$,a.blinkShape=tt,a.blinkAnim={property:"object3D.scale.z",from:.65,to:1.3,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"square"===C?(a.socketShape=ot,a.socketScale=at,a.lidShape=nt,a.lidPosition=st,a.lidOffsetPosition=rt,a.blinkShape=lt,a.blinkAnim={property:"object3D.scale.z",from:.45,to:.8,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"rectangle"===C?(a.socketShape=dt,a.socketScale=ut,a.lidShape=mt,a.lidPosition=yt,a.lidOffsetPosition=gt,a.blinkShape=vt,a.blinkAnim={property:"object3D.scale.z",from:.35,to:.75,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}):"triangle"===C&&(a.socketShape=wt,a.socketScale=Et,a.lidShape=xt,a.lidPosition=Dt,a.lidOffsetPosition=Tt,a.blinkShape=Rt,a.blinkAnim={property:"object3D.scale.z",from:.325,to:.6,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0});let kt=Math.random();a.custom&&("small"===o.earSize?kt=0:"medium"===o.earSize?kt=.5:"large"===o.earSize&&(kt=1));let St=.15*kt+.1,Ct=new THREE.Vector3(-.25,.5,.4),Lt=new THREE.Vector3(.25,.5,.4),zt=new THREE.Vector3(.9,1,.9),Nt={primitive:"cylinder",radius:St,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},It=new THREE.Vector3(0,0,.175),Ht=new THREE.Vector3(1,1,1),Ft=.1*kt+.15,Ot=new THREE.Vector3(-.25,.5,.4),At=new THREE.Vector3(.25,.5,.4),jt=new THREE.Vector3(.5,1,.5),Vt={primitive:"cylinder",radius:Ft,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Bt=new THREE.Vector3(0,0,.175),Ut=new THREE.Vector3(1,1,5),Gt=.175*kt+.075,qt=new THREE.Vector3(-.125,.51,.4),Wt=new THREE.Vector3(.125,.51,.4),_t=new THREE.Vector3(.5,1,.5),Jt={primitive:"cylinder",radius:Gt,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},Kt=new THREE.Vector3(0,0,.175),Xt=new THREE.Vector3(.35,.35,6),Zt=.2*kt+.125,Yt=new THREE.Vector3(-.25,.5,.4),Qt=new THREE.Vector3(.25,.5,.4),$t=new THREE.Vector3(.5,1,.5),te={primitive:"cylinder",radius:Zt,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:90,thetaLength:180},ee=new THREE.Vector3(0,0,.175),ie=new THREE.Vector3(.4,.4,2),oe=.15*kt+.1,ae=new THREE.Vector3(-.325,.625,.4),ne=new THREE.Vector3(.325,.625,.4),se=new THREE.Vector3(1,1,1),re={primitive:"cylinder",radius:oe,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},le=new THREE.Vector3(0,0,.175),ce=new THREE.Vector3(1,1,1);"bun"===F?(a.ear1OffsetPos=Ct,a.ear2OffsetPos=Lt,a.earOffsetScale=zt,a.earShape=Nt,a.earPos=It,a.earScale=Ht):"bunny"===F?(a.ear1OffsetPos=Ot,a.ear2OffsetPos=At,a.earOffsetScale=jt,a.earShape=Vt,a.earPos=Bt,a.earScale=Ut):"mouse"===F?(a.ear1OffsetPos=ae,a.ear2OffsetPos=ne,a.earOffsetScale=se,a.earShape=re,a.earPos=le,a.earScale=ce):"ant"===F?(a.ear1OffsetPos=qt,a.ear2OffsetPos=Wt,a.earOffsetScale=_t,a.earShape=Jt,a.earPos=Kt,a.earScale=Xt):"horn"===F&&(a.ear1OffsetPos=Yt,a.ear2OffsetPos=Qt,a.earOffsetScale=$t,a.earShape=te,a.earPos=ee,a.earScale=ie),a.faceParentData={data:"faceParentData",id:n,sources:!1,text:!1,geometry:!1,material:!1,position:a.position,rotation:a.rotation,scale:a.scale,animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},a[n]=t.Core(a.faceParentData),a.headData={data:"headData",id:s,sources:!1,text:!1,geometry:{primitive:"sphere",radius:.4,phiStart:0,phiLength:180,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:180},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.15,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},a[s]=t.Core(a.headData),a.faceEye1SocketData={data:"faceEye1SocketData",id:r,sources:!1,text:!1,geometry:a.socketShape,material:{shader:"standard",color:"#fcfafd",emissive:"#fcfafd",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.15,.1,.4),rotation:new THREE.Vector3(90,0,0),scale:a.socketScale,animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[r]=t.Core(a.faceEye1SocketData),a.faceEye2SocketData=t.coreDataFromTemplate(a.faceEye1SocketData,{id:m,position:new THREE.Vector3(.15,.1,.4)},!0),a[m]=t.Core(a.faceEye2SocketData),a.faceEye1PupilData={data:"faceEye1PupilData",id:c,sources:!1,text:!1,geometry:a.pupilShape,material:a.pupilMaterial,position:new THREE.Vector3(0,.01,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{lookdown:{property:"position",to:new THREE.Vector3(0,.01,.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookDown"},lookup:{property:"position",to:new THREE.Vector3(0,.01,-.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookUp"},lookright:{property:"position",to:new THREE.Vector3(.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookRight"},lookleft:{property:"position",to:new THREE.Vector3(-.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookLeft"}},mixins:!1,classes:["a-ent"],components:!1},a[c]=t.Core(a.faceEye1PupilData),a.faceEye2PupilData=t.coreDataFromTemplate(a.faceEye1PupilData,{id:g},!0),a[g]=t.Core(a.faceEye2PupilData),a.faceEye1PupilAccentData={data:"faceEye1PupilAccentData",id:h,sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(Pt,Pt,Pt),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[h]=t.Core(a.faceEye1PupilAccentData),a.faceEye2PupilAccentData=t.coreDataFromTemplate(a.faceEye1PupilAccentData,{id:v},!0),a[v]=t.Core(a.faceEye2PupilAccentData),a.faceEyebrow1Data={data:"faceEyebrow1Data",id:l,sources:!1,text:!1,geometry:{primitive:"box",depth:a.browThickness,width:.25,height:.025},material:a.browMaterial,position:new THREE.Vector3(0,0,-.25),rotation:new THREE.Vector3(0,10,0),scale:new THREE.Vector3(1,1,1),animations:{updown:{property:"object3D.position.z",from:-.3,to:-.225,dur:2e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},a[l]=t.Core(a.faceEyebrow1Data),a.faceEyebrow2Data=t.coreDataFromTemplate(a.faceEyebrow1Data,{id:y,rotation:new THREE.Vector3(0,-10,0)},!0),a[y]=t.Core(a.faceEyebrow2Data),a.faceEye1LidOffsetData={data:"faceEye1LidOffsetData",id:d,sources:!1,text:!1,geometry:!1,material:!1,position:a.lidOffsetPosition,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{flux:a.blinkAnim,wide:a.wideAnim,normal:a.normalAnim,squint:a.squintAnim,tired:a.tiredAnim},mixins:!1,classes:["a-ent"],components:!1},a[d]=t.Core(a.faceEye1LidOffsetData),a.faceEye2LidOffsetData=t.coreDataFromTemplate(a.faceEye1LidOffsetData,{id:b},!0),a[b]=t.Core(a.faceEye2LidOffsetData),a.faceEye1LidData={data:"faceEye1LidData",id:u,sources:!1,text:!1,geometry:a.lidShape,material:a.skinMaterial,position:a.lidPosition,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.06,4,1.06),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[u]=t.Core(a.faceEye1LidData),a.faceEye2LidData=t.coreDataFromTemplate(a.faceEye1LidData,{id:w},!0),a[w]=t.Core(a.faceEye2LidData),a.faceEye1BlinkData={data:"faceEye1BlinkData",id:p,sources:!1,text:!1,geometry:a.blinkShape,material:a.skinMaterial,position:new THREE.Vector3(0,.05,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.05,1.05,1.05),animations:{blinkin:{property:"visible",from:!1,to:!0,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"visible",from:!0,to:!1,dur:1,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},close:{property:"visible",from:!1,to:!0,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"},open:{property:"visible",from:!0,to:!1,dur:1,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"open"}},mixins:!1,classes:["a-ent"],components:{visible:!1}},a[p]=t.Core(a.faceEye1BlinkData),a.faceEye2BlinkData=t.coreDataFromTemplate(a.faceEye1BlinkData,{id:f},!0),a[f]=t.Core(a.faceEye2BlinkData),a.faceEar1OffsetData={data:"faceEar1OffsetData",id:E,sources:!1,text:!1,geometry:!1,material:!1,position:a.ear1OffsetPos,rotation:new THREE.Vector3(90,0,0),scale:a.earOffsetScale,animations:!1,mixins:!1,classes:["a-ent"],components:!1},a[E]=t.Core(a.faceEar1OffsetData),a.faceEar2OffsetData=t.coreDataFromTemplate(a.faceEar1OffsetData,{id:D,position:a.ear2OffsetPos},!0),a[D]=t.Core(a.faceEar2OffsetData),a.faceEar1Data={data:"faceEar1Data",id:x,sources:!1,text:!1,geometry:a.earShape,material:a.skinMaterial,position:a.earPos,rotation:new THREE.Vector3(0,30,0),scale:a.earScale,animations:{twitch:{property:"object3D.rotation.y",from:25,to:35,dur:3e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},a[x]=t.Core(a.faceEar1Data),a.faceEar2Data=t.coreDataFromTemplate(a.faceEar1Data,{id:T,rotation:new THREE.Vector3(0,-30,0),animations:{twitch:{property:"object3D.rotation.y",from:-25,to:-35,dur:3e3,delay:0,loop:!0,dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0}}},!0),a[T]=t.Core(a.faceEar2Data),a.bodyData={data:"bodyData",id:R,sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.4,height:.3,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},a[R]=t.Core(a.bodyData),a.legData={data:"legData",id:"leg",sources:!1,text:!1,geometry:{primitive:"cone",radiusBottom:0,radiusTop:.15,height:.2,openEnded:!1,segmentsHeight:4,segmentsRadial:8,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.25,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},a.leg1Data=t.coreDataFromTemplate(a.legData,{id:M},!0),a[M]=t.Core(a.leg1Data),a.leg2Data=t.coreDataFromTemplate(a.legData,{id:P,position:new THREE.Vector3(.25,-.25,0)},!0),a[P]=t.Core(a.leg2Data),a.leg3Data=t.coreDataFromTemplate(a.legData,{id:k,position:new THREE.Vector3(0,-.25,-.25)},!0),a[k]=t.Core(a.leg3Data),a.leg4Data=t.coreDataFromTemplate(a.legData,{id:S,position:new THREE.Vector3(0,-.25,.25)},!0),a[S]=t.Core(a.leg4Data),a.faceLayerData={parent:{core:a[n]},child0:{parent:{core:a[s]},child0:{parent:{core:a[r]},child0:{core:a[l]},child1:{parent:{core:a[c]},child0:{core:a[h]}},child2:{core:a[p]},child3:{parent:{core:a[d]},child0:{core:a[u]}}},child1:{parent:{core:a[m]},child0:{core:a[y]},child1:{parent:{core:a[g]},child0:{core:a[v]}},child2:{core:a[f]},child3:{parent:{core:a[b]},child0:{core:a[w]}}},child2:{parent:{core:a[E]},child0:{core:a[x]}},child3:{parent:{core:a[D]},child0:{core:a[T]}}},child1:{parent:{core:a[R]},child0:{core:a[M]},child1:{core:a[P]},child2:{core:a[k]},child3:{core:a[S]}}},t[a.auxlId]=t.Layer(a.auxlId,a.faceLayerData),t[a.bubbleId]=t.InfoBubble(a.bubbleId,t[a.auxlId],.75,a.color.base);const he=()=>{a[d].EmitEvent("normal"),a[b].EmitEvent("normal"),t[a.auxlId].EmitEventParent("casual")},pe=()=>{a[d].EmitEvent("wide"),a[b].EmitEvent("wide"),t[a.auxlId].EmitEventParent("happy")},de=()=>{a[d].EmitEvent("squint"),a[b].EmitEvent("squint"),t[a.auxlId].EmitEventParent("sad")},ue=()=>{a[d].EmitEvent("squint"),a[b].EmitEvent("squint"),t[a.auxlId].EmitEventParent("angry")},me=()=>{a[d].EmitEvent("wide"),a[b].EmitEvent("squint"),t[a.auxlId].EmitEventParent("confused")},ye=()=>{a[d].EmitEvent("tired"),a[b].EmitEvent("tired"),t[a.auxlId].EmitEventParent("tired")},ge=()=>{a[p].EmitEvent("close"),a[f].EmitEvent("close"),t[a.auxlId].EmitEventParent("asleep")},ve=()=>{a[p].EmitEvent("open"),a[f].EmitEvent("open"),t[a.auxlId].EmitEventParent("shocked")},fe=()=>{a[d].EmitEvent("normal"),a[b].EmitEvent("normal"),t[a.auxlId].EmitEventParent("annoyed")},be=()=>{a[d].EmitEvent("squint"),a[b].EmitEvent("squint"),t[a.auxlId].EmitEventParent("smug")},we=()=>{a[d].EmitEvent("wide"),a[b].EmitEvent("wide"),t[a.auxlId].EmitEventParent("shocked")},Ee=()=>{a[d].EmitEvent("wide"),a[b].EmitEvent("wide"),t[a.auxlId].EmitEventParent("scared")},xe=()=>{a[d].EmitEvent("normal"),a[b].EmitEvent("normal"),t[a.auxlId].EmitEventParent("confident")},De=()=>{a[d].EmitEvent("wide"),a[b].EmitEvent("wide"),t[a.auxlId].EmitEventParent("love")},Te=()=>{a[d].EmitEvent("squint"),a[b].EmitEvent("squint"),t[a.auxlId].EmitEventParent("shy")};return{creature:a,SpawnCreature:()=>{a.inScene||(t[a.auxlId].SpawnLayer(a.parent),(()=>{let t=.25;a.blinkInterval=setInterval((()=>{Math.random()>=t?(a[p].EmitEvent("blink"),a[f].EmitEvent("blink"),t=.25):t+=.25}),3e3)})(),a.inScene=!0)},DespawnCreature:()=>{a.inScene&&(clearInterval(a.blinkInterval),clearTimeout(a.accentTimeout),clearTimeout(a.emoteTimeout),clearInterval(a.intervalTest),clearTimeout(a.timeoutTest),t[a.auxlId].DespawnLayer(),a.inScene=!1)},Emote:t=>{console.log(t),"casual"===t?he():"happy"===t?pe():"sad"===t?de():"angry"===t?ue():"confused"===t?me():"tired"===t?ye():"asleep"===t?ge():"wakeUp"===t?ve():"annoyed"===t?fe():"smug"===t?be():"shocked"===t?we():"scared"===t?Ee():"confident"===t?xe():"love"===t?De():"shy"===t&&Te()}}})(i,t,e,o),this.Collision=()=>c(i),this.GridLayout=t=>((t,e)=>{let i=Object.assign({},e);i.inScene=!1,i.current=!1,i.type,i.objInfo="single",i.coreData?(i.type="coreData",Array.isArray(i.coreData)&&(i.objInfo="array")):i.core?(i.type="core",Array.isArray(i.core)&&(i.objInfo="array")):i.layerData?(i.type="layerData",Array.isArray(i.layerData)&&(i.objInfo="array")):i.layer&&(i.type="layer",Array.isArray(i.layer)&&(i.objInfo="array")),i.objs=[],i.amount=0;for(let t in i.grids)i.grids[t].length>i.amount&&(i.amount=i.grids[t].length);return"single"===i.objInfo?(()=>{for(let e=0;e<i.amount;e++){let o={},a={};"coreData"===i.type?(o=t.coreDataFromTemplate(i.coreData,{id:i.id+e},!0),a=t.Core(o),i.objs.push(a)):"core"===i.type?(a=t.coreFromTemplate(i.core,{id:i.id+e},!0),i.objs.push(a)):"layerData"===i.type?(o=t.layerDataFromTemplate(i.layerData,{id:i.id+e},!0),a=t.Layer(i.id+"layer",o),i.objs.push(a)):"layer"===i.type&&(a=t.layerFromTemplate(i.layer,i.id+e,{id:i.id+e},!1,!0),i.objs.push(a))}})():(()=>{let e=0,o=1;"coreData"===i.type?o=i.coreData.length:"core"===i.type?o=i.core.length:"layerData"===i.type?o=i.layerData.length:"layer"===i.type&&(o=i.layer.length);for(let a=0;a<i.amount;a++){let n={},s={};"coreData"===i.type?(n=t.coreDataFromTemplate(i.coreData[e],{id:i.id+a},!0),s=t.Core(n),i.objs.push(s)):"core"===i.type?(s=t.coreFromTemplate(i.core[e],{id:i.id+a},!0),i.objs.push(s)):"layerData"===i.type?(n=t.layerDataFromTemplate(i.layerData[e],{id:i.id+a},!0),s=t.Layer(i.id+"layer",n),i.objs.push(s)):"layer"===i.type&&(s=t.layerFromTemplate(i.layer[e],i.id+a,{id:i.id+a},!1,!0),i.objs.push(s)),e++,e>=o&&(e=0)}})(),{gridLayout:i,SpawnGridLayout:t=>{if(i.inScene);else{(t=>{for(let e in i.grids[t])"coreData"===i.type||"core"===i.type?i.objs[e].core.grid=i.grids[t][e]:"data"!==i.type&&"core"!==i.type||(i.objs[e].layer.grid=i.grids[t][e])})(t);for(let e in i.grids[t])"coreData"===i.type||"core"===i.type?i.objs[e].SpawnCoreOnGrid():"layerData"!==i.type&&"layer"!==i.type||i.objs[e].SpawnLayerOnGrid();i.current=t,i.inScene=!0}},DespawnGridLayout:()=>{if(i.inScene){for(let t in i.grids[i.current])"coreData"===i.type||"core"===i.type?i.objs[t].DespawnCore():"layerData"!==i.type&&"layer"!==i.type||i.objs[t].DespawnLayer();i.current=!1,i.inScene=!1,t.RemoveFromTracker(i.id)}}}})(i,t),this.Gate=(t,e,o)=>((t,e,i,o)=>{let a={};a.id=e,a.object=i,a.objType,a.object.core?a.objType="core":a.object.core&&(a.objType="layer"),a.direction=o,a.directions=[],a.inScene=!1,a.open=!1;const n=t=>{t&&(a.direction=t,a.directions=[],"forward"===a.direction?(a.directions.push("forwardright"),a.directions.push("forwardleft"),a.directions.push("forward")):"reverse"===a.direction?(a.directions.push("reverseright"),a.directions.push("reverseleft"),a.directions.push("reverse")):"right"===a.direction?(a.directions.push("forwardright"),a.directions.push("reverseright"),a.directions.push("right")):"left"===a.direction&&(a.directions.push("reverseleft"),a.directions.push("forwardleft"),a.directions.push("left"))),"core"===a.objType?(0===Object.keys(a.object.core.components).length&&(a.object.core.components={}),a.object.core.components.oneventrun__closegate={event:"triggerExit",cursorObj:a.id,component:"null",method:"CloseGate",params:"null"}):"layer"===a.objType&&(Object.keys(0===a.object.layer.all.parent.core.core.components.length)&&(a.object.layer.all.parent.core.core.components={}),a.object.layer.all.parent.core.core.components.oneventrun__closegate={event:"triggerExit",cursorObj:a.id,component:"null",method:"CloseGate",params:"null"}),a.open=!0},s=()=>{a.inScene||("core"===a.objType?a.object.SpawnCoreOnGrid():"layer"===a.objType&&a.object.SpawnLayerOnGrid(),a.inScene=!0)},r=()=>{a.inScene&&("core"===a.objType?a.object.DespawnCore():"layer"===a.objType&&a.object.DespawnLayer(),a.inScene=!1)},l=()=>{a.open||(console.log("opening gate"),r(),"core"===a.objType?(a.object.core.grid.collide=!1,a.object.core.grid.trigger=!0,a.object.core.material.opacity=0):"layer"===a.objType&&(a.object.layer.all.parent.core.core.grid.collide=!1,a.object.layer.all.parent.core.core.grid.trigger=!0,a.object.layer.all.parent.core.core.material.opacity=0),n(),s())};return n(a.direction),{gate:a,SpawnGate:s,DespawnGate:()=>{a.inScene&&("core"===a.objType?a.object.DespawnCore():"layer"===a.objType&&a.object.DespawnLayer(),a.inScene=!1,t.RemoveFromTracker(a.id))},CloseGate:()=>{if(a.open)for(let e in a.directions)if(t.player.layer.gridDirection===a.directions[e]){console.log("closing gate"),"core"===a.objType?(a.object.core.grid.trigger=!1,a.object.core.grid.collide=!0,delete a.object.core.components.oneventrun__closegate,a.object.core.material.opacity=1):"layer"===a.objType&&(a.object.layer.all.parent.core.core.grid.trigger=!1,a.object.layer.all.parent.core.core.grid.collide=!0,delete a.object.layer.all.parent.core.core.components.oneventrun__closegate,a.object.layer.all.parent.core.core.material.opacity=1),r(),s(),a.open=!1;let t=setTimeout((()=>{console.log("Re-opening Gate"),l(),clearTimeout(t)}),3e3)}},OpenGate:l,ResetGate:n}})(i,t,e,o),this.BuildIn3D=()=>(t=>{let e={id:"build"};return e.player=t.player.GetPlayerInfo(),e.core={},e.core.data={},e.core.made=[],e.layer={},e.objGen={},e.null={},e.templates={},e.core.blank={data:"blankData",id:"blank",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.states=["ready","building","editing","deleting","settings"],e.state=e.states[0],e.building={},e.building.current=!1,e.building.prepped=!1,e.building.building=!1,e.buildMenuData={info:{id:"buildMenu",buttonData:t.buildCoreData,hoverData:t.buildHoverData,title:"Build Mode",description:"Build objects.",layout:"circleUp",posOffset:new THREE.Vector3(0,1.5,1.5),offset:-1,parent:!1,stare:!1},menu0:{button0:{id:"subMenu1",style:!1,title:"Build",description:"Build a new object.",subMenu:"menu1",action:!1},button1:{id:"subMenu2",style:!1,title:"Edit",description:"Edit an object in-scene.",subMenu:"menu22",action:!1},button2:{id:"subMenu3",style:!1,title:"Delete",description:"Delete an object in-scene.",subMenu:"menu23",action:!1},button3:{id:"subMenu4",style:!1,title:"Settings",description:"Configure system settings.",subMenu:"menu24",action:!1}},menu1:{button0:{id:"subMenu2",style:!1,title:"Core",description:"Build a Core object.",subMenu:"menu2",action:!1},button1:{id:"subMenu3",style:!1,title:"Layer",description:"Build a Layer object.",subMenu:"end",action:!1},button2:{id:"subMenu4",style:!1,title:"ObjGen",description:"Build an object.",subMenu:"end",action:!1},button3:{id:"subMenu5",style:!1,title:"Null",description:"Build a Null object.",subMenu:"end",action:!1},button4:{id:"subMenu6",style:!1,title:"Templates",description:"Build a from a Template.",subMenu:"end",action:!1}},menu2:{button0:{id:"subMenu0",style:!1,title:"Generate",description:"Generate a default Core object.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"StartBuilding",params:null,menu:"stay"}},button1:{id:"subMenu1",style:!1,title:"Name",description:"Update core Name.",subMenu:"coreName",action:!1},button2:{id:"subMenu2",style:!1,title:"Geometry",description:"Update core Geometry.",subMenu:"coreGeometry",action:!1},button3:{id:"subMenu3",style:!1,title:"Material",description:"Update core Material.",subMenu:"coreMaterial",action:!1},button4:{id:"subMenu4",style:!1,title:"Text",description:"Update core Text.",subMenu:"coreText",action:!1},button5:{id:"subMenu5",style:!1,title:"Position",description:"Update core Position.",subMenu:"corePosition",action:!1},button6:{id:"subMenu6",style:!1,title:"More",description:"More options.",subMenu:"menu3",action:!1}},menu3:{button0:{id:"subMenu0",style:!1,title:"Rotation",description:"Update core Rotation.",subMenu:"coreRotation",action:!1},button1:{id:"subMenu1",style:!1,title:"Scale",description:"Update core Scale.",subMenu:"coreScale",action:!1},button2:{id:"subMenu2",style:!1,title:"Animations",description:"Update core Animations.",subMenu:"coreAnimations",action:!1},button3:{id:"subMenu3",style:!1,title:"Clickable",description:"Toggle core to be clickable in-scene.",subMenu:"coreClickable",action:!1},button4:{id:"subMenu4",style:!1,title:"Components",description:"Update core Components.",subMenu:"coreComponents",action:!1},button5:{id:"subMenu5",style:!1,title:"Done",description:"Finalize core updates.",subMenu:"coreDone",action:!1}},coreName:{button0:{id:"action1",style:!1,title:"Update Name",description:"Update the cores name and id.",subMenu:!1,action:{auxlObj:"one",component:!1,method:"UpdateName",params:null,menu:"stay"}}},coreGeometry:{button0:{id:"action0",style:!1,title:"Plane",description:"A 2D plane.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"plane",menu:"stay"}},button1:{id:"action1",style:!1,title:"Cube",description:"A 3D cube.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"box",menu:"stay"}},button2:{id:"action2",style:!1,title:"Circle",description:"A 2D circle.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"circle",menu:"stay"}},button3:{id:"action3",style:!1,title:"Cylinder",description:"A 3D cylinder.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"cylinder",menu:"stay"}},button4:{id:"action4",style:!1,title:"Sphere",description:"A 3D sphere.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateGeometry",params:"sphere",menu:"stay"}}},coreMaterial:{button0:{id:"action1",style:!1,title:"Update Material",description:"Update the cores Material.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateMaterial",params:null,menu:"stay"}}},coreText:{button0:{id:"action1",style:!1,title:"Update Text",description:"Update the cores text.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateText",params:null,menu:"stay"}}},corePosition:{button0:{id:"action1",style:!1,title:"Update Position",description:"Update the cores position.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdatePosition",params:null,menu:"stay"}}},coreRotation:{button0:{id:"action1",style:!1,title:"Update Rotation",description:"Update the cores rotation.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateRotation",params:null,menu:"stay"}}},coreScale:{button0:{id:"action1",style:!1,title:"Update Scale",description:"Update the cores scale.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateScale",params:null,menu:"stay"}}},coreAnimations:{button0:{id:"action1",style:!1,title:"Update Animations",description:"Update the cores animations.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateAnimations",params:null,menu:"stay"}}},coreClickable:{button0:{id:"action1",style:!1,title:"Toggle Clickable",description:"Toggle the core being interactable. ",subMenu:!1,action:{auxlObj:"build",component:!1,method:"ToggleClickable",params:null,menu:"stay"}}},coreComponents:{button0:{id:"action1",style:!1,title:"Update Components",description:"Update the cores components.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"UpdateComponents",params:null,menu:"stay"}}},coreDone:{button0:{id:"action1",style:!1,title:"Done",description:"Finalize the core.",subMenu:!1,action:{auxlObj:"build",component:!1,method:"Done",params:null,menu:"close"}}},end:{button0:{id:"subMenu2",style:!1,title:"Core",description:"Build a Core object.",subMenu:"menu0",action:!1}}},t.buildMenu=t.MultiMenu(e.buildMenuData),e.building.geometry={},e.building.geometry.plane={primitive:"plane",width:.5,height:.5},e.building.geometry.box={primitive:"box",depth:.5,width:.5,height:.5},e.building.geometry.circle={primitive:"circle",radius:.5,segments:32},e.building.geometry.cylinder={primitive:"cylinder",radius:.25,height:.75,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},e.building.geometry.sphere={primitive:"sphere",radius:.4,phiStart:0,phiLength:360,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:360},{one:e,SpawnBuild:()=>{t.buildMenu.SpawnMultiMenu()},DespawnBuild:()=>{t.buildMenu.DespawnMultiMenu()},StartBuilding:()=>{console.log("Start Building"),(()=>{if(e.building.prepped)console.log("Already Prepped");else{console.log("New Core");let i=e.core.made.length;e.core.data[i+"data"]={data:i+"data",id:i,sources:!1,text:!1,geometry:{primitive:"box",depth:.5,width:.5,height:.5},material:{shader:"standard",color:"#2aad7b",emissive:"#2aad7b",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(0,1.5,1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},e.core[i]=t.Core(e.core.data[i+"data"]),e.building.current=e.core[i],e.building.prepped=!0,e.building.building=!0,e.building.current.SpawnCore()}})()},UpdateName:()=>{console.log("UpdateName")},UpdateGeometry:t=>{let i;console.log("UpdateGeometry"),"plane"===t?i=e.building.geometry.plane:"box"===t?i=e.building.geometry.box:"circle"===t?i=e.building.geometry.circle:"cylinder"===t?i=e.building.geometry.cylinder:"sphere"===t&&(i=e.building.geometry.sphere),e.core.data[e.building.current.core.id+"data"].geometry=i,e.building.current.ChangeSelf({property:"geometry",value:i})},UpdateMaterial:()=>{console.log("UpdateMaterial")},UpdateText:()=>{console.log("UpdateText")},UpdatePosition:()=>{console.log("UpdatePosition")},UpdateRotation:()=>{console.log("UpdateRotation")},UpdateScale:()=>{console.log("UpdateScale")},UpdateAnimations:()=>{console.log("UpdateAnimations")},UpdateClickable:()=>{console.log("UpdateClickable")},UpdateComponents:()=>{console.log("UpdateComponents")},UpdateDone:()=>{console.log("UpdateDone")},Testing:()=>{console.log(e)}}})(i),this.ImageSwapper=(t,e,o,...a)=>((t,e,i,o,...a)=>{let n,s={};s.id=e,s.inScene=!1,s.thumbnailCores=[];let r=new THREE.Vector3(0,-.3,.05);s.layerData={};for(let e in a)"0"===e?(i.material=a[e],n=t.Core(i),s.layerData.parent={},s.layerData.parent.core=n):(o.id="thumbnail"+e,o.material=a[e],3===a.length?"1"===e?r.x=-.25:"2"===e&&(r.x=.25):4===a.length?"1"===e?r.x=-.33:"2"===e?r.x=0:"3"===e&&(r.x=.33):5===a.length&&("1"===e?r.x=-.375:"2"===e?r.x=-.125:"3"===e?r.x=.125:"4"===e&&(r.x=.375)),o.position=r,s.thumbnailCores[e]=t.Core(o),s.layerData["child"+e]={},s.layerData["child"+e].core=s.thumbnailCores[e]);s.layer=t.Layer("imageSwapper",s.layerData);const l=()=>{s.inScene||(s.layer.SpawnLayer(),s.inScene=!0)},c=()=>{s.inScene&&(s.layer.DespawnLayer(),RemoveFromTracker(s.id),s.inScene=!1)};return{imageSwapper:s,Click:t=>{let e=t.getAttribute("material").src,i=JSON.parse(JSON.stringify(t.parentNode.getAttribute("material").src));t.parentNode.setAttribute("material",{src:e}),t.setAttribute("material",{src:i})},SpawnImgSwap:l,DespawnImgSwap:c,ToggleSpawn:()=>{s.inScene?c():l()},SetFlag:t=>{if(Array.isArray(t))for(let e in t)s[t[e].flag]=t[e].value;else s[t.flag]=t.value},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(s(t[i]));return e}return s[t]}}})(i,t,e,o,...a),this.ImageCarousel=t=>((t,e)=>{let i,o,a,n=Object.assign({},e);n.inScene=!1,n.frames=8,n.framesPerPage=8,currentImageForward=-1,currentImageBackward=n.images.length-n.framesPerPage,n.framesPerPage;let s=0;currentRotation=-1;let r=!0,l=!0,c=!1,h=!1,p=0,d=!1,u={data:"artFrameParentData",id:"artFrameParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},m={data:"artFrameData",id:"artFrame",sources:!1,text:!1,geometry:{primitive:"box",depth:.01,width:4.4,height:2.55},material:{shader:"flat",color:"#55a5be",opacity:1,alphaTest:.1},position:new THREE.Vector3(0,1.75,-6),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{scale0:{property:"scale",from:"1 1 1",to:"2 2 2",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to0"},position0:{property:"position",from:"0 1.75 -6",to:"0 3.5 -12",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to0"},scale1:{property:"scale",from:"2 2 2",to:"1 1 1",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to1"},position1:{property:"position",from:"0 3.5 -12",to:"0 1.75 -6",dur:2e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"to1"}},mixins:!1,classes:["a-ent"],components:!1},y={data:"artFrameTextData",id:"artFrameText",sources:!1,text:{value:"Art Frame Text",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:0,side:"double"},geometry:!1,material:!1,position:new THREE.Vector3(0,-1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1};u.id="artFrameParentAll",u.rotation=new THREE.Vector3(0,1,0);let g={parent:{core:t.Core(u)}},v="artFrameParent",f=[],b="artFrame",w=[],E="artFrameText",x=[];for(let e=0;e<n.frames;e++){0===e?s=-45:1===e?s=0:2===e?s=-315:3===e?s=-270:4===e?s=-225:5===e?s=-180:6===e?s=-135:7===e&&(s=-90),v="artFrameParent"+e;let i=new THREE.Vector3(0,0,0);i.y=s,u.id=v,u.rotation=i,f[e]=t.Core(u),b="artFrame"+e,m.id=b,w[e]=t.Core(m),E="artFrameText"+e,y.id=E,x[e]=t.Core(y),g["child"+e]={parent:{core:f[e]},child0:{parent:{core:w[e]},child0:{core:x[e]}}}}let D=t.Layer("artFrameAllLayer",g),T=t.colorTheoryGen("#6ab0db"),R={data:"Button Parent",id:"buttonParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,80,0),scale:new THREE.Vector3(1,1,1),animations:{scaleclick:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["a-ent"],components:!1},M={data:"Button Obj",id:"buttonObj",sources:!1,text:!1,geometry:!1,material:{shader:"flat",color:T.base,opacity:1},position:new THREE.Vector3(0,.4,-2.5),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(.1,.1,.1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},P={data:"Button Border",id:"buttonBorder",sources:!1,text:!1,geometry:!1,material:{shader:"flat",color:T.splitCompl[0],opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"obj-model":{obj:"./assets/3d/buttons/border.obj"}}},k={data:"Button Click Background",id:"buttonClick",sources:!1,text:!1,geometry:{primitive:"circle",radius:2,segments:12},material:{shader:"flat",color:T.splitCompl[1],opacity:.5,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},S={data:"Button Text",id:"buttonText",sources:!1,text:{value:"Button",width:20,color:T.base,align:"center",font:"exo2bold",zOffset:0,side:"double"},geometry:!1,material:!1,position:new THREE.Vector3(0,-2.75,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1};R.id="buttonBackwardParent",R.rotation=new THREE.Vector3(0,22.5,0);let C=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/backward.obj"}},M.id="buttonBackward",P.id="buttonBackwardBorder",k.id="buttonBackwardClick",S.id="buttonBackwardText",S.text.value="Back";let L=t.Core(M),z=t.Core(P),N=t.Core(k),I=t.Core(S),H={parent:{core:C},child0:{parent:{core:L},child0:{core:z},child1:{core:N},child2:{core:I}}},F=t.Layer("buttonBackwardLayer",H);R.id="buttonForwardParent",R.rotation=new THREE.Vector3(0,-22.5,0);let O=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/forward.obj"}},M.id="buttonForward",P.id="buttonForwardBorder",k.id="buttonForwardClick",S.id="buttonForwardText",S.text.value="Forward";let A=t.Core(M),j=t.Core(P),V=t.Core(k),B=t.Core(S),U={parent:{core:O},child0:{parent:{core:A},child0:{core:j},child1:{core:V},child2:{core:B}}},G=t.Layer("buttonForwardLayer",U);R.id="buttonLeftSkipParent",R.rotation=new THREE.Vector3(0,37.5,0);let q=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/left_skip.obj"}},M.id="buttonLeftSkip",P.id="buttonLeftSkipBorder",k.id="buttonLeftSkipClick",S.id="buttonLeftSkipText",S.text.value="Back Page";let W=t.Core(M),_=t.Core(P),J=t.Core(k),K=t.Core(S),X={parent:{core:q},child0:{parent:{core:W},child0:{core:_},child1:{core:J},child2:{core:K}}},Z=t.Layer("buttonLeftSkipLayer",X);R.id="buttonPlayParent",R.rotation=new THREE.Vector3(0,-7.5,0);let Y=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/play.obj"}},M.id="buttonPlay",P.id="buttonPlayBorder",k.id="buttonPlayClick",S.id="buttonPlayText",S.text.value="Play";let Q=t.Core(M),$=t.Core(P),tt=t.Core(k),et=t.Core(S),it={parent:{core:Y},child0:{parent:{core:Q},child0:{core:$},child1:{core:tt},child2:{core:et}}},ot=t.Layer("buttonPlayLayer",it);R.id="buttonRightSkipParent",R.rotation=new THREE.Vector3(0,-37.5,0);let at=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/right_skip.obj"}},M.id="buttonRightSkip",P.id="buttonRightSkipBorder",k.id="buttonRightSkipClick",S.id="buttonRightSkipText",S.text.value="Next Page";let nt=t.Core(M),st=t.Core(P),rt=t.Core(k),lt=t.Core(S),ct={parent:{core:at},child0:{parent:{core:nt},child0:{core:st},child1:{core:rt},child2:{core:lt}}},ht=t.Layer("buttonRightSkipLayer",ct);R.id="buttonSettingsParent",R.rotation=new THREE.Vector3(0,-52.5,0);let pt=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/settings.obj"}},M.id="buttonSettings",P.id="buttonSettingsBorder",k.id="buttonSettingsClick",S.id="buttonSettingsText",S.text.value="Scale";let dt=t.Core(M),ut=t.Core(P),mt=t.Core(k),yt=t.Core(S),gt={parent:{core:pt},child0:{parent:{core:dt},child0:{core:ut},child1:{core:mt},child2:{core:yt}}},vt=t.Layer("buttonSettingsLayer",gt);R.id="buttonStopParent",R.rotation=new THREE.Vector3(0,7.5,0),buttonStopParent=t.Core(R),M.components={"obj-model":{obj:"./assets/3d/buttons/stop.obj"}},M.id="buttonStop",P.id="buttonStopBorder",k.id="buttonStopClick",S.id="buttonStopText",S.text.value="Info";let ft=t.Core(M),bt=t.Core(P),wt=t.Core(k),Et=t.Core(S),xt={parent:{core:buttonStopParent},child0:{parent:{core:ft},child0:{core:bt},child1:{core:wt},child2:{core:Et}}},Dt=t.Layer("buttonStopLayer",xt);R.id="buttonHashtagParent",R.rotation=new THREE.Vector3(0,52.5,0);let Tt=t.Core(R);M.components={"obj-model":{obj:"./assets/3d/buttons/hashtag.obj"}},M.id="buttonHashtag",P.id="buttonHashtagBorder",k.id="buttonHashtagClick",S.id="buttonHashtagText",S.text.value="Random Page";let Rt=t.Core(M),Mt=t.Core(P),Pt=t.Core(k),kt=t.Core(S),St={parent:{core:Tt},child0:{parent:{core:Rt},child0:{core:Mt},child1:{core:Pt},child2:{core:kt}}},Ct=t.Layer("buttonHashtagLayer",St),Lt={name:"anim90",property:"object3D.rotation.y",from:"0",to:"90",dur:2500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!0,enabled:!0},zt={name:"anim360",property:"object3D.rotation.y",from:"0",to:"360",dur:12e4,delay:0,loop:"true",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"play",pauseEvents:"pause"};const Nt=(t,e,i)=>{g[t].child0.parent.core.ChangeSelf({property:"material",value:{src:i,shader:"flat",color:"#FFFFFF",opacity:1}}),g[t].child0.child0.core.ChangeSelf({property:"text",value:{value:e,width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:0,side:"double"}})},It=(t,e)=>{"forward"===e?(currentImageForward++,currentImageBackward++,currentImageForward>=n.images.length&&(currentImageForward=0),currentImageBackward>=n.images.length&&(currentImageBackward=0),Nt("child"+t,n.images[currentImageForward].text,n.images[currentImageForward].image)):"backward"===e&&(currentImageBackward--,currentImageForward--,currentImageBackward<0&&(currentImageBackward=n.images.length-1),currentImageForward<0&&(currentImageForward=n.images.length-1),Nt("child"+t,n.images[currentImageBackward].text,n.images[currentImageBackward].image))},Ht=t=>{for(let e=0;e<n.frames;e++)It(e,t);c=!1},Ft=t=>{let e,i=[];"forward"===t?0===currentRotation?i=[0,1]:1===currentRotation?i=[2,3]:2===currentRotation?i=[4,5]:3===currentRotation&&(i=[6,7]):"backward"===t&&(0===currentRotation?i=[6,7]:1===currentRotation?i=[0,1]:2===currentRotation?i=[2,3]:3===currentRotation&&(i=[4,5]),i.reverse());for(let o in i)e=i[o],It(e,t)},Ot=()=>{n.inScene||(D.SpawnLayer(),F.SpawnLayer(),Ct.SpawnLayer(),G.SpawnLayer(),Z.SpawnLayer(),ot.SpawnLayer(),ht.SpawnLayer(),vt.SpawnLayer(),Dt.SpawnLayer(),N.GetEl().addEventListener("click",Vt),V.GetEl().addEventListener("click",jt),J.GetEl().addEventListener("click",Gt),tt.GetEl().addEventListener("click",Bt),rt.GetEl().addEventListener("click",Ut),mt.GetEl().addEventListener("click",Wt),Pt.GetEl().addEventListener("click",qt),_t(),n.inScene=!0)},At=()=>{n.inScene&&(N.GetEl().removeEventListener("click",Vt),V.GetEl().removeEventListener("click",jt),J.GetEl().removeEventListener("click",Gt),tt.GetEl().removeEventListener("click",Bt),rt.GetEl().removeEventListener("click",Ut),mt.GetEl().removeEventListener("click",Wt),Pt.GetEl().removeEventListener("click",qt),D.DespawnLayer(),F.DespawnLayer(),Ct.DespawnLayer(),G.DespawnLayer(),Z.DespawnLayer(),ot.DespawnLayer(),ht.DespawnLayer(),vt.DespawnLayer(),Dt.DespawnLayer(),RemoveFromTracker(n.id),n.inScene=!1)},jt=()=>{if(r){r=!1;let t=D.GetParentEl().getAttribute("rotation").y;Lt.from=t,Lt.to=t-90,D.AnimateParent(Lt),o=setTimeout((()=>{currentRotation++,currentRotation>3&&(currentRotation=0),Ft("forward"),r=!0,clearTimeout(o)}),Lt.dur+10)}},Vt=()=>{if(r){r=!1;let t=D.GetParentEl().getAttribute("rotation").y;Lt.from=t,Lt.to=t+90,D.AnimateParent(Lt),o=setTimeout((()=>{currentRotation--,currentRotation<0&&(currentRotation=3),console.log(currentRotation),Ft("backward"),r=!0,clearTimeout(o)}),Lt.dur+10)}},Bt=()=>{if(l){l=!1,r=!1,i=setInterval((()=>{(t=>{let e;e=3,It(3,void 0)})(),currentRotation=0,7===currentRotation?currentRotation=0:currentRotation++}),zt.dur/8);let t=D.GetParentEl().getAttribute("rotation").y;zt.from=t,zt.to=t-360,D.AnimateParent(zt),D.layer.all.parent.core.EmitEvent("play"),Q.ChangeSelf({property:"obj-model",value:{obj:"./assets/3d/buttons/pause.obj"}}),et.ChangeSelf({property:"text",value:{value:"Pause",width:20,color:T.base,align:"center",font:"exo2bold",zOffset:0,side:"double"}})}else l=!0,r=!0,clearInterval(i),D.layer.all.parent.core.EmitEvent("pause"),Q.ChangeSelf({property:"obj-model",value:{obj:"./assets/3d/buttons/play.obj"}}),et.ChangeSelf({property:"text",value:{value:"Play",width:20,color:T.base,align:"center",font:"exo2bold",zOffset:0,side:"double"}})},Ut=()=>{c||(c=!0,Ht("forward"))},Gt=()=>{c||(c=!0,Ht("backward"))},qt=()=>{c||(c=!0,currentImageForward=Math.floor(Math.random()*n.images.length),Ht("forward"))},Wt=()=>{h||(h=!0,a=setTimeout((()=>{h=!1,clearTimeout(a)}),2050),0===p?(p=1,g.child0.child0.parent.core.EmitEvent("to0"),g.child1.child0.parent.core.EmitEvent("to0"),g.child2.child0.parent.core.EmitEvent("to0"),g.child3.child0.parent.core.EmitEvent("to0"),g.child4.child0.parent.core.EmitEvent("to0"),g.child5.child0.parent.core.EmitEvent("to0"),g.child6.child0.parent.core.EmitEvent("to0"),g.child7.child0.parent.core.EmitEvent("to0")):(p=0,g.child0.child0.parent.core.EmitEvent("to1"),g.child1.child0.parent.core.EmitEvent("to1"),g.child2.child0.parent.core.EmitEvent("to1"),g.child3.child0.parent.core.EmitEvent("to1"),g.child4.child0.parent.core.EmitEvent("to1"),g.child5.child0.parent.core.EmitEvent("to1"),g.child6.child0.parent.core.EmitEvent("to1"),g.child7.child0.parent.core.EmitEvent("to1")))},_t=()=>{wt.EnableDetail({text:n.description,position:new THREE.Vector3(0,1.5,-2)}),Ht("forward")};return{imageCarousel:n,SpawnImgCarousel:Ot,DespawnImgCarousel:At,ToggleSpawn:()=>{n.inScene?At():Ot()},SetFlag:t=>{if(Array.isArray(t))for(let e in t)n[t[e].flag]=t[e].value;else n[t.flag]=t.value},GetFlag:t=>{if(Array.isArray(t)){let e=[];for(let i in t)e.push(n(t[i]));return e}return n[t]},PlayPause:Bt,Forward:jt,Backward:Vt,NextPage:Ut,PrevPage:Gt,RandomPage:qt,Scale:Wt,Info:()=>{d=!d}}})(i,t)},checkSceneLoad:function(t,e){if(this.loadingObjects.size<=0){let t;"blink"===this.player.layer.transition.scene?(this.blink1Screen.EmitEvent("blinkScene2"),this.blink2Screen.EmitEvent("blinkScene2"),this.loadingScene=!1,t=setTimeout((()=>{this.blink1Screen.ChangeSelf({property:"visible",value:"false"}),this.blink2Screen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(t)}),800)):"fade"===this.player.layer.transition.scene?(this.fadeScreen.EmitEvent("fadeScene2"),this.loadingScene=!1,t=setTimeout((()=>{this.fadeScreen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(t)}),800)):"sphere"===this.player.layer.transition.scene?(this.sphereScreen.EmitEvent("sphereScene2"),this.loadingScene=!1,t=setTimeout((()=>{this.sphereScreen.ChangeSelf({property:"visible",value:"false"}),this.player.layer.teleporting=!1,this.player.EnableClick(),clearTimeout(t)}),800)):"instant"===this.player.layer.transition.scene&&(this.loadingScene=!1,this.player.layer.teleporting=!1,this.player.EnableClick())}},tick:function(t,e){this.loadingScene&&(this.sceneReading||this.checkSceneLoadThrottled())}}),AFRAME.registerComponent("universal-controls",{dependencies:["auxl"],schema:{update:{type:"number",default:0}},init:function(){this.aScene=document.querySelector("a-scene"),this.auxl=document.querySelector("a-scene").systems.auxl,this.locomotion,this.gimbal,this.vrController1,this.vrController2,this.controls={directionForwardKeys:["w","W"],directionLeftKeys:["a","A"],directionBackwardKeys:["s","S"],directionRightKeys:["d","D"],rotationForwardKeys:[null],rotationLeftKeys:[null],rotationBackwardKeys:[null],rotationRightKeys:[null],action1Keys:["q","Q"],action2Keys:["e","E"],action3Keys:["r","R"],action4Keys:["t","T"],action5Keys:["c","C"],action6Keys:["v","V"],action7Keys:["z","Z"],action8Keys:["x","X"]},this.auxl.controlConfig=this.controls,this.mobileUpLeft=document.getElementById("upLeft"),this.mobileUp=document.getElementById("up"),this.mobileUpRight=document.getElementById("upRight"),this.mobileLeft=document.getElementById("left"),this.mobileCenter=document.getElementById("center"),this.mobileRight=document.getElementById("right"),this.mobileDownLeft=document.getElementById("downLeft"),this.mobileDown=document.getElementById("down"),this.mobileDownRight=document.getElementById("downRight"),this.mobileSelect=document.getElementById("select"),this.mobileStart=document.getElementById("start"),this.mobileA=document.getElementById("a"),this.mobileB=document.getElementById("b"),this.mobileC=document.getElementById("c"),this.mobileD=document.getElementById("d"),this.mobileE=document.getElementById("e"),this.mobileF=document.getElementById("f"),this.mobileL=document.getElementById("l"),this.mobileR=document.getElementById("r"),this.altDownFunc=!1,this.altDownParams=!1,this.altUpFunc=!1,this.altUpParams=!1,this.action1DownFunc=!1,this.action1DownParams=!1,this.action1UpFunc=!1,this.action1UpParams=!1,this.action2DownFunc=!1,this.action2DownParams=!1,this.action2UpFunc=!1,this.action2UpParams=!1,this.action3DownFunc=!1,this.action3DownParams=!1,this.action3UpFunc=!1,this.action3UpParams=!1,this.action4DownFunc=!1,this.action4DownParams=!1,this.action4UpFunc=!1,this.action4UpParams=!1,this.action5DownFunc=!1,this.action5DownParams=!1,this.action5UpFunc=!1,this.action5UpParams=!1,this.action6DownFunc=!1,this.action6DownParams=!1,this.action6UpFunc=!1,this.action6UpParams=!1,this.action7DownFunc=!1,this.action7DownParams=!1,this.action7UpFunc=!1,this.action7UpParams=!1,this.action8DownFunc=!1,this.action8DownParams=!1,this.action8UpFunc=!1,this.action8UpParams=!1,this.mainClickDetail={info:"Main Click",click:null},this.mainClickEvent=new CustomEvent("mainClick",{bubbles:!1,cancelable:!0,detail:this.mainClickDetail}),this.altClickDetail={info:"Alt Click",click:null},this.altClickEvent=new CustomEvent("altClick",{bubbles:!1,cancelable:!0,detail:this.altClickDetail}),this.directionEventDetail={info:"Direction",direction:null},this.directionEvent=new CustomEvent("direction",{bubbles:!1,cancelable:!0,detail:this.directionEventDetail}),this.rotationEventDetail={info:"Rotation",rotation:null},this.rotationEvent=new CustomEvent("rotation",{bubbles:!1,cancelable:!0,detail:this.rotationEventDetail}),this.action1EventDetail={info:"Action 1",action:null},this.action1Event=new CustomEvent("action1",{bubbles:!1,cancelable:!0,detail:this.action1EventDetail}),this.action2EventDetail={info:"Action 2",action:null},this.action2Event=new CustomEvent("action2",{bubbles:!1,cancelable:!0,detail:this.action2EventDetail}),this.action3EventDetail={info:"Action 3",action:null},this.action3Event=new CustomEvent("action3",{bubbles:!1,cancelable:!0,detail:this.action3EventDetail}),this.action4EventDetail={info:"Action 4",action:null},this.action4Event=new CustomEvent("action4",{bubbles:!1,cancelable:!0,detail:this.action4EventDetail}),this.action5EventDetail={info:"Action 5",action:null},this.action5Event=new CustomEvent("action5",{bubbles:!1,cancelable:!0,detail:this.action5EventDetail}),this.action6EventDetail={info:"Action 6",action:null},this.action6Event=new CustomEvent("action6",{bubbles:!1,cancelable:!0,detail:this.action6EventDetail}),this.action7EventDetail={info:"Action 7",action:null},this.action7Event=new CustomEvent("action7",{bubbles:!1,cancelable:!0,detail:this.action7EventDetail}),this.action8EventDetail={info:"Action 8",action:null},this.action8Event=new CustomEvent("action8",{bubbles:!1,cancelable:!0,detail:this.action8EventDetail}),this.mainClickHit=t=>{this.mainClick(t)},this.mainClickE=()=>{this.mainClickDetail.click="click",document.dispatchEvent(this.mainClickEvent)},this.mainClickDown=()=>{this.mainClickDetail.click="clickDown",document.dispatchEvent(this.mainClickEvent)},this.mainClickUp=()=>{this.mainClickDetail.click="clickUp",document.dispatchEvent(this.mainClickEvent)},this.altClickHit=t=>{this.altClick(t)},this.altClickDown=()=>{this.altClickDetail.click="altClickHit",document.dispatchEvent(this.altClickEvent)},this.altClickUp=()=>{this.altClickDetail.click="altClickRelease",document.dispatchEvent(this.altClickEvent)},this.dispatchAlt=()=>{document.dispatchEvent(this.altClickEvent)},this.directionHit=t=>{this.direction(t)},this.directionForwardLeftDown=()=>{this.directionForwardDown(),this.directionLeftDown()},this.directionForwardLeftUp=()=>{this.directionForwardUp(),this.directionLeftUp()},this.directionForwardDown=()=>{this.directionEventDetail.direction="forwardHit",document.dispatchEvent(this.directionEvent)},this.directionForwardUp=()=>{this.directionEventDetail.direction="forwardRelease",document.dispatchEvent(this.directionEvent)},this.directionForwardRightDown=()=>{this.directionForwardDown(),this.directionRightDown()},this.directionForwardRightUp=()=>{this.directionForwardUp(),this.directionRightUp()},this.directionLeftDown=()=>{this.directionEventDetail.direction="leftHit",document.dispatchEvent(this.directionEvent)},this.directionLeftUp=()=>{this.directionEventDetail.direction="leftRelease",document.dispatchEvent(this.directionEvent)},this.directionBackwardLeftDown=()=>{this.directionBackwardDown(),this.directionLeftDown()},this.directionBackwardLeftUp=()=>{this.directionBackwardUp(),this.directionLeftUp()},this.directionBackwardDown=()=>{this.directionEventDetail.direction="backwardHit",document.dispatchEvent(this.directionEvent)},this.directionBackwardUp=()=>{this.directionEventDetail.direction="backwardRelease",document.dispatchEvent(this.directionEvent)},this.directionBackwardRightDown=()=>{this.directionBackwardDown(),this.directionRightDown()},this.directionBackwardRightUp=()=>{this.directionBackwardUp(),this.directionRightUp()},this.directionRightDown=()=>{this.directionEventDetail.direction="rightHit",document.dispatchEvent(this.directionEvent)},this.directionRightUp=()=>{this.directionEventDetail.direction="rightRelease",document.dispatchEvent(this.directionEvent)},this.rotationHit=t=>{this.rotation(t)},this.rotationForwardLeftDown=()=>{this.rotationForwardDown(),this.rotationLeftDown()},this.rotationForwardLeftUp=()=>{this.rotationForwardUp(),this.rotationLeftUp()},this.rotationForwardDown=()=>{this.rotationEventDetail.rotation="forwardHit",document.dispatchEvent(this.rotationEvent)},this.rotationForwardUp=()=>{this.rotationEventDetail.rotation="forwardRelease",document.dispatchEvent(this.rotationEvent)},this.rotationForwardRightDown=()=>{this.rotationForwardDown(),this.rotationRightDown()},this.rotationForwardRightUp=()=>{this.rotationForwardUp(),this.rotationRightUp()},this.rotationLeftDown=()=>{this.rotationEventDetail.rotation="leftHit",document.dispatchEvent(this.rotationEvent)},this.rotationLeftUp=()=>{this.rotationEventDetail.rotation="leftRelease",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardLeftDown=()=>{this.rotationBackwardDown(),this.rotationLeftDown()},this.rotationBackwardLeftUp=()=>{this.rotationBackwardUp(),this.rotationLeftUp()},this.rotationBackwardDown=()=>{this.rotationEventDetail.rotation="backwardHit",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardUp=()=>{this.rotationEventDetail.rotation="backwardRelease",document.dispatchEvent(this.rotationEvent)},this.rotationBackwardRightDown=()=>{this.rotationBackwardDown(),this.rotationRightDown()},this.rotationBackwardRightUp=()=>{this.rotationBackwardUp(),this.rotationRightUp()},this.rotationRightDown=()=>{this.rotationEventDetail.rotation="rightHit",document.dispatchEvent(this.rotationEvent)},this.rotationRightUp=()=>{this.rotationEventDetail.rotation="rightRelease",document.dispatchEvent(this.rotationEvent)},this.action1Hit=t=>{this.action1(t)},this.action1Down=()=>{this.action1EventDetail.action="action1Hit",document.dispatchEvent(this.action1Event)},this.action1Up=()=>{this.action1EventDetail.action="action1Release",document.dispatchEvent(this.action1Event)},this.action2Hit=t=>{this.action2(t)},this.action2Down=()=>{this.action2EventDetail.action="action2Hit",document.dispatchEvent(this.action2Event)},this.action2Up=()=>{this.action2EventDetail.action="action2Release",document.dispatchEvent(this.action2Event)},this.action3Hit=t=>{this.action3(t)},this.action3Down=()=>{this.action3EventDetail.action="action3Hit",document.dispatchEvent(this.action3Event)},this.action3Up=()=>{this.action3EventDetail.action="action3Release",document.dispatchEvent(this.action3Event)},this.action4Hit=t=>{this.action4(t)},this.action4Down=()=>{this.action4EventDetail.action="action4Hit",document.dispatchEvent(this.action4Event)},this.action4Up=()=>{this.action4EventDetail.action="action4Release",document.dispatchEvent(this.action4Event)},this.action5Hit=t=>{this.action5(t)},this.action5Down=()=>{this.action5EventDetail.action="action5Hit",document.dispatchEvent(this.action5Event)},this.action5Up=()=>{this.action5EventDetail.action="action5Release",document.dispatchEvent(this.action5Event)},this.action6Hit=t=>{this.action6(t)},this.action6Down=()=>{this.action6EventDetail.action="action6Hit",document.dispatchEvent(this.action6Event)},this.action6Up=()=>{this.action6EventDetail.action="action6Release",document.dispatchEvent(this.action6Event)},this.action7Hit=t=>{this.action7(t)},this.action7Down=()=>{this.action7EventDetail.action="action7Hit",document.dispatchEvent(this.action7Event)},this.action7Up=()=>{this.action7EventDetail.action="action7Release",document.dispatchEvent(this.action7Event)},this.action8Hit=t=>{this.action8(t)},this.action8Down=()=>{this.action8EventDetail.action="action8Hit",document.dispatchEvent(this.action8Event)},this.action8Up=()=>{this.action8EventDetail.action="action8Release",document.dispatchEvent(this.action8Event)},this.keyboardDownHit=t=>{this.keyboardDown(t)},this.keyboardUpHit=t=>{this.keyboardUp(t)},this.blankHit=t=>{this.blank(t)},this.questLeftMainClickDown=()=>{this.mainClickDetail.click="leftClickDown",document.dispatchEvent(this.mainClickEvent)},this.questLeftMainClickUp=()=>{this.mainClickDetail.click="leftClickUp",document.dispatchEvent(this.mainClickEvent)},this.questLeftAltClickDown=()=>{this.altClickDetail.click="leftAltClickDown",document.dispatchEvent(this.altClickEvent)},this.questLeftAltClickUp=()=>{this.altClickDetail.click="leftAltClickUp",document.dispatchEvent(this.altClickEvent)},this.questJoystickLocomotionEvent=t=>{1===auxl.joystickLoco||(4===auxl.joystickLoco?this.questJoystick4Locomotion(t):8===auxl.joystickLoco&&this.questJoystick8Locomotion(t))},this.deadzoneLoco=.1,this.xNumLoco=0,this.yNumLoco=0,this.angleLoco=0,this.angleDegLoco=0,this.questRightMainClickDown=()=>{this.mainClickDetail.click="rightClickDown",document.dispatchEvent(this.mainClickEvent)},this.questRightMainClickUp=()=>{this.mainClickDetail.click="rightClickUp",document.dispatchEvent(this.mainClickEvent)},this.questRightAltClickDown=()=>{this.altClickDetail.click="rightAltClickDown",document.dispatchEvent(this.altClickEvent)},this.questRightAltClickUp=()=>{this.altClickDetail.click="rightAltClickUp",document.dispatchEvent(this.altClickEvent)},this.questJoystickOtherEvent=t=>{this.questJoystick4Other(t)},this.deadzoneOther=.1,this.xNumOther=0,this.yNumOther=0,this.angleOther=0,this.angleDegOther=0,this.questJoystickRotationEvent=t=>{1===auxl.joystickRotation||(4===auxl.joystickRotation?this.questJoystick4Rotation(t):8===auxl.joystickRotation&&this.questJoystick8Rotation(t))},this.deadzoneRot=.1,this.xNumRot=0,this.yNumRot=0,this.angleRot=0,this.angleDegRot=0},updateInput:function(t){},updateAction:function(t){for(let e in t){let i,o,a;if("altDown"===e)i="altDownFunc",o="altDownParams",a="center";else if("altUp"===e)i="altUpFunc",o="altUpParams",a="center";else if("action1Down"===e)i="action1DownFunc",o="action1DownParams",a="a";else if("action1Up"===e)i="action1UpFunc",o="action1UpParams",a="a";else if("action2Down"===e)i="action2DownFunc",o="action2DownParams",a="b";else if("action2Up"===e)i="action2UpFunc",o="action2UpParams",a="b";else if("action3Down"===e)i="action3DownFunc",o="action3DownParams",a="c";else if("action3Up"===e)i="action3UpFunc",o="action3UpParams",a="c";else if("action4Down"===e)i="action4DownFunc",o="action4DownParams",a="d";else if("action4Up"===e)i="action4UpFunc",o="action4UpParams",a="d";else if("action5Down"===e)i="action5DownFunc",o="action5DownParams",a="e";else if("action5Up"===e)i="action5UpFunc",o="action5UpParams",a="e";else if("action6Down"===e)i="action6DownFunc",o="action6DownParams",a="f";else if("action6Up"===e)i="action6UpFunc",o="action6UpParams",a="f";else if("action7Down"===e)i="action7DownFunc",o="action7DownParams",a="l";else if("action7Up"===e)i="action7UpFunc",o="action7UpParams",a="l";else if("action8Down"===e)i="action8DownFunc",o="action8DownParams",a="r";else{if("action8Up"!==e)return void console.log("Failed to identify action");i="action8UpFunc",o="action8UpParams",a="r"}if(t[e]){let n=t[e].auxlObj,s=!1;t[e].component&&(s=t[e].component);let r=t[e].func;this[o]=!1,t[e].params&&(this[o]=t[e].params),this[i]=s?document.getElementById(n).components[s][r].bind(document.getElementById(n).components[s]):this.auxl[n][r],t[e].name&&(this.auxl.controlsInfo[e]={name:t[e].name,info:t[e].info}),this.auxl.ToggleHTML(a,!0)}else this[i]=!1,this[o]=!1}},disableAction:function(t){for(let e in t){let i,o,a;if("altDown"===e)i="altDownFunc",o="altDownParams",a="center";else if("altUp"===e)i="altUpFunc",o="altUpParams",a="center";else if("action1Down"===e)i="action1DownFunc",o="action1DownParams",a="a";else if("action1Up"===e)i="action1UpFunc",o="action1UpParams",a="a";else if("action2Down"===e)i="action2DownFunc",o="action2DownParams",a="b";else if("action2Up"===e)i="action2UpFunc",o="action2UpParams",a="b";else if("action3Down"===e)i="action3DownFunc",o="action3DownParams",a="c";else if("action3Up"===e)i="action3UpFunc",o="action3UpParams",a="c";else if("action4Down"===e)i="action4DownFunc",o="action4DownParams",a="d";else if("action4Up"===e)i="action4UpFunc",o="action4UpParams",a="d";else if("action5Down"===e)i="action5DownFunc",o="action5DownParams",a="e";else if("action5Up"===e)i="action5UpFunc",o="action5UpParams",a="e";else if("action6Down"===e)i="action6DownFunc",o="action6DownParams",a="f";else if("action6Up"===e)i="action6UpFunc",o="action6UpParams",a="f";else if("action7Down"===e)i="action7DownFunc",o="action7DownParams",a="l";else if("action7Up"===e)i="action7UpFunc",o="action7UpParams",a="l";else if("action8Down"===e)i="action8DownFunc",o="action8DownParams",a="r";else{if("action8Up"!==e)return console.log("Failed to identify action"),console.log(e),void console.log(t[e]);i="action8UpFunc",o="action8UpParams",a="r"}t[e].name&&delete this.auxl.controlsInfo[e],this.auxl.ToggleHTML(a,!1),this[i]=!1,this[o]=!1}},mainClick:function(t){},altClick:function(t){"altClickHit"===t.detail.action?this.altDownFunc&&(this.altDownParams?this.altDownFunc(this.altDownParams):this.altDownFunc()):"altClickRelease"===t.detail.action&&this.altUpFunc&&(this.altUpParams?this.altUpFunc(this.altUpParams):this.altUpFunc())},direction:function(t){"forwardHit"===t.detail.direction?this.locomotion.movingForward():"forwardRelease"===t.detail.direction?this.locomotion.cancelForward():"leftHit"===t.detail.direction?this.locomotion.movingLeft():"leftRelease"===t.detail.direction?this.locomotion.cancelLeft():"backwardHit"===t.detail.direction?this.locomotion.movingReverse():"backwardRelease"===t.detail.direction?this.locomotion.cancelReverse():"rightHit"===t.detail.direction?this.locomotion.movingRight():"rightRelease"===t.detail.direction&&this.locomotion.cancelRight()},rotation:function(t){"forwardHit"===t.detail.rotation?this.gimbal.movingForward():"forwardRelease"===t.detail.rotation?this.gimbal.cancelForward():"leftHit"===t.detail.rotation?this.gimbal.movingLeft():"leftRelease"===t.detail.rotation?this.gimbal.cancelLeft():"backwardHit"===t.detail.rotation?this.gimbal.movingReverse():"backwardRelease"===t.detail.rotation?this.gimbal.cancelReverse():"rightHit"===t.detail.rotation?this.gimbal.movingRight():"rightRelease"===t.detail.rotation&&this.gimbal.cancelRight()},action1:function(t){"action1Hit"===t.detail.action?this.action1DownFunc&&(this.action1DownParams?this.action1DownFunc(this.action1DownParams):this.action1DownFunc()):"action1Release"===t.detail.action&&this.action1UpFunc&&(this.action1UpParams?this.action1UpFunc(this.action1UpParams):this.action1UpFunc())},action2:function(t){"action2Hit"===t.detail.action?this.action2DownFunc&&(this.action2DownParams?this.action2DownFunc(this.action2DownParams):this.action2DownFunc()):"action2Release"===t.detail.action&&this.action2UpFunc&&(this.action2UpParams?this.action2UpFunc(this.action2UpParams):this.action2UpFunc())},action3:function(t){"action3Hit"===t.detail.action?this.action3DownFunc&&(this.action3DownParams?this.action3DownFunc(this.action3DownParams):this.action3DownFunc()):"action3Release"===t.detail.action&&this.action3UpFunc&&(this.action3UpParams?this.action3UpFunc(this.action3UpParams):this.action3UpFunc())},action4:function(t){"action4Hit"===t.detail.action?this.action4DownFunc&&(this.action4DownParams?this.action4DownFunc(this.action4DownParams):this.action4DownFunc()):"action4Release"===t.detail.action&&this.action4UpFunc&&(this.action4UpParams?this.action4UpFunc(this.action4UpParams):this.action4UpFunc())},action5:function(t){"action5Hit"===t.detail.action?this.action5DownFunc&&(this.action5DownParams?this.action5DownFunc(this.action5DownParams):this.action5DownFunc()):"action5Release"===t.detail.action&&this.action5UpFunc&&(this.action5UpParams?this.action5UpFunc(this.action5UpParams):this.action5UpFunc())},action6:function(t){"action6Hit"===t.detail.action?this.action6DownFunc&&(this.action6DownParams?this.action6DownFunc(this.action6DownParams):this.action6DownFunc()):"action6Release"===t.detail.action&&this.action6UpFunc&&(this.action6UpParams?this.action6UpFunc(this.action6UpParams):this.action6UpFunc())},action7:function(t){"action7Hit"===t.detail.action?this.action7DownFunc&&(this.action7DownParams?this.action7DownFunc(this.action7DownParams):this.action7DownFunc()):"action7Release"===t.detail.action&&this.action7UpFunc&&(this.action7UpParams?this.action7UpFunc(this.action7UpParams):this.action7UpFunc())},action8:function(t){"action8Hit"===t.detail.action?this.action8DownFunc&&(this.action8DownParams?this.action8DownFunc(this.action8DownParams):this.action8DownFunc()):"action8Release"===t.detail.action&&this.action8UpFunc&&(this.action8UpParams?this.action8UpFunc(this.action8UpParams):this.action8UpFunc())},keyboardDown:function(t){this.controls.directionForwardKeys.includes(t.key)?this.directionForwardDown():this.controls.directionLeftKeys.includes(t.key)?this.directionLeftDown():this.controls.directionBackwardKeys.includes(t.key)?this.directionBackwardDown():this.controls.directionRightKeys.includes(t.key)?this.directionRightDown():this.controls.rotationForwardKeys.includes(t.key)?this.rotationForwardDown():this.controls.rotationLeftKeys.includes(t.key)?this.rotationLeftDown():this.controls.rotationBackwardKeys.includes(t.key)?this.rotationBackwardDown():this.controls.rotationRightKeys.includes(t.key)?this.rotationRightDown():this.controls.action1Keys.includes(t.key)?this.action1Down():this.controls.action2Keys.includes(t.key)?this.action2Down():this.controls.action3Keys.includes(t.key)?this.action3Down():this.controls.action4Keys.includes(t.key)?this.action4Down():this.controls.action5Keys.includes(t.key)?this.action5Down():this.controls.action6Keys.includes(t.key)?this.action6Down():this.controls.action7Keys.includes(t.key)?this.action7Down():this.controls.action8Keys.includes(t.key)&&this.action8Down()},keyboardUp:function(t){this.controls.directionForwardKeys.includes(t.key)?this.directionForwardUp():this.controls.directionLeftKeys.includes(t.key)?this.directionLeftUp():this.controls.directionBackwardKeys.includes(t.key)?this.directionBackwardUp():this.controls.directionRightKeys.includes(t.key)?this.directionRightUp():this.controls.rotationForwardKeys.includes(t.key)?this.rotationForwardUp():this.controls.rotationLeftKeys.includes(t.key)?this.rotationLeftUp():this.controls.rotationBackwardKeys.includes(t.key)?this.rotationBackwardUp():this.controls.rotationRightKeys.includes(t.key)?this.rotationRightUp():this.controls.action1Keys.includes(t.key)?this.action1Up():this.controls.action2Keys.includes(t.key)?this.action2Up():this.controls.action3Keys.includes(t.key)?this.action3Up():this.controls.action4Keys.includes(t.key)?this.action4Up():this.controls.action5Keys.includes(t.key)?this.action5Up():this.controls.action6Keys.includes(t.key)?this.action6Up():this.controls.action7Keys.includes(t.key)?this.action7Up():this.controls.action8Keys.includes(t.key)&&this.action8Up()},questJoystick4Locomotion:function(t){this.xNumLoco=t.detail.x,this.yNumLoco=t.detail.y,this.angleLoco=Math.atan2(this.xNumLoco,this.yNumLoco),this.angleDegLoco=this.angleLoco/(Math.PI/180),this.yNumLoco<this.deadzoneLoco&&this.yNumLoco>-1*this.deadzoneLoco&&this.xNumLoco>-1*this.deadzoneLoco&&this.xNumLoco<this.deadzoneLoco?(this.locomotion.clearMovement(),this.updateInput("Locomotion Clear")):this.yNumLoco>this.deadzoneLoco||this.yNumLoco<-1*this.deadzoneLoco||this.xNumLoco<-1*this.deadzoneLoco||this.xNumLoco>this.deadzoneLoco?this.angleDegLoco>-45&&this.angleDegLoco<45?(this.locomotion.clearMovement(),this.locomotion.movingReverse()):this.angleDegLoco>45&&this.angleDegLoco<135?(this.locomotion.clearMovement(),this.locomotion.movingRight()):this.angleDegLoco>135||this.angleDegLoco<-135?(this.locomotion.clearMovement(),this.locomotion.movingForward()):this.angleDegLoco<-45&&this.angleDegLoco>-135&&(this.locomotion.clearMovement(),this.locomotion.movingLeft()):this.locomotion.clearMovement()},questJoystick8Locomotion:function(t){this.xNumLoco=t.detail.x,this.yNumLoco=t.detail.y,this.angleLoco=Math.atan2(this.xNumLoco,this.yNumLoco),this.angleDegLoco=this.angleLoco/(Math.PI/180),this.yNumLoco<this.deadzoneLoco&&this.yNumLoco>-1*this.deadzoneLoco&&this.xNumLoco>-1*this.deadzoneLoco&&this.xNumLoco<this.deadzoneLoco?(this.locomotion.clearMovement(),this.updateInput("Locomotion Clear")):this.yNumLoco>this.deadzoneLoco||this.yNumLoco<-1*this.deadzoneLoco||this.xNumLoco<-1*this.deadzoneLoco||this.xNumLoco>this.deadzoneLoco?this.angleDegLoco>-22.5&&this.angleDegLoco<22.5?(this.locomotion.clearMovement(),this.locomotion.movingReverse()):this.angleDegLoco>22.5&&this.angleDegLoco<67.5?(this.locomotion.clearMovement(),this.locomotion.movingReverse(),this.locomotion.movingRight()):this.angleDegLoco>67.5&&this.angleDegLoco<112.5?(this.locomotion.clearMovement(),this.locomotion.movingRight()):this.angleDegLoco>112.5&&this.angleDegLoco<157.5?(this.locomotion.clearMovement(),this.locomotion.movingForward(),this.locomotion.movingRight()):this.angleDegLoco>157.5||this.angleDegLoco<-157.5?(this.locomotion.clearMovement(),this.locomotion.movingForward()):this.angleDegLoco<-112.5&&this.angleDegLoco>-157.5?(this.locomotion.clearMovement(),this.locomotion.movingForward(),this.locomotion.movingLeft()):this.angleDegLoco<-67.5&&this.angleDegLoco>-112.5?(this.locomotion.clearMovement(),this.locomotion.movingLeft()):this.angleDegLoco<-22.5&&this.angleDegLoco>-67.5&&(this.locomotion.clearMovement(),this.locomotion.movingReverse(),this.locomotion.movingLeft()):this.locomotion.clearMovement()},questJoystick4Rotation:function(t){this.xNumRot=t.detail.x,this.yNumRot=t.detail.y,this.angleRot=Math.atan2(this.xNumRot,this.yNumRot),this.angleDegRot=this.angleRot/(Math.PI/180),this.yNumRot<this.deadzoneRot&&this.yNumRot>-1*this.deadzoneRot&&this.xNumRot>-1*this.deadzoneRot&&this.xNumRot<this.deadzoneRot?(this.gimbal.clearMovement(),this.updateInput("Rotation Clear")):this.yNumRot>this.deadzoneRot||this.yNumRot<-1*this.deadzoneRot||this.xNumRot<-1*this.deadzoneRot||this.xNumRot>this.deadzoneRot?this.angleDegRot>-45&&this.angleDegRot<45?(this.gimbal.clearMovement(),this.gimbal.movingReverse()):this.angleDegRot>45&&this.angleDegRot<135?(this.gimbal.clearMovement(),this.gimbal.movingRight()):this.angleDegRot>135||this.angleDegRot<-135?(this.gimbal.clearMovement(),this.gimbal.movingForward()):this.angleDegRot<-45&&this.angleDegRot>-135&&(this.gimbal.clearMovement(),this.gimbal.movingLeft()):this.gimbal.clearMovement()},questJoystick8Rotation:function(t){this.xNumRot=t.detail.x,this.yNumRot=t.detail.y,this.angleRot=Math.atan2(this.xNumRot,this.yNumRot),this.angleDegRot=this.angleRot/(Math.PI/180),this.yNumRot<this.deadzoneRot&&this.yNumRot>-1*this.deadzoneRot&&this.xNumRot>-1*this.deadzoneRot&&this.xNumRot<this.deadzoneRot?(this.gimbal.clearMovement(),this.updateInput("Rotation Clear")):this.yNumRot>this.deadzoneRot||this.yNumRot<-1*this.deadzoneRot||this.xNumRot<-1*this.deadzoneRot||this.xNumRot>this.deadzoneRot?this.angleDegRot>-22.5&&this.angleDegRot<22.5?(this.gimbal.clearMovement(),this.gimbal.movingReverse()):this.angleDegRot>22.5&&this.angleDegRot<67.5?(this.gimbal.clearMovement(),this.gimbal.movingReverse(),this.gimbal.movingRight()):this.angleDegRot>67.5&&this.angleDegRot<112.5?(this.gimbal.clearMovement(),this.gimbal.movingRight()):this.angleDegRot>112.5&&this.angleDegRot<157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward(),this.gimbal.movingRight()):this.angleDegRot>157.5||this.angleDegRot<-157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward()):this.angleDegRot<-112.5&&this.angleDegRot>-157.5?(this.gimbal.clearMovement(),this.gimbal.movingForward(),this.gimbal.movingLeft()):this.angleDegRot<-67.5&&this.angleDegRot>-112.5?(this.gimbal.clearMovement(),this.gimbal.movingLeft()):this.angleDegRot<-22.5&&this.angleDegRot>-67.5&&(this.gimbal.clearMovement(),this.gimbal.movingReverse(),this.gimbal.movingLeft()):this.gimbal.clearMovement()},questJoystick4Other:function(t){this.xNumOther=t.detail.x,this.yNumOther=t.detail.y,this.angleOther=Math.atan2(this.xNumOther,this.yNumOther),this.angleDegOther=this.angleOther/(Math.PI/180),this.yNumOther<this.deadzoneOther&&this.yNumOther>-1*this.deadzone&&this.xNumOther>-1*this.deadzoneOther&&this.xNumOther<this.deadzoneOther?this.updateInput("Rotation|Duck Clear"):(this.yNumOther>this.deadzoneOther||this.yNumOther<-1*this.deadzoneOther||this.xNumOther<-1*this.deadzoneOther||this.xNumOther>this.deadzoneOther)&&(this.angleDegOther>-45&&this.angleDegOther<45?this.action5Down():this.angleDegOther>45&&this.angleDegOther<135?this.action7Down():this.angleDegOther>135||this.angleDegOther<-135?this.action6Down():this.angleDegOther<-45&&this.angleDegOther>-135&&this.action8Down())},blank:function(t){console.log(t)},update:function(){document.addEventListener("mainClick",this.mainClickHit),document.addEventListener("altClick",this.altClickHit),document.addEventListener("direction",this.directionHit),document.addEventListener("rotation",this.rotationHit),document.addEventListener("action1",this.action1Hit),document.addEventListener("action2",this.action2Hit),document.addEventListener("action3",this.action3Hit),document.addEventListener("action4",this.action4Hit),document.addEventListener("action5",this.action5Hit),document.addEventListener("action6",this.action6Hit),document.addEventListener("action7",this.action7Hit),document.addEventListener("action8",this.action8Hit),document.addEventListener("click",this.mainClickE),document.addEventListener("contextmenu",this.dispatchAlt),document.addEventListener("keydown",this.keyboardDownHit),document.addEventListener("keyup",this.keyboardUpHit),this.questJoystickLocomotionEvent=t=>{1===auxl.joystickLoco||(4===auxl.joystickLoco?this.questJoystick4Locomotion(t):8===auxl.joystickLoco&&this.questJoystick8Locomotion(t))},this.questJoystickRotationEvent=t=>{1===auxl.joystickRotation||(4===auxl.joystickRotation?this.questJoystick4Rotation(t):8===auxl.joystickRotation&&this.questJoystick8Rotation(t))},setTimeout((()=>{this.locomotion=document.getElementById("playerRig").components.locomotion,this.gimbal=document.getElementById("playerRig").components.gimbal,this.vrController1=document.getElementById("vrController1"),this.vrController2=document.getElementById("vrController2"),this.vrController1.addEventListener("triggerdown",this.questLeftMainClickDown),this.vrController1.addEventListener("triggerup",this.questLeftMainClickUp),this.vrController1.addEventListener("gripdown",this.questLeftAltClickDown),this.vrController1.addEventListener("gripup",this.questLeftAltClickUp),this.vrController1.addEventListener("xbuttondown",this.action1Down),this.vrController1.addEventListener("xbuttonup",this.action1Up),this.vrController1.addEventListener("ybuttondown",this.action2Down),this.vrController1.addEventListener("ybuttonup",this.action2Up),this.vrController2.addEventListener("triggerdown",this.questRightMainClickDown),this.vrController2.addEventListener("triggerup",this.questRightMainClickUp),this.vrController2.addEventListener("gripdown",this.questRightAltClickDown),this.vrController2.addEventListener("gripup",this.questRightAltClickUp),this.vrController2.addEventListener("abuttondown",this.action3Down),this.vrController2.addEventListener("abuttonup",this.action3Up),this.vrController2.addEventListener("bbuttondown",this.action4Down),this.vrController2.addEventListener("bbuttonup",this.action4Up),"bothRight"===this.auxl.vrHand||"bothLeftLoco"===this.auxl.vrHand?(this.vrController1.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.addEventListener("thumbstickmoved",this.questJoystickRotationEvent)):"bothLeft"===this.auxl.vrHand||"bothRightLoco"===this.auxl.vrHand?(this.vrController2.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController1.addEventListener("thumbstickmoved",this.questJoystickRotationEvent)):(this.vrController1.addEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.addEventListener("thumbstickmoved",this.questJoystickRotationEvent))}),100),this.mobileUpLeft.addEventListener("touchstart",this.directionForwardLeftDown),this.mobileUpLeft.addEventListener("touchend",this.directionForwardLeftUp),this.mobileUp.addEventListener("touchstart",this.directionForwardDown),this.mobileUp.addEventListener("touchend",this.directionForwardUp),this.mobileUpRight.addEventListener("touchstart",this.directionForwardRightDown),this.mobileUpRight.addEventListener("touchend",this.directionForwardRightUp),this.mobileLeft.addEventListener("touchstart",this.directionLeftDown),this.mobileLeft.addEventListener("touchend",this.directionLeftUp),this.mobileCenter.addEventListener("touchstart",this.blankHit),this.mobileCenter.addEventListener("touchend",this.blankHit),this.mobileRight.addEventListener("touchstart",this.directionRightDown),this.mobileRight.addEventListener("touchend",this.directionRightUp),this.mobileDownLeft.addEventListener("touchstart",this.directionBackwardLeftDown),this.mobileDownLeft.addEventListener("touchend",this.directionBackwardLeftUp),this.mobileDown.addEventListener("touchstart",this.directionBackwardDown),this.mobileDown.addEventListener("touchend",this.directionBackwardUp),this.mobileDownRight.addEventListener("touchstart",this.directionBackwardRightDown),this.mobileDownRight.addEventListener("touchend",this.directionBackwardRightUp),this.mobileSelect.addEventListener("touchstart",this.blankHit),this.mobileStart.addEventListener("touchstart",this.blankHit),this.mobileA.addEventListener("touchstart",this.action1Down),this.mobileA.addEventListener("touchend",this.action1Up),this.mobileB.addEventListener("touchstart",this.action2Down),this.mobileB.addEventListener("touchend",this.action2Up),this.mobileC.addEventListener("touchstart",this.action3Down),this.mobileC.addEventListener("touchend",this.action3Up),this.mobileD.addEventListener("touchstart",this.action4Down),this.mobileD.addEventListener("touchend",this.action4Up),this.mobileE.addEventListener("touchstart",this.action5Down),this.mobileE.addEventListener("touchend",this.action5Up),this.mobileF.addEventListener("touchstart",this.action6Down),this.mobileF.addEventListener("touchend",this.action6Up),this.mobileL.addEventListener("touchstart",this.action7Down),this.mobileL.addEventListener("touchend",this.action7Up),this.mobileR.addEventListener("touchstart",this.action8Down),this.mobileR.addEventListener("touchend",this.action8Up)},remove:function(){document.removeEventListener("mainClick",this.mainClickHit),document.removeEventListener("altClick",this.altClickHit),document.removeEventListener("direction",this.directionHit),document.removeEventListener("rotation",this.rotationHit),document.removeEventListener("action1",this.action1Hit),document.removeEventListener("action2",this.action2Hit),document.removeEventListener("action3",this.action3Hit),document.removeEventListener("action4",this.action4Hit),document.removeEventListener("action5",this.action5Hit),document.removeEventListener("action6",this.action6Hit),document.removeEventListener("action7",this.action7Hit),document.removeEventListener("action8",this.action8Hit),document.removeEventListener("click",this.mainClickE),document.removeEventListener("contextmenu",this.dispatchAlt),document.removeEventListener("keydown",this.keyboardDownHit),document.removeEventListener("keyup",this.keyboardUpHit),this.vrController1.removeEventListener("triggerdown",this.questLeftMainClickDown),this.vrController1.removeEventListener("triggerup",this.questLeftMainClickUp),this.vrController1.removeEventListener("gripdown",this.questLeftAltClickDown),this.vrController1.removeEventListener("gripup",this.questLeftAltClickUp),this.vrController1.removeEventListener("xbuttondown",this.action1Down),this.vrController1.removeEventListener("xbuttonup",this.action1Up),this.vrController1.removeEventListener("ybuttondown",this.action2Down),this.vrController1.removeEventListener("ybuttonup",this.action2Up),this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.removeEventListener("triggerdown",this.questRightMainClickDown),this.vrController2.removeEventListener("triggerup",this.questRightMainClickUp),this.vrController2.removeEventListener("gripdown",this.questRightAltClickDown),this.vrController2.removeEventListener("gripup",this.questRightAltClickUp),this.vrController2.removeEventListener("abuttondown",this.action3Down),this.vrController2.removeEventListener("abuttonup",this.action3Up),this.vrController2.removeEventListener("bbuttondown",this.action4Down),this.vrController2.removeEventListener("bbuttonup",this.action4Up),this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent),"bothRight"===this.auxl.vrHand||"bothLeftLoco"===this.auxl.vrHand?(this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent)):"bothLeft"===this.auxl.vrHand||"bothRightLoco"===this.auxl.vrHand?(this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent)):(this.vrController1.removeEventListener("thumbstickmoved",this.questJoystickLocomotionEvent),this.vrController2.removeEventListener("thumbstickmoved",this.questJoystickOtherEvent)),this.mobileUpLeft.removeEventListener("mousedown",this.directionForwardLeftDown),this.mobileUpLeft.removeEventListener("mouseup",this.directionForwardLeftUp),this.mobileUp.removeEventListener("mousedown",this.directionForwardDown),this.mobileUp.removeEventListener("mouseup",this.directionForwardUp),this.mobileUpRight.removeEventListener("mousedown",this.directionForwardRightDown),this.mobileUpRight.removeEventListener("mouseup",this.directionForwardRightUp),this.mobileLeft.removeEventListener("mousedown",this.directionLeftDown),this.mobileLeft.removeEventListener("mouseup",this.directionLeftUp),this.mobileCenter.removeEventListener("mousedown",this.blankHit),this.mobileCenter.removeEventListener("mouseup",this.blankHit),this.mobileRight.removeEventListener("mousedown",this.directionRightDown),this.mobileRight.removeEventListener("mouseup",this.directionRightUp),this.mobileDownLeft.removeEventListener("mousedown",this.directionBackwardLeftDown),this.mobileDownLeft.removeEventListener("mouseup",this.directionBackwardLeftUp),this.mobileDown.removeEventListener("mousedown",this.directionBackwardDown),this.mobileDown.removeEventListener("mouseup",this.directionBackwardUp),this.mobileDownRight.removeEventListener("mousedown",this.directionBackwardRightDown),this.mobileDownRight.removeEventListener("mouseup",this.directionBackwardRightUp),this.mobileSelect.removeEventListener("mousedown",this.blankHit),this.mobileStart.removeEventListener("mousedown",this.blankHit),this.mobileA.removeEventListener("mousedown",this.action1Down),this.mobileA.removeEventListener("mouseup",this.action1Up),this.mobileB.removeEventListener("mousedown",this.action2Down),this.mobileB.removeEventListener("mouseup",this.action2Up),this.mobileC.removeEventListener("mousedown",this.action3Down),this.mobileC.removeEventListener("mouseup",this.action3Up),this.mobileD.removeEventListener("mousedown",this.action4Down),this.mobileD.removeEventListener("mouseup",this.action4Up),this.mobileE.removeEventListener("mousedown",this.action5Down),this.mobileE.removeEventListener("mouseup",this.action5Up),this.mobileF.removeEventListener("mousedown",this.action6Down),this.mobileF.removeEventListener("mouseup",this.action6Up),this.mobileL.removeEventListener("touchstart",this.action7Down),this.mobileL.removeEventListener("touchend",this.action7Up),this.mobileR.removeEventListener("touchstart",this.action8Down),this.mobileR.removeEventListener("touchend",this.action8Up)}}),AFRAME.registerComponent("locomotion",{dependencies:["auxl"],schema:{uiid:{type:"string",default:"ui"},courserid:{type:"string",default:"mouseCursor"},movetype:{type:"string",default:"vr"},pov:{type:"string",default:"1st"},style:{type:"string",default:"free"},axis:{type:"string",default:"posXZ"},speedFast:{type:"number",default:.15},speedSlow:{type:"number",default:.075}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.freeStepThrottled=AFRAME.utils.throttle(this.freeStep,30,this),this.gridStepThrottled=AFRAME.utils.throttle(this.gridStep,400,this),this.mouseCursor=document.getElementById(this.data.courserid),this.data.uuid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,this.pov=this.data.pov,this.style=this.data.style,this.axis=this.data.axis,this.directionForward,this.directionReverse,this.directionBrake1,this.directionBrake2,this.directionBrake3,this.directionBrake4,this.camera=document.getElementById("camera"),this.player=document.getElementById("playerRig"),this.avatar,this.avatarSphere,this.ui=document.getElementById("beltUIParent"),this.positionCam=new THREE.Vector3,this.positionPlayer=new THREE.Vector3,this.rotationPlayer=new THREE.Vector3,this.positionAvatar=new THREE.Vector3,this.rotationAvatar=new THREE.Vector3,this.positionNew=new THREE.Vector3,this.rotationNew=new THREE.Vector3,this.positionTemp=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.vector,this.angle,this.directionObject,this.directionVector=new THREE.Vector3,this.posRound=new THREE.Vector3,this.newPosRound=new THREE.Vector3,this.newPosStandRound=new THREE.Vector3,this.newPosTemp=new THREE.Vector3,this.mapX,this.mapZ,this.elPosVec3New=new THREE.Vector3,this.velocity,this.userPreviousPos=this.player.getAttribute("position"),this.userPos,this.userRot,this.userPov,this.userTravel,this.userView,this.newX,this.newZ,this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveUp=!1,this.moveDown=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault=this.data.speedFast,this.moveSpeedSlow=this.data.speedSlow,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridUpTimeout,this.gridDownTimeout,this.gridMove=!1,this.gridSpeed=400,setTimeout((()=>{"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere"),"angleXY"===this.axis&&(this.avatar.object3D.position.copy(new THREE.Vector3(0,0,-10)),this.player.object3D.position.copy(new THREE.Vector3(0,1.6,2)))}),500))}),1e3)},round:function(t){return Math.round(t)},roundHalf:function(t){return Math.round(2*t)/2},movingForward:function(){clearTimeout(this.gridForwardTimeout),this.moveTo||(this.moveTo=!0)},cancelForward:function(){this.moveTo&&("grid"===this.style?this.gridMove?this.moveTo=!1:this.gridForwardTimeout=setTimeout((()=>{this.moveTo=!1}),this.gridSpeed/1.25):this.moveTo=!1)},movingReverse:function(){clearTimeout(this.gridReverseTimeout),this.moveBack||(this.moveBack=!0)},cancelReverse:function(){this.moveBack&&("grid"===this.style?this.gridMove?this.moveBack=!1:this.gridReverseTimeout=setTimeout((()=>{this.moveBack=!1}),this.gridSpeed/1.25):this.moveBack=!1)},movingLeft:function(){clearTimeout(this.gridLeftTimeout),this.moveLeft||(this.moveLeft=!0)},cancelLeft:function(){this.moveLeft&&("grid"===this.style?this.gridMove?this.moveLeft=!1:this.gridLeftTimeout=setTimeout((()=>{this.moveLeft=!1}),this.gridSpeed/1.25):this.moveLeft=!1)},movingRight:function(){clearTimeout(this.gridRightTimeout),this.moveRight||(this.moveRight=!0)},cancelRight:function(){this.moveRight&&("grid"===this.style?this.gridMove?this.moveRight=!1:this.gridRightTimeout=setTimeout((()=>{this.moveRight=!1}),this.gridSpeed/1.25):this.moveRight=!1)},movingUp:function(){clearTimeout(this.gridUpTimeout),this.moveUp||(this.moveUp=!0)},cancelUp:function(){this.moveUp&&("grid"===this.style?this.gridMove?this.moveUp=!1:this.gridUpTimeout=setTimeout((()=>{this.moveUp=!1}),this.gridSpeed/1.25):this.moveUp=!1)},movingDown:function(){clearTimeout(this.gridDownTimeout),this.moveDown||(this.moveDown=!0)},cancelDown:function(){this.moveDown&&("grid"===this.style?this.gridMove?this.moveDown=!1:this.gridDownTimeout=setTimeout((()=>{this.moveDown=!1}),this.gridSpeed/1.25):this.moveDown=!1)},clearMovement:function(){this.cancelForward(),this.cancelReverse(),this.cancelLeft(),this.cancelRight(),this.cancelUp(),this.cancelDown()},clearGridMovement:function(){this.moveTo=!1,this.moveBack=!1,this.moveLeft=!1,this.moveRight=!1,clearTimeout(this.gridForwardTimeout),clearTimeout(this.gridReverseTimeout),clearTimeout(this.gridLeftTimeout),clearTimeout(this.gridRightTimeout)},toggleSpeed:function(){this.brakeReady&&(this.brakeToggle?(this.brakeToggle=!1,this.brakeReady=!1,this.moveBrake=!0,this.gridSpeed=400,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)):(this.brakeToggle=!0,this.brakeReady=!1,this.moveBrake=!1,this.gridSpeed=200,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)),this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),250))},brakeReadBufferLong:function(){this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),2250)},hoverLocomotion:function(t){this.brakeReady&&(this.brakeToggle?(this.brakeToggle=!1,this.brakeReady=!1,this.moveBrake=!0,this.directionBrake1.setAttribute("material",{color:"red"}),this.directionBrake2.setAttribute("material",{color:"red"}),this.directionBrake3.setAttribute("material",{color:"red"}),this.directionBrake4.setAttribute("material",{color:"red"}),this.directionForward.emit("brakeOn",{}),this.directionReverse.emit("brakeOn",{}),this.directionBrake1.emit("brakeOn",{}),this.directionBrake2.emit("brakeOn",{}),this.directionBrake3.emit("brakeOn",{}),this.directionBrake4.emit("brakeOn",{})):(this.brakeToggle=!0,this.brakeReady=!1,this.moveBrake=!1,this.directionBrake1.setAttribute("material",{color:"black"}),this.directionBrake2.setAttribute("material",{color:"black"}),this.directionBrake3.setAttribute("material",{color:"black"}),this.directionBrake4.setAttribute("material",{color:"black"}),this.directionForward.emit("brakeOff",{}),this.directionReverse.emit("brakeOff",{}),this.directionBrake1.emit("brakeOff",{}),this.directionBrake2.emit("brakeOff",{}),this.directionBrake3.emit("brakeOff",{}),this.directionBrake4.emit("brakeOff",{})))},update:function(){this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault=this.data.speedFast,this.moveSpeedSlow=this.data.speedSlow,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridMove=!1,this.gridSpeed=500,this.mouseCursor=document.getElementById(this.data.courserid),this.data.uiid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,this.pov=this.data.pov,this.style=this.data.style,this.axis=this.data.axis,setTimeout((()=>{"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere"),"angleXY"===this.axis&&(this.avatar.object3D.position.copy(new THREE.Vector3(0,0,-10)),this.player.object3D.position.copy(new THREE.Vector3(0,1.6,2)))}),500))}),1e3),"desktop"===this.movetype||"mobile"===this.movetype?this.directionObject=document.getElementById("camera"):"vr"===this.movetype?"camera"===this.auxl.directionType?this.directionObject=document.getElementById("camera"):"bothRight"===this.auxl.vrHand||"bothLeftLoco"===this.auxl.vrHand?this.directionObject=document.getElementById("vrController1"):"bothLeft"===this.auxl.vrHand||"bothRightLoco"===this.auxl.vrHand?this.directionObject=document.getElementById("vrController2"):this.directionObject=document.getElementById("vrController1"):"vrHover"===this.movetype&&("camera"===this.auxl.directionType?this.directionObject=document.getElementById("camera"):this.directionObject=document.getElementById("vrController1"),this.directionForward=document.getElementById("locomotionForwardUI"),this.directionReverse=document.getElementById("locomotionReverseUI"),this.directionBrake1=document.getElementById("locomotionBrake1UI"),this.directionBrake2=document.getElementById("locomotionBrake2UI"),this.directionBrake3=document.getElementById("locomotionBrake3UI"),this.directionBrake4=document.getElementById("locomotionBrake4UI"),this.directionForward.addEventListener("mouseenter",this.movingForward),this.directionForward.addEventListener("mouseleave",this.cancelForward),this.directionReverse.addEventListener("mouseenter",this.movingReverse),this.directionReverse.addEventListener("mouseleave",this.cancelReverse),this.hoverLocomotionEvent=t=>{this.hoverLocomotion(t)},document.querySelectorAll(".directionBrake").forEach((t=>{t.addEventListener("mouseenter",(t=>this.hoverLocomotionEvent))})),document.querySelectorAll(".directionBrake").forEach((t=>{t.addEventListener("mouseleave",(t=>this.brakeReadBufferLong))})))},remove:function(){"desktop"===this.movetype||"mobile"===this.movetype||"vr"===this.movetype||"vrHover"===this.movetype&&(this.directionForward.removeEventListener("mouseenter",this.movingForward),this.directionForward.removeEventListener("mouseleave",this.cancelForward),this.directionReverse.removeEventListener("mouseenter",this.movingReverse),this.directionReverse.removeEventListener("mouseleave",this.cancelReverse),document.querySelectorAll(".directionBrake").forEach((t=>{t.removeEventListener("mouseenter",(t=>this.hoverLocomotionEvent))})),document.querySelectorAll(".directionBrake").forEach((t=>{t.removeEventListener("mouseleave",(t=>this.brakeReadBufferLong))})))},tick:function(t,e){this.auxl.player.layer.move&&("free"===this.style?this.freeStepThrottled():"grid"===this.style&&this.gridStepThrottled(),"vrHover"===this.movetype&&this.uiSync())},freeStep:function(t,e){this.moveBrake?this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedSlow):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedSlow):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedSlow):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedSlow):this.moveTo?this.move("forward",this.moveSpeedSlow):this.moveBack?this.move("reverse",this.moveSpeedSlow):this.moveRight?this.move("right",this.moveSpeedSlow):this.moveLeft&&this.move("left",this.moveSpeedSlow):this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedDefault):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedDefault):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedDefault):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedDefault):this.moveTo?this.move("forward",this.moveSpeedDefault):this.moveBack?this.move("reverse",this.moveSpeedDefault):this.moveRight?this.move("right",this.moveSpeedDefault):this.moveLeft&&this.move("left",this.moveSpeedDefault)},freeStepPlus:function(t,e){this.movement="",this.moveUp&&this.moveDown||(this.moveUp?this.movement+="Up":this.moveDown&&(this.movement+="Down")),this.moveTo&&this.moveBack||(this.moveTo?this.movement+="Forward":this.moveBack&&(this.movement+="Reverse")),this.moveRight&&this.moveLeft||(this.moveRight?this.movement+="Right":this.moveLeft&&(this.movement+="Left")),this.moveBrake?this.move(this.movement,this.moveSpeedSlow):this.move(this.movement,this.moveSpeedDefault)},gridStep:function(t,e){this.moveTo||this.moveBack||this.moveRight||this.moveLeft?this.gridMove||(this.gridMove=!0):this.gridMove=!1,this.moveTo&&this.moveRight?this.move("forwardRight",.5):this.moveTo&&this.moveLeft?this.move("forwardLeft",.5):this.moveBack&&this.moveRight?this.move("reverseRight",.5):this.moveBack&&this.moveLeft?this.move("reverseLeft",.5):this.moveTo?this.move("forward",.5):this.moveBack?this.move("reverse",.5):this.moveRight?this.move("right",.5):this.moveLeft&&this.move("left",.5)},distance:function(t,e,i,o){return Math.sqrt(Math.pow(i-t,2)+1*Math.pow(o-e,2))},uiSync:function(){this.elPosVec3New.copy(this.el.object3D.position),this.ui.object3D.position.copy(this.elPosVec3New)},move:function(t,e){"1st"===this.pov?"posXZ"===this.axis?this.directionXZ(t,e):"posXZY"===this.axis?this.directionXZY(t,e):"posXY"===this.axis?this.directionXY(t,e):"posXYZ"===this.axis?this.directionXYZ(t,e):"posXYZWall"===this.axis?this.directionXYZWall(t,e):"angleXY"===this.axis?this.directionAXY(t,e):"angleXYZ"===this.axis&&this.directionAXYZ(t,e):"3rd"===this.pov&&("posXZ"===this.axis?this.rigXZ(t,e):"posXZY"===this.axis?this.rigXZY(t,e):"posXY"===this.axis?this.rigXY(t,e):"posXYZ"===this.axis?this.rigXYZ(t,e):"posXYZWall"===this.axis?this.rigXYZWall(t,e):"angleXY"===this.axis?this.rigAXY(t,e):"angleXYZ"===this.axis&&this.rigAXYZ(t,e))},togglePOV:function(){"3rd"===this.pov&&(this.auxl.avatar.SpawnLayer(!0),this.player.object3D.position.copy(new THREE.Vector3(0,5,10)),setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere")}),500))},directionXZ:function(t,e){if(this.allow=!1,this.velocity=e,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"forwardLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverseRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"reverseLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"forward"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverse"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity):"right"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z):"left"===t&&("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z)),this.positionNew.y=this.positionPlayer.y,this.auxl.physics)this.player.body.position.copy(this.positionNew);else if(this.auxl.collision){if(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.round(this.positionNew.y),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.round(this.positionPlayer.y),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.auxl.player.layer.standing?(this.newPosStandRound.copy(this.newPosRound),this.newPosStandRound.y+=1,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosStandRound,this.posRound)?this.allow=!0:this.allow=!1):this.allow=!0),this.allow||(this.newPosTemp.copy(this.newPosRound),this.newPosRound.x=this.posRound.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.x=this.positionPlayer.x,this.allow=!0):(this.newPosRound.z=this.posRound.z,this.newPosRound.x=this.newPosTemp.x,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.positionNew.z=this.positionPlayer.z,this.allow=!0))),this.allow){this.player.object3D.position.copy(this.positionNew),this.auxl.player.layer.gridPos.copy(this.newPosRound);let t="";this.newPosRound.z<this.posRound.z?t+="forward":this.newPosRound.z>this.posRound.z&&(t+="reverse"),this.newPosRound.x>this.posRound.x?t+="right":this.newPosRound.x<this.posRound.x&&(t+="left"),this.auxl.player.layer.gridDirection=t,this.newPosRound.x===this.posRound.x&&this.newPosRound.z===this.posRound.z||(this.auxl.map.CheckMapTriggers(this.newPosRound)&&this.auxl.map.TriggerEnterHit(this.newPosRound),this.auxl.map.CheckActiveTriggers(this.newPosRound),this.auxl.map.WaitingToSpawn())}}else this.player.object3D.position.copy(this.positionNew)},directionXZY:function(t,e){this.velocity=e,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","UpForwardRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForwardRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ForwardRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpForwardLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForwardLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ForwardLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverseRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverseRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ReverseRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverseLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverseLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"ReverseLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpForward"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownForward"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"Forward"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity),this.positionNew.y=this.positionPlayer.y):"UpReverse"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownReverse"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y-this.velocity):"Reverse"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity),this.positionNew.y=this.positionPlayer.y):"UpRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownRight"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y-this.velocity):"Right"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y):"UpLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y+this.velocity):"DownLeft"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y-this.velocity):"Left"===t?("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z),this.positionNew.y=this.positionPlayer.y):"Up"===t?(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y+this.velocity):"Down"===t?(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y-this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z,this.positionNew.y=this.positionPlayer.y),this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.player.object3D.position.copy(this.positionNew)):this.player.object3D.position.copy(this.positionNew)},directionXY:function(t,e){this.velocity=e,this.directionVector=new THREE.Vector3,this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2||this.angle<0&&this.angle>-Math.PI/2?this.face="front":this.angle>Math.PI/2&&this.angle<Math.PI||this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="back":this.face="front","forwardRight"===t?("front"===this.face?this.positionNew.x=this.positionPlayer.x+this.velocity:this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y+this.velocity):"forwardLeft"===t?("front"===this.face?this.positionNew.x=this.positionPlayer.x-this.velocity:this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y+this.velocity):"reverseRight"===t?("front"===this.face?this.positionNew.x=this.positionPlayer.x+this.velocity:this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y-this.velocity):"reverseLeft"===t?("front"===this.face?this.positionNew.x=this.positionPlayer.x-this.velocity:this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y-this.velocity):"forward"===t?(this.positionNew.x=this.positionPlayer.x,this.positionNew.y=this.positionPlayer.y+this.velocity):"reverse"===t?(this.positionNew.x=this.positionPlayer.x,this.positionNew.y=this.positionPlayer.y-this.velocity):"right"===t?(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.y=this.positionPlayer.y):"left"===t&&(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.y=this.positionPlayer.y),this.positionNew.z=this.positionPlayer.z,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.roundHalf(this.positionNew.y),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.roundHalf(this.positionPlayer.y),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.player.object3D.position.copy(this.positionNew)):this.player.object3D.position.copy(this.positionNew)},directionXYZ:function(t,e){this.allow=!1,this.yDeadZone=.1,this.velocity=e,this.directionVector=new THREE.Vector3,this.cameraVector=new THREE.Vector3,this.camera.object3D.getWorldDirection(this.cameraVector),this.directionObject.object3D.getWorldDirection(this.directionVector),this.positionNew=new THREE.Vector3,this.positionPlayer.copy(this.player.object3D.position),this.angle=Math.atan2(this.directionVector.x,this.directionVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"forwardLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverseRight"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"reverseLeft"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z+this.velocity):"forward"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z-this.velocity):"reverse"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.sin(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.cos(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x,this.positionNew.z=this.positionPlayer.z+this.velocity):"right"===t?"frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x+this.velocity,this.positionNew.z=this.positionPlayer.z):"left"===t&&("frontLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.positionNew.x=this.positionPlayer.x+Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.positionNew.x=this.positionPlayer.x-Math.cos(this.angle)*this.velocity,this.positionNew.z=this.positionPlayer.z+Math.sin(this.angle)*this.velocity):(this.positionNew.x=this.positionPlayer.x-this.velocity,this.positionNew.z=this.positionPlayer.z)),this.cameraVector.y<this.yDeadZone?this.positionNew.y=this.positionPlayer.y+-1*this.cameraVector.y*this.velocity:this.cameraVector.y>-1*this.yDeadZone?this.positionNew.y=this.positionPlayer.y-this.cameraVector.y*this.velocity:this.positionNew.y=this.positionPlayer.y,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.round(this.positionNew.y),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionPlayer.x),this.posRound.y=this.round(this.positionPlayer.y),this.posRound.z=this.roundHalf(this.positionPlayer.z),this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?this.auxl.player.layer.standing?(this.newPosStandRound.copy(this.newPosRound),this.newPosStandRound.y+=1,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosStandRound,this.posRound)?this.allow=!0:this.allow=!1):this.allow=!0:this.allow=!1,this.allow||(this.newPosTemp.copy(this.newPosRound),this.newPosRound.y=this.posRound.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.y=this.positionPlayer.y,this.allow=!0):(this.newPosRound.x=this.posRound.x,this.newPosRound.y=this.newPosTemp.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)?(this.positionNew.x=this.positionPlayer.x,this.allow=!0):(this.newPosRound.z=this.posRound.z,this.newPosRound.x=this.newPosTemp.x,this.newPosRound.y=this.newPosTemp.y,this.auxl.map.CheckMapObstaclesDiagonal(this.newPosRound,this.posRound)&&(this.positionNew.z=this.positionPlayer.z,this.allow=!0)))),this.allow&&(this.player.object3D.position.copy(this.positionNew),this.auxl.player.layer.gridPos.copy(this.newPosRound),this.newPosRound.x===this.posRound.x&&this.newPosRound.z===this.posRound.z||(this.auxl.map.CheckMapTriggers(this.newPosRound)&&this.auxl.map.TriggerEnterHit(this.newPosRound),this.auxl.map.CheckActiveTriggers(this.newPosRound),this.auxl.map.WaitingToSpawn()))):this.player.object3D.position.copy(this.positionNew)},directionXYZWall:function(t,e){},directionAXY:function(t,e){},directionAXYZ:function(t,e){},rigXZ:function(t,e){this.velocity=e,this.positionNew=new THREE.Vector3,this.positionAvatar.copy(this.avatar.object3D.position),"forwardRight"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z-this.velocity):"forwardLeft"===t?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z-this.velocity):"reverseRight"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z+this.velocity):"reverseLeft"===t?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z+this.velocity):"forward"===t?(this.positionNew.x=this.positionAvatar.x,this.positionNew.z=this.positionAvatar.z-this.velocity):"reverse"===t?(this.positionNew.x=this.positionAvatar.x,this.positionNew.z=this.positionAvatar.z+this.velocity):"right"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.z=this.positionAvatar.z):"left"===t&&(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.z=this.positionAvatar.z),this.positionNew.y=this.positionAvatar.y,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.z=this.roundHalf(this.positionNew.z),this.posRound.x=this.roundHalf(this.positionAvatar.x),this.posRound.z=this.roundHalf(this.positionAvatar.z),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.avatar.object3D.position.copy(this.positionNew)):this.avatar.object3D.position.copy(this.positionNew)},rigXZY:function(t,e){},rigXY:function(t,e){this.velocity=e,this.positionNew=new THREE.Vector3,this.positionAvatar.copy(this.avatar.object3D.position),"forwardRight"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y+this.velocity):"forwardLeft"===t?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y+this.velocity):"reverseRight"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y-this.velocity):"reverseLeft"===t?(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y-this.velocity):"forward"===t?(this.positionNew.x=this.positionAvatar.x,this.positionNew.y=this.positionAvatar.y+this.velocity):"reverse"===t?(this.positionNew.x=this.positionAvatar.x,this.positionNew.y=this.positionAvatar.y-this.velocity):"right"===t?(this.positionNew.x=this.positionAvatar.x+this.velocity,this.positionNew.y=this.positionAvatar.y):"left"===t&&(this.positionNew.x=this.positionAvatar.x-this.velocity,this.positionNew.y=this.positionAvatar.y),this.positionNew.z=this.positionAvatar.z,this.auxl.collision?(this.newPosRound.x=this.roundHalf(this.positionNew.x),this.newPosRound.y=this.roundHalf(this.positionNew.y),this.posRound.x=this.roundHalf(this.positionAvatar.x),this.posRound.y=this.roundHalf(this.positionAvatar.y),this.auxl.map.CheckMapObstacles(this.newPosRound,this.posRound)&&this.avatar.object3D.position.copy(this.positionNew)):this.avatar.object3D.position.copy(this.positionNew)},rigXYZ:function(t,e){},rigXYZWall:function(t,e){},rigAXY:function(t,e){this.velocity=e/10,this.rotationNew=new THREE.Euler(0,0,0,"YXZ"),this.rotationAvatar.copy(this.avatarSphere.object3D.rotation),"forwardRight"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"forwardLeft"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y+this.velocity):"reverseRight"===t?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"reverseLeft"===t?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y+this.velocity):"forward"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.y=this.rotationAvatar.y):"reverse"===t?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.y=this.rotationAvatar.y):"right"===t?(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.y=this.rotationAvatar.y-this.velocity):"left"===t&&(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.y=this.rotationAvatar.y+this.velocity),this.rotationNew.z=this.rotationAvatar.z,this.avatarSphere.object3D.rotation.copy(this.rotationNew)},rigAXYZ:function(t,e){},userDirection:function(){if(this.userPos=this.player.getAttribute("position"),this.userRot=this.camera.getAttribute("rotation"),this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z<0?this.userTravel="northWest":this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southWest":this.userPreviousPos.x+this.userPos.x>0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southEast":(this.userPreviousPos.x+this.userPos.x>0&&(this.userPreviousPos.z,this.userPos.z),this.userTravel="northEast"),this.userPreviousPos=this.userPos,this.userRot.y>360){let t=this.userRot.y/360;this.userPov=360*Math.floor(t)-this.userRot.y,this.userPov*=-1}else if(this.userRot.y<-360){let t=this.userRot.y/360;this.userPov=360*Math.floor(t)-this.userRot.y,this.userPov*=-1}else this.userPov=this.userRot.y;this.userPov>0&&this.userPov<15||this.userPov>345&&this.userPov<360?this.userView="north":this.userPov>255&&this.userPov>285?this.userView="east":this.userPov>75&&this.userPov<105?this.userView="west":this.userPov>165&&this.userPov<195?this.userView="south":this.userPov<0&&this.userPov>-15||this.userPov<-345&&this.userPov>-360?this.userView="north":this.userPov<-255&&this.userPov>-285?this.userView="west":this.userPov<-75&&this.userPov>-105?this.userView="east":this.userPov<-165&&this.userPov>-195?this.userView="south":this.userPov>15&&this.userPov<75?this.userView="northWest":this.userPov>105&&this.userPov<165?this.userView="southWest":this.userPov>195&&this.userPov<255?this.userView="southEast":this.userPov>285&&this.userPov<345||this.userPov<-15&&this.userPov>-75?this.userView="northEast":this.userPov<-105&&this.userPov>-165?this.userView="southEast":this.userPov<-195&&this.userPov>-255?this.userView="southWest":this.userPov<-285&&this.userPov>-345?this.userView="northWest":this.userView="north","northWest"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=-1*(this.velocity+this.positionPlayer.z),this.positionTemp.z+=this.positionPlayer.z):"southWest"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=this.velocity+this.positionPlayer.z):"southEast"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=this.velocity+this.positionPlayer.z):"northEast"===this.userView||"north"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=-1*(this.velocity+this.positionPlayer.z)):"west"===this.userView?(this.positionTemp.x=-1*(this.velocity+this.positionPlayer.x),this.positionTemp.z=this.velocity+this.positionPlayer.z):"east"===this.userView||"south"===this.userView?(this.positionTemp.x=this.velocity+this.positionPlayer.x,this.positionTemp.z=this.velocity+this.positionPlayer.z):(this.positionTemp.x=0,this.positionTemp.z=0),this.positionNew=new THREE.Vector3(this.positionTemp.x,0,this.positionTemp.z)}}),AFRAME.registerComponent("gimbal",{dependencies:["auxl"],schema:{uiid:{type:"string",default:"ui"},courserid:{type:"string",default:"mouseCursor"},movetype:{type:"string",default:"vr"},pov:{type:"string",default:"1st"},style:{type:"string",default:"free"},axis:{type:"string",default:"rotXZ"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.freeStepThrottled=AFRAME.utils.throttle(this.freeStep,30,this),this.gridStepThrottled=AFRAME.utils.throttle(this.gridStep,400,this),this.mouseCursor=document.getElementById(this.data.courserid),this.data.uuid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,this.pov=this.data.pov,this.style=this.data.style,this.axis=this.data.axis,this.camera=document.getElementById("camera"),this.player=document.getElementById("playerRig"),this.avatar,this.avatarSphere,this.ui=document.getElementById("beltUIParent"),this.rotationPlayer=new THREE.Vector3,this.rotationAvatar=new THREE.Vector3,this.rotationNew=new THREE.Vector3,this.rotationTemp=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.vector,this.angle,this.posRound=new THREE.Vector3,this.newPosRound=new THREE.Vector3,this.mapX,this.mapZ,this.elPosVec3New=new THREE.Vector3,this.velocity,this.userPreviousPos=this.player.getAttribute("rotation"),this.userPos,this.userRot,this.userPov,this.userTravel,this.userView,this.newX,this.newZ,this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveUp=!1,this.moveDown=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault,this.moveSpeedSlow,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridUpTimeout,this.gridDownTimeout,this.gridMove=!1,this.gridSpeed=400,setTimeout((()=>{"3rd"===this.pov&&setTimeout((()=>{this.avatar=document.getElementById("avatarRig"),this.avatarSphere=document.getElementById("avatarSphere")}),500)}),1e3)},roundHalf:function(t){return Math.round(2*t)/2},movingForward:function(){clearTimeout(this.gridForwardTimeout),this.moveTo||(this.moveTo=!0)},cancelForward:function(){this.moveTo&&("grid"===this.style?this.gridMove?this.moveTo=!1:this.gridForwardTimeout=setTimeout((()=>{this.moveTo=!1}),this.gridSpeed/1.25):this.moveTo=!1)},movingReverse:function(){clearTimeout(this.gridReverseTimeout),this.moveBack||(this.moveBack=!0)},cancelReverse:function(){this.moveBack&&("grid"===this.style?this.gridMove?this.moveBack=!1:this.gridReverseTimeout=setTimeout((()=>{this.moveBack=!1}),this.gridSpeed/1.25):this.moveBack=!1)},movingLeft:function(){clearTimeout(this.gridLeftTimeout),this.moveLeft||(this.moveLeft=!0)},cancelLeft:function(){this.moveLeft&&("grid"===this.style?this.gridMove?this.moveLeft=!1:this.gridLeftTimeout=setTimeout((()=>{this.moveLeft=!1}),this.gridSpeed/1.25):this.moveLeft=!1)},movingRight:function(){clearTimeout(this.gridRightTimeout),this.moveRight||(this.moveRight=!0)},cancelRight:function(){this.moveRight&&("grid"===this.style?this.gridMove?this.moveRight=!1:this.gridRightTimeout=setTimeout((()=>{this.moveRight=!1}),this.gridSpeed/1.25):this.moveRight=!1)},movingUp:function(){clearTimeout(this.gridUpTimeout),this.moveUp||(this.moveUp=!0)},cancelUp:function(){this.moveUp&&("grid"===this.style?this.gridMove?this.moveUp=!1:this.gridUpTimeout=setTimeout((()=>{this.moveUp=!1}),this.gridSpeed/1.25):this.moveUp=!1)},movingDown:function(){clearTimeout(this.gridDownTimeout),this.moveDown||(this.moveDown=!0)},cancelDown:function(){this.moveDown&&("grid"===this.style?this.gridMove?this.moveDown=!1:this.gridDownTimeout=setTimeout((()=>{this.moveDown=!1}),this.gridSpeed/1.25):this.moveDown=!1)},clearMovement:function(){this.cancelForward(),this.cancelReverse(),this.cancelLeft(),this.cancelRight(),this.cancelUp(),this.cancelDown()},clearGridMovement:function(){this.moveTo=!1,this.moveBack=!1,this.moveLeft=!1,this.moveRight=!1,clearTimeout(this.gridForwardTimeout),clearTimeout(this.gridReverseTimeout),clearTimeout(this.gridLeftTimeout),clearTimeout(this.gridRightTimeout)},toggleSpeed:function(){this.brakeReady&&(this.brakeToggle?(this.brakeToggle=!1,this.brakeReady=!1,this.moveBrake=!0,this.gridSpeed=400,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)):(this.brakeToggle=!0,this.brakeReady=!1,this.moveBrake=!1,this.gridSpeed=200,this.everyStepThrottled=AFRAME.utils.throttle(this.everyStep,this.gridSpeed,this)),this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),250))},brakeReadBufferLong:function(){this.brakeReset=setTimeout((()=>{this.brakeReady=!0,clearTimeout(this.brakeReset)}),2250)},update:function(){this.moveTo=!1,this.moveBack=!1,this.moveRight=!1,this.moveLeft=!1,this.moveBrake=!0,this.brakeReady=!0,this.brakeToggle=!1,this.brakeReset,this.moveSpeedDefault=1,this.moveSpeedSlow=.5,this.gridForwardTimeout,this.gridReverseTimeout,this.gridLeftTimeout,this.gridRightTimeout,this.gridMove=!1,this.gridSpeed=500,this.mouseCursor=document.getElementById(this.data.courserid),this.data.uiid&&(this.ui=document.getElementById(this.data.uiid)),this.movetype=this.data.movetype,"desktop"===this.movetype||"mobile"===this.movetype||"vr"===this.movetype||this.movetype},remove:function(){"desktop"===this.movetype||"mobile"===this.movetype||"vr"===this.movetype||this.movetype},tick:function(t,e){"free"===this.style?this.freeStepThrottled():"grid"===this.style&&this.gridStepThrottled()},freeStep:function(t,e){this.moveBrake?this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedSlow):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedSlow):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedSlow):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedSlow):this.moveTo?this.move("forward",this.moveSpeedSlow):this.moveBack?this.move("reverse",this.moveSpeedSlow):this.moveRight?this.move("right",this.moveSpeedSlow):this.moveLeft&&this.move("left",this.moveSpeedSlow):this.moveTo&&this.moveRight?this.move("forwardRight",this.moveSpeedDefault):this.moveTo&&this.moveLeft?this.move("forwardLeft",this.moveSpeedDefault):this.moveBack&&this.moveRight?this.move("reverseRight",this.moveSpeedDefault):this.moveBack&&this.moveLeft?this.move("reverseLeft",this.moveSpeedDefault):this.moveTo?this.move("forward",this.moveSpeedDefault):this.moveBack?this.move("reverse",this.moveSpeedDefault):this.moveRight?this.move("right",this.moveSpeedDefault):this.moveLeft&&this.move("left",this.moveSpeedDefault)},freeStepPlus:function(t,e){this.movement="",this.moveUp&&this.moveDown||(this.moveUp?this.movement+="Up":this.moveDown&&(this.movement+="Down")),this.moveTo&&this.moveBack||(this.moveTo?this.movement+="Forward":this.moveBack&&(this.movement+="Reverse")),this.moveRight&&this.moveLeft||(this.moveRight?this.movement+="Right":this.moveLeft&&(this.movement+="Left")),console.log(this.movement),this.moveBrake?this.moveFree(this.movement,this.moveSpeedSlow):this.moveFree(this.movement,this.moveSpeedDefault)},gridStep:function(t,e){this.moveTo||this.moveBack||this.moveRight||this.moveLeft?this.gridMove||(this.gridMove=!0):this.gridMove=!1,this.moveTo&&this.moveRight?this.move("forwardRight",.5):this.moveTo&&this.moveLeft?this.move("forwardLeft",.5):this.moveBack&&this.moveRight?this.move("reverseRight",.5):this.moveBack&&this.moveLeft?this.move("reverseLeft",.5):this.moveTo?this.move("forward",.5):this.moveBack?this.move("reverse",.5):this.moveRight?this.move("right",.5):this.moveLeft&&this.move("left",.5)},distance:function(t,e,i,o){return Math.sqrt(Math.pow(i-t,2)+1*Math.pow(o-e,2))},uiSync:function(){this.elPosVec3New.copy(this.el.object3D.rotation),this.ui.object3D.rotation.copy(this.elPosVec3New)},move:function(t,e){"1st"===this.pov?"rotXZ"===this.axis&&this.directionXZ(t,e):"3rd"===this.pov&&"rotXZ"===this.axis&&this.rigXZ(t,e)},directionXZ:function(t,e){this.velocity=e,this.cameraVector=new THREE.Vector3,this.camera.object3D.getWorldDirection(this.cameraVector),this.rotationNew=new THREE.Vector3,this.rotationPlayer=this.player.getAttribute("rotation"),this.angle=Math.atan2(this.cameraVector.x,this.cameraVector.z),this.face,this.angle>0&&this.angle<Math.PI/2?this.face="frontLeft":this.angle<0&&this.angle>-Math.PI/2?this.face="frontRight":this.angle>Math.PI/2&&this.angle<Math.PI?this.face="backLeft":this.angle<-Math.PI/2&&this.angle>-Math.PI?this.face="backRight":this.face="level","forwardRight"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x+this.velocity,this.rotationNew.z=this.rotationPlayer.z-this.velocity):"forwardLeft"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x-this.velocity,this.rotationNew.z=this.rotationPlayer.z-this.velocity):"reverseRight"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x+this.velocity,this.rotationNew.z=this.rotationPlayer.z+this.velocity):"reverseLeft"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity+Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x-this.velocity,this.rotationNew.z=this.rotationPlayer.z+this.velocity):"forward"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x,this.rotationNew.z=this.rotationPlayer.z-this.velocity):"reverse"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.cos(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.sin(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.cos(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x,this.rotationNew.z=this.rotationPlayer.z+this.velocity):"right"===t?"frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x+this.velocity,this.rotationNew.z=this.rotationPlayer.z):"left"===t&&("frontLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.sin(this.angle)*this.velocity):"frontRight"===this.face?(this.angle+=Math.PI,this.rotationNew.x=this.rotationPlayer.x+Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z-Math.sin(this.angle)*this.velocity):"backLeft"===this.face?(this.rotationNew.x=this.rotationPlayer.x-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.sin(this.angle)*this.velocity):"backRight"===this.face?(this.angle+=2*Math.PI,this.rotationNew.x=this.rotationPlayer.x-Math.cos(this.angle)*this.velocity,this.rotationNew.z=this.rotationPlayer.z+Math.sin(this.angle)*this.velocity):(this.rotationNew.x=this.rotationPlayer.x-this.velocity,this.rotationNew.z=this.rotationPlayer.z)),this.rotationNew.y=this.rotationPlayer.y,this.player.setAttribute("rotation",this.rotationNew)},rigXZ:function(t,e){this.velocity=e,this.rotationNew=new THREE.Vector3,this.rotationAvatar=this.avatar.getAttribute("rotation"),"forwardRight"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.z=this.rotationAvatar.z-this.velocity):"forwardLeft"===t?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.z=this.rotationAvatar.z-this.velocity):"reverseRight"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.z=this.rotationAvatar.z+this.velocity):"reverseLeft"===t?(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.z=this.rotationAvatar.z+this.velocity):"forward"===t?(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.z=this.rotationAvatar.z-this.velocity):"reverse"===t?(this.rotationNew.x=this.rotationAvatar.x,this.rotationNew.z=this.rotationAvatar.z+this.velocity):"right"===t?(this.rotationNew.x=this.rotationAvatar.x+this.velocity,this.rotationNew.z=this.rotationAvatar.z):"left"===t&&(this.rotationNew.x=this.rotationAvatar.x-this.velocity,this.rotationNew.z=this.rotationAvatar.z),this.rotationNew.y=this.rotationAvatar.y,this.avatar.setAttribute("rotation",this.rotationNew)},userDirection:function(){if(this.userPos=this.player.getAttribute("rotation"),this.userRot=this.camera.getAttribute("rotation"),this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z<0?this.userTravel="northWest":this.userPreviousPos.x+this.userPos.x<0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southWest":this.userPreviousPos.x+this.userPos.x>0&&this.userPreviousPos.z+this.userPos.z>0?this.userTravel="southEast":(this.userPreviousPos.x+this.userPos.x>0&&(this.userPreviousPos.z,this.userPos.z),this.userTravel="northEast"),this.userPreviousPos=this.userPos,this.userRot.y>360){let t=this.userRot.y/360;this.userPov=360*Math.floor(t)-this.userRot.y,this.userPov*=-1}else if(this.userRot.y<-360){let t=this.userRot.y/360;this.userPov=360*Math.floor(t)-this.userRot.y,this.userPov*=-1}else this.userPov=this.userRot.y;this.userPov>0&&this.userPov<15||this.userPov>345&&this.userPov<360?this.userView="north":this.userPov>255&&this.userPov>285?this.userView="east":this.userPov>75&&this.userPov<105?this.userView="west":this.userPov>165&&this.userPov<195?this.userView="south":this.userPov<0&&this.userPov>-15||this.userPov<-345&&this.userPov>-360?this.userView="north":this.userPov<-255&&this.userPov>-285?this.userView="west":this.userPov<-75&&this.userPov>-105?this.userView="east":this.userPov<-165&&this.userPov>-195?this.userView="south":this.userPov>15&&this.userPov<75?this.userView="northWest":this.userPov>105&&this.userPov<165?this.userView="southWest":this.userPov>195&&this.userPov<255?this.userView="southEast":this.userPov>285&&this.userPov<345||this.userPov<-15&&this.userPov>-75?this.userView="northEast":this.userPov<-105&&this.userPov>-165?this.userView="southEast":this.userPov<-195&&this.userPov>-255?this.userView="southWest":this.userPov<-285&&this.userPov>-345?this.userView="northWest":this.userView="north","northWest"===this.userView?(this.rotationTemp.x=-1*(this.velocity+this.rotationPlayer.x),this.rotationTemp.z=-1*(this.velocity+this.rotationPlayer.z),this.rotationTemp.z+=this.rotationPlayer.z):"southWest"===this.userView?(this.rotationTemp.x=-1*(this.velocity+this.rotationPlayer.x),this.rotationTemp.z=this.velocity+this.rotationPlayer.z):"southEast"===this.userView?(this.rotationTemp.x=this.velocity+this.rotationPlayer.x,this.rotationTemp.z=this.velocity+this.rotationPlayer.z):"northEast"===this.userView||"north"===this.userView?(this.rotationTemp.x=this.velocity+this.rotationPlayer.x,this.rotationTemp.z=-1*(this.velocity+this.rotationPlayer.z)):"west"===this.userView?(this.rotationTemp.x=-1*(this.velocity+this.rotationPlayer.x),this.rotationTemp.z=this.velocity+this.rotationPlayer.z):"east"===this.userView||"south"===this.userView?(this.rotationTemp.x=this.velocity+this.rotationPlayer.x,this.rotationTemp.z=this.velocity+this.rotationPlayer.z):(this.rotationTemp.x=0,this.rotationTemp.z=0),this.rotationNew=new THREE.Vector3(this.rotationTemp.x,0,this.rotationTemp.z)}}),AFRAME.registerComponent("teleportation",{dependencies:["auxl"],init:function(){this.el.classList.contains("teleport")?this.el.parentNode.setAttribute("active","false"):this.el.classList.contains("cancel")&&(this.el.classList.toggle("clickable",!1),this.el.parentNode.setAttribute("active","false"))},resetTeleCircles:function(){this.allTeleportors=document.querySelectorAll(".teleporter");for(let t=0;t<this.allTeleportors.length;t++)"true"===this.allTeleportors[t].parentNode.getAttribute("active")&&(this.allTeleportors[t].emit("resetInstant",{}),this.allTeleportors[t].nextSibling.emit("resetInstant",{}))},resetInstantEvent:function(){this.classList.contains("teleport")?this.parentNode.setAttribute("active","false"):this.classList.contains("cancel")&&(this.classList.toggle("clickable",!1),this.parentNode.setAttribute("active","false"))},resetEvent:function(){this.classList.contains("teleport")?this.parentNode.setAttribute("active","false"):this.classList.contains("cancel")&&(this.classList.toggle("clickable",!1),this.parentNode.setAttribute("active","false"))},clickToTeleport:function(){let t,e=this,i=document.getElementById("playerRig"),o=document.getElementById("camera"),a=document.querySelector("a-scene").systems.auxl,n=i.getAttribute("position"),s=a.player.layer.transition.teleport,r=new THREE.Vector3,l=this.parentNode.getAttribute("position"),c=document.querySelectorAll(".teleporter");function h(t,e,i){t.emit("reset",{}),t.nextSibling.emit("reset",{}),e.copy(i),e.y=0}function p(){for(let t=0;t<c.length;t++)"true"===c[t].parentNode.getAttribute("active")&&(c[t].emit("resetInstant",{}),c[t].nextSibling.emit("resetInstant",{}))}if("false"===e.parentNode.getAttribute("active"))e.nextSibling.classList.toggle("clickable",!0),e.nextSibling.emit("click1",{}),e.userPov=o.getAttribute("rotation"),e.rotationParams={property:"object3D.rotation.y",to:e.userPov.y,dur:500,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"},e.parentNode.setAttribute("animation__rotateToUser",e.rotationParams),e.parentNode.setAttribute("active","true");else if(e.classList.contains("teleport"))if("instant"===s)p(),h(e,r,l),t=setTimeout((function(){i.object3D.position.copy(r),clearTimeout(t)}),250);else if("fade"===s)a.player.PlayerTeleportAnim(),h(e,r,l),t=setTimeout((function(){p(),i.object3D.position.copy(r),clearTimeout(t)}),600);else if("locomotion"===s){let t={property:"position",from:{x:n.x,y:0,z:n.z},to:{x:l.x,y:0,z:l.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",t),e.nextSibling.emit("reset",{}),p()}else("sphere"===s||"blink"===s)&&(a.player.PlayerTeleportAnim(),h(e,r,l),t=setTimeout((function(){p(),i.object3D.position.copy(r),clearTimeout(t)}),600));else e.classList.contains("cancel")&&e.emit("reset",{})},update:function(){this.el.addEventListener("reset",this.resetEvent),this.el.addEventListener("resetInstant",this.resetInstantEvent),this.el.addEventListener("click",this.clickToTeleport)},remove:function(){this.el.removeEventListener("reset",this.resetEvent),this.el.removeEventListener("resetInstant",this.resetInstantEvent),this.el.removeEventListener("click",this.clickToTeleport)}}),AFRAME.registerComponent("raycast-teleportation-select",{dependencies:["auxl"],init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.hoverSelectData={data:"hoverSelectData",id:"hoverSelect",text:{value:"Teleport Here",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.5,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#3eb58c",opacity:1,metalness:.6,roughness:.4,emissive:"#3eb58c",emissiveIntensity:.2,side:"front"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{stare:{twist:!0}}},this.hoverSelect=this.auxl.Core(this.hoverSelectData),this.spawned=!1},spawnSelect:function(t){let e=t.detail.intersection.point;this.spawned&&(this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore()),this.hoverSelect.core.position.x=e.x,this.hoverSelect.core.position.y=1,this.hoverSelect.core.position.z=e.z,this.hoverSelect.SpawnCore(),this.clickToTeleportEvent=t=>{this.clickToTeleport(t)},this.hoverSelect.GetEl().addEventListener("click",this.clickToTeleportEvent),this.spawned=!0},clickToTeleport:function(t){let e,i=document.getElementById("playerRig"),o=(document.getElementById("camera"),document.querySelector("a-scene").systems.auxl),a=i.getAttribute("position"),n=o.player.layer.transition.teleport,s=new THREE.Vector3,r=t.detail.intersection.point;function l(t,e){t.copy(e),t.y=0}if(document.querySelectorAll(".teleporter"),this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore(),this.spawned=!1,"instant"===n)l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),250);else if("fade"===n)o.player.PlayerTeleportAnim(),l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),600);else if("locomotion"===n){let t={property:"position",from:{x:a.x,y:0,z:a.z},to:{x:r.x,y:0,z:r.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",t)}else("sphere"===n||"blink"===n)&&(o.player.PlayerTeleportAnim(),l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),600))},update:function(){this.spawnSelectEvent=t=>{this.spawnSelect(t)},this.el.addEventListener("click",this.spawnSelectEvent)},remove:function(){this.spawned&&(this.hoverSelect.GetEl().removeEventListener("click",this.clickToTeleportEvent),this.hoverSelect.DespawnCore()),this.el.removeEventListener("click",this.spawnSelectEvent)}}),AFRAME.registerComponent("raycast-teleportation",{init:function(){},clickToTeleport:function(t){let e,i=document.getElementById("playerRig"),o=(document.getElementById("camera"),document.querySelector("a-scene").systems.auxl),a=i.getAttribute("position"),n=o.player.layer.transition.teleport,s=new THREE.Vector3,r=t.detail.intersection.point;function l(t,e){t.copy(e),t.y=0}if(document.querySelectorAll(".teleporter"),"instant"===n)l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),250);else if("fade"===n)o.player.PlayerTeleportAnim(),l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),600);else if("locomotion"===n){let t={property:"position",from:{x:a.x,y:0,z:a.z},to:{x:r.x,y:0,z:r.z},dur:1e3,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:"true",enabled:"true"};i.setAttribute("animation__locomotion",t)}else("sphere"===n||"blink"===n)&&(o.player.PlayerTeleportAnim(),l(s,r),e=setTimeout((function(){i.object3D.position.copy(s),clearTimeout(e)}),600))},update:function(){this.raycastTeleport=t=>{this.clickToTeleport(t)},this.el.addEventListener("click",this.raycastTeleport)},remove:function(){this.el.removeEventListener("click",this.raycastTeleport)}}),AFRAME.registerComponent("clickfunc",{dependencies:["auxl"],schema:{clickObj:{type:"string",default:"auxlObj"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(t){this.auxl[this.data.clickObj].Click(t.target)}}}),AFRAME.registerComponent("clickrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{click:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("clickrunfunc",{dependencies:["auxl"],multiple:!0,schema:{method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(t){"null"===this.data.params?this.auxl[this.data.method]():"target"===this.data.params?this.auxl[this.data.method](t.target):this.auxl[this.data.method](this.data.params)}}}),AFRAME.registerComponent("fusingrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{fusing:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mousedownrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mousedown:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseenterrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseenter:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseleaverun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseleave:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("mouseuprun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},events:{mouseup:function(t){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():"target"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():"target"===this.data.params?this.domEnt.components[this.data.component][this.data.method](t.target):this.domEnt.components[this.data.component][this.data.method](this.data.params))}}}),AFRAME.registerComponent("menurun",{dependencies:["auxl"],schema:{cursorObj:{type:"string",default:"auxlObj"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl},events:{click:function(t){this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method](t.target):this.auxl[this.data.cursorObj][this.data.method](this.data.params))}}}),AFRAME.registerComponent("hoverrun",{dependencies:["auxl"],schema:{attached:{type:"string",default:"none"},menu:{type:"string",default:"menuName"},action:{type:"string",default:"actionName"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.attached=this.data.attached,this.menu=this.data.menu,this.action=this.data.action},events:{mouseenter:function(t){"none"!==this.attached?this.auxl[this.attached][this.menu].hoverMenu.active=this.action:this.auxl[this.menu].hoverMenu.active=this.action},mouseleave:function(t){"none"!==this.attached?this.auxl[this.attached][this.menu].hoverMenu.active=!1:this.auxl[this.menu].hoverMenu.active=!1}}}),AFRAME.registerComponent("onspawnrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():this.domEnt.components[this.data.component][this.data.method](this.data.params))}}),AFRAME.registerComponent("onspawnfunc",{dependencies:["auxl"],multiple:!0,schema:{auxlFunc:{type:"string",default:"auxlFunc"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,"null"===this.data.params?this.auxl[this.data.auxlFunc]():this.auxl[this.data.auxlFunc](this.data.params)}}),AFRAME.registerComponent("ondespawnrun",{dependencies:["auxl"],multiple:!0,schema:{cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},remove:function(){"null"===this.data.component?this.auxl[this.data.cursorObj][this.data.method]&&("null"===this.data.params?this.auxl[this.data.cursorObj][this.data.method]():this.auxl[this.data.cursorObj][this.data.method](this.data.params)):document.getElementById(this.data.cursorObj)&&(this.domEnt=document.getElementById(this.data.cursorObj),"null"===this.data.params?this.domEnt.components[this.data.component][this.data.method]():this.domEnt.components[this.data.component][this.data.method](this.data.params))}}),AFRAME.registerComponent("oneventrun",{dependencies:["auxl"],multiple:!0,schema:{event:{type:"string",default:"eventName"},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"},once:{type:"boolean",default:!1}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.event=this.data.event,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.once=this.data.once,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.el.addEventListener(this.event,this.run,{once:this.once})},remove:function(){this.el.removeEventListener(this.event,this.run)}}),AFRAME.registerComponent("ondelayrun",{dependencies:["auxl"],multiple:!0,schema:{delay:{type:"number",default:1e3},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.delay=this.data.delay,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.timeout=setTimeout((()=>{this.run(),clearTimeout(this.timeout)}),this.delay)},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("onintervalrun",{dependencies:["auxl"],multiple:!0,schema:{interval:{type:"number",default:1e3},loop:{type:"number",default:0},end:{type:"string",default:"null"},cursorObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"Click"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt},update:function(){this.interval=this.data.interval,this.loop=this.data.loop,0===this.loop&&(this.loop=!1),this.end=this.data.end,this.checkEnd=!1,"null"===this.end||(this.checkEnd=!0),this.running=!0,this.cursorObj=this.data.cursorObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params,this.run=()=>{"null"===this.component?this.auxl[this.cursorObj][this.method]&&("null"===this.params?this.auxl[this.cursorObj][this.method]():this.auxl[this.cursorObj][this.method](this.params)):document.getElementById(this.cursorObj)&&(this.domEnt=document.getElementById(this.cursorObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params))},this.repeat=setInterval((()=>{this.checkEnd&&!0===this.auxl[this.cursorObj].GetFlag(this.end)&&(this.running=!1,clearInterval(this.repeat)),this.running&&this.run(),this.loop&&(this.loop--,this.loop<=0&&(this.running=!1,clearInterval(this.repeat)))}),this.interval)},remove:function(){clearInterval(this.repeat)}}),AFRAME.registerComponent("sync-pos",{dependencies:["auxl"],schema:{idname:{type:"string",default:"ui"},position:{type:"vec3"}},init:function(){this.attachee=document.getElementById(this.data.idname),this.offset=new THREE.Vector3,this.data.position?this.offset.copy(this.data.position):this.offset.copy(this.attachee.object3D.position),this.newPosVec3=new THREE.Vector3},attached:function(){this.newPosVec3.copy(this.el.object3D.position),this.newPosVec3.x+=this.offset.x,this.newPosVec3.y+=this.offset.y,this.newPosVec3.z+=this.offset.z,this.attachee.object3D.position.copy(this.newPosVec3)},tick:function(t,e){this.attached()}}),AFRAME.registerComponent("look-at-xyz",{dependencies:["auxl"],schema:{buffer:{type:"number",default:0},drag:{type:"number",default:0},match:{type:"string",default:"camera"},x:{type:"boolean",default:!1},y:{type:"boolean",default:!1},z:{type:"boolean",default:!1}},init:function(){},update:function(){this.rotation=new THREE.Euler,this.rotation.copy(this.el.object3D.rotation),this.matchView=document.getElementById(this.data.match),this.matchRotation=new THREE.Euler,this.lookAtXYZThrottled=AFRAME.utils.throttle(this.lookAtXYZ,30,this)},lookAtXYZ:function(){this.matchRotation.copy(this.matchView.object3D.rotation),this.data.x&&Math.abs(this.matchRotation.x-this.rotation.x)>=this.data.buffer&&(this.rotation.x=this.matchRotation.x),this.data.y&&Math.abs(this.matchRotation.y-this.rotation.y)>=this.data.buffer&&(this.data.drag>0?this.matchRotation.y>this.rotation.y?this.rotation.y+=this.data.drag:this.rotation.y-=this.data.drag:this.rotation.y=this.matchRotation.y),this.data.z&&Math.abs(this.matchRotation.z-this.rotation.z)>=this.data.buffer&&(this.rotation.z=this.matchRotation.z),this.el.object3D.rotation.copy(this.rotation)},tick:function(t,e){this.lookAtXYZThrottled()}}),AFRAME.registerComponent("stare",{dependencies:["auxl"],schema:{id:{type:"string",default:"playerRig"},twist:{type:"boolean",default:!1}},init:function(){},update:function(){this.idView=document.getElementById(this.data.id),this.idPosition=new THREE.Vector3,this.stareThrottled=AFRAME.utils.throttle(this.stare,30,this)},stare:function(){this.idPosition.copy(this.idView.object3D.position),"playerRig"===this.data.id&&(this.idPosition.y+=document.getElementById("camera").object3D.position.y),this.data.twist&&(this.idPosition.y=this.el.object3D.position.y),this.el.object3D.lookAt(this.idPosition)},tick:function(t,e){this.stareThrottled()}}),AFRAME.registerComponent("hovertext",{dependencies:["auxl"],schema:{value:{type:"string",default:"TEXT"},hover:{type:"string",default:"front"},offset:{type:"number",default:1},twist:{type:"bool",default:!0},size:{type:"number",default:20}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.value=this.data.value,this.hover=this.data.hover,this.offset=this.data.offset,this.twist=this.data.twist,this.size=this.data.size,this.hoverSpawned=!1,this.position=new THREE.Vector3(0,0,0),"top"===this.hover?this.position=new THREE.Vector3(0,this.offset,0):"front"===this.hover&&(this.position=new THREE.Vector3(0,0,this.offset)),this.hoverTextParentData={data:"hoverTextParentData",id:"hoverTextParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:{stare:{id:"playerRig",twist:this.twist}}},this.hoverTextParent=this.auxl.Core(this.hoverTextParentData),this.hoverTextData={data:"hoverTextData",id:"hoverText",text:{value:this.value,wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",width:2},position:this.position,rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},this.hoverText=this.auxl.Core(this.hoverTextData),this.hoverTextAllData={parent:{core:this.hoverTextParent},child0:{core:this.hoverText}},this.hoverTextAll=this.auxl.Layer("hoverTextAll",this.hoverTextAllData)},events:{mouseenter:function(t){this.hoverSpawned||(this.hoverSpawned=!0,this.hoverTextAll.SpawnLayer(this.el))},mouseleave:function(t){this.hoverSpawned&&(this.hoverTextAll.DespawnLayer(),this.hoverSpawned=!1)}},update:function(){},remove:function(){this.hoverSpawned||(this.hoverTextAll.DespawnLayer(),this.hoverSpawned=!1)}}),AFRAME.registerComponent("gltfmat",{dependencies:["auxl"],schema:{colors:{type:"array",default:[!1]},emissive:{type:"array",default:[!1]},textures:{type:"array",default:[!1]},repeats:{type:"array",default:[!1]},random:{type:"boolean",default:!1}},init:function(){const t=document.querySelector("a-scene").systems.auxl;this.meshName=!1,this.current=0,this.materials=[],this.data.colors.forEach((e=>{e?(this.materials[this.current]="random"===e?new THREE.MeshStandardMaterial({color:t.colorTheoryGen().base}):new THREE.MeshStandardMaterial({color:e}),this.data.emissive[this.current]&&(this.materials[this.current].emissive=this.materials[this.current].color,this.materials[this.current].emissiveIntensity=this.data.emissive[this.current]),this.data.textures[this.current]&&(this.materials[this.current].texture=(new THREE.TextureLoader).load(this.data.textures[this.current]),this.data.repeats[this.current]&&"false"!==this.data.repeats[this.current]&&(this.materials[this.current].texture.wrapS=THREE.RepeatWrapping,this.materials[this.current].texture.wrapT=THREE.RepeatWrapping,this.materials[this.current].texture.repeat.set(this.data.repeats[this.current])))):this.materials[this.current]=!1,this.current++})),this.current=-2,this.el.addEventListener("model-loaded",(()=>{this.el.getObject3D("mesh").traverse((e=>{this.current<0||(this.data.random?e.material=new THREE.MeshStandardMaterial({color:t.colorTheoryGen().base}):this.materials[this.current]&&(e.material=this.materials[this.current])),this.current++}))}))}}),AFRAME.registerComponent("modify-materials",{dependencies:["auxl"],init:function(){document.querySelector("a-scene").systems.auxl,this.el.addEventListener("model-loaded",(()=>{const t=this.el.getObject3D("mesh"),e=(new THREE.MeshBasicMaterial({color:16777215}),(new THREE.TextureLoader).load("./assets/img/gradient/threeTone.jpg"));e.minFilter=THREE.NearestFilter,e.magFilter=THREE.NearestFilter;const i=(new THREE.TextureLoader).load("./assets/img/gradient/fourTone.jpg");i.minFilter=THREE.NearestFilter,i.magFilter=THREE.NearestFilter;const o=(new THREE.TextureLoader).load("./assets/img/gradient/fiveTone.jpg");o.minFilter=THREE.NearestFilter,o.magFilter=THREE.NearestFilter,new THREE.DataTexture(2,1,2,3).needsUpdate=!0;const a=new THREE.MeshToonMaterial({color:"blue",gradientMap:o});t.traverse((t=>{-1!==t.name.indexOf("Mesh_crop_melon")&&(t.material=a)}))}))}}),AFRAME.registerComponent("scroll",{dependencies:["auxl","raycaster"],schema:{type:{type:"string",default:"plane"},axis:{type:"string",default:"horizontal"},parent:{type:"string",default:"auxlObj"},length:{type:"number",default:1},options:{type:"number",default:5},elements:{type:"array",default:[]}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.scrollee=document.getElementById(this.data.parent),this.domEnt,this.elements=[],this.data.elements.forEach((t=>this.elements.push(document.getElementById(t)))),this.scrollMap=new Map,this.scrollMap.set(4,this.elements[7]),this.scrollMap.set(3,this.elements[6]),this.scrollMap.set(2,this.elements[5]),this.scrollMap.set(1,this.elements[4]),this.scrollMap.set(0,this.elements[3]),this.scrollMap.set(-1,this.elements[2]),this.scrollMap.set(-2,this.elements[1]),this.scrollMap.set(-3,this.elements[0]),this.scrollThrottled=AFRAME.utils.throttle(this.scroll,50,this),this.mouse=document.querySelector("#mouseController"),this.mouseRay=this.mouse.components.raycaster,this.intersection,this.previous=new THREE.Vector3(0,0,0),this.hold=!1,this.distance=0,this.compass=!1,this.direction=!1,this.location=0,this.prevPos=0,this.pos=0,this.size=this.data.length/this.data.options,this.opacInit=!0,this.opacityPlus=0,this.plusFadeEl=!1,this.opacityMinus=0,this.minusFadeEl=!1,this.extraEl=!1,this.el.addEventListener("mousedown",(()=>{this.hold=!0,this.previous.copy(this.mouseRay.getIntersection(this.el).point)})),this.el.addEventListener("mouseup",(()=>{this.hold=!1,this.opacInit=!0})),this.el.addEventListener("mouseleave",(()=>{this.hold=!1,this.opacInit=!0})),this.el.addEventListener("raycaster-intersected",(function(t){}))},axisDirection:function(t,e){let i,o=[];return"vertical"===this.data.axis?(i="y",o=["down","up"]):"horizontal"===this.data.axis&&(i="x",o=["left","right"]),t[i]<e[i]?{axis:i,dir:o[0]}:{axis:i,dir:o[1]}},twoDecimal:function(t){return Math.round(100*t)/100},distanceTo:function(t,e){return Math.abs(Math.abs(t)-Math.abs(e))},getMapEl:function(t,e){for(;i=e,void 0===t.get(i);)e>0?e-=this.elements.length:e<0&&(e+=this.elements.length);var i;return t.get(e)},scroll:function(){if(this.hold)if(this.intersection=this.mouseRay.getIntersection(this.el),null===this.intersection||void 0===this.intersection);else if(this.intersection.point.equals(this.previous));else{if(this.compass=this.axisDirection(this.previous,this.intersection.point),this.distance=this.distanceTo(this.previous[this.compass.axis],this.intersection.point[this.compass.axis]),this.pos=this.scrollee.object3D.position[this.compass.axis],"plane"===this.data.type){let t,e;"left"===this.compass.dir||"down"===this.compass.dir?this.scrollee.object3D.position[this.compass.axis]+=this.distance:"right"!==this.compass.dir&&"up"!==this.compass.dir||(this.scrollee.object3D.position[this.compass.axis]-=this.distance),this.pos=this.twoDecimal(this.pos),this.location>0?(t=-1*(this.location*this.size+this.size),e=t+this.size):this.location<0?(e=-1*(this.location*this.size-this.size),t=e-this.size):(t=this.location*this.size-this.size,e=this.location*this.size+this.size),t=this.twoDecimal(t),e=this.twoDecimal(e),this.pos>e?(this.location--,this.opacityPlus=1,this.opacityMinus=0,this.direction="plus",this.opacInit=!1,this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+2),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-3),this.extraEl=this.getMapEl(this.scrollMap,this.location+4),this.extraEl.object3D.position[this.compass.axis]=(this.location-this.elements.length/2)*this.size,console.log("Shift Plus"),console.log(this.pos),console.log(this.location)):this.pos<t&&(this.location++,this.opacityPlus=0,this.opacityMinus=1,this.direction="minus",this.opacInit=!1,this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+3),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-2),this.extraEl=this.getMapEl(this.scrollMap,this.location-4),this.extraEl.object3D.position[this.compass.axis]=(this.location+this.elements.length/2)*this.size,console.log("Shift Minus"),console.log(this.pos),console.log(this.location));let i=0;this.pos>this.prevPos?(this.opacInit&&("minus"!==this.direction&&this.direction||(this.opacityPlus=1,this.opacityMinus=0,this.direction="plus",this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+2),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-3),this.extraEl=this.getMapEl(this.scrollMap,this.location+4),this.extraEl.object3D.position[this.compass.axis]=(this.location-this.elements.length/2)*this.size,console.log("swap"))),i=this.twoDecimal((this.pos-this.prevPos)*this.data.options),this.opacityPlus=this.twoDecimal(this.opacityPlus-i),this.opacityMinus=this.twoDecimal(this.opacityMinus+i),console.log("Plus")):this.pos<this.prevPos&&(this.opacInit&&("plus"!==this.direction&&this.direction||(this.opacityPlus=0,this.opacityMinus=1,this.direction="minus",this.plusFadeEl=this.getMapEl(this.scrollMap,this.location+3),this.minusFadeEl=this.getMapEl(this.scrollMap,this.location-2),this.extraEl=this.getMapEl(this.scrollMap,this.location-4),this.extraEl.object3D.position[this.compass.axis]=(this.location+this.elements.length/2)*this.size,console.log("swap"))),i=this.twoDecimal((this.prevPos-this.pos)*this.data.options),this.opacityPlus=this.twoDecimal(this.opacityPlus+i),this.opacityMinus=this.twoDecimal(this.opacityMinus-i),console.log("Minus")),this.prevPos=this.pos,this.plusFadeEl&&this.minusFadeEl&&(this.plusFadeEl.setAttribute("material",{opacity:this.opacityPlus}),this.minusFadeEl.setAttribute("material",{opacity:this.opacityMinus})),console.log({previous:t,next:e,location:this.location,plusFadeEl:this.plusFadeEl,minusFadeEl:this.minusFadeEl,extraEl:this.extraEl})}else"cylinder"===this.data.type&&("left"===this.compass?this.scrollee.object3D.rotation.y+=this.distance:"right"===this.compass?this.scrollee.object3D.rotation.y-=this.distance:"up"===this.compass?this.scrollee.object3D.rotation.x+=this.distance:"down"===this.compass&&(this.scrollee.object3D.rotation.x-=this.distance));this.previous.copy(this.intersection.point)}},tick:function(t,e){this.scrollThrottled()}}),AFRAME.registerComponent("doorway",{dependencies:["auxl"],schema:{zone:{type:"string",default:"zone0"},to:{type:"string",default:"connect0"},delay:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.zone=this.data.zone,this.to=this.data.to,this.delay=this.data.delay},swap:function(){this.timeout=setTimeout((()=>{this.auxl[this.zone].Move(this.to),clearTimeout(this.timeout)}),this.delay)},events:{click:function(t){this.swap()}},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("doorway-trigger",{dependencies:["auxl"],schema:{zone:{type:"string",default:"zone0"},to:{type:"string",default:"connect0"},delay:{type:"number",default:0}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.zone=this.data.zone,this.to=this.data.to,this.delay=this.data.delay},swap:function(){this.timeout=setTimeout((()=>{this.auxl[this.zone].Move(this.to),clearTimeout(this.timeout)}),this.delay)},remove:function(){clearTimeout(this.timeout)}}),AFRAME.registerComponent("clickaddinventory",{dependencies:["auxl"],multiple:!0,schema:{item:{type:"string",default:"itemName"},once:{type:"boolean",default:!0},delay:{type:"number",default:0},despawn:{type:"boolean",default:!0},auxlObj:{type:"string",default:"auxlObj"},despawnMethod:{type:"string",default:"DespawnCore"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,this.item=this.data.item,this.once=this.data.once,this.delay=this.data.delay,this.give=!0,this.despawn=this.data.despawn,this.auxlObj=this.data.auxlObj,this.despawnMethod=this.data.despawnMethod},events:{click:function(){this.give&&(this.timeout=setTimeout((()=>{this.auxl.comp.AddToInventory({item:this.auxl[this.item]}),this.once&&(this.give=!1),this.despawn&&this.auxl[this.auxlObj][this.despawnMethod](),clearTimeout(this.timeout)}),this.delay))}}}),AFRAME.registerComponent("acceptobject",{dependencies:["auxl"],multiple:!0,schema:{item:{type:"string",default:"itemName"},uses:{type:"number",default:1},delay:{type:"number",default:0},despawn:{type:"boolean",default:!0},auxlObj:{type:"string",default:"auxlObj"},despawnMethod:{type:"string",default:"DespawnCore"},methodObj:{type:"string",default:"auxlObj"},component:{type:"string",default:"null"},method:{type:"string",default:"methodName"},params:{type:"string",default:"null"}},init:function(){this.auxl=document.querySelector("a-scene").systems.auxl,this.domEnt,this.item=this.data.item,this.uses=this.data.uses,this.delay=this.data.delay,this.inUse=!1,this.despawn=this.data.despawn,this.auxlObj=this.data.auxlObj,this.despawnMethod=this.data.despawnMethod,this.methodObj=this.data.methodObj,this.component=this.data.component,this.method=this.data.method,this.params=this.data.params},run:function(){this.timeout=setTimeout((()=>{"null"===this.component?this.auxl[this.methodObj][this.method]&&("null"===this.params?this.auxl[this.methodObj][this.method]():this.auxl[this.methodObj][this.method](this.params)):document.getElementById(this.methodObj)&&(this.domEnt=document.getElementById(this.methodObj),"null"===this.params?this.domEnt.components[this.component][this.method]():this.domEnt.components[this.component][this.method](this.params)),"limited"===this.auxl[this.item].persist&&(this.auxl[this.item].amount--,this.auxl.comp.UpdateInventoryMenu(),this.auxl.player.Unequip()),this.uses--,this.uses<=0&&this.despawn&&this.auxl[this.auxlObj][this.despawnMethod](),this.inUse=!1,clearTimeout(this.timeout)}),this.delay)},events:{click:function(){this.auxl.player.layer.equipped&&this.auxl.player.layer.equippedObject===this.item&&(this.inUse||(this.inUse=!0,this.run()))}}}),AFRAME.registerComponent("add-physics",{dependencies:["auxl"],init:function(){playerRig.addEventListener("collide",(function(t){console.log("Player has collided with body #"+t.detail.body.id),t.detail.target.el,t.detail.body.el,t.detail.contact,t.detail.contact.ni,new CANNON.Vec3(0,.125,0),new CANNON.Vec3(-10,0,0),new THREE.Quaternion(0,0,0,0);let e=new THREE.Vector3(0,6,-6);t.detail.body.el.body.position.copy(e)}))}}),AFRAME.registerComponent("auxl-third-party",{dependencies:["auxl"],init:function(){const t=document.querySelector("a-scene").systems.auxl;t.TestObj=e=>{let i={};return i.id=e,i.testData={data:"testData",id:"test",sources:!1,text:!1,geometry:{primitive:"box",depth:.5,width:.5,height:.5},material:{shader:"standard",src:t.pattern10,repeat:"1 1",color:"#52a539",emissive:"#52a539",emissiveIntensity:.25,opacity:1},position:new THREE.Vector3(-1.5,2.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{doorway:{zone:"zone0",to:"connect0"}}},i.test=t.Core(i.testData),{testObj:i,SpawnTest:()=>{i.test.SpawnCore()},DespawnTest:()=>{i.test.DespawnCore()},TestMethod:t=>{console.log(t)}}},t.AddObjGenToTracker("testObj","SpawnTest","DespawnTest"),t.test=t.TestObj("test"),t.buildExtra=()=>{t.test=t.TestObj("test")},t.toBeRebuilt("buildExtra")}}),AFRAME.registerShader("threeColorGradientShader",{schema:{topColor:{type:"color",default:"1 0 0",is:"uniform"},middleColor:{type:"color",default:"0 1 0",is:"uniform"},bottomColor:{type:"color",default:"0 0 1",is:"uniform"}},vertexShader:["varying vec3 vWorldPosition;","void main() {"," vec4 worldPosition = modelMatrix * vec4( position, 1.0 );"," vWorldPosition = worldPosition.xyz;"," gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 bottomColor;","uniform vec3 middleColor;","uniform vec3 topColor;","uniform float offset;","varying vec3 vWorldPosition;","void main() {"," float h = normalize( vWorldPosition ).y;"," if (h>0.0) {","   gl_FragColor = vec4( mix( middleColor, topColor, max( pow( max(h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," } else {","   gl_FragColor = vec4( mix( middleColor, bottomColor, max( pow( max(-h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," }","}"].join("\n")}),AFRAME.registerComponent("library",{dependencies:["auxl"],init:function(){const t=document.querySelector("a-scene").systems.auxl;t.mintyGreen="#3EB489",t.mintyPink="#C14B76",t.vaporPink="#ff71ce",t.vaporBlue="#01cdfe",t.vaporGreen="#05ffa1",t.vaporPurple="#b967ff",t.vaporYellow="#fffb96",t.pattern01="./assets/img/tiles/kenny/pattern_01.png",t.pattern02="./assets/img/tiles/kenny/pattern_02.png",t.pattern03="./assets/img/tiles/kenny/pattern_03.png",t.pattern04="./assets/img/tiles/kenny/pattern_04.png",t.pattern05="./assets/img/tiles/kenny/pattern_05.png",t.pattern06="./assets/img/tiles/kenny/pattern_06.png",t.pattern07="./assets/img/tiles/kenny/pattern_07.png",t.pattern08="./assets/img/tiles/kenny/pattern_08.png",t.pattern09="./assets/img/tiles/kenny/pattern_09.png",t.pattern10="./assets/img/tiles/kenny/pattern_10.png",t.pattern11="./assets/img/tiles/kenny/pattern_11.png",t.pattern12="./assets/img/tiles/kenny/pattern_12.png",t.pattern13="./assets/img/tiles/kenny/pattern_13.png",t.pattern14="./assets/img/tiles/kenny/pattern_14.png",t.pattern15="./assets/img/tiles/kenny/pattern_15.png",t.pattern16="./assets/img/tiles/kenny/pattern_16.png",t.pattern17="./assets/img/tiles/kenny/pattern_17.png",t.pattern18="./assets/img/tiles/kenny/pattern_18.png",t.pattern19="./assets/img/tiles/kenny/pattern_19.png",t.pattern20="./assets/img/tiles/kenny/pattern_20.png",t.pattern21="./assets/img/tiles/kenny/pattern_21.png",t.pattern22="./assets/img/tiles/kenny/pattern_22.png",t.pattern23="./assets/img/tiles/kenny/pattern_23.png",t.pattern24="./assets/img/tiles/kenny/pattern_24.png",t.pattern25="./assets/img/tiles/kenny/pattern_25.png",t.pattern26="./assets/img/tiles/kenny/pattern_26.png",t.pattern27="./assets/img/tiles/kenny/pattern_27.png",t.pattern28="./assets/img/tiles/kenny/pattern_28.png",t.pattern29="./assets/img/tiles/kenny/pattern_29.png",t.pattern30="./assets/img/tiles/kenny/pattern_30.png",t.pattern31="./assets/img/tiles/kenny/pattern_31.png",t.pattern32="./assets/img/tiles/kenny/pattern_32.png",t.pattern33="./assets/img/tiles/kenny/pattern_33.png",t.pattern34="./assets/img/tiles/kenny/pattern_34.png",t.pattern35="./assets/img/tiles/kenny/pattern_35.png",t.pattern36="./assets/img/tiles/kenny/pattern_36.png",t.pattern37="./assets/img/tiles/kenny/pattern_37.png",t.pattern38="./assets/img/tiles/kenny/pattern_38.png",t.pattern39="./assets/img/tiles/kenny/pattern_39.png",t.pattern40="./assets/img/tiles/kenny/pattern_40.png",t.pattern41="./assets/img/tiles/kenny/pattern_41.png",t.pattern42="./assets/img/tiles/kenny/pattern_42.png",t.pattern43="./assets/img/tiles/kenny/pattern_43.png",t.pattern44="./assets/img/tiles/kenny/pattern_44.png",t.pattern45="./assets/img/tiles/kenny/pattern_45.png",t.pattern46="./assets/img/tiles/kenny/pattern_46.png",t.pattern47="./assets/img/tiles/kenny/pattern_47.png",t.pattern48="./assets/img/tiles/kenny/pattern_48.png",t.pattern49="./assets/img/tiles/kenny/pattern_49.png",t.pattern50="./assets/img/tiles/kenny/pattern_50.png",t.pattern51="./assets/img/tiles/kenny/pattern_51.png",t.pattern52="./assets/img/tiles/kenny/pattern_52.png",t.pattern53="./assets/img/tiles/kenny/pattern_53.png",t.pattern54="./assets/img/tiles/kenny/pattern_54.png",t.pattern55="./assets/img/tiles/kenny/pattern_55.png",t.pattern56="./assets/img/tiles/kenny/pattern_56.png",t.pattern57="./assets/img/tiles/kenny/pattern_57.png",t.pattern58="./assets/img/tiles/kenny/pattern_58.png",t.pattern59="./assets/img/tiles/kenny/pattern_59.png",t.pattern60="./assets/img/tiles/kenny/pattern_60.png",t.pattern61="./assets/img/tiles/kenny/pattern_61.png",t.pattern62="./assets/img/tiles/kenny/pattern_62.png",t.pattern63="./assets/img/tiles/kenny/pattern_63.png",t.pattern64="./assets/img/tiles/kenny/pattern_64.png",t.pattern65="./assets/img/tiles/kenny/pattern_65.png",t.pattern66="./assets/img/tiles/kenny/pattern_66.png",t.pattern67="./assets/img/tiles/kenny/pattern_67.png",t.pattern68="./assets/img/tiles/kenny/pattern_68.png",t.pattern69="./assets/img/tiles/kenny/pattern_69.png",t.pattern70="./assets/img/tiles/kenny/pattern_70.png",t.pattern71="./assets/img/tiles/kenny/pattern_71.png",t.pattern72="./assets/img/tiles/kenny/pattern_72.png",t.pattern73="./assets/img/tiles/kenny/pattern_73.png",t.pattern74="./assets/img/tiles/kenny/pattern_74.png",t.pattern75="./assets/img/tiles/kenny/pattern_75.png",t.pattern76="./assets/img/tiles/kenny/pattern_76.png",t.pattern77="./assets/img/tiles/kenny/pattern_77.png",t.pattern78="./assets/img/tiles/kenny/pattern_78.png",t.pattern79="./assets/img/tiles/kenny/pattern_79.png",t.pattern80="./assets/img/tiles/kenny/pattern_80.png",t.pattern81="./assets/img/tiles/kenny/pattern_81.png",t.pattern82="./assets/img/tiles/kenny/pattern_82.png",t.pattern83="./assets/img/tiles/kenny/pattern_83.png",t.pattern84="./assets/img/tiles/kenny/pattern_84.png",t.patterns=[t.pattern01,t.pattern02,t.pattern03,t.pattern04,t.pattern05,t.pattern06,t.pattern07,t.pattern08,t.pattern09,t.pattern10,t.pattern11,t.pattern12,t.pattern13,t.pattern14,t.pattern15,t.pattern16,t.pattern17,t.pattern18,t.pattern19,t.pattern20,t.pattern21,t.pattern22,t.pattern23,t.pattern24,t.pattern25,t.pattern26,t.pattern27,t.pattern28,t.pattern29,t.pattern30,t.pattern31,t.pattern32,t.pattern33,t.pattern34,t.pattern35,t.pattern36,t.pattern37,t.pattern38,t.pattern39,t.pattern40,t.pattern41,t.pattern42,t.pattern43,t.pattern44,t.pattern45,t.pattern46,t.pattern47,t.pattern48,t.pattern49,t.pattern50,t.pattern51,t.pattern52,t.pattern53,t.pattern54,t.pattern55,t.pattern56,t.pattern57,t.pattern58,t.pattern59,t.pattern60,t.pattern61,t.pattern62,t.pattern63,t.pattern64,t.pattern65,t.pattern66,t.pattern67,t.pattern68,t.pattern69,t.pattern70,t.pattern71,t.pattern72,t.pattern73,t.pattern74,t.pattern75,t.pattern76,t.pattern77,t.pattern78,t.pattern79,t.pattern80,t.pattern81,t.pattern82,t.pattern83,t.pattern84],t.grassMaterial={shader:"standard",color:"#55be71",opacity:1,metalness:.1,roughness:.9,emissive:"#397e4b",emissiveIntensity:.2},t.waterMaterial={shader:"standard",color:"#55a5be",opacity:1,metalness:.1,roughness:.9,emissive:"#65c3e0",emissiveIntensity:.2},t.mat0={src:"./assets/img/minty/4up.jpg",shader:"flat",color:"#FFFFFF",opacity:1},t.mat1={src:"./assets/img/vwave/1.jpg",shader:"flat",color:"#FFFFFF",opacity:1},t.mat2={src:"./assets/img/vwave/2.jpg",shader:"flat",color:"#FFFFFF",opacity:1},t.mat3={src:"./assets/img/vwave/3.jpg",shader:"flat",color:"#FFFFFF",opacity:1},t.mat4={src:"./assets/img/vwave/4.jpg",shader:"flat",color:"#FFFFFF",opacity:1},t.playerRigData={data:"playerRigData",id:"playerRig",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"universal-controls":null,locomotion:{uiid:!1,courserid:"mouseController",movetype:"desktop"},light:{type:"point",intensity:.075,distance:5,decay:.75}}},t.playerRig=t.Core(t.playerRigData),t.playerBodyData={data:"playerBodyData",id:"playerBody",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,1,0),scale:new THREE.Vector3(1,1,1),animations:{crouchdownstanding:{property:"object3D.position.y",from:0,to:-.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchDownStanding"},crouchupstanding:{property:"object3D.position.y",from:-.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchUpStanding"},crouchdownsitting:{property:"object3D.position.y",from:.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchDownSitting"},crouchupsitting:{property:"object3D.position.y",from:0,to:.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"crouchUpSitting"},sit:{property:"object3D.position.y",from:0,to:.75,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sit"},stand:{property:"object3D.position.y",from:.75,to:0,dur:750,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"stand"}},mixins:!1,classes:["a-ent","player"],components:!1},t.playerBody=t.Core(t.playerBodyData),t.cameraData={data:"Camera Entity",id:"camera",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,1.6,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:{"wasd-controls":{enabled:!1}}},t.camera=t.Core(t.cameraData),t.cameraUIData={data:"Camera UI",id:"cameraUI",sources:!1,text:{value:"Message",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold",side:"double",opacity:0},geometry:{primitive:"plane",width:.3,height:.15},material:{shader:"flat",color:"#ac2d2d",opacity:.69,side:"both"},position:new THREE.Vector3(0,.05,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{opacinbk:{property:"components.material.material.opacity",from:0,to:.82,dur:750,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacoutbk:{property:"components.material.material.opacity",from:.82,to:0,dur:750,delay:2e3,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacintxt:{property:"text.opacity",from:0,to:.82,dur:750,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"},opacouttxt:{property:"text.opacity",from:.82,to:0,dur:750,delay:2e3,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"cameraMsg"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},t.cameraUI=t.Core(t.cameraUIData),t.mouseControllerData={data:"Mouse Controller",id:"mouseController",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.005,radiusOuter:.01},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.75,.75,.75),animations:{click:{property:"scale",from:"0.75 0.75 0.75",to:"0.4 0.4 0.4",dur:100,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mousedown"},clickreset:{property:"scale",from:"0.4 0.4 0.4",to:"0.75 0.75 0.75",dur:300,delay:0,loop:"false",dir:"normal",easing:"easeOutCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseup"},hoverenter:{property:"material.color",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"material.color",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{raycaster:{enabled:"true",autoRefresh:"true",objects:".clickable",origin:new THREE.Vector3(0,0,0),direction:new THREE.Vector3(0,0,-1),far:"Infinity",near:0,interval:0,lineColor:"red",lineOpacity:.5,showLine:"false",useWorldCoordinates:"false"},cursor:{fuse:"false",rayOrigin:"mouseController",mouseCursorStylesEnabled:"true"}}},t.mouseController=t.Core(t.mouseControllerData),t.vrController1Data={data:"vrController1Data",id:"vrController1",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},t.vrController1=t.Core(t.vrController1Data),t.vrController1UIData={data:"vrController1UIData",id:"vrController1UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},t.vrController1UI=t.Core(t.vrController1UIData),t.vrController2Data={data:"vrController2Data",id:"vrController2",sources:!1,text:!1,geometry:{primitive:"ring",radiusInner:.02,radiusOuter:.03},material:{shader:"flat",color:"#228da7",opacity:.75,side:"double"},position:new THREE.Vector3(0,0,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.15,.15,.15),animations:{hoverenter:{property:"raycaster.lineColor",from:"#228da7",to:"#22a741",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoverleave:{property:"raycaster.lineColor",from:"#22a741",to:"#228da7",dur:1,delay:0,loop:"false",dir:"normal",easing:"easeInCubic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"}},mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},t.vrController2=t.Core(t.vrController2Data),t.vrController2UIData={data:"vrController2UIData",id:"vrController2UI",sources:!1,text:{value:"...",width:.5,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:.25,height:.1},material:{shader:"flat",color:"#ac2d2d",opacity:.75,side:"double"},position:new THREE.Vector3(0,-.25,-.25),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:!1,mixins:!1,classes:["a-ent","player"],components:{visible:"false"}},t.vrController2UI=t.Core(t.vrController2UIData),t.playerBeltUIData={data:"playerBeltUIData",id:"playerBeltUI",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{"look-at-xyz":{match:"camera",x:!1,y:!0,z:!1}}},t.playerBeltUI=t.Core(t.playerBeltUIData),t.playerBeltTextData={data:"playerBeltTextData",id:"playerBeltText",sources:!1,text:{value:"Hello World!",color:"#FFFFFF",align:"left",font:"exo2bold",width:.9,zOffset:.03,side:"front",wrapCount:45,baseline:"center"},geometry:{primitive:"box",depth:.025,width:1,height:.25},material:{shader:"standard",color:"#4bb8c1",opacity:.75,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{visible:!1}},t.playerBeltText=t.Core(t.playerBeltTextData),t.playerFloorData={data:"Player Floor",id:"playerFloor",sources:!1,text:!1,geometry:{primitive:"circle",radius:1,segments:32,thetaStart:0,thetaLength:360},material:{shader:"flat",src:"./assets/img/compass/compass.jpg",repeat:"1 1",color:"#3EB489",opacity:.42,side:"both"},position:new THREE.Vector3(0,.05,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player","clickable"],components:!1},t.playerFloor=t.Core(t.playerFloorData),t.playerAudioData={data:"playerAudioData",id:"playerAudio",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","player"],components:!1},t.playerAudio=t.Core(t.playerAudioData),t.fadeScreenData={data:"Fade Screen",id:"fadeScreen",sources:!1,text:!1,geometry:{primitive:"plane",width:1,height:.5},material:{shader:"flat",color:"#000000",opacity:0},position:new THREE.Vector3(0,0,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{fadein:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fade"},fadeinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene1"},fadeoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"fadeScene2"}},mixins:!1,classes:["a-ent","player","clickable"],components:{visible:!1}},t.fadeScreen=t.Core(t.fadeScreenData),t.sphereScreenData={data:"Sphere Screen",id:"sphereScreen",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.125,segmentsWidth:36,segmentsHeight:18,phiLength:360,phiStart:0,thetaLength:0,thetaStart:90},material:{shader:"flat",color:"#000000",opacity:1,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{spherein1:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein2:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout1:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},sphereout2:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphere"},spherein1scene:{property:"geometry.thetaLength",from:0,to:180,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},spherein2scene:{property:"geometry.thetaStart",from:90,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene1"},sphereout1scene:{property:"geometry.thetaLength",from:180,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"},sphereout2scene:{property:"geometry.thetaStart",from:0,to:90,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sphereScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},t.sphereScreen=t.Core(t.sphereScreenData),t.blink1ScreenData={data:"Blink 1 Screen",id:"blink1Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinscene:{property:"object3D.position.y",from:2.5,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:1,to:2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},t.blink1Screen=t.Core(t.blink1ScreenData),t.blink2ScreenData={data:"Blink 2 Screen",id:"blink2Screen",sources:!1,text:!1,geometry:{primitive:"plane",width:5,height:2},material:{shader:"flat",color:"#000000",opacity:0,side:"double"},position:new THREE.Vector3(0,-2.5,-.15),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{blinkin:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacin:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkout:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkopacout:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:800,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blink"},blinkinscene:{property:"object3D.position.y",from:-2.5,to:-1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkopacinscene:{property:"components.material.material.opacity",from:0,to:1,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene1"},blinkoutscene:{property:"object3D.position.y",from:-1,to:-2.5,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"},blinkopacoutscene:{property:"components.material.material.opacity",from:1,to:0,dur:400,delay:0,loop:"false",dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"blinkScene2"}},mixins:!1,classes:["a-ent","player"],components:{visible:!1}},t.blink2Screen=t.Core(t.blink2ScreenData),t.playerAll={parent:{core:t.playerRig},child0:{parent:{core:t.playerBody},child0:{parent:{core:t.camera},child0:{core:t.mouseController},child1:{core:t.cameraUI},child2:{core:t.fadeScreen},child3:{core:t.sphereScreen},child4:{core:t.blink1Screen},child5:{core:t.blink2Screen}},child1:{parent:{core:t.vrController1},child0:{core:t.vrController1UI}},child2:{parent:{core:t.vrController2},child0:{core:t.vrController2UI}},child3:{parent:{core:t.playerBeltUI},child0:{core:t.playerBeltText}}},child1:{core:t.playerFloor}},t.playerLayer=t.Layer("playerLayer",t.playerAll),t.player=t.Player("player",t.playerLayer),t.avatarSphereData={data:"avatarSphereData",id:"avatarSphere",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},t.avatarSphere=t.Core(t.avatarSphereData),t.avatarRigData={data:"avatarRigData",id:"avatarRig",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,1,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:{light:{type:"point",intensity:.075,distance:5,decay:.75}}},t.avatarRig=t.Core(t.avatarRigData),t.avatarBodyData={data:"avatarBodyData",id:"avatarBody",sources:!1,text:!1,geometry:{primitive:"box",depth:.95,width:.95,height:1.5},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,.75,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},t.avatarBody=t.Core(t.avatarBodyData),t.avatarFaceData={data:"avatarFaceData",id:"avatarFace",sources:!1,text:!1,geometry:{primitive:"triangle",vertexA:new THREE.Vector3(0,.5,0),vertexB:new THREE.Vector3(-.5,-.5,0),vertexC:new THREE.Vector3(.5,-.5,0)},material:{shader:"standard",color:"#1fceac",opacity:1,metalness:.2,roughness:.8,emissive:"#1fceac",emissiveIntensity:.6},position:new THREE.Vector3(0,.755,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(.95,.95,.95),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},t.avatarFace=t.Core(t.avatarFaceData),t.avatarHoverData={data:"avatarHoverData",id:"avatarHover",sources:!1,text:{value:"Avatar",width:3,color:"#FFFFFF",align:"center",font:"exo2bold"},geometry:{primitive:"plane",width:2,height:2},material:{shader:"standard",color:"#c1664b",opacity:.5,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,3,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","avatar"],components:!1},t.avatarHover=t.Core(t.avatarHoverData),t.avatarData={parent:{core:t.avatarSphere},child0:{parent:{core:t.avatarRig},child0:{parent:{core:t.avatarBody},child0:{core:t.avatarFace},child1:{core:t.avatarHover}}}},t.avatar=t.Layer("avatar",t.avatarData),t.beltUIParentData={data:"beltUIParentData",id:"beltUIParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:!1},t.beltUIParent=t.Core(t.beltUIParentData),t.locomotionForwardUIData={data:"locomotionForwardUIData",id:"locomotionForwardUI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.4,radiusBottom:1.5,radiusTop:2,segmentsHeight:6,segmentsRadial:24,thetaStart:0,thetaLength:360},material:{shader:"flat",color:"#5c174b",opacity:.3,side:"double"},position:new THREE.Vector3(0,.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:1,to:.25,dur:1250,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.25,to:1,dur:700,delay:100,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.locomotionForwardUI=t.Core(t.locomotionForwardUIData),t.locomotionReverseUIData={data:"locomotionReverseUIData",id:"locomotionReverseUI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.001,radiusBottom:1.25,radiusTop:1.5,segmentsHeight:1,segmentsRadial:24,thetaStart:0,thetaLength:360},material:{shader:"flat",color:"#46113a",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.75,to:.1,dur:1150,delay:350,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.75,dur:700,delay:250,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.locomotionReverseUI=t.Core(t.locomotionReverseUIData),t.locomotionBrake1UIData={data:"locomotionBrake1UIData",id:"locomotionBrake1UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:0,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},t.locomotionBrake1UI=t.Core(t.locomotionBrake1UIData),t.locomotionBrake2UIData={data:"locomotionBrake2UIData",id:"locomotionBrake2UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:90,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},t.locomotionBrake2UI=t.Core(t.locomotionBrake2UIData),t.locomotionBrake3UIData={data:"locomotionBrake3UIData",id:"locomotionBrake3UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:180,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},t.locomotionBrake3UI=t.Core(t.locomotionBrake3UIData),t.locomotionBrake4UIData={data:"locomotionBrake4UIData",id:"locomotionBrake4UI",sources:!1,text:!1,geometry:{primitive:"cone",openEnded:!0,height:.01,radiusBottom:.75,radiusTop:1,segmentsHeight:1,segmentsRadial:8,thetaStart:270,thetaLength:30},material:{shader:"flat",color:"red",opacity:.3,side:"double"},position:new THREE.Vector3(0,.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{brakeon:{property:"object3D.position.y",from:.5,to:.1,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOn"},brakeoff:{property:"object3D.position.y",from:.1,to:.5,dur:1050,delay:450,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"brakeOff"}},mixins:!1,classes:["clickable","a-ent","directionBrake"],components:!1},t.locomotionBrake4UI=t.Core(t.locomotionBrake4UIData),t.locomotionUIAllData={parent:{core:t.beltUIParent},child0:{core:t.locomotionForwardUI},child1:{core:t.locomotionReverseUI},child2:{core:t.locomotionBrake1UI},child3:{core:t.locomotionBrake2UI},child4:{core:t.locomotionBrake3UI},child5:{core:t.locomotionBrake4UI}},t.locomotionUILayer=t.Layer("locomotionUILayer",t.locomotionUIAllData),t.nullParentData={data:"nullParent",id:"nullParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["nullParent","a-ent"],components:!1},t.menuBaseData={data:"menu part",id:"menuBaseTemp",sources:!1,text:{value:"Hmmm...",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"box",depth:.04,width:.4,height:.15},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"},click2:{property:"material.emissiveIntensity",from:"0.6",to:"0.8",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:{stare:{id:"playerRig"}}},t.menuCylinderData={data:"menuCylinderData",id:"menuCylinder",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.menuHoverData={data:"menuHoverData",id:"menuHover",sources:!1,text:{value:"Menu",wrapCount:40,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(0,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.buildCoreData={data:"buildCoreData",id:"buildCore",sources:!1,text:{value:"Menu",wrapCount:20,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:{primitive:"circle",radius:.25,segments:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#c1664b",opacity:1,metalness:.2,roughness:.8,emissive:"#c1664b",emissiveIntensity:.6,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1:{property:"scale",from:"1 1 1",to:"1.05 1.05 1.05",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.buildHoverData={data:"buildHoverData",id:"buildHover",sources:!1,text:{value:"Menu",wrapCount:40,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center"},geometry:!1,material:!1,position:new THREE.Vector3(0,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.ghostParentData={data:"ghostParentData",id:"ghostParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},t.ghostParent=t.Core(t.ghostParentData),t.ghostAllData={data:"ghostAllData",id:"ghostAll",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.75,.75,.75),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.ghostAll=t.Core(t.ghostAllData),t.eye1SocketData={data:"eye1SocketData",id:"eye1Socket",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.175,height:.0125,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#fcfafd",emissive:"#fcfafd",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.15,.1,.4),rotation:new THREE.Vector3(90,0,0),scale:new THREE.Vector3(.75,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},t.eye1Socket=t.Core(t.eye1SocketData),t.eye2SocketData=t.coreDataFromTemplate(t.eye1SocketData,{id:"eye2Socket",position:new THREE.Vector3(.15,.1,.4)},!0),t.eye2Socket=t.Core(t.eye2SocketData),t.eye1PupilData={data:"eye1PupilData",id:"eye1Pupil",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.1,height:.025,openEnded:!1,segmentsHeight:2,segmentsRadial:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#1500fa",emissive:"#1500fa",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.01,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1.25,1,1),animations:{lookdown:{property:"position",to:new THREE.Vector3(0,.01,.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookDown"},lookup:{property:"position",to:new THREE.Vector3(0,.01,-.07),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookUp"},lookright:{property:"position",to:new THREE.Vector3(.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookRight"},lookleft:{property:"position",to:new THREE.Vector3(-.05,.01,0),dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"lookLeft"},powerup1:{property:"material.color",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#fcfafd",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},t.eye1Pupil=t.Core(t.eye1PupilData),t.eye2PupilData=t.coreDataFromTemplate(t.eye1PupilData,{id:"eye2Pupil"},!0),t.eye2Pupil=t.Core(t.eye2PupilData),t.mouthData={data:"mouthData",id:"mouth",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup:{property:"visible",to:!0,dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown:{property:"visible",to:!1,dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:{visible:!1,line:{start:new THREE.Vector3(-.3,-.2,.41),end:new THREE.Vector3(-.2,-.15,.41),color:"white"},line__2:{start:new THREE.Vector3(-.2,-.15,.41),end:new THREE.Vector3(-.1,-.2,.41),color:"white"},line__3:{start:new THREE.Vector3(-.1,-.2,.41),end:new THREE.Vector3(0,-.15,.41),color:"white"},line__4:{start:new THREE.Vector3(0,-.15,.41),end:new THREE.Vector3(.1,-.2,.41),color:"white"},line__5:{start:new THREE.Vector3(.1,-.2,.41),end:new THREE.Vector3(.2,-.15,.41),color:"white"},line__6:{start:new THREE.Vector3(.2,-.15,.41),end:new THREE.Vector3(.3,-.2,.41),color:"white"}}},t.mouth=t.Core(t.mouthData),t.spinData={data:"spinData",id:"spin",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,-.1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{rotate:{property:"object3D.rotation.y",from:0,to:360,dur:1500,delay:0,loop:!0,dir:"normal",easing:"linear",elasticity:400,autoplay:!0,enabled:!0}},mixins:!1,classes:["a-ent"],components:!1},t.spin=t.Core(t.spinData),t.headData={data:"headData",id:"head",sources:!1,text:!1,geometry:{primitive:"sphere",radius:.4,phiStart:0,phiLength:180,segmentsWidth:16,segmentsHeight:16,thetaStart:0,thetaLength:180},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,.15,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.head=t.Core(t.headData),t.bodyData={data:"bodyData",id:"body",sources:!1,text:!1,geometry:{primitive:"cylinder",radius:.4,height:.3,openEnded:!1,segmentsHeight:2,segmentsRadial:32,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.body=t.Core(t.bodyData),t.legData={data:"legData",id:"leg",sources:!1,text:!1,geometry:{primitive:"cone",radiusBottom:0,radiusTop:.15,height:.2,openEnded:!1,segmentsHeight:4,segmentsRadial:8,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#C14B76",emissive:"#C14B76",emissiveIntensity:.25,opacity:1,side:"double",metalness:.2,roughness:.8},position:new THREE.Vector3(-.25,-.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{powerup1:{property:"material.color",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerup2:{property:"material.emissive",to:"#1500fa",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredUp"},powerdown1:{property:"material.color",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"},powerdown2:{property:"material.emissive",to:"#C14B76",dur:100,delay:0,loop:!1,dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"poweredDown"}},mixins:!1,classes:["a-ent"],components:!1},t.leg1Data=t.coreDataFromTemplate(t.legData,{id:"leg1"},!0),t.leg1=t.Core(t.leg1Data),t.leg2Data=t.coreDataFromTemplate(t.legData,{id:"leg2",position:new THREE.Vector3(.25,-.25,0)},!0),t.leg2=t.Core(t.leg2Data),t.leg3Data=t.coreDataFromTemplate(t.legData,{id:"leg3",position:new THREE.Vector3(0,-.25,-.25)},!0),t.leg3=t.Core(t.leg3Data),t.leg4Data=t.coreDataFromTemplate(t.legData,{id:"leg4",position:new THREE.Vector3(0,-.25,.25)},!0),t.leg4=t.Core(t.leg4Data),t.ghostLayerData={parent:{core:t.ghostParent},child0:{parent:{core:t.ghostAll},child0:{parent:{core:t.eye1Socket},child0:{core:t.eye1Pupil}},child1:{parent:{core:t.eye2Socket},child0:{core:t.eye2Pupil}},child2:{core:t.mouth},child3:{parent:{core:t.spin},child0:{core:t.head},child1:{core:t.body},child2:{core:t.leg1},child3:{core:t.leg2},child4:{core:t.leg3},child5:{core:t.leg4}}}},t.ghost=t.Layer("ghost",t.ghostLayerData),t.compCubeParentData={data:"compCubeParentData",id:"compCubeParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},t.compCubeParent=t.Core(t.compCubeParentData),t.compCubeData={data:"compCubeData",id:"compCube",sources:!1,text:{value:"Menu",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.135,side:"double"},geometry:{primitive:"box",depth:.25,width:.25,height:.25},material:{src:"./assets/img/minty/4up.jpg",shader:"flat",color:"#FFFFFF",opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.compCube=t.Core(t.compCubeData),t.cubeLayerData={parent:{core:t.compCubeParent},child0:{core:t.compCube}},t.compCubeLayer=t.Layer("compCubeLayer",t.cubeLayerData),t.compSphereParentData={data:"compSphereParentData",id:"compSphereParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(2,1.5,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},t.compSphereParent=t.Core(t.compSphereParentData),t.compSphereData={data:"compSphereData",id:"compSphere",sources:!1,text:{value:"Menu",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.26,side:"double"},geometry:{primitive:"sphere",radius:.25},material:{src:"./assets/img/minty/4up.jpg",shader:"flat",color:"#FFFFFF",opacity:1},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.compSphere=t.Core(t.compSphereData),t.compSphereLayerData={parent:{core:t.compSphereParent},child0:{core:t.compSphere}},t.compSphereLayer=t.Layer("compSphereLayer",t.compSphereLayerData),t.compBubbleParentData={data:"compBubbleParentData",id:"compBubbleParent",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:.75,zOffset:.025,side:"front",wrapCount:35,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.8,height:.15},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.45,-.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.compBubbleParent=t.Core(t.compBubbleParentData),t.compBubbleCloseData={data:"compBubbleCloseData",id:"compBubbleClose",sources:!1,text:{value:"X",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.025,side:"front",wrapCount:2,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.08,height:.08},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.5,.06,-.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"},hoveron:{property:"text.color",to:"#000000",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"text.color",to:"#ffffff",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click:{property:"scale",from:"1 1 1",to:"1.25 1.25 1.25",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.compBubbleClose=t.Core(t.compBubbleCloseData),t.compBubbleResetData={data:"compBubbleResetData",id:"compBubbleReset",sources:!1,text:{value:"@",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.025,side:"front",wrapCount:2,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.08,height:.08},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.5,-.04,-.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.01,.01,.01),animations:{loadin:{property:"scale",from:new THREE.Vector3(.01,.01,.01),to:new THREE.Vector3(1,1,1),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadin"},loadout:{property:"scale",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(.01,.01,.01),dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"loadout"},hoveron:{property:"text.color",to:"#000000",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseenter"},hoveroff:{property:"text.color",to:"#ffffff",dur:100,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"mouseleave"},click:{property:"scale",from:"1 1 1",to:"1.25 1.25 1.25",dur:125,delay:0,loop:"1",dir:"alternate",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.compBubbleReset=t.Core(t.compBubbleResetData),t.compBubbleLayerData={parent:{core:t.compBubbleParent},child0:{core:t.compBubbleClose},child1:{core:t.compBubbleReset}},t.compBubbleLayer=t.Layer("compBubbleLayer",t.compBubbleLayerData),t.compPage0Data={info:{id:"compPage0",description:"Companion page 0.",tags:"comp",nextPage:null,prevPage:null,timeline:"linear"},timeline0:{self:{Speak:{speech:"Hey there!"}}},timeline1:{self:{Speak:{speech:"Having fun?"}}},timeline2:{self:{Speak:{speech:"Lets look around."}}},timeline3:{self:{Speak:{speech:"Whats over there?"}}},timeline4:{self:{Speak:{speech:"Now... where was that cookie I was eating?"}}},timeline5:{self:{Speak:{speech:"Found it!"}}},timeline6:{self:{NewPage:!0}}},t.compPage1Data={info:{id:"compPage1",description:"Companion page 1.",tags:"comp",nextPage:null,prevPage:null,timeline:"linear"},timeline0:{self:{Speak:{speech:"2 Hey there!"}}},timeline1:{self:{Speak:{speech:"2 Having fun?"}}},timeline2:{self:{Speak:{speech:"2 Lets look around."}}},timeline3:{self:{Speak:{speech:"2 Whats over there?"}}},timeline4:{self:{Speak:{speech:"2 Now... where was that cookie I was eating?"}}},timeline5:{self:{Speak:{speech:"2 Found it!"}}},timeline6:{self:{ResetBook:!0}}},t.compIdleData={info:{id:"compIdleData",description:"Companion idle page.",tags:"comp",nextPage:null,prevPage:null,timeline:"random"},timeline0:{self:{Speak:{speech:"Yo ho ho ho and a bottle of rum for me..."}}},timeline1:{self:{Speak:{speech:"Ooh a piece of candy!"}}},timeline2:{self:{Speak:{speech:"Nom nom nom nom..."}}},timeline3:{self:{Speak:{speech:"Yada yada yada..."}}},timeline4:{self:{Speak:{speech:"Whistle whistle whistle..."}}},timeline5:{self:{Speak:{speech:"16 16 16..."}}},timeline6:{self:{Speak:{speech:"Twinkle twinkle little star..."}}},timeline7:{self:{IdleReset:!0}}},t.compBookData={info:{id:"compBook",name:"Comp",description:"Companion book.",tags:"comp",timeline:"other",idleDelay:5e3,idleInterval:7e3},pages:{page0:t.compPage0Data,page1:t.compPage1Data},idle:{page0:t.compIdleData}},t.comp=t.Companion("comp",t.ghost),t.configurationViewData={data:"configurationViewData",id:"configurationView",sources:!1,text:{value:"Controls",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:1},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,1.5,-2),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:{clickrun:{cursorObj:"comp",method:"ToggleControlView"},stare:{id:"playerRig",twist:!0}}},t.configurationView=t.Core(t.configurationViewData),t.sceneTextData={data:"Scene display text.",id:"sceneText",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.textBubbleSideData={data:"text bubble to the side of user/character",id:"textBubbleSide",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:.45,zOffset:.025,side:"front",wrapCount:45,baseline:"center"},geometry:{primitive:"box",depth:.025,width:.5,height:.15},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(.375,1.7,-.65),rotation:new THREE.Vector3(5,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.textBubbleSide=t.Core(t.textBubbleSideData),t.textBubbleBottomData={data:"text bubble on bottom",id:"textBubbleBottom",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,.69,-.8),rotation:new THREE.Vector3(-30,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.textBubbleBottom=t.Core(t.textBubbleBottomData),t.textBubbleTopData={data:"text bubble on top",id:"textBubbleTop",sources:!1,text:{value:"... ... ...",color:"#FFFFFF",align:"left",font:"exo2bold",width:1.9,zOffset:.025,side:"front",wrapCount:75,baseline:"center"},geometry:{primitive:"box",depth:.025,width:2,height:.3},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,2.05,-1.25),rotation:new THREE.Vector3(15,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["clickable","a-ent"],components:!1},t.textBubbleTop=t.Core(t.textBubbleTopData),t.detailMainData={data:"detailMainData",id:"detailMain",sources:!1,text:{value:"Details...",color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.065,side:"double"},geometry:{primitive:"box",depth:.1,width:1,height:1},material:{shader:"standard",color:"#4bb8c1",opacity:1,metalness:.2,roughness:.8,emissive:"#4bb8c1",emissiveIntensity:.6},position:new THREE.Vector3(0,1.5,-1.5),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(0,0,0),animations:{opening:{property:"scale",from:"0.001 0.001 0.001",to:"1 1 1",dur:500,delay:50,loop:"false",dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"open"},close:{property:"scale",from:"1 1 1",to:"0.001 0.001 0.001",dur:500,delay:50,loop:!1,dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"}},mixins:!1,classes:["a-ent"],components:{stare:{id:"playerRig"}}},t.detailCloseData={data:"detailCloseData",id:"detailClose",sources:!1,text:{value:"X",width:3,color:"#FFFFFF",align:"center",font:"exo2bold",zOffset:.065,side:"double"},geometry:{primitive:"box",depth:.1,width:.25,height:.25},material:{shader:"standard",color:"#c14b4b",opacity:1,metalness:.2,roughness:.8,emissive:"#c14b4b",emissiveIntensity:.6},position:new THREE.Vector3(.5,.5,.05),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(0,0,0),animations:{opening:{property:"scale",from:"0.001 0.001 0.001",to:"1 1 1",dur:500,delay:50,loop:"false",dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!0,enabled:!0,startEvents:"open"},close:{property:"scale",from:"1 1 1",to:"0.001 0.001 0.001",dur:500,delay:50,loop:!1,dir:"linear",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"close"}},mixins:!1,classes:["clickable","a-ent"],components:!1},t.teleportParentData={data:"teleportParentData",id:"teleportParent",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,.025,0),rotation:new THREE.Vector3(-90,0,0),scale:new THREE.Vector3(1,1,1),animations:{click1pos:{property:"object3D.position.y",from:.025,to:.75,dur:2e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1rot:{property:"object3D.rotation.x",from:-90,to:720,dur:2e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},posreset:{property:"object3D.position.y",from:.75,to:.025,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},rotreset:{property:"object3D.rotation.x",from:720,to:-90,dur:1e3,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},posresetinstant:{property:"object3D.position.y",from:.75,to:.025,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"},rotresetinstant:{property:"object3D.rotation.x",from:720,to:-90,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutElastic",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"}},mixins:!1,classes:["a-ent"],components:!1},t.teleportConfirmData={data:"teleportConfirmData",id:"teleportConfirm",sources:!1,text:{value:"Teleport Here",wrapCount:45,width:5,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",opacity:.75},geometry:{primitive:"circle",radius:.75,segments:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#838282",opacity:.75,metalness:.6,roughness:.4,emissive:"#838282",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable","teleporter","teleport"],components:{teleportation:null}},t.teleportCancelData={data:"teleportCancelData",id:"teleportCancel",sources:!1,text:{value:"Cancel",wrapCount:45,width:5,color:"#FFFFFF",font:"exo2bold",zOffset:.025,side:"double",align:"center",baseline:"center",opacity:0},geometry:{primitive:"circle",radius:.75,segments:16,thetaStart:0,thetaLength:360},material:{shader:"standard",color:"#838282",opacity:0,metalness:.6,roughness:.4,emissive:"#838282",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(0,1.25,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(.5,.5,.5),animations:{click1opac:{property:"material.opacity",from:0,to:.75,dur:1e3,delay:1800,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1textopac:{property:"text.opacity",from:0,to:1,dur:1e3,delay:1800,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"click1"},click1opacreset:{property:"material.opacity",from:.75,to:0,dur:500,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},click1textopacreset:{property:"text.opacity",from:1,to:0,dur:500,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"reset"},click1opacresetinstant:{property:"material.opacity",from:.75,to:0,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"},click1textopacresetinstant:{property:"text.opacity",from:1,to:0,dur:50,delay:0,loop:!1,dir:"normal",easing:"easeInOutSine",elasticity:400,autoplay:!1,enabled:!0,startEvents:"resetInstant"}},mixins:!1,classes:["a-ent","clickable","teleporter","cancel"],components:{teleportation:null}};let e=[new THREE.Vector3(0,.025,0),new THREE.Vector3(-5,.025,-5),new THREE.Vector3(0,.025,-10),new THREE.Vector3(-5,.025,5),new THREE.Vector3(-10,.025,0),new THREE.Vector3(5,.025,-5),new THREE.Vector3(10,.025,0),new THREE.Vector3(5,.025,5),new THREE.Vector3(0,.025,10)];t.teleport=t.Teleport("teleport",e);let i=[new THREE.Vector3(0,.025,0),new THREE.Vector3(-5,.025,-5),new THREE.Vector3(-5,.025,5),new THREE.Vector3(5,.025,-5),new THREE.Vector3(5,.025,5)];t.teleport0=t.Teleport("teleport0",i),t.teleportPortalData={data:"teleportPortalData",id:"teleportPortal",sources:!1,text:!1,geometry:{primitive:"plane",width:2,height:10},material:{shader:"standard",color:"#beef1a",opacity:.25,metalness:.6,roughness:.4,emissive:"#beef1a",emissiveIntensity:.2,side:"double"},position:new THREE.Vector3(10,5,-10),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent","clickable"],components:{stare:{id:"playerRig",twist:!0},"raycast-teleportation":null}},t.teleportPortal1Data=t.coreDataFromTemplate(t.teleportPortalData,{id:"teleportPortal1"},!0),t.teleportPortal1=t.Core(t.teleportPortal1Data),t.teleportPortal2Data=t.coreDataFromTemplate(t.teleportPortalData,{id:"teleportPortal2",position:new THREE.Vector3(0,5,3)},!0),t.teleportPortal2=t.Core(t.teleportPortal2Data),t.directionalLightData={data:"directionalLight",id:"directionalLight",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(-1,1,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.1,to:1,dur:t.timeInDay/4,delay:0,loop:"true",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(-1,1,-1),to:new THREE.Vector3(1,1,1),dur:t.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:1,castShadow:!1}}},t.directionalLight=t.Core(t.directionalLightData),t.ambientLightData={data:"ambientLight",id:"ambientLight",entity:"preAdded",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.5,to:.25,dur:t.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daycolor:{property:"light.color",from:"#99154E",to:"#fffb96",dur:t.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"ambient",intensity:1,color:"#716a9a"}}},t.ambientLight=t.Core(t.ambientLightData),t.directionalLight2Data={data:"directionalLight2",id:"directionalLight2",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(1,1,1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{nightlight:{property:"light.intensity",from:.2,to:.1,dur:t.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(1,1,1),to:new THREE.Vector3(-1,1,-1),dur:t.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:.1,castShadow:!1}}},t.directionalLight2=t.Core(t.directionalLight2Data),t.directionalLight3Data={data:"directionalLight3",id:"directionalLight3",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(1,1,-1),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{daylight:{property:"light.intensity",from:.05,to:.1,dur:t.timeInDay/4,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},daypos:{property:"position",from:new THREE.Vector3(1,1,-1),to:new THREE.Vector3(-1,1,-1),dur:t.timeInDay/2,delay:0,loop:"1",dir:"alternate",easing:"linear",elasticity:400,autoplay:!1,enabled:!1,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:{light:{type:"directional",intensity:.05,castShadow:!1}}},t.directionalLight3=t.Core(t.directionalLight3Data),t.sunOuterData={data:"sunOuter",id:"sunOuter",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(-5,45,0),scale:new THREE.Vector3(1,1,1),animations:{daynight:{property:"object3D.rotation.x",from:-5,to:355,dur:t.timeInDay,delay:0,loop:"1",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:!1},t.sunData={data:"sun",id:"sun",sources:!1,text:!1,geometry:{primitive:"sphere",radius:50},material:{shader:"standard",color:"#F0A500",opacity:1,side:"front",emissive:"#F0A500",emissiveIntensity:1,fog:!1},position:new THREE.Vector3(0,0,-400),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.sunOuter=t.Core(t.sunOuterData),t.sun=t.Core(t.sunData),t.sunLayerData={parent:{core:t.sunOuter},child0:{core:t.sun}},t.sunLayer=t.Layer("sunLayer",t.sunLayerData),t.moonOuterData={data:"moonOuter",id:"moonOuter",sources:!1,text:!1,geometry:!1,material:!1,position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(175,45,0),scale:new THREE.Vector3(1,1,1),animations:{daynight:{property:"object3D.rotation.x",from:175,to:535,dur:t.timeInDay,delay:0,loop:"1",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:!1},t.moonData={data:"moon",id:"moon",sources:!1,text:!1,geometry:{primitive:"sphere",radius:24},material:{shader:"standard",color:"#5c2196",opacity:1,side:"front",emissive:"#5c2196",emissiveIntensity:.75,fog:!1},position:new THREE.Vector3(0,0,-400),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.moonOuter=t.Core(t.moonOuterData),t.moon=t.Core(t.moonData),t.moonLayerData={parent:{core:t.moonOuter},child0:{core:t.moon}},t.moonLayer=t.Layer("moonLayer",t.moonLayerData),t.skyGradData={data:"sky gradient",id:"skyGrad",entity:"a-sky",sources:!1,text:!1,geometry:!1,material:{shader:"threeColorGradientShader",topColor:"#613381",middleColor:"#99154E",bottomColor:"#b967ff"},position:new THREE.Vector3(0,0,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:{sunrisetop:{property:"material.topColor",from:"#613381",to:"#01cdfe",dur:t.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunrisemid:{property:"material.middleColor",from:"#99154E",to:"#fffb96",dur:t.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunrise",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunsettop:{property:"material.topColor",from:"#01cdfe",to:"#613381",dur:t.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunset",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"},sunsetmid:{property:"material.middleColor",from:"#fffb96",to:"#99154E",dur:t.timeInDay/6,delay:0,loop:"false",dir:"normal",easing:"linear",elasticity:400,autoplay:!1,enabled:!0,startEvents:"sunset",pauseEvents:"pauseDayNight",resumeEvents:"resumeDayNight"}},mixins:!1,classes:["a-ent"],components:!1},t.skyGrad=t.Core(t.skyGradData),t.skyBox0Data={data:"skyBox0Data",id:"skyBox0",sources:!1,lights:[t.directionalLight,t.directionalLight2,t.directionalLight3,t.ambientLight],sky:[t.skyGrad],space:[t.sunLayer,t.moonLayer]},t.skyBox0=t.SkyBox(t.skyBox0Data),t.mapEdgeBasicData={data:"mapEdgeBasicData",id:"mapEdgeBasic",sources:!1,text:!1,geometry:{primitive:"box",depth:.25,width:.25,height:.5},material:{shader:"standard",color:"#6c4646",opacity:1},position:new THREE.Vector3(0,1,0),rotation:new THREE.Vector3(0,0,0),scale:new THREE.Vector3(1,1,1),animations:!1,mixins:!1,classes:["a-ent"],components:!1},t.mapEdgeBasic=t.Core(t.mapEdgeBasicData),t.buildLibrary=()=>{t.ghostParent=t.Core(t.ghostParentData),t.ghostAll=t.Core(t.ghostAllData),t.eye1Socket=t.Core(t.eye1SocketData),t.eye2Socket=t.Core(t.eye2SocketData),t.eye1Pupil=t.Core(t.eye1PupilData),t.eye2Pupil=t.Core(t.eye2PupilData),t.mouth=t.Core(t.mouthData),t.spin=t.Core(t.spinData),t.head=t.Core(t.headData),t.body=t.Core(t.bodyData),t.leg1=t.Core(t.leg1Data),t.leg2=t.Core(t.leg2Data),t.leg3=t.Core(t.leg3Data),t.leg4=t.Core(t.leg4Data),t.ghost=t.Layer("ghost",t.ghostLayerData),t.compCubeParent=t.Core(t.compCubeParentData),t.compCube=t.Core(t.compCubeData),t.compCubeLayer=t.Layer("compCubeLayer",t.cubeLayerData),t.compSphereParent=t.Core(t.compSphereParentData),t.compSphere=t.Core(t.compSphereData),t.compSphereLayer=t.Layer("compSphereLayer",t.compSphereLayerData),t.compBubbleParent=t.Core(t.compBubbleParentData),t.compBubbleClose=t.Core(t.compBubbleCloseData),t.compBubbleReset=t.Core(t.compBubbleResetData),t.compBubbleLayer=t.Layer("compBubbleLayer",t.compBubbleLayerData),t.comp=t.Companion("comp",t.ghost),t.configurationView=t.Core(t.configurationViewData),t.textBubbleSide=t.Core(t.textBubbleSideData),t.textBubbleBottom=t.Core(t.textBubbleBottomData),t.textBubbleTop=t.Core(t.textBubbleTopData),t.teleport=t.Teleport("teleport",e),t.teleport0=t.Teleport("teleport0",i),t.teleportPortal1=t.Core(t.teleportPortal1Data),t.teleportPortal2=t.Core(t.teleportPortal2Data),t.directionalLight=t.Core(t.directionalLightData),t.ambientLight=t.Core(t.ambientLightData),t.directionalLight2=t.Core(t.directionalLight2Data),t.directionalLight3=t.Core(t.directionalLight3Data),t.sunOuter=t.Core(t.sunOuterData),t.sun=t.Core(t.sunData),t.sunLayer=t.Layer("sunLayer",t.sunLayerData),t.moonOuter=t.Core(t.moonOuterData),t.moon=t.Core(t.moonData),t.moonLayer=t.Layer("moonLayer",t.moonLayerData),t.skyGrad=t.Core(t.skyGradData),t.skyBox0=t.SkyBox(t.skyBox0Data),t.mapEdgeBasic=t.Core(t.mapEdgeBasicData)},t.toBeRebuilt("buildLibrary")}})})()})();